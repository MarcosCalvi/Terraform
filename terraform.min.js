var b4w="object"===typeof b4w?b4w:function(a){var m={};a.module=m;var l={};a.ua=function(a,b){var x=m[a];x&&(x.nn=null);l[b||"__b4w_default"]=null};a.register=function(a,b){m[a]||(m[a]=b)};a.require=function(a,b){if(!m[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";l[b]||(l[b]=function(a){return function(b){var c=m[b];if(!c)throw Error('Module "'+b+'" not found');c.nn||(c.nn={});c.nn[a]||(c.nn[a]={},c(c.nn[a],l[a]));return c.nn[a]}}(b));return l[b](a)};a.module_check=function(a){return m[a]?
!0:!1};a.get_namespace=function(a){for(var b in l)if(l[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.main=function(a,m){function l(){}function c(){}function b(){}function x(){window.performance||(M.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(M.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ma.qM(0)}function q(a,b){for(var g=null,c=b?oa:ya,d=0;d<c.length;d++){var e=c[d];try{g=a.getContext(e,v)}catch(f){}if(g)break}g&&D.aU(g);return g}function A(a,b,g){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();M.error("WebGL context lost");z()},!1);P.Lf(g);var C=P.Wu();C&&M.log("%cRENDERER INFO:","color: #00a",g.getParameter(C.UNMASKED_VENDOR_WEBGL)+", "+g.getParameter(C.UNMASKED_RENDERER_WEBGL));G.Lf(g);d.Lf(g);H.Lf(g);X.Lf(g);B.Lf(g);R.Lf(g);I.mZ(a);R.Vg(a,b);T.uM(a.width,a.height,1);S.Vg();c=e();n()}function h(){l=function(){}}function z(){p()||(pa=performance.now()/1E3,S.pause(),aa.pause(),H.pause(),y.pause())}function p(){return L<pa}function n(){var a="HMD"===ba.stereo&&
f.DJ();a?a.requestAnimationFrame(n):fa(n);var b=performance.now()/1E3;na||(na=b);var g=b-na;if(!(g<1/ba.max_fps)){for(var d=ma.cm(),e=0;e<Y.length;e++)Y[e](d,g);p()||(L>na&&(g-=L-Math.max(pa,na)),d+=g,ma.qM(d),B.update(),F.update(),I.update(),u(d,g),c(g));na=b;a&&a.isPresenting&&a.submitFrame()}}function k(a,b,g){if(ea)if(ea.e_)ea.e_(a,b,g);else{g=atob(ea.toDataURL(b,g).split(",")[1]);for(var c=new Uint8Array(g.length),d=0;d<g.length;d++)c[d]=g.charCodeAt(d);a(new Blob([c],{type:b||"image/png"}))}}
function u(a,b){if(I.Yg()&&(r.reset(),W.update(b),Q.update(a,b),g.update(a,b),S.update(a,b),b&&K.update(b),I.Yg()&&(aa.update(a,b),I.Yg()&&(f.update(a),E.update(a,b),I.Yg()&&(y.update(!1),t.update(a,b),ga.update(),l(b,a),I.Yg()))))){T.update(a,b);y.LN();var d=xa.callback;d&&(xa.oK&&URL.revokeObjectURL(xa.zz),k(function(a){xa.zz=URL.createObjectURL(a);d(xa.zz)},xa.format,xa.quality),xa.callback=null,xa.format="image/png",xa.quality=1)}}function e(){var a=60,g=0,d=ba.gI,c=ba.NU;return function(e){e<
1/ba.max_fps||(a=O.mc(1/e,a,e,d),e=aa.AV(),g=(g+1)%c,0==g&&b(Math.round(a),e))}}var y=m("__anchors"),K=m("__animation"),F=m("__assets"),J=m("__config"),D=m("__compat"),R=m("__container"),E=m("__controls"),I=m("__data"),B=m("__debug"),P=m("__extensions"),d=m("__geometry"),f=m("__input"),r=m("__hud"),g=m("__nla"),Q=m("__logic_nodes"),t=m("__objects"),aa=m("__physics"),M=m("__print"),G=m("__renderer"),T=m("__scenes"),S=m("__sfx"),X=m("__shaders"),H=m("__textures"),ma=m("__time"),W=m("__transform"),O=
m("__util"),V=m("__version"),ga=m("__particles"),v=J.context,ba=J.B,ea=null,ca=null,na=0,pa=0,L=0,Y=[],xa={callback:null,format:"image/png",quality:1,zz:"",oK:!1,GH:!1},ya=["webgl","experimental-webgl"],oa=["webgl2","experimental-webgl2"],Z=null,fa=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ba.max_fps)}}();a.Vg=function(a,
b){J.$Y();M.iZ(ba.console_verbose);var g=V.oE()+" "+V.type()+" ("+V.xA()+")";M.log("%cINIT ENGINE","color: #00a",g);M.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;x();ea=a;b?(r.Vg(b),ca=b):(J.B.show_hud_debug_info=!1,J.X.Wv=!1);D.gR();D.Rz("Chrome")||D.Rz("Firefox")||(ba.gc=!1);g=q(a,ba.gc);!g&&ba.gc&&(ba.gc=!1,g=q(a,!1));if(!g)return null;M.log("%cINIT WEBGL "+(ba.gc?"2":"1"),"color: #00a");Z=g;A(ea,ca,g);J.qn();D.fM(g,!0);X.XW();ba.Sn&&(a.style["touch-action"]=
"none");M.log("%cSET PRECISION:","color: #00a",ba.precision);return g};a.resize=function(a,b,g){M.Rb("main.resize","container.resize");R.resize(a,b,g)};a.MY=function(a){b=a};a.j3=function(){b=function(){}};a.E8=function(a){l=a};a.m3=function(){h()};a.g6=function(){M.Rb("main.global_timeline","time.get_timeline");return ma.cm()};a.pause=z;a.ci=function(){p()&&(L=performance.now()/1E3,S.ci(),aa.ci(),H.play(!0),y.ci())};a.Cr=p;a.reset=function(){I.ux(0);I.reset();P.reset();G.reset();d.reset();H.rY();
X.reset();B.reset();R.reset();I.reset();R.reset();ma.reset();S.reset();ca=ea=null;L=pa=na=0;b=function(){};c=function(){};l=function(){};Y.length=0;Z=null};a.O2=function(a,b,g,d){xa.GH="undefined"===typeof d?d:!0;xa.oK=xa.GH;xa.callback=a;xa.format=b||xa.format;xa.quality=g||xa.quality};a.G4=function(){M.Rb("main.get_canvas_elem","container.get_canvas");return ea};a.Cn=function(){return D.Cn()};a.Rp=function(a){for(var b=0;b<Y.length;b++)if(Y[b]==a)return;Y.push(a)};a.eY=function(a){for(var b=0;b<
Y.length;b++)if(Y[b]==a){Y.splice(b,1);break}};a.Wu=function(){var a=P.Wu();return a?{vendor:Z.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:Z.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.__anchors=function(a,m){function l(){t=!0;y.af().addEventListener("mouseup",function(){function a(){return"visible"==d.style.visibility&&!k&&!l}if(!aa&&!g){var b=Q;if(b)if("visible"==b.lastElementChild.style.visibility)c(),Q=null;else if(1==b.style.opacity){var d=b.lastElementChild,b=b.firstElementChild,e=d.firstElementChild,f=e.innerHTML;d.style.visibility="visible";var t=Math.min(parseInt(d.style.width)||200,A(f)-24),v=h(f,t),k=!0,l=!0;b.style.display="none";aa=!0;I.Fj(0,t,200,function(b){b==
t&&(k=!1,l||(aa=!1),a&&(e.style.visibility="visible"));d.style.width=b+"px"});I.Fj(0,v,200,function(b){b==v&&(l=!1,k||(aa=!1),a&&(e.style.visibility="visible"));d.style.height=b+"px"})}}})}function c(){var a=Q.lastElementChild;Q.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function x(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function q(a,d,e){var f=document.createElement("div"),t=document.createElement("span");e&&(f.style.width=e+"px");x(f);b(t);t.innerHTML=a;f.style.visibility="hidden";t.style.visibility="hidden";f.appendChild(t);d.appendChild(f);d.addEventListener("mousedown",function(){aa||d==Q||1!=d.style.opacity||g||(Q&&"visible"==Q.lastElementChild.style.visibility&&c(),Q=d)})}function A(a){var g=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);x(g);g.appendChild(d);document.body.appendChild(g);
a=g.offsetWidth+1;document.body.removeChild(g);return a}function h(a,g){var d=document.createElement("div"),c=document.createElement("span");c.innerHTML=a;b(c);x(d);d.style.width=g+"px";d.style.display="inline-block";d.appendChild(c);document.body.appendChild(d);c=d.offsetHeight-16;document.body.removeChild(d);return c}function z(){for(var a=0,b=0;b<r.length;b++)r[b].Dn&&a++;M=new Float32Array(3*a)}function p(a,b){return b.depth-a.depth}function n(a,b,g){a=a.element;f.TJ&&(b=Math.floor(b),g=Math.floor(g));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+g+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+g+"px, 0px)":(a.style.left=b+"px",a.style.top=g+"px")}var k=m("__batch"),u=m("__camera"),e=m("__config"),y=m("__container"),K=m("__objects"),F=m("__obj_util"),J=m("__print"),D=m("__renderer"),R=m("__scenes"),E=m("__subscene"),I=m("__time"),B=m("__transform"),P=m("__tsr"),d=m("__vec3"),f=e.B,r=[],g=!1,Q=null,t=!1,aa=!1,M=new Float32Array(0),G=new Uint8Array(16),
T=new Float32Array(2),S=new Float32Array(3),X=new Float32Array(3);a.append=function(a){var g;a:{for(g=0;g<r.length;g++)if(r[g].ea==a){g=!0;break a}g=!1}if(!g){g=a.anchor.Dn&&Boolean(R.La(R.Nh(),E.cn));g={type:a.anchor.type,ea:a,x:0,y:0,depth:0,rl:"out",Dn:g,element:null,lo:null,IQ:a.anchor.oX,Uj:a.anchor.Uj};switch(g.type){case "ANNOTATION":var d=g.ea;a=y.af();var c=K.Tu(d),d=d.name,e=document.createElement("div"),f=e.cloneNode(),v=document.createElement("span"),k="";e.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
f.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";e.style.visibility="hidden";c&&(k=c.description||k,d=c.title||d);v.innerHTML=d;v.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(v);v.style.whiteSpace="nowrap";f.appendChild(v);e.appendChild(f);k&&q(k,e,g.IQ);a.appendChild(e);g.element=e;break;case "ELEMENT":if(g.element=document.getElementById(a.anchor.Uj),g.element)for(c=0;c<r.length;c++)"ELEMENT"==r[c].type&&r[c].Uj==a.anchor.Uj&&(J.warn("Anchor with the id '"+a.anchor.Uj+"' already exists, making the new anchor generic."),g.type="GENERIC");else J.warn("Anchor HTML element with the id '"+a.anchor.Uj+"' was not found, making it generic."),g.type="GENERIC"}r.push(g);z();
t||l()}};a.remove=function(a){for(var b=0;b<r.length;b++){var g=r[b];if(g.ea==a){"ANNOTATION"==g.type&&(a=g,y.af().removeChild(a.element));r.splice(b,1);z();break}}};a.update=function(a){for(var b=0,g=r.length;g--;){var d=r[g];if(d.Dn){var c=P.F(d.ea.k.n);M.set(c,3*b++)}var e;e=d;var c=S,f=R.Mh(R.Nh());e=P.F(e.ea.k.n);e=c=u.GC(f,e,c);c=e[0];f=e[1];e=e[2];if(a||c!=d.x||f!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var t=c,l=f;n(d,t,l);break;case "ELEMENT":l=d.element.getBoundingClientRect(),
t=c-l.width/2,l=f-l.height/2,n(d,t,l)}d.x=c;d.y=f;d.depth=e;d.lo&&d.lo(c,f,d.rl,d.ea,d.element)}}r.sort(p);for(g=0;g<r.length;g++)d=r[g],"GENERIC"!=d.type&&(d.element.style.zIndex=Q==d.element?r.length:g);0<b&&(a=R.La(R.Nh(),E.cn),b=a.Qa[0].sa[0],k.r_(b.za,M),E.Tc(a,b))};a.LN=function(){for(var a=y.af(),b=r.length;b--;){var g=r[b],e=g.ea,f=e.k,t=g.x,v=g.y,k=g.depth,l=R.Mh(R.Nh()),n=B.Zd(e,S),l=B.Zd(l,X),n=d.dist(n,l);(k=0>t||0>v||0>k||1<k||R.FB(e)||t>=a.clientWidth||v>=a.clientHeight)||(k=f.ff,k=
!(n<f.$g?0:k==F.Bp||n<k));f=k?"out":"visible";g.Dn&&"out"!=f&&(f=g,k=R.La(R.Nh(),E.cn).p,n=y.cu(f.x,f.y,T,k),D.NC(k.$e,n[0],k.height-n[1],2,2,G),f=1020==G[5]+G[6]+G[9]+G[10]?"visible":"out"==f.rl||0==G[5]+G[6]+G[9]+G[10]?"covered":f.rl);if(f!=g.rl){switch(g.type){case "ANNOTATION":case "ELEMENT":var h=g.element;if(!h)break;"out"==f?(h.style.visibility="hidden",h.children.length&&(h.children[0].style.visibility="hidden")):"visible"==f?(h.style.visibility="visible",h.children.length&&(h.children[0].style.visibility=
"visible"),h.style.opacity=1):(h.style.visibility="visible",h.style.opacity=.1,h.children.length&&(h.children[0].style.visibility="visible"),"ANNOTATION"==g.type&&1<h.children.length&&"visible"==h.lastElementChild.style.visibility&&(c(),h==Q&&(Q=null)))}g.rl=f;g.lo&&g.lo(t,v,g.rl,e,h)}}};a.F2=function(a,b){for(var g=0;g<r.length;g++)r[g].ea==a&&(r[g].lo=b)};a.H3=function(a){for(var b=0;b<r.length;b++)r[b].ea==a&&(r[b].lo=null)};a.ua=function(){for(var a=0;a<r.length;a++){var b=r[a];"ANNOTATION"==
b.type&&y.af().removeChild(b.element)}r.length=0};a.oW=function(a){for(var b=0;b<r.length;b++)if(r[b].ea==a)return!0;return!1};a.P4=function(a){for(var b=0;b<r.length;b++)if(r[b].ea==a)return r[b].Uj;return!1};a.pause=function(){g=!0};a.ci=function(){g=!1};a.JX=function(a,b){for(var g=-1,d=0;d<r.length;d++){var c;if(c="visible"==r[d].rl){var e=r[d];if(e.element){c=Math.round(e.element.offsetWidth)||0;var f=Math.round(e.element.offsetHeight)||0}else f=c=0;var t=e.x,e=e.y;c=a>=t&&a<=t+c&&b<e&&b>=e-
f?!0:!1}if(c)if(0>g)var k=r[d].depth,g=d;else r[d].depth<k&&(g=d,k=r[d].depth)}return 0>g?null:r[g].ea}};b4w.module.__batch=function(a,m){function l(a){a={type:a,Fb:"",id:0,tq:-1,ok:"",su:-1,An:-1,Jq:0,Af:0,Ll:[],ya:[],Ld:[],Gg:[],ud:[],Pj:[],wj:null,$c:{},zb:null,hb:{wg:null,Ye:null,Ki:[],lg:[],status:Z.gz,OU:0,l0:0,dG:0,lN:0},mk:"",Wp:[],Ba:null,Le:C.Sj(),Ke:!1,Ji:!1,tu:!1,Rr:0,vm:0,Hv:0,Iv:0,jd:!1,dv:0,qr:0,ie:new Float32Array(3),ye:new Float32Array(16),Cg:!1,Lb:!1,Ua:!1,th:!1,$b:!1,Je:!1,Yf:!1,Ge:!1,qe:!1,fe:!1,ee:!1,Hd:!1,Gd:!1,zu:!1,Ih:ka.en,rf:!1,bg:!1,Tj:!1,Ig:!1,ff:na.Bp,$g:0,ah:0,Rd:-1,Ed:-1,
iv:!1,mv:0,jv:0,nv:0,ov:0,lv:new Float32Array(3),kv:new Float32Array(3),sr:!1,Ej:0,Vj:0,Nl:1,yo:0,Qo:0,Cs:1,qo:0,Ml:0,nl:1,dw:0,Nr:0,mg:0,Bw:0,Ud:new Float32Array(2),Kk:new Float32Array(3),ji:new Float32Array(3),Mm:new Float32Array(3),Xf:new Float32Array(4),Ni:new Float32Array(4),om:null,eo:null,Gr:null,Fr:null,ak:!1,wireframe_edge_color:ia.create(),xj:!1,water_dynamic:!1,Zs:!1,Ix:!1,Jx:0,Kx:0,Hx:0,np:.1,Io:0,Ko:0,Mn:0,Ku:new Float32Array(2),Ju:new Float32Array(2),Yq:new Float32Array(2),Ho:new Float32Array(3),
Jo:new Float32Array(3),gj:null,zk:!1,gb:null,Kv:0,ol:null,Wr:null,fj:[],ej:[],Ce:[],dj:[],P:null,Ta:null,wa:null,lb:null,qb:null,ba:null,Qf:!1,Wf:!0,VJ:0,oo:new Float32Array(3)};a.Xf[3]=1;a.Ua=!0;a.Kv=1;return a}function c(a){var w=l(a.type);w.Fb=a.Fb;w.id=a.id;w.tq=a.tq;w.ok=a.ok;w.su=a.su;w.An=a.An;w.Jq=a.Jq;w.Af=a.Af;w.Ll=[];w.ya=a.ya.slice();w.Ld=a.Ld.slice();w.Gg=a.Gg.slice();w.ud=a.ud.slice();w.Pj=a.Pj.slice();w.wj=C.R(a.wj);w.$c=C.R(a.$c);w.zb=a.zb;w.hb=C.R(a.hb);w.mk=a.mk;w.Wp=ya.ES(a.Wp);
w.Ba=a.Ba;w.Ke=a.Ke;w.Ji=a.Ji;w.tu=a.tu;w.Rr=a.Rr;w.vm=a.vm;w.Hv=a.Hv;w.Iv=a.Iv;w.dv=a.dv;w.qr=a.qr;w.ie=a.ie;w.ye=a.ye;w.Cg=a.Cg;w.Lb=a.Lb;w.Ua=a.Ua;w.th=a.th;w.$b=a.$b;w.Je=a.Je;w.Yf=a.Yf;w.Ge=a.Ge;w.qe=a.qe;w.fe=a.fe;w.ee=a.ee;w.Hd=a.Hd;w.Gd=a.Gd;w.jd=a.jd;w.zu=a.zu;w.Ih=a.Ih;w.rf=a.rf;w.bg=a.bg;w.Tj=a.Tj;w.Ig=a.Ig;w.ff=a.ff;w.$g=a.$g;w.ah=a.ah;w.Rd=a.Rd;w.Ed=a.Ed;w.iv=a.iv;w.mv=a.mv;w.jv=a.jv;w.nv=a.nv;w.ov=a.ov;ia.copy(a.lv,w.lv);ia.copy(a.kv,w.kv);w.sr=a.sr;w.Ej=a.Ej;w.Vj=a.Vj;w.Nl=a.Nl;w.yo=
a.yo;w.Qo=a.Qo;w.Cs=a.Cs;w.qo=a.qo;w.Ml=a.Ml;w.nl=a.nl;w.dw=a.dw;w.Nr=a.Nr;w.mg=a.mg;w.Bw=a.Bw;w.Ud[0]=a.Ud[0];w.Ud[1]=a.Ud[1];ia.copy(a.Kk,w.Kk);ia.copy(a.ji,w.ji);ia.copy(a.Mm,w.Mm);qa.copy(a.Xf,w.Xf);qa.copy(a.Ni,w.Ni);w.om=C.R(a.om);a.eo&&(w.eo=new Float32Array(a.eo),w.Gr=new Float32Array(a.Gr),w.Fr=new Float32Array(a.Fr));w.ak=a.ak;ia.copy(a.wireframe_edge_color,w.wireframe_edge_color);w.xj=a.xj;w.water_dynamic=a.water_dynamic;w.Zs=a.Zs;w.Ix=a.Ix;w.Jx=a.Jx;w.Kx=a.Kx;w.Hx=a.Hx;w.np=a.np;w.Io=
a.Io;w.Ko=a.Ko;w.Mn=a.Mn;w.Ku.set(a.Ku);w.Ju.set(a.Ju);w.Yq.set(a.Yq);ia.copy(a.Ho,w.Ho);ia.copy(a.Jo,w.Jo);w.gj=C.R(a.gj);w.zk=a.zk;w.gb=C.R(a.gb);w.Kv=a.Kv;a.ol&&(w.ol=new Float32Array(a.ol));w.Wr=C.R(a.Wr);w.fj=C.R(a.fj);w.ej=C.R(a.ej);w.Ce=C.R(a.Ce);w.dj=C.R(a.dj);w.P=O.Bl(a.P);w.Ta=O.Bl(a.Ta);w.ba=O.rq(a.ba);w.qb=O.rq(a.qb);w.wa=O.Cl(a.wa);w.lb=O.Cl(a.lb);w.Qf=a.Qf;w.Wf=a.Wf;w.oo=a.oo;return w}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.Fb=a.Lb?a.th?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.Fb=a.qe?"CAST":"RECEIVE";break;case "COLOR_ID":a.Fb=a.th?"COLOR_ID_XRAY":"COLOR_ID"}}function x(a,w,b){var g=[],d=h(b,w,!w.En,!1),c=a.data,e=c.materials,v=Array(e.length),k=Array(e.length),H=[],n=oa.ic(b,fa.Pb),u=!1;n&&(u=n.Jr.length?!0:!1);for(var G=0;G<d.length;G++)for(var q=d[G],p=0;p<e.length;p++){var O=e[p];if(!ka.LJ(c,p))if("PHYSICS"==q&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)H.push(ka.PA(c,p,[],w.Ci,{},null));else if(!O.b4w_lens_flares||u){var L=l(q);
"MAIN"==q?v[p]=L:"DEBUG_VIEW"==q&&(k[p]=L);L.tq=a.b4w_cluster_data.cluster_id;if(t(L,O)){"SHADOW"==q&&v[p]&&(L.Je=v[p].Je);L.Ih=w.Ke||w.Yf?ka.ht:ka.en;B(L,w);for(var M=L,S=a.particle_systems,y=0;y<S.length;y++){var ca=S[y].settings.b4w_vcol_from_name,Y=S[y].settings.b4w_vcol_to_name;""!==ca&&""!==Y&&(M.$c[ca]={$l:!1,src:[{name:ca,gg:7}]})}if("DYNAMIC"==w.type||"COLOR_ID"==L.type)L.ok=a.uuid;L.Tj=a.b4w_do_not_cull;"MAIN"==L.type&&(L.Ig=a.b4w_caustics);r(L,"DISABLE_FOG",("COLOR_ID"!=q&&"SHADOW"!=q&&
a.b4w_disable_fogging)|0);var ua=ka.PA(c,p,L.Pj,w.Ci,L.$c,L.wj);!O.use_tangent_shading||"a_shade_tangs"in ua.aa[0]||(r(L,"CALC_TBN",1),f(L,"a_tbn_quat"));O.b4w_lens_flares&&(ua=pa.VX(ua));aa(L);g.push({za:L,gf:w,Wt:w,Mf:ua,hg:[O.name],Id:[a]})}}}if(H.length){L=l("PHYSICS");L.Fb="NAVMESH";L.ok=a.uuid;for(var ua=ka.ZM(H),x=[],G=0;G<e.length;G++)x.push(e[G].name);aa(L);g.push({za:L,gf:w,Wt:w,Mf:ua,hg:x,Id:[a]})}for(G=0;G<k.length;G++)k[G]&&(k[G].An=v[G].id,aa(k[G]));var W=a.particle_systems;if(0<W.length&&
g.length){for(var D=!1,T=!1,G=0;G<W.length;G++){var F=W[G],J=F.settings;J.use_render_emitter&&(D=!0);"HAIR"!=J.type||"OBJECT"!=J.render_type&&"GROUP"!=J.render_type&&F.transforms.length||(T=!0);if(D&&T)break}var ba=g[0].za.$c,P;if(T){var I;if(1<e.length){for(var ma={},m=0;m<W.length;m++){var V=W[m].settings;if("HAIR"==V.type&&("OBJECT"==V.render_type||"GROUP"==V.render_type)){var A=V.b4w_vcol_from_name,X=V.b4w_vcol_to_name;""!==A&&""!==X&&(ma[A]=C.R(ba[A]))}}"a_bending_col_main"in ba&&(ma.a_bending_col_main=
C.R(ba.a_bending_col_main));"a_bending_col_detail"in ba&&(ma.a_bending_col_detail=C.R(ba.a_bending_col_detail));I=ka.bI(c,[],ma)}else I=g[0].Mf;P=I}else P=null;for(var Pa=P,R=a.pb,K=[],wa=a.particle_systems,E=a.data,ea=0;ea<wa.length;ea++){var xb=wa[ea],Wa=xb.settings;if(Wa.count)if("EMITTER"==Wa.type){if("DYNAMIC"==w.type){var ha=l("PARTICLES");ha.wa=w.wa;ha.P=w.P;ha.ba=w.ba;ha.lb=w.lb;ha.Ta=w.Ta;ha.qb=w.qb;var Ea,ya=E.materials,Ba=xb.settings.material-1;Ba>=ya.length&&(ga.warn('Wrong material used for rendering particle system "'+
xb.name+'"'),Ba=0);Ea=ya[Ba];"HALO"===xb.settings.render_type&&"HALO"===Ea.type&&(ha.sr=!0);z(ha,Ea);var Ca=ha,Ga=a,la=xb.settings;switch(la.b4w_billboard_align){case "VIEW":r(Ca,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":r(Ca,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":r(Ca,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":r(Ca,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:C.q("Wrong billboard align value")}r(Ca,"BILLBOARD",0);var qa=la.b4w_enable_soft_particles&&
na.PG(Ga,la);r(Ca,"SOFT_PARTICLES",0<la.b4w_particles_softness&&qa&&ja.xu?1:0);r(Ca,"SOFT_STRENGTH",Z.M(la.b4w_particles_softness));Z.ha(Ca.hb,"WORLD_SPACE","WORLD"==la.b4w_coordinate_system?1:0);ha.Yf=!0;ha.Tj=a.b4w_do_not_cull;ha.ok=R.name+"_"+Wa.uuid;pa.jW(ha,xb,Ea);var Qa=pa.aV(ha,E,xb,R.k);pa.P_(Qa,ha,Wa.count);pa.O_(R);B(ha,R.k);aa(ha);K.push({za:ha,gf:w,Wt:w,Mf:Qa,hg:[Ea.name],Id:[a]})}}else if("HAIR"==Wa.type){var va=C.wv(xb.seed),ta=xa.QG(ja.RB)&&!Wa.b4w_initial_rand_rotation&&!Wa.b4w_hair_billboard,
Db=4;ta&&(Db=8);if(xb.transforms.length)var nb=xb.transforms;else for(var jb=ka.VA(Pa,Wa.count,!1,va),nb=new Float32Array(jb.length*Db),kb=0;kb<jb.length;kb++){var Gc=.75+.5*C.qg(va);nb[kb*Db]=jb[kb][0];nb[kb*Db+1]=jb[kb][1];nb[kb*Db+2]=jb[kb][2];nb[kb*Db+3]=Gc;ta&&(nb[kb*Db+4]=1,nb[kb*Db+5]=0,nb[kb*Db+6]=0,nb[kb*Db+7]=0)}var wc=oa.ic(b,fa.ui)?!0:!1;if("OBJECT"==Wa.render_type){var hc=[h(b,Wa.dupli_object.pb.k,!w.En,!0)],Eb=Q(a,w,ba,Pa,[Wa.dupli_object],hc,[nb],Wa,xb,wc,va,!1);K.push.apply(K,Eb)}else if("GROUP"==
Wa.render_type){for(var ac=Wa.dupli_group.objects,hc=[],kb=0;kb<ac.length;kb++){var xc=h(b,ac[kb].pb.k,!w.En,!0);hc.push(xc)}for(var Rb=!1,ic=[],kb=0;kb<ac.length;kb++)ic.push(ac[kb].pb);if(Wa.use_whole_group){for(var yc,pb=nb,ab=ic,Kc=ta,dd=Db,Fb={},Yb=new Float32Array([0,0,0,1]),gb=0;gb<pb.length;gb+=dd)for(var qb=0;qb<ab.length;qb++){var yb=ia.create(),Yc=N.td(ab[qb].k.n),Sc=N.F(ab[qb].k.n);ia.scale(Sc,Yc,yb);var jc=ia.clone([pb[gb],pb[gb+1],pb[gb+2]]);Fb[qb]||(Fb[qb]=new Float32Array(pb.length));
Kc&&(Fb[qb][gb+4]=Yb[0]=pb[gb+4],Fb[qb][gb+5]=Yb[1]=pb[gb+5],Fb[qb][gb+6]=Yb[2]=pb[gb+6],Fb[qb][gb+7]=Yb[3]=pb[gb+7],C.IC(Yb,Yb),C.i_(yb,Yb,yb));ia.add(jc,yb,jc);Fb[qb][gb]=jc[0];Fb[qb][gb+1]=jc[1];Fb[qb][gb+2]=jc[2];Fb[qb][gb+3]=pb[gb+3]}yc=Fb;Rb=!0}else{var nc;if(Wa.use_group_count){for(var Jb=nb,oc=ic,pc=Wa.dupli_weights,Tc=va,zc=ta,qc=Db,Kb={},Xa=[],Oa=0;Oa<oc.length;Oa++)for(var Sb=oc[Oa],kc=Sb.wm||Sb.name,Ua=0;Ua<pc.length;Ua++){var zb=pc[Ua];kc==zb.name&&Xa.push(zb)}pc.length!=Xa.length&&ga.error("dupli weights match failed");
for(Oa=0;Oa<Jb.length;Oa+=qc){for(var Lb,Tb=Xa,bc=[0],Gb=0;Gb<Tb.length;Gb++)bc[Gb+1]=bc[Gb]+Tb[Gb].count;for(var Ab=bc[bc.length-1]*C.qg(Tc),bb=0,Gb=0;Gb<bc.length;Gb++)if(Ab>=bc[Gb]&&Ab<bc[Gb+1]){bb=Gb;break}Lb=bb;Kb[Lb]=Kb[Lb]||[];Kb[Lb].push(Jb[Oa],Jb[Oa+1],Jb[Oa+2],Jb[Oa+3]);zc&&Kb[Lb].push(Jb[Oa+4],Jb[Oa+5],Jb[Oa+6],Jb[Oa+7])}for(Lb in Kb)Kb[Lb]=new Float32Array(Kb[Lb]);nc=Kb}else{for(var Bb=nb,Ka=va,cc=ta,Ma=Db,dc=ic.length,Ha={},tb=0;tb<Bb.length;tb+=Ma){var Pb=Math.floor(dc*C.qg(Ka));Ha[Pb]=
Ha[Pb]||[];Ha[Pb].push(Bb[tb],Bb[tb+1],Bb[tb+2],Bb[tb+3]);cc&&Ha[Pb].push(Bb[tb+4],Bb[tb+5],Bb[tb+6],Bb[tb+7])}for(Pb in Ha)Ha[Pb]=new Float32Array(Ha[Pb]);nc=Ha}yc=nc}Eb=Q(a,w,ba,Pa,ac,hc,yc,Wa,xb,wc,va,Rb);K.push.apply(K,Eb)}"INSTANCE"==Wa.b4w_wind_bend_inheritance&&R.k.qf&&ga.warn('Emitter object "'+R.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else C.q("Unknown particle settings type")}D?
g.push.apply(g,K):g=K}return g}function q(a){for(var w=[],b=[],g={},d=0;d<a.length;d++){var c=a[d].za,e=null;if(c.id in g){var f=g[c.id],t=b[f].za;M(c,function(a){M(t,function(w){C.RZ(a,w)&&1!=a.VJ&&(e=b[f])})});if(!e){do c.id++;while(g[c.id])}}e||(e={za:c,VK:[],hG:[],aN:[],Id:[],xL:[],hg:[]},g[c.id]=b.length,b.push(e));if(a[d].Mf&&a[d].Mf.Ja){e.VK.push(a[d].gf);e.hG.push(a[d].Wt);e.aN.push(a[d].Mf);for(var v=0;v<a[d].Id.length;v++)c=a[d].Id[v],-1==e.xL.indexOf(c.uuid)&&(e.Id.push(c),e.xL.push(c.uuid));
for(v=0;v<a[d].hg.length;v++)c=a[d].hg[v],-1==e.hg.indexOf(c)&&e.hg.push(c)}e.hg.sort()}for(d=0;d<b.length;d++){var c=b[d].za,k=b[d].VK,l=b[d].hG,H=b[d].aN;a=na.Vz(l[0]);if("STATIC"==a.type)for(v=0;v<k.length;v++){var n=k[v],h=l[v],g=H[v],G=N.identity(wa);n.Eg&&!n.aq?(n=N.jc(n.n,Ca),N.pe(n,G)):N.copy(n.n,G);h.lm?g.If||(h.Eg?ka.TZ(g,G):ka.jx(g,G)):ka.jx(g,G);if(h.lm)r(c,"AU_QUALIFIER","GLSL_IN");else if(1<b[d].Id.length){n={};if(h.qf||h.Eg)n.au_center_pos=[G[0],G[1],G[2]];h.qf&&(n.au_wind_bending_amp=
[h.rh],n.au_wind_bending_freq=[h.sh],n.au_detail_bending_amp=[h.Mg],n.au_detail_bending_freq=[h.Ng],n.au_branch_bending_amp=[h.Hg]);ka.SZ(g,n);r(c,"AU_QUALIFIER","GLSL_IN")}else a.kq.set(G.subarray(0,3)),h.kq.set(G.subarray(0,3)),r(c,"AU_QUALIFIER","uniform")}if(0==H.length)g=ka.Hf(C.Js("%empty"));else if(1==H.length)g=H[0];else{g=[];for(v=0;v<H.length;v++)ka.xW(H[v])||g.push(v);if(g.length<H.length)for(v=0;v<g.length;v++)ka.kx(H[g[v]]);g=ka.ZM(H)}if(1<b[d].Id.length){H=[];for(v=0;v<b[d].Id.length;v++)O.OA(b[d].Id[v].pb.k.jG,
H);O.iG(H,a.Ta);O.vn(a.Ta,a.P);a.qb=O.ju(C.Cf(H),!0);O.aA(a.qb,a.ba);a.lb=O.Dq(a.qb);O.cA(a.lb,a.wa)}a.Qf=O.DB(a.ba,a.wa);"STATIC"==a.type&&a.Yn&&(v=b[d].Id[0].b4w_cluster_data,v.cluster_center&&v.cluster_radius?(a.Kr.set(v.cluster_center),a.Lr=v.cluster_radius):(a.Kr.set(a.lb.G),a.Lr=a.lb.Xa));"PARTICLES"!=c.type&&(v=g.Nf,c.P=O.Bl(v.P),c.ba=O.rq(v.ba),c.wa=a.wa.Xa<v.wa.Xa?"STATIC"==a.type?O.Cl(a.lb):O.Cl(a.wa):O.Cl(v.wa),"STATIC"==a.type?(c.qb=c.ba,c.Ta=c.P,c.lb=c.wa):(v=a.n,c.qb=O.dq(c.ba,v),c.lb=
O.eq(c.wa,v),c.Ta=O.yl(c.P,v)),c.Qf=O.DB(c.ba,c.wa));w.push({za:c,k:a,Mf:g,hg:b[d].hg,Id:b[d].Id})}return w}function A(a,w,b,g){a.Zp=O.mG(w,g);a.Xp=O.kG(b,g);a.Yp=O.lG(w,g)}function h(a,w,b,g){var d=[];g||(w.Dk&&oa.ic(a,fa.sf)||w.Wc&&oa.ic(a,fa.Ag))&&d.push("COLOR_ID");b&&(d.push("MAIN"),d.push("NODES_GLOW"),oa.ic(a,fa.uf)&&d.push("DEBUG_VIEW"),oa.ic(a,fa.wf)&&d.push("SHADOW"),oa.ic(a,fa.ui)&&d.push("GRASS_MAP"));d.push("PHYSICS");if(w.qe||w.Hd)for(a=null,w.qe&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),w.Hd&&(w=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?C.lR(a,w):w),w=a,a=0;a<w.length;a++)b=d.indexOf(w[a]),-1!==b&&d.splice(b,1);return d}function z(a,w){var b;switch(a.type){case "MAIN":if(w.b4w_do_not_render)b=!1;else{if(w.use_nodes&&"HALO"!=w.type)F(a,w,"MAIN");else{k(a,w);b=w.game_settings.alpha_blend;a.th=w.b4w_render_above_all&&"OPAQUE"!=b&&"CLIP"!=b;a.mg=w.offset_z;a.ji.set([1,1,1]);var g=w.texture_slots;qa.set(w.diffuse_color[0],w.diffuse_color[1],w.diffuse_color[2],
w.alpha,a.Xf);if(w.b4w_lens_flares){T(a,"lens_flares.glslv","lens_flares.glslf");f(a,"a_position");f(a,"a_texcoord");var d=ha.he(g[0]),c=g[0].texture;S(a,d,"u_sampler",c.name)}else{T(a,"main.glslv","main_stack.glslf");w.use_shadeless||(b=ca.jA(w.uuid,w.name,{Je:w.use_shadeless,Nq:w.diffuse_shader,Ds:w.specular_shader,Wm:w.use_tangent_shading}),a.hb.lg=ca.fu(b));var t=u("use_map_color_diffuse",g),l=u("use_map_color_spec",g),H=u("use_map_normal",g),h=u("use_map_mirror",g),G=u("use_stencil",g);b=t[0];
l=l[0];H=H[0];h=h[0];t=t[1];g=G[0]&&u("use_rgb_to_intensity",g)[0];if(b){c=b.texture;switch(b.blend_type){case "MIX":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}d=ha.he(b);S(a,d,"u_colormap0",c.name);a.Ml=b.diffuse_color_factor;a.nl=b.use_map_alpha?b.alpha_factor:0;a.ji.set(b.scale)}G=b&&b==l;l&&(G||(c=l.texture,d=ha.he(l),S(a,d,"u_specmap0",c.name)),a.Qo=l.specular_color_factor);if(H&&(c=H.texture,f(a,"a_tbn_quat"),
d=ha.he(H),S(a,d,"u_normalmap0",c.name),a.dw=H.normal_factor,c.b4w_use_map_parallax&&ja.lw)){var d=Z.M(c.b4w_parallax_steps),Q=Z.M(c.b4w_parallax_lod_dist);r(a,"PARALLAX",1);r(a,"PARALLAX_STEPS",d);r(a,"PARALLAX_LOD_DIST",Q);a.qo=c.b4w_parallax_scale}h&&(c=h.texture,d=ha.he(h),S(a,d,"u_mirrormap",c.name),a.Nr=h.mirror_factor);if(h=b&&t&&g?1:0)d=ha.he(t),c=t.texture,S(a,d,"u_colormap1",c.name),d=ha.he(g),c=g.texture,S(a,d,"u_stencil0",c.name);(c=b||l||H)&&a.ji.set(c.scale);r(a,"TEXTURE_SPEC",void 0==
l?0:1);r(a,"ALPHA_AS_SPEC",G?1:0);r(a,"TEXTURE_STENCIL_ALPHA_MASK",h);f(a,"a_position");f(a,"a_tbn_quat");(b||l||H)&&f(a,"a_texcoord");if(w.b4w_water){a.xj=!0;a.water_dynamic=w.b4w_water_dynamic;w.b4w_water_shore_smoothing&&!a.Lb?(ga.warn('Material: "'+w.name+'" is opaque.',"Disabling water shore smoothing."),a.Zs=!1):a.Zs="REFLECT"!=a.Fb?w.b4w_water_shore_smoothing:!1;T(a,"water.glslv","water.glslf");h=ca.jA(w.uuid,w.name,{Je:!1,Nq:w.diffuse_shader,Ds:w.specular_shader,Wm:w.use_tangent_shading});
a.hb.lg=ca.fu(h);f(a,"a_position");ja.hO?(f(a,"a_polyindex"),a.Ua=!0,ia.set(0,0,0,a.wireframe_edge_color),v.lB()?r(a,"DEBUG_WIREFRAME",1):r(a,"DEBUG_WIREFRAME",2)):r(a,"DEBUG_WIREFRAME",0);G=w.texture_slots;h=u("use_map_normal",G);d=u("use_map_mirror",G)[0];h.length&&(Q=ha.he(h[0]),c=h[0].texture,S(a,Q,"u_normalmap0",c.name),a.np=w.b4w_water_norm_uv_velocity);r(a,"NUM_NORMALMAPS",h.length);a.gj=Array(h.length);for(c=0;c<h.length;c++)a.gj[c]=new Float32Array(2),a.gj[c].set([h[c].scale[0],h[c].scale[1]]);
d&&(Q=ha.he(d),c=d.texture,S(a,Q,"u_mirrormap",c.name),a.Nr=d.mirror_factor);d=null;if(ja.Xq)for(c=0;c<G.length;c++){var q=G[c];if(!0===q.texture.b4w_water_foam){d=q;break}}d&&(r(a,"FOAM",1),Q=ha.he(d),c=d.texture,S(a,Q,"u_foam",c.name),a.Mn=w.b4w_foam_factor,a.Ku.set(c.b4w_foam_uv_freq),a.Ju.set(c.b4w_foam_uv_magnitude),a.Yq[0]=d.scale[0],a.Yq[1]=d.scale[1]);for(c=0;c<G.length;c++)if(q=G[c],!0===q.texture.b4w_shore_dist_map){var L=q;break}L&&ja.Nt&&(G=ha.he(L),c=L.texture,S(a,G,"u_shore_dist_map",
c.name),r(a,"SHORE_PARAMS",1),L=q.texture.b4w_shore_boundings,r(a,"MAX_SHORE_DIST",Z.M(q.texture.b4w_max_shore_dist)),r(a,"SHORE_MAP_SIZE_X",Z.M(L[0]-L[1])),r(a,"SHORE_MAP_SIZE_Y",Z.M(L[2]-L[3])),r(a,"SHORE_MAP_CENTER_X",Z.M((L[0]+L[1])/2)),r(a,"SHORE_MAP_CENTER_Y",Z.M((L[2]+L[3])/2)));w.b4w_generated_mesh?(r(a,"GENERATED_MESH",1),a.Ix=!0,a.Jx=w.b4w_water_num_cascads,a.Kx=w.b4w_water_subdivs,a.Hx=w.b4w_water_detailed_dist):(f(a,"a_tbn_quat"),(d||h.length)&&f(a,"a_texcoord"),r(a,"GENERATED_MESH",0));
if(w.b4w_water_dynamic){var q=Z.M(w.b4w_water_dst_noise_scale0),L=Z.M(w.b4w_water_dst_noise_scale1),h=Z.M(w.b4w_water_dst_noise_freq0),G=Z.M(w.b4w_water_dst_noise_freq1),c=Z.M(w.b4w_water_dir_min_shore_fac),d=Z.M(w.b4w_water_dir_freq),Q=Z.M(w.b4w_water_dir_noise_scale),O=Z.M(w.b4w_water_dir_noise_freq),M=Z.M(w.b4w_water_dir_min_noise_fac),ua=Z.M(w.b4w_water_dst_min_fac),Y=Z.M(w.b4w_water_waves_hor_fac);r(a,"DST_NOISE_SCALE_0",q);r(a,"DST_NOISE_SCALE_1",L);r(a,"DST_NOISE_FREQ_0",h);r(a,"DST_NOISE_FREQ_1",
G);r(a,"DIR_MIN_SHR_FAC",c);r(a,"DIR_FREQ",d);r(a,"DIR_NOISE_SCALE",Q);r(a,"DIR_NOISE_FREQ",O);r(a,"DIR_MIN_NOISE_FAC",M);r(a,"DST_MIN_FAC",ua);r(a,"WAVES_HOR_FAC",Y)}y(a,w);K(a,w);a.Ho.set(w.b4w_shallow_water_col);a.Jo.set(w.b4w_shore_water_col);a.Io=w.b4w_shallow_water_col_fac;a.Ko=w.b4w_shore_water_col_fac;r(a,"ABSORB",Z.M(w.b4w_water_absorb_factor));r(a,"SSS_STRENGTH",Z.M(w.b4w_water_sss_strength));r(a,"SSS_WIDTH",Z.M(w.b4w_water_sss_width))}"HALO"===w.type&&(T(a,"halo.glslv","halo.glslf"),p(a,
w),a.Pj=["a_position"]);w.use_tangent_shading&&(r(a,"USE_TBN_SHADING",1),f(a,"a_shade_tangs"));r(a,"TEXCOORD",0);r(a,"NORMAL_TEXCOORD",0);b&&n(a,b,"TEXTURE_COLOR0_CO");t&&n(a,t,"TEXTURE_COLOR1_CO");g&&n(a,g,"TEXTURE_STENCIL_ALPHA_MASK_CO");l&&n(a,l,"TEXTURE_SPEC_CO");H&&n(a,H,"TEXTURE_NORM_CO");r(a,"SHADELESS",w.use_shadeless?1:0);a.Je=w.use_shadeless}b=w.game_settings.alpha_blend;r(a,"ALPHA","OPAQUE"===b?0:1);r(a,"ALPHA_CLIP","CLIP"===b?1:0);r(a,"DOUBLE_SIDED_LIGHTING",w.b4w_double_sided_lighting?
1:0);w.use_vertex_color_paint?(r(a,"VERTEX_COLOR",1),f(a,"a_color")):r(a,"VERTEX_COLOR",0);a.Ej=w.ambient;a.Nl=w.diffuse_intensity;a.Vj=w.emit;a.Mm.set(w.specular_color);a.Cs=w.specular_alpha;y(a,w);K(a,w);w.b4w_wettable?r(a,"WETTABLE",1):r(a,"WETTABLE",0);e(a,w);w.b4w_refractive&&!a.Lb?(ga.warn('Material "'+w.name+'" is not blend. Disabling refractions.'),a.zk=!1):a.zk=w.b4w_refractive;a.Bw=w.b4w_refr_bump}b=!0}break;case "NODES_GLOW":b=F(a,w,"GLOW");break;case "SHADOW":if(w.b4w_lens_flares||w.b4w_water||
w.b4w_do_not_render||"HALO"===w.type)b=!1;else if(k(a,w),a.Lb)b=!1;else{l=w.game_settings.alpha_blend;w.use_nodes&&"CLIP"==l?F(a,w,"SHADOW"):T(a,"shadow.glslv","shadow.glslf");qa.set(0,0,0,w.alpha,a.Xf);f(a,"a_position");f(a,"a_tbn_quat");r(a,"ALPHA","OPAQUE"===l?0:1);a.ji.set([1,1,1]);if((b=u("use_map_color_diffuse",w.texture_slots)[0])&&"CLIP"===l){switch(b.blend_type){case "MIX":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ji.set(b.scale);
r(a,"TEXTURE_COLOR",1);f(a,"a_texcoord");l=ha.he(b);b=b.texture;"IMAGE"!=l.source&&"ENVIRONMENT_MAP"!=l.source&&"CANVAS"!=l.source&&"NONE"!=l.source||S(a,l,"u_colormap0",b.name)}else r(a,"TEXTURE_COLOR",0);b=!0}break;case "PHYSICS":w.b4w_collision?(a.Rs=w.b4w_use_ghost,a.cc=w.b4w_collision_id,a.wq=w.b4w_collision_margin,a.uq=w.b4w_collision_group,a.xq=w.b4w_collision_mask,a.Wl=w.physics.friction,a.Ql=w.physics.elasticity,b=!0):w.b4w_water?(a.xj=!0,a.u0=w.b4w_water_dynamic,a.dst_noise_scale0=w.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=w.b4w_water_dst_noise_scale1,a.dst_noise_freq0=w.b4w_water_dst_noise_freq0,a.dst_noise_freq1=w.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=w.b4w_water_dir_min_shore_fac,a.dir_freq=w.b4w_water_dir_freq,a.dir_noise_scale=w.b4w_water_dir_noise_scale,a.dir_noise_freq=w.b4w_water_dir_noise_freq,a.dir_min_noise_fac=w.b4w_water_dir_min_noise_fac,a.dst_min_fac=w.b4w_water_dst_min_fac,a.waves_hor_fac=w.b4w_water_waves_hor_fac,b=!0):b=!1;break;case "COLOR_ID":if(w.b4w_lens_flares||"HALO"===
w.type)b=!1;else{k(a,w);a.rf=!1;a.Ua=!0;a.Lb=!1;l=w.game_settings.alpha_blend;a.th=w.b4w_render_above_all&&"OPAQUE"!=l&&"CLIP"!=l;w.use_nodes&&"CLIP"==l?F(a,w,"COLOR_ID"):T(a,"color_id.glslv","color_id.glslf");qa.set(0,0,0,w.alpha,a.Xf);f(a,"a_position");r(a,"ALPHA","OPAQUE"===l?0:1);a.ji.set([1,1,1]);b=u("use_map_color_diffuse",w.texture_slots)[0];l="CLIP"===l?1:0;r(a,"ALPHA_CLIP",l);if(b&&l){switch(b.blend_type){case "MIX":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":r(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ji.set(b.scale);r(a,"TEXTURE_COLOR",1);f(a,"a_texcoord");l=ha.he(b);b=b.texture;"IMAGE"!=l.source&&"ENVIRONMENT_MAP"!=l.source&&"CANVAS"!=l.source&&"NONE"!=l.source||S(a,l,"u_colormap0",b.name)}else r(a,"TEXTURE_COLOR",0);b=!0}break;case "GRASS_MAP":!w.b4w_terrain||w.b4w_do_not_render?b=!1:(k(a,w),a.Lb=!1,a.rf=!1,a.Ua=!0,T(a,"grass_map.glslv","grass_map.glslf"),f(a,"a_position"),b=w.b4w_dynamic_grass_size?w.b4w_dynamic_grass_size:null,l=w.b4w_dynamic_grass_color?
w.b4w_dynamic_grass_color:null,a.$c.a_grass_size={$l:!0,src:[]},b?(a.$c.a_grass_size.src.push({name:b,gg:4}),r(a,"DYNAMIC_GRASS_SIZE",1)):r(a,"DYNAMIC_GRASS_SIZE",0),a.$c.a_grass_color={$l:!0,src:[]},l?(a.$c.a_grass_color.src.push({name:l,gg:7}),r(a,"DYNAMIC_GRASS_COLOR",1)):r(a,"DYNAMIC_GRASS_COLOR",0),r(a,"GRASS_TEXTURE_SIZE",Z.M(ta.rr)),b=!0);break;case "DEBUG_VIEW":b=I(a,w);break;case "PARTICLES":a:if(w.b4w_do_not_render)b=!1;else{b=w.texture_slots;if(a.sr)T(a,"particle_system.glslv","particle_system_stack.glslf"),
r(a,"HALO_PARTICLES",1),p(a,w);else{l={Je:!1,Nq:w.diffuse_shader,Ds:w.specular_shader,Wm:w.use_tangent_shading};if(w.use_nodes){T(a,"particle_system.glslv","particle_system.glslf");F(a,w,"PARTICLES");b=!0;break a}T(a,"particle_system.glslv","particle_system_stack.glslf");l=ca.jA(w.uuid,w.name,l);a.hb.lg=ca.fu(l);if(b=u("use_map_color_diffuse",b)[0]){r(a,"TEXTURE_COLOR",1);switch(b.blend_type){case "MIX":r(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":r(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.Ml=b.diffuse_color_factor;a.nl=b.use_map_alpha?b.alpha_factor:0;l=ha.he(b);S(a,l,"default"+String(a.ya.length),b.texture.name)}}qa.set(w.diffuse_color[0],w.diffuse_color[1],w.diffuse_color[2],w.alpha,a.Xf);a.Ej=w.ambient;a.Nl=w.diffuse_intensity;a.Vj=w.emit;a.Mm.set(w.specular_color);a.Cs=w.specular_alpha;f(a,"a_position");f(a,"a_tbn_quat");b=w.game_settings.alpha_blend;r(a,"ALPHA","OPAQUE"===b?0:1);r(a,"ALPHA_CLIP","CLIP"===b?1:0);r(a,"PARTICLES_SHADELESS",w.use_shadeless?
1:0);y(a,w);K(a,w);k(a,w);b=w.game_settings.alpha_blend;a.th=w.b4w_render_above_all&&"OPAQUE"!=b&&"CLIP"!=b;a.mg=w.offset_z;b=!0}break;default:C.q("Wrong batch type: "+a.type)}return b}function p(a,w){var b=w.halo;r(a,"NUM_RINGS",b.ring_count);r(a,"NUM_LINES",b.line_count);r(a,"NUM_STARS",b.star_tip_count);r(a,"SKY_STARS",w.b4w_halo_sky_stars?1:0);a.mv=b.size;a.jv=b.hardness/20;a.lv.set(b.b4w_halo_rings_color);a.kv.set(b.b4w_halo_lines_color);a.nv=1/w.b4w_halo_stars_blend_height;a.ov=w.b4w_halo_stars_min_height;
a.iv=!0}function n(a,w,b){switch(w.texture_coords){case "UV":case "ORCO":r(a,b,"TEXTURE_COORDS_UV_ORCO");r(a,"TEXCOORD",1);break;case "NORMAL":r(a,b,"TEXTURE_COORDS_NORMAL");r(a,"NORMAL_TEXCOORD",1);break;default:r(a,b,"TEXTURE_COORDS_NONE")}}function k(a,w){var b=w.game_settings,g=b.alpha_blend;switch(g){case "ALPHA_SORT":a.Lb=!0;a.rf=!0;a.Ua=!0;a.Cg=!1;break;case "ALPHA":a.Lb=!0;a.rf=!1;a.Ua=!0;a.Cg=!1;break;case "CLIP":a.Lb=!1;a.rf=!1;a.Ua=!0;a.Cg=!0;break;case "ADD":a.Lb=!0;a.rf=!1;a.Ua=!1;a.Cg=
!1;break;case "OPAQUE":a.Lb=!1;a.rf=!1;a.Ua=!0;a.Cg=!1;break;default:C.q("Unknown alpha blend mode: "+g)}a.$b=b.use_backface_culling}function u(a,w){for(var b=[],g=w.length,d=0;d<g;d++){var c=w[d];1==c[a]&&c.texture&&c.texture.s&&b.push(c)}return b}function e(a,w){var b=w.raytrace_transparency;a.Ni[0]=b.fresnel;a.Ni[1]=1-b.fresnel_factor/5;b=w.raytrace_mirror;a.yo=b.reflect_factor;a.Ni[2]=b.fresnel;a.Ni[3]=1-b.fresnel_factor/5}function y(a,w){var b,g=0;switch(w.specular_shader){case "PHONG":case "COOKTORR":b=
w.specular_hardness;break;case "WARDISO":b=w.specular_slope;break;case "TOON":b=w.specular_toon_size;g=w.specular_toon_smooth;break;case "BLINN":b=w.specular_ior;g=w.specular_hardness;break;default:ga.error("unsupported specular shader: "+w.specular_shader+' (material "'+w.name+'")'),b=w.specular_hardness}a.Kk[0]=w.specular_intensity;a.Kk[1]=b;a.Kk[2]=g}function K(a,w){switch(w.diffuse_shader){case "LAMBERT":a.Ud[0]=0;a.Ud[1]=0;break;case "OREN_NAYAR":a.Ud[0]=w.roughness;a.Ud[1]=0;break;case "FRESNEL":a.Ud[0]=
w.diffuse_fresnel;a.Ud[1]=w.diffuse_fresnel_factor;break;case "MINNAERT":a.Ud[0]=w.darkness;a.Ud[1]=0;break;case "TOON":a.Ud[0]=w.diffuse_toon_size;a.Ud[1]=w.diffuse_toon_smooth;break;default:ga.error("unsupported diffuse shader: "+w.diffuse_shader+' (material "'+w.name+'")'),a.Ud[0]=0,a.Ud[1]=0}}function F(a,w,b){if(!w.use_nodes||w.b4w_do_not_render)return!1;var g;switch(b){case "MAIN":T(a,"main.glslv","main.glslf");g=!1;break;case "GLOW":T(a,"main.glslv","main.glslf");g=!0;break;case "SHADOW":T(a,
"shadow.glslv","shadow.glslf");g=!1;break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf"),g=!1}var d=w.node_tree;b=ca.IS(d,w.uuid,!1,w.name,b);if(!b.Wa)return ga.error('Failed to create node graph for material "'+w.name+'", disable nodes'),E(a,w),!0;a.mk=b.id;a.ak=!0;r(a,"NODES",1);r(a,"DOUBLE_SIDED_LIGHTING",w.b4w_double_sided_lighting?1:0);f(a,"a_position");w.use_orco_tex_coord&&f(a,"a_orco_tex_coord");k(a,w);a.mg=w.offset_z;var c=w.game_settings.alpha_blend;g?(r(a,"ALPHA",1),r(a,"ALPHA_CLIP",
0)):(r(a,"ALPHA","OPAQUE"===c?0:1),r(a,"ALPHA_CLIP","CLIP"===c?1:0));a.th=w.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Vj=w.emit;a.Ej=w.ambient;e(a,w);w.b4w_wettable?r(a,"WETTABLE",1):r(a,"WETTABLE",0);var C=null,t=!1;ba.pa(b.Wa,function(b,g){switch(g.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=g.data.name,c=g.data.value;a.wj||(a.wj={});a.wj[c]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=g.data.name;a.$c[d]={$l:!0,
src:[{name:g.data.value}]};c=0;if("GEOMETRY_VC"==g.type)c=7;else for(var e=0;e<g.fb.length;e++){var Za="RGB".indexOf(g.fb[e].identifier);-1<Za&&(c|=1<<2-Za)}a.$c[d].src[0].gg=c;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":f(a,"a_tbn_quat");break;case "TEX_COORD_OB":r(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":r(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":g.data.value.Wm&&(r(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&f(a,
"a_shade_tangs"));f(a,"a_tbn_quat");t=!0;break;case "BSDF_BEGIN":t=!0;f(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=g.data.name;c=g.data.Ez;e=g.data.value;S(a,e,d,c);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":r(a,"CALC_TBN_SPACE",1);f(a,"a_tbn_quat");g.data&&(d=g.data.name,c=g.data.Ez,e=g.data.value,S(a,e,d,c));break;case "NORMAL_MAP":f(a,"a_tbn_quat");switch(Number(g.Tb[0][1])){case ca.iP:r(a,"CALC_TBN_SPACE",1);break;case ca.hP:case ca.gP:r(a,"USE_MODEL_TSR",1)}break;
case "LAMP":g.data&&(a.om=g.data);break;case "B4W_REFRACTION":a.Lb?a.zk=!0:(a.zk=!1,ga.warn('Material "'+w.name+'" is not blend. Disabling refractions.'));r(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":C||(C=g.data.jb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&g.data&&(a.Wr=g.data);break;case "VECT_TRANSFORM":switch(Number(g.Tb[1][1])){case ca.yQ:r(a,"USE_MODEL_TSR_INVERSE",1);break;case ca.xQ:r(a,"USE_VIEW_TSR",1);break;case ca.wQ:r(a,"USE_MODEL_TSR",1);
break;case ca.vQ:r(a,"USE_MODEL_TSR",1);r(a,"USE_VIEW_TSR",1);break;case ca.uQ:r(a,"USE_VIEW_TSR_INVERSE",1);break;case ca.tQ:r(a,"USE_MODEL_TSR_INVERSE",1),r(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":r(a,"USE_MODEL_TSR",1);a.oo[1]=w.pass_index;a.oo[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":r(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":r(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":f(a,"a_tbn_quat"),v.lB()?r(a,"USE_DERIVATIVES_EXT",1):ga.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
w.name+'" material.')}});C&&S(a,C,"u_nodes_texture");t||(a.Je=!0);g=a.hb.lg=ca.fu(b.Wa);J(d,a);d=a.ej;b=a.dj;for(c=0;c<g.length;c++){var l=g[c];switch(l.id){case "VALUE":var H=l.mw[0];if(H)for(var h=0;h<d.length;h+=2)if(d[h]==H){l.Tb.push(["VALUE_IND",d[h+1]]);break}break;case "RGB":if(H=l.mw[0])for(h=0;h<b.length;h+=2)if(b[h]==H){l.Tb.push(["RGB_IND",b[h+1]]);break}}}r(a,"NUM_VALUES",a.fj.length);r(a,"NUM_RGBS",a.Ce.length);return!0}function J(a,w){var b=[],g=[],d=[],c=[];D(a,"",b,g,d,c);w.fj=b;
w.ej=g;w.Ce=d;w.dj=c}function D(a,w,b,g,d,c){for(var e=0;e<a.nodes.length;e++){var C=a.nodes[e];if("VALUE"==C.type){var f=R(w,C.name);b.push(C.outputs[0].default_value);g.push(f,g.length/2)}else"RGB"==C.type?(f=R(w,C.name),C=C.outputs[0].default_value.slice(0,3),d.push(C[0],C[1],C[2]),c.push(f,c.length/2)):"GROUP"==C.type&&D(C.node_group.node_tree,R(w,C.name),b,g,d,c)}}function R(a,w){var b;return b=(a?a+"%join%":"")+w}function E(a,w){switch(a.type){case "SHADOW":T(a,"shadow.glslv","shadow.glslf");
break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf");break;default:T(a,"main.glslv","main_stack.glslf")}r(a,"SHADELESS",1);f(a,"a_position");f(a,"a_tbn_quat");qa.set(1,0,1,1,a.Xf);if(w){var b=w.game_settings.alpha_blend;r(a,"ALPHA","OPAQUE"===b?0:1);r(a,"ALPHA_CLIP","CLIP"===b?1:0);r(a,"VERTEX_COLOR",0);a.mg=w.offset_z;k(a,w)}return!0}function I(a,w){if(w&&(w.b4w_lens_flares||w.b4w_do_not_render))return!1;T(a,"debug_view.glslv","debug_view.glslf");f(a,"a_position");f(a,"a_tbn_quat");f(a,"a_polyindex");
a.Ua=!0;ia.set(0,0,0,a.wireframe_edge_color);return!0}function B(a,w){if("PHYSICS"!==a.type){"DYNAMIC"==w.type?(w.lm?r(a,"AU_QUALIFIER","GLSL_IN"):r(a,"AU_QUALIFIER","uniform"),r(a,"STATIC_BATCH",0)):(r(a,"AU_QUALIFIER","GLSL_IN"),r(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(v.lB()?r(a,"WIREFRAME_QUALITY",1):r(a,"WIREFRAME_QUALITY",0),a.Ji?(r(a,"DEBUG_SPHERE",1),a.tu?r(a,"DEBUG_SPHERE_DYNAMIC",1):r(a,"DEBUG_SPHERE_DYNAMIC",0)):r(a,"DEBUG_SPHERE",0),r(a,"ALPHA",1));w.Ke&&(a.Ke=w.Ke);w.qf?(""!==w.Zi?
(a.$c.a_bending_col_main={$l:!0,src:[{name:w.Zi,gg:4}]},f(a,"a_bending_col_main"),""!==w.ze.LB&&""!==w.ze.KB&&""!==w.ze.uC?(a.$c.a_bending_col_detail={$l:!0,src:[{name:w.ze.LB,gg:4},{name:w.ze.KB,gg:2},{name:w.ze.uC,gg:1}]},f(a,"a_bending_col_detail"),f(a,"a_tbn_quat"),r(a,"DETAIL_BEND",1)):r(a,"DETAIL_BEND",0),r(a,"MAIN_BEND_COL",1)):r(a,"MAIN_BEND_COL",0),w.ul?r(a,"BEND_CENTER_ONLY",1):r(a,"BEND_CENTER_ONLY",0),r(a,"WIND_BEND",1)):r(a,"WIND_BEND",0);r(a,"BILLBOARD_PRES_GLOB_ORIENTATION",w.aq|0);
w.Eg?r(a,"BILLBOARD",1):r(a,"BILLBOARD",0);w.Eg&&w.lm?r(a,"HAIR_BILLBOARD",1):r(a,"HAIR_BILLBOARD",0);w.bq?r(a,"BILLBOARD_SPHERICAL",1):r(a,"BILLBOARD_SPHERICAL",0);switch(w.cq){case "RANDOM":r(a,"BILLBOARD_RANDOM",1);r(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":r(a,"BILLBOARD_RANDOM",0);r(a,"BILLBOARD_JITTERED",1);break;default:r(a,"BILLBOARD_RANDOM",0),r(a,"BILLBOARD_JITTERED",0)}w.jd&&ja.Nt?r(a,"DYNAMIC_GRASS",1):r(a,"DYNAMIC_GRASS",0);a.jd=w.jd;"PARTICLES"!=a.type&&(a.Yf=w.Yf);a.Ge=w.Ge;
a.qe=w.qe;a.fe=w.fe&&!a.Je&&!(a.Lb&&ja.EA);a.ee=w.ee;a.Hd=w.Hd;a.Gd=w.Gd;a.oo[0]=w.pw;a.ff=w.ff;a.$g=w.$g;a.ah=w.ah;a.Rd=w.Rd;a.Ed=w.Ed;w.gk?(f(a,"a_influence"),r(a,"SKINNED",1),ja.Yw?(r(a,"DISABLE_TANGENT_SKINNING",1),r(a,"FRAMES_BLENDING",0)):(r(a,"DISABLE_TANGENT_SKINNING",0),w.Vl?r(a,"FRAMES_BLENDING",1):r(a,"FRAMES_BLENDING",0)),r(a,"MAX_BONES",w.bh)):(r(a,"SKINNED",0),r(a,"FRAMES_BLENDING",0),r(a,"DISABLE_TANGENT_SKINNING",0));w.Zc?(r(a,"VERTEX_ANIM",1),ja.aO?r(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):r(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):r(a,"VERTEX_ANIM",0);w.gk&&w.Zc&&C.q("Skinning and vertex animation are mutually exlusive")}}function P(a,w,b){if(w.length){for(var g=na.Xu(w,ja.ssao&&b.b4w_enable_ssao),c=a.hb,e=a.om,C=0,f=0;f<a.hb.lg.length;f++){var t=a.hb.lg[f];if("LIGHTING_LAMP"==t.id){var v=w[C++%w.length],l=v.ub,k=na.ka(v,b);if("SPOT"==l.type||"POINT"==l.type)var h=Math.cos(l.Om/2);if("SPOT"==l.type)var H=l.Fs*(1-h);v=g.indexOf(v);t.Tb=[["LAMP_TYPE",l.type],["LAMP_IND",
k.pm],["LAMP_SPOT_SIZE",Z.M(h||.01)],["LAMP_SPOT_BLEND",Z.M(H||.01)],["LAMP_LIGHT_DIST",Z.M(l.distance)],["LAMP_USE_SPHERE",l.lE?1:0],["LAMP_SHADOW_MAP_IND",v]]}else if("LAMP"==t.id&&e)for(var k=t.Tb[0][1],n=0;n<w.length;n++)if(v=w[n],e[v.vj]==k){l=v.ub;if("SPOT"==l.type||"POINT"==l.type)h=Math.cos(l.Om/2);"SPOT"==l.type&&(H=l.Fs*(1-h));t.Tb.push(["LAMP_TYPE",l.type],["LAMP_SPOT_SIZE",Z.M(h||.01)],["LAMP_SPOT_BLEND",Z.M(H||.01)],["LAMP_LIGHT_DIST",Z.M(l.distance)],["LAMP_USE_SPHERE",l.lE?1:0])}}if(e){b=
0;for(var G in e)b++;a.eo=new Float32Array(3*b);a.Gr=new Float32Array(3*b);a.Fr=new Float32Array(3*b);Z.ha(c,"NUM_LAMP_LIGHTS",b);for(f=0;f<w.length;f++)d(a,w[f])}}}function d(a,w){if(w.vj in a.om){var b=a.om[w.vj],g=N.F(w.k.n);a.eo.set(g,3*b);a.Gr.set(w.ub.direction,3*b);a.Fr.set(w.ub.yq,3*b)}}function f(a,w){var b=a.Pj;-1==b.indexOf(w)&&b.push(w);a.Pj=b.sort()}function r(a,w,b){Z.ha(a.hb,w,b)}function g(a,w){if("PHYSICS"==a.type)"NAVMESH"==a.Fb?a.Ba=ka.$M(w,ka.en,[]):(0<w.ib.length&&ka.UZ(w,w.aa[0]),
a.Mf=w);else{var b=a.Ih;a.iv&&"PARTICLES"!=a.type&&(w=ka.yU(w));a.Ix&&(w=L.YU(a.Jx,a.Kx,a.Hx));b=ka.$M(w,b,a.$c);a.Ba=b;a.Yf||a.rf||a.Ke||(b.ke=null,b.rc.length=0);b=w.aa.length;a.Rr=w.Ja*b;var g;a:switch(a.Ih){case ka.en:case ka.vp:case ka.ht:g=!0;break a;default:g=!1}g?ka.wW(w)?a.vm=w.na.length/3*b:a.vm=w.Ja/3*b:a.vm=0}}function Q(a,w,b,g,d,c,e,f,v,k,h,H){var n=a.pb,G=[],Q=f.b4w_dynamic_grass;if(!k&&Q)return G;for(var q="INSTANCE"==f.b4w_wind_bend_inheritance,u="INSTANCE"==f.b4w_shadow_inheritance,
L="INSTANCE"==f.b4w_reflection_inheritance,p=[],O=[],M=0;M<d.length;M++){var S=d[M].pb.k,y=na.Vz(w);y.Eg=f.b4w_hair_billboard;y.cq=f.b4w_hair_billboard_type;y.bq="SPHERICAL"==f.b4w_hair_billboard_geometry;y.jd=Q;y.lm=!0;q?(y.qf=S.qf,y.bn=S.bn,y.sh=S.sh,y.Ng=S.Ng,y.Zi=S.Zi,y.Mg=S.Mg,y.Hg=S.Hg,y.rh=S.rh,y.ze=S.ze,y.ul=!1):(y.qf=n.k.qf,y.bn=n.k.bn,y.sh=n.k.sh,y.Ng=n.k.Ng,y.Zi=n.k.Zi,y.Mg=n.k.Mg,y.Hg=n.k.Hg,y.rh=n.k.rh,y.ze=n.k.ze,y.ul=!0);u?(y.Ge=S.Ge,y.qe=S.qe,y.fe=S.fe):(y.Ge=n.k.Ge,y.qe=n.k.qe,y.fe=
n.k.fe);L?(y.ee=S.ee,y.Hd=S.Hd,y.Gd=S.Gd,y.Rd=S.Rd,y.Ed=S.Ed,y.jh=S.jh):(y.ee=n.k.ee,y.Hd=n.k.Hd,y.Gd=n.k.Gd,y.Rd=n.k.Rd,y.Ed=n.k.Ed,y.jh=n.k.jh);p.push(y);var ua=e[M];ua||(ua=new Float32Array);H&&C.wv(v.seed,h);var ca=new Float32Array(3),z=new Float32Array([0,0,0,1]),W=[],x=xa.QG(ja.RB)&&!f.b4w_initial_rand_rotation&&!f.b4w_hair_billboard,D=4;x&&(D=8);for(var T=0;T<ua.length;T+=D){ca[0]=ua[T];ca[1]=ua[T+1];ca[2]=ua[T+2];var F=ua[T+3]*N.td(S.n);if(f.b4w_initial_rand_rotation){switch(f.b4w_rotation_type){case "XYZ":var Z=
new Float32Array([C.qg(h),C.qg(h),C.qg(h)]);ia.normalize(Z,Z);break;case "Z":Z=new Float32Array([0,0,1]);break;default:C.q("Unsupported random rotation type: "+f.b4w_rotation_type)}Y.setAxisAngle(Z,f.b4w_rand_rotation_strength*(2*Math.PI*C.qg(h)-Math.PI),z)}else if(x&&(z.set(ua.subarray(T+4,T+8)),C.IC(z,z),!f.use_whole_group))if(f.use_rotation_dupli){var ba=N.N(S.n);Y.multiply(z,ba,z)}else Y.multiply(z,Ea,z);var J=N.sg(ca,F,z,N.create());W.push(J)}O.push(W)}for(var P={},I=0,M=0;M<d.length;M++)for(var ma=
d[M].data.materials,T=0;T<ma.length;T++)ma[T].name in P?P[ma[T].name]++:(P[ma[T].name]=1,I++);for(var I=I?I:1,fa={},M=0;M<d.length;M++){var V=d[M],m=c[M],y=p[M],A={};y.qf&&(A.au_wind_bending_amp=[y.rh],A.au_wind_bending_freq=[y.sh],A.au_detail_bending_freq=[y.Ng],A.au_detail_bending_amp=[y.Mg],A.au_branch_bending_amp=[y.Hg],y.rh=0,y.sh=0,y.Ng=0,y.Mg=0,y.Hg=0);W=O[M];if(W.length){for(var X=V.data,ma=X.materials,R=Array(ma.length),Pa=Array(ma.length),T=0;T<ma.length;T++)if(!ka.LJ(X,T))for(var K=0;K<
m.length;K++){var wa=m[K],E=l(wa),ha=ma[T];"MAIN"==wa?R[T]=E:"DEBUG_VIEW"==wa&&(Pa[T]=E);E.tq=a.b4w_cluster_data.cluster_id;if(t(E,ha)){"SHADOW"==wa&&R[T]&&(E.Je=R[T].Je);E.Ih=ka.en;B(E,y);E.ok=f.uuid;E.Tj=a.b4w_do_not_cull||f.b4w_dynamic_grass;"MAIN"==E.type&&(E.Ig=a.b4w_caustics);r(E,"DISABLE_FOG",("COLOR_ID"!=wa&&"SHADOW"!=wa&&a.b4w_disable_fogging)|0);"JITTERED"==f.b4w_hair_billboard_type&&(E.Hv=f.b4w_hair_billboard_jitter_amp,E.Iv=f.b4w_hair_billboard_jitter_freq);Q&&(E.dv=f.b4w_dynamic_grass_scale_threshold);
q||(delete E.$c.a_bending_col_main,delete E.$c.a_bending_col_detail);var ea=ka.PA(X,T,E.Pj,w.Ci,E.$c,E.wj),ya=n.k.n,Ba=!0;if(1<P[ha.name]){var pa=0,Ca;for(Ca in ea.aa)pa++;Ba=ea.na.length*W.length*pa*P[ha.name]>2E5*I}var oa=ja.NF&&Ba&&"PHYSICS"!=E.type;if(oa){E.VJ=f.use_whole_group?2:1;var Ga=C.R(ea);ka.zG(ea,Ga,W);Ga.If={dp:W,hx:ya,SM:"STATIC"==w.type,Hs:A,Bm:{},Bu:Q};if(y.qf&&y.ul){var la=ia.fromValues(0,0,0);N.Hc(la,n.k.n,la);for(var qa=[],Qa=0;Qa<W.length;Qa++)qa.push(la[0],la[1],la[2]);Ga.If.Bm.a_emitter_center=
{Kc:3,data:qa}}ka.zG(ea,ea,W);"STATIC"==w.type&&ka.HR(Ga.Nf,ya)}else{var va=Ga=ka.gX(ea,A,W),ta=W;va.qa.au_center_pos=new Float32Array(3*va.Ja);for(var Gc=ta.length,wc=va.Ja/Gc,hc=0;hc<Gc;hc++)for(var Eb=ta[hc],ac=3*wc*hc,xc=0;xc<wc;xc++)va.qa.au_center_pos[ac+3*xc]=Eb[0],va.qa.au_center_pos[ac+3*xc+1]=Eb[1],va.qa.au_center_pos[ac+3*xc+2]=Eb[2];Ga=va;if(y.qf&&y.ul){var Rb=Ga,ic=n.k.n;Rb.qa.a_emitter_center=new Float32Array(3*Rb.Ja);var yc=ia.fromValues(0,0,0);N.Hc(yc,ic,yc);for(var pb=0;pb<Rb.Ja;pb++)Rb.qa.a_emitter_center[3*
pb]=yc[0],Rb.qa.a_emitter_center[3*pb+1]=yc[1],Rb.qa.a_emitter_center[3*pb+2]=yc[2];Ga=Rb}}var ab=f.b4w_vcol_from_name,Kc=f.b4w_vcol_to_name,dd=E,Fb=b,Yb=!q,gb=X,qb=[];if(""!==ab&&""!==Kc){var yb,Yc=Kc,Sc=dd.$c,jc=[],nc=void 0;for(nc in Sc)for(var Jb=Sc[nc].src,oc=0,pc=0;pc<Jb.length;pc++){var Tc=Jb[pc].gg;Yc==Jb[pc].name&&jc.push(nc,Tc,oc);oc+=C.Gm(Tc)}yb=jc;if(0<yb.length)for(var zc=0;zc<yb.length;zc+=3)qb.push({Uq:ab,Du:7,nw:yb[zc],ow:yb[zc+1],Au:yb[zc+2]});else ka.VV(dd.Pj,"a_color")&&Kc==gb.active_vcol_name&&
qb.push({Uq:ab,Du:7,nw:"a_color",ow:7,Au:0})}Yb&&("a_bending_col_main"in Fb&&qb.push({Uq:"a_bending_col_main",Du:4,nw:"a_bending_col_main",ow:4,Au:0}),"a_bending_col_detail"in Fb&&qb.push({Uq:"a_bending_col_detail",Du:7,nw:"a_bending_col_detail",ow:7,Au:0}));for(var qc=Ga,Kb=W,Xa=g,Oa=qb,Sb=E.$c,kc=oa,Ua=!1,zb=0;zb<Oa.length;zb++){var Lb=Oa[zb].Uq,Tb=Xa.qa[Lb];if(Tb&&0<Tb.length){Ua=!0;break}}if(kc)var bc=qc.If.Bm;if(Ua){var Gb,Ab=n.k.P,bb=Xa.aa[0].a_position,Bb=Kb,Ka=fa,cc=new Float32Array(3),Ma=
new Float32Array(3),dc=new Uint32Array(Bb.length);if(!("verts_indices"in Ka)){Ka.Di=new Float32Array(3);Ka.Bi=new Float32Array(3);Ka.pE=new Uint32Array(bb.length/3);Ka.Sr=new Uint32Array(bb.length/3);Ka.Di[0]=(Ab.max_x-Ab.min_x)/20;Ka.Di[1]=(Ab.max_y-Ab.min_y)/20;Ka.Di[2]=(Ab.max_z-Ab.min_z)/20;Ka.Bi[0]=Ab.min_x;Ka.Bi[1]=Ab.min_y;Ka.Bi[2]=Ab.min_z;for(var Ha=0;Ha<bb.length/3;Ha++){var tb=C.trunc((bb[3*Ha]-Ka.Bi[0])/Ka.Di[0]),Pb=C.trunc((bb[3*Ha+1]-Ka.Bi[1])/Ka.Di[1]),Ub=C.trunc((bb[3*Ha+2]-Ka.Bi[2])/
Ka.Di[2]),tb=C.W(tb,0,19),Pb=C.W(Pb,0,19),Ub=C.W(Ub,0,19);Ka.pE[Ha]=Ha;Ka.Sr[Ha]=Ub*Math.pow(20,2)+20*Pb+tb}ka.CZ(Ka.Sr,Ka.pE,ka.ez,!0);Ka.Xm=new Uint32Array(Math.pow(20,3));for(Ha=0;Ha<Ka.Sr.length;Ha++)Ka.Xm[Ka.Sr[Ha]]++;delete Ka.Sr;for(Ha=1;Ha<Ka.Xm.length;Ha++)Ka.Xm[Ha]+=Ka.Xm[Ha-1]}for(var rc=0;rc<Bb.length;rc++){cc[0]=Bb[rc][0];cc[1]=Bb[rc][1];cc[2]=Bb[rc][2];for(var Lc=1E10,lc=-1,ld=C.trunc((cc[0]-Ka.Bi[0])/Ka.Di[0]),ed=C.trunc((cc[1]-Ka.Bi[1])/Ka.Di[1]),Mc=C.trunc((cc[2]-Ka.Bi[2])/Ka.Di[2]),
ld=C.W(ld,0,19),ed=C.W(ed,0,19),Mc=C.W(Mc,0,19),Hc=Mc*Math.pow(20,2)+20*ed+ld,Vb=Ka.Xm[Hc],cb=0==Hc?0:Ka.Xm[Hc-1];cb<Vb;cb++){var mc=Ka.pE[cb];Ma[0]=bb[3*mc];Ma[1]=bb[3*mc+1];Ma[2]=bb[3*mc+2];ia.sub(Ma,cc,Ma);var Ac=ia.sqrLen(Ma);Ac<=Lc&&(Lc=Ac,lc=mc)}if(-1==lc)for(cb=0;cb<bb.length/3;cb++)Ma[0]=bb[3*cb],Ma[1]=bb[3*cb+1],Ma[2]=bb[3*cb+2],ia.sub(Ma,cc,Ma),Ac=ia.sqrLen(Ma),Ac<=Lc&&(Lc=Ac,lc=cb);dc[rc]=lc}Gb=dc;for(var Ic=qc.Ja/Kb.length,zb=0;zb<Oa.length;zb++){var Cb=Oa[zb].nw,Wb=Oa[zb].ow,Lb=Oa[zb].Uq,
Bc=Oa[zb].Du,Tb=Xa.qa[Lb];switch(Cb){case "a_bending_col_main":var Qb=1;break;case "a_bending_col_detail":Qb=3;break;case "a_color":Qb=3;break;default:for(var rb=Qb=0;rb<Sb[Cb].src.length;rb++)Qb+=C.Gm(Sb[Cb].src[rb].gg)}if(Tb&&0<Tb.length){var Uc=C.Gm(Bc),Vc=C.Gm(Wb),db=Bc&Wb,Ya=C.EL(db);db!=Wb&&ga.error("Wrong color extraction from "+Lb+" to "+Cb+".");if(kc)for(bc[Cb]={Kc:Qb,data:[]},rb=0;rb<Kb.length;rb++)for(Jc=Gb[rb],Nc=Jc*Uc,Xb=0;Xb<Ya.length;Xb++)Ya[Xb]&&(Oc=C.Bo(Bc,Xb),bc[Cb].data.push(Tb[Nc+
Oc]));else{if("a_bending_col_main"==Cb||"a_bending_col_detail"==Cb)qc.qa[Cb]=new Float32Array(qc.Ja*Vc);for(rb=0;rb<Kb.length;rb++){var Jc=Gb[rb],Nc=Jc*Uc,Cc=rb*Ic*Qb;if(-1!=Jc)for(var ec=0;ec<Ic;ec++)for(var Zc=ec*Qb,Xb=0;Xb<Ya.length;Xb++)if(Ya[Xb]){var Oc=C.Bo(Bc,Xb);qc.qa[Cb][Cc+Zc+(Oa[zb].Au+C.Bo(Wb,Xb))]=Tb[Nc+Oc]}}}}else qc.qa[Cb]=new Float32Array(0)}}Ga=qc;r(E,"USE_INSTANCED_PARTCLS",Ga.If?1:0);aa(E);G.push({za:E,gf:w,Wt:y,Mf:Ga,hg:[ha.name],Id:[a]})}}for(T=0;T<Pa.length;T++)Pa[T]&&(Pa[T].An=
R[T].id,aa(Pa[T]))}}return G}function t(a,w){var b=!0;"NODES_GLOW"==a.type&&(b=ca.OG(w));return b=b&&z(a,w)}function aa(a){M(a,function(a){a.id=0;a.id=C.WR(a)})}function M(a,w){for(var b=null,g=null,d=[],c=0;c<a.ya.length;c++){var e=a.ya[c],f=e.Vf;f&&(b||(b={}),b[c]=f,e.Vf=null);if(f=e.Sa)g||(g={}),g[c]=f,e.Sa=null;d.push(e.nk);e.nk=0}var e=a.P,f=a.ba,C=a.wa,t=a.Ta,v=a.qb,l=a.lb;a.P=null;a.ba=null;a.wa=null;a.Ta=null;a.qb=null;a.lb=null;var k=a.Le;a.Le=null;w(a);a.Le=k;a.P=e;a.ba=f;a.wa=C;a.Ta=t;
a.qb=v;a.lb=l;if(b)for(c in b)a.ya[c].Vf=b[c];if(g)for(c in g)a.ya[c].Sa=g[c];for(c=0;c<a.ya.length;c++)a.ya[c].nk=d[c]}function G(a,w,b,d){var c=l("DEBUG_VIEW");T(c,"debug_view.glslv","debug_view.glslf");c.Ji=!0;c.Ua=!0;c.ok=w;c.tu=b;B(c,a);aa(c);if(d.Qf){b?(b=d.ba,N.pe(d.ba.G,wa)):(b=d.qb,N.pe(b.G,wa));var e=ia.create();a=L.Ou(1,e);w=ia.fromValues(ia.length(b.Ga),ia.length(b.Ha),ia.length(b.Ia));ka.JL(a,w,e);var e=ia.normalize(b.Ga,Ca),f=ia.normalize(b.Ha,Ba);b=ia.normalize(b.Ia,la);!w[0]&&w[1]&&
w[2]?ia.cross(f,b,e):!w[1]&&w[0]&&w[2]?ia.cross(b,e,f):!w[2]&&w[0]&&w[1]&&ia.cross(e,f,b);w=C.lU(e,f,b,Pa);ea.invert(w,w);w=Y.fromMat3(w,ua);N.di(w,wa);N.Fe(1,wa);ka.jx(a,wa)}else b?(w=d.wa,a=L.Ou(w.Xa,w.G)):(w=d.lb,a=L.Ou(w.Xa,ia.create()),N.identity(wa),N.pe(w.G,wa),ka.jx(a,wa));c.P=O.Bl(d.P);c.ba=O.rq(d.ba);c.wa=O.Cl(d.wa);c.Ta=O.Bl(d.Ta);c.qb=O.rq(d.qb);c.lb=O.Cl(d.lb);ka.kx(a,1,!0);a.qa.a_polyindex=ka.Gu(a);g(c,a);return c}function T(a,w,b){a.hb.wg=w;a.hb.Ye=b;Z.JY(a.hb)}function S(a,w,b,g){g=
g||"";-1==a.Ld.indexOf(b)&&(a.ya.push(w),a.Ld.push(b),a.Gg.push(g),ha.uv(w));a.zb&&ya.cG(a)}function X(a){a.hb||C.q("No shaders info for batch "+a.name);a.zb=Z.mV(a.hb);var w=a.hb;if(w.status===Z.gz){var b=a.zb.attributes,g=a.Ba.ld,c;for(c in b)g[c]||C.q('missing data for "'+c+'" attribute')}w.status&Z.wO&&ga.error("Texture limit exceeded for shader - "+w.Ye+', materials: "'+a.ud.join(", ")+'". Maximum texture count: '+va.YB+", actual texture count: "+w.lN);w.status&Z.vO&&ga.error("Fragment uniform limit exceeded for shader - "+
w.Ye+', materials: "'+a.ud.join(", ")+'". Maximum fragment uniform count: '+va.Rv+", actual fragment uniform count: "+w.OU);w.status&Z.zO&&ga.error("Vertex uniform limit exceeded for shader - "+w.wg+', materials: "'+a.ud.join(", ")+'". Maximum vertex uniform count: '+va.Mr+", actual vertex uniform count: "+w.l0);w.status&Z.yO&&ga.error("Vertex attribute limit exceeded for shader - "+w.wg+', materials: "'+a.ud.join(", ")+'". Maximum attribute count: '+va.ZB+", actual attribute count: "+w.dG);w.status&
Z.xO&&("MAIN"!=a.type||a.ak||ga.error("Varying limit exceeded for shader - "+a.hb.Ye+', materials: "'+a.ud.join(", ")+'"'),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type)&&(g=b=0,a.wj&&(b=C.ir(a.wj)),a.$c&&(g=C.ir(a.$c)),ga.error("Varying limit exceeded for node shader - "+a.hb.Ye+", uv: "+b+", vc: "+g+', materials: "'+a.ud.join(", ")+'"'));w.status&Z.rO&&ga.error("Shader compilation/linking error: "+w.wg+", "+w.Ye+', materials: "'+a.ud.join(", ")+'"');return a.hb.status===Z.gz?(ya.rR(a.zb),ya.nR(a),
ya.cG(a),!0):!1}function H(a,w,b){a=a.I[0].V;for(var g=0;g<a.length;g++)if(a[g].type==b&&!a[g].bg&&-1!=a[g].ud.indexOf(w))return a[g];return null}function ma(a,w,b){a=a.I[0].V;for(var g=0;g<a.length;g++)if(a[g].type==b&&a[g].bg&&-1!=a[g].ud.indexOf(w))return a[g];return null}function W(a,w){a.Xf.set(w.Xf);a.Nl=w.Nl;a.Mm.set(w.Mm);a.Qo=w.Qo;a.Kk.set(w.Kk);a.Vj=w.Vj;a.Ej=w.Ej;a.Ml=w.Ml;a.nl=w.nl;a.yo=w.yo;a.Ni.set(w.Ni);a.qo=w.qo;a.Ho.set(w.Ho);a.Io=w.Io;a.Jo.set(w.Jo);a.Ko=w.Ko;a.Mn=w.Mn;a.np=w.np}
var O=m("__boundings"),V=m("__config"),ga=m("__print"),v=m("__extensions"),ba=m("__graph"),ea=m("__mat3"),ca=m("__nodemat"),na=m("__obj_util"),pa=m("__particles"),L=m("__primitives"),Y=m("__quat"),xa=m("__reformer"),ya=m("__renderer"),oa=m("__scenegraph"),Z=m("__shaders"),fa=m("__subscene"),ha=m("__textures"),N=m("__tsr"),ka=m("__geometry"),C=m("__util"),ia=m("__vec3"),qa=m("__vec4"),ja=V.B,va=V.Fi,ta=V.Do,Ea=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Ca=new Float32Array(3),Ba=new Float32Array(3),
la=new Float32Array(3),ua=new Float32Array(4),wa=N.create(),Pa=ea.create();a.z0=Ga;var Ga="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Qa={};a.wR=function(a){return Qa[a]||null};a.xR=function(a,w){Qa[a]=w};a.gV=function(a,w,c,d){var e;e=a.s.Wa;for(var f=[],t=0;t<w.length;t++){var v=w[t],l=v.pb,k=l.k;if(!l.Ar){var h=na.Ra(l),l=l.k,H=v.data.b4w_boundings,n=H.bs_rad,Q=H.bs_cen,u=H.bc_rad,r=H.caxis_x,p=H.caxis_y,L=H.caxis_z,y=H.be_ax,M=H.be_cen,S=H.rbb.rbb_c,ua=
H.rbb.rbb_s,H=O.Bl(l.tl);l.Eg&&(n=Math.max(Math.abs(H.max_x),Math.abs(H.min_x)),Q=Math.max(Math.abs(H.max_y),Math.abs(H.min_y)),ua=Math.max(Math.abs(H.max_z),Math.abs(H.min_z)),ua=Math.sqrt(n*n+Q*Q+ua*ua),u=Math.sqrt(n*n+Q*Q),H.max_x=H.max_y=H.max_z=ua,H.min_x=H.min_y=H.min_z=-ua,n=ua,Q=[0,0,0],r=[1,0,0],p=[0,1,0],L=[0,0,1],y=[ua,ua,ua],M=[0,0,0],S=[0,0,0],ua=[ua,ua,ua]);O.vn(H,l.P);O.yl(l.P,l.n,l.Ta);l.wa=O.Gz(n,C.Cf(Q));O.eq(l.wa,l.n,l.lb);l.ba=h?O.$p(r,p,L,M):O.$p([1,0,0],[0,1,0],[0,0,1],M);ia.scale(l.ba.Ga,
y[0],l.ba.Ga);ia.scale(l.ba.Ha,y[1],l.ba.Ha);ia.scale(l.ba.Ia,y[2],l.ba.Ia);O.dq(l.ba,l.n,l.qb);h?A(l,u,u,l.P):(l.zd=O.uY(S,r,p,L,ua),O.Dz(l.zd,l.n,l.jG));f.push.apply(f,x(v,k,e))}}e=q(f);for(f=0;f<e.length;f++)if(t=e[f].za,t.ud=e[f].hg,g(t,e[f].Mf),P(t,c,a),"STATIC"==e[f].k.type&&"COLOR_ID"!=t.type){if(v=C.Js("%meta%"+t.type+"%"+t.ud.join("%")+"%"),h=na.Fq(v,"MESH"),na.sX(h,e[f].k),na.Sp(h,a),na.Ot(h,a,t),d.push(h),"MAIN"==t.type)for(k=0;k<e[f].Id.length;k++)v=e[f].Id[k].pb,v.Uv.push(h)}else v=e[f].Id[0].pb,
na.Ot(v,a,t);if(ja.debug_view){for(f=0;f<e.length;f++)if(c=e[f].k,"DYNAMIC"==c.type&&(v=e[f].Id[0].pb,t=e[f].za,"MAIN"==t.type)){k=na.ka(v,a);h=k.V;l=!1;for(k=0;k<h.length;k++)h[k].Ji&&(l=!0);l||(c=G(c,v.name,!0,t),na.Ot(v,a,c))}for(f=0;f<d.length;f++)v=d[f],c=v.k,k=na.ka(v,a),t=k.V[0],"MAIN"==t.type&&(c=G(c,v.name,!1,t),na.Ot(v,a,c));for(f=0;f<e.length;f++)t=e[f].za,"DEBUG_VIEW"==t.type&&(t.su=f)}for(f=0;f<w.length;f++)for(k=na.ka(w[f].pb,a),h=k.V,k=0;k<h.length;k++)b(h[k]);for(f=0;f<d.length;f++)for(k=
na.ka(d[f],a),h=k.V,k=0;k<h.length;k++)b(h[k])};a.XQ=function(a,w,d){var e=a.s.pp,C=l("MAIN");T(C,"sky.glslv","sky.glslf");if(w.procedural_skydome)r(C,"PROCEDURAL_SKYDOME",1),C.zu=!0;else{var t=e.Po,v=oa.ic(a.s.Wa,fa.Bg).p.vc;S(C,v,"u_sky");t&&(r(C,"WO_SKYTEX",1),t.invert&&r(C,"MTEX_NEGATIVE",1),t.SN&&r(C,"MTEX_RGBTOINT",1),r(C,"BLENDTYPE",t.tG),t.NN&&r(C,"WOMAP_BLEND",1),t.ON&&r(C,"WOMAP_HORIZ",1),t.QN&&r(C,"WOMAP_ZENUP",1),t.PN&&r(C,"WOMAP_ZENDOWN",1));e.Ss&&r(C,"WO_SKYBLEND",1);e.Ts&&r(C,"WO_SKYPAPER",
1);e.Us&&r(C,"WO_SKYREAL",1)}w.ee&&(C.ee=!0,w.Hd&&(C.Hd=!0));C.mg=99999;f(C,"a_position");w=L.cV();g(C,w);b(C);d=na.ka(d,a);C.Tj=!0;C.ba=O.Jg();C.qb=O.Jg();C.P=O.Qd();C.Ta=O.Qd();C.wa=O.Gh();C.lb=O.Gh();aa(C);d.V.push(C);oa.ic(a.s.Wa,fa.uf)&&(a=c(C),a.type="DEBUG_VIEW",a.Fb="",I(a),r(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),w.qa.a_polyindex=ka.Gu(w),g(a,w),a.An=C.id,aa(a),d.V.push(a))};a.iA=function(a,w,b){b=na.ka(a,b).V;var g=[];oa.ic(w,fa.dd);var d=oa.ic(w,fa.Nd),e=oa.ic(w,fa.nd),f=oa.ic(w,fa.Ag);w=oa.ic(w,
fa.sf);for(var C=0;C<b.length;C++){var t=b[C],v=null;"SHADOW"==t.type&&"RECEIVE"==t.Fb&&t.Ge&&(v=c(t),v.Fb="CAST");"MAIN"!=t.type&&"PARTICLES"!=t.type||!d&&!e||!t.ee||(v=c(t),v.Fb="REFLECT",v.zk=!1,v.rf&&(v.rf=!1,v.Ua=!1),v.gb=t.gb);"COLOR_ID"==t.type&&f&&a.k.Wc&&(w&&a.k.Dk?(v=c(t),v.Fb="OUTLINE"):t.Fb="OUTLINE");v&&(v.bg=!0,aa(v),g.push(v))}b.push.apply(b,g)};a.VY=A;a.w0=function(a,w,b){w?w=b*(w.max_z-w.min_z):(w=1,C.q("No bounding box for mesh"));if(0==w)return 0;a=w*Math.tan(C.Cb(a));return.5*
(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/w};a.yR=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.v_=E;a.u_=P;a.RY=d;a.bG=function(a,w){r(a,"CSM_SECTION1",0);r(a,"CSM_SECTION2",0);r(a,"CSM_SECTION3",0);r(a,"NUM_CAST_LAMPS",0);if(w){r(a,"NUM_CAST_LAMPS",w.Zg.length);ja.Pv&&r(a,"MAC_OS_SHADOW_HACK",1);for(var b=1;b<w.csm_num;b++)r(a,"CSM_SECTION"+String(b),1);r(a,"SHADOW_TEX_RES",Z.M(w.csm_resolution));r(a,"CSM_FADE_LAST_CASCADE",w.fade_last_cascade?
1:0);r(a,"CSM_BLEND_BETWEEN_CASCADES",w.blend_between_cascades?1:0)}else r(a,"SHADOW_TEX_RES",0),r(a,"CSM_FADE_LAST_CASCADE",0),r(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.jf=r;a.ZA=function(a,w){return Z.rV(a.hb,w)};a.s_=g;a.t_=aa;a.Rt=T;a.Hj=S;a.nY=function(a,w,b){b=a.Ld.indexOf(b);-1<b&&(a.ya[b]=w)};a.kT=function(a,w){var b=l("MAIN");b.Lb=!0;qa.set(w[0],w[1],w[2],.5,b.Xf);b.Ih=ka.vp;g(b,a);T(b,"main.glslv","main_stack.glslf");r(b,"SHADELESS",1);X(b);return b};a.Yc=X;a.fV=function(a,w){for(var c=0;c<
w.length;c++){var d=w[c].pb,e=l("LINE");T(e,"line.glslv","line.glslf");e.Lb=!0;e.Tj=!0;var f=L.eV();g(e,f);b(e);e.P=O.Qd();e.Ta=O.Qd();e.ba=O.Jg();e.qb=O.Jg();e.lb=O.Gh();e.wa=O.Gh();na.Sp(d,a);na.ka(d,a).V.push(e);X(e)}};a.fS=function(a){return a.zb.Xr.length?a.zb.zC.u_cube_fog?!0:!1:!1};a.US=function(){var a=l("DEPTH_PACK");a.$b=!0;a.Ua=!1;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");X(a);return a};a.lA=function(a){var w=l("POSTPROCESSING");T(w,
"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":r(w,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":r(w,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":r(w,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":r(w,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":r(w,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":r(w,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":r(w,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":r(w,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:C.q("Wrong postprocessing effect: "+a)}w.$b=!0;w.Ua=!1;a=L.Uc();g(w,a);X(w);return w};a.nT=function(a){var w=l("SSAO");w.Ua=!1;w.$b=!0;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");r(w,"SSAO_QUALITY","SSAO_QUALITY_"+a.RM);r(w,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:
0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};b=ha.Jl(ha.wh,!1);b.source="NODE_TEX";ha.Ls(b,a,0);S(w,b,"u_ssao_special_tex");X(w);return w};a.oT=function(a){var w=l("SSAO_BLUR");w.Ua=!1;w.$b=!0;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");r(w,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);X(w);return w};a.RS=function(a){var w=l("COC");w.Ua=!1;w.$b=!0;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");r(w,"DEPTH_RGBA",1);switch(a){case "COC_ALL":r(w,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":r(w,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":r(w,"COC_TYPE","COC_COMBINE")}X(w);return w};a.VS=function(a){var w=l("DOF");w.Ua=!1;w.$b=!0;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?r(w,"DOF_TYPE","DOF_BOKEH"):(r(w,"DOF_TYPE","DOF_SIMPLE"),r(w,"DEPTH_RGBA",1));X(w);return w};a.dT=function(){var a=l("OUTLINE");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");X(a);return a};a.XS=function(){var a=l("GLOW_COMBINE");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");X(a);return a};a.YS=function(a,w,b){var c=l("GOD_RAYS");c.Ua=!1;c.$b=!0;var d=L.XU();g(c,
d);T(c,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");r(c,"DEPTH_RGBA",a?1:0);r(c,"WATER_EFFECTS",w?1:0);r(c,"STEPS_PER_PASS",Z.M(b,1));X(c);return c};a.ZS=function(){var a=l("GOD_RAYS_COM");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");r(a,"SAFARI_CANVAS_ALPHA_HACK",ja.HL?1:0);X(a);return a};a.TS=function(a,w){var b=l("SKY");b.Ua=!1;b.$b=!0;var c=L.ZU();g(b,c);if(w.procedural_skydome)T(b,"skybox.glslv","proc_skybox.glslf"),
r(b,"WATER_EFFECTS",1);else{T(b,"skybox.glslv","tex_skybox.glslf");if(a){c=a.s.pp;if(c.dx){var d=c.dx.texture,e=ha.he(c.dx);S(b,e,"u_sky_texture",d.name)}c.Po&&r(b,"WO_SKYTEX",1)}w.GM&&r(b,"MTEX_NEGATIVE",1);w.LM&&r(b,"MTEX_RGBTOINT",1);r(b,"BLENDTYPE",w.FM);w.HM&&r(b,"WOMAP_BLEND",1);w.IM&&r(b,"WOMAP_HORIZ",1);w.KM&&r(b,"WOMAP_ZENUP",1);w.JM&&r(b,"WOMAP_ZENDOWN",1);w.Ss&&r(b,"WO_SKYBLEND",1);w.Ts&&r(b,"WO_SKYPAPER",1);w.Us&&r(b,"WO_SKYREAL",1)}b.ba=O.Jg();b.qb=O.Jg();b.P=O.Qd();b.Ta=O.Qd();b.wa=
O.Gh();b.lb=O.Gh();X(b);return b};a.NQ=function(a,w){var b=oa.ic(a.s.Wa,fa.Bg);b&&(b=b.Qa[0].sa[0].za,na.ka(w,a).V.push(b))};a.MS=function(a){var w=l("ANTIALIASING");w.Ua=!1;w.$b=!0;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ja.oL?(r(w,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),r(w,"AA_QUALITY",a.lI)):r(w,"AA_METHOD","AA_METHOD_FXAA_LIGHT");X(w);return w};a.lT=function(a){var w=l("SMAA"),b=L.Uc();g(w,b);T(w,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
r(w,"AA_METHOD","AA_METHOD_SMAA_HIGH");r(w,"SMAA_PASS",a);r(w,"SMAA_PREDICATION",0);r(w,"SMAA_REPROJECTION",0);X(w);w.Ua=!1;w.$b=!0;return w};a.SS=function(){var a=l("COMPOSITING");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");X(a);return a};a.cT=function(){var a=l("MOTION_BLUR");a.$b=!0;a.Ua=!1;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");X(a);return a};a.pT=function(a){var w=
l("STEREO");w.$b=!0;w.Ua=!1;var b=L.Uc();g(w,b);T(w,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");r(w,"ANAGLYPH","ANAGLYPH"===a?1:0);X(w);return w};a.$S=function(){var a=l("LUMINANCE");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");X(a);return a};a.NS=function(){var a=l("LUMINANCE");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");X(a);return a};
a.aT=function(){var a=l("LUMINANCE_X_BLUR");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");X(a);return a};a.PS=function(){var a=l("POSTPROCESSING");a.$b=!0;a.Ua=!1;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");X(a);return a};a.QS=function(){var a=l("BLOOM");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
X(a);return a};a.NT=function(){var a=l("VELOCITY");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");X(a);return a};a.LS=function(){var a=l("ANCHOR_VISIBILITY");a.Ua=!0;a.$b=!0;a.Ih=ka.vp;T(a,"anchors.glslv","anchors.glslf");var w=L.rI(1);g(a,w);r(a,"ANCHOR_NUM",1);X(a);a.ol=new Float32Array(3);return a};a.eT=function(){var a=l("PERFORMANCE");a.Ua=!1;a.$b=!0;var w=L.Uc();g(a,w);T(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
X(a);return a};a.r_=function(a,w){var b=w.length/3;if(b!=a.ol.length/3){var c=L.rI(b);g(a,c);r(a,"ANCHOR_NUM",b);X(a)}a.ol=w};a.V4=function(a){if(!a.I.length)return null;a=a.I[0];return a.V.length?a.V[0]:null};a.GU=H;a.m4=ma;a.s8=W;a.T2=function(a,w){for(var b=a.I[0].V,g=0;g<b.length;g++)if(b[g].type==w)return!0;return!1};a.WG=function(a){for(var w=a.ya,b=0;b<w.length;b++)ha.OC(w[b]);a.Ba.Wf&&ka.zS(a.Ba);a.Wf&&a.Le.length&&ya.CS(a);a.zb.Wf&&Z.BS(a.zb);a.mk&&(w=ca.aJ(a.mk))&&w.VG&&ca.AS(a.mk)};a.eW=
function(a,w,b,g){for(var c=["MAIN","SHADOW","COLOR_ID"],d=!1,e=0;e<c.length;e++){var f=c[e],C=H(a,w,f),t=H(b,g,f);if(C&&t){var d=!0,v=ma(b,g,f);"MAIN"==f&&(W(t,C),v&&W(v,C));for(f=0;f<t.Ld.length;f++){var l=t.Ld[f];if(-1!==Ga.indexOf(l)){var k=C.Ld.indexOf(l);-1!==k&&(k=C.ya[k],ha.OC(t.ya[f]),t.ya[f]=k,ha.uv(k),v&&(l=v.Ld.indexOf(l),-1!==l&&(ha.OC(v.ya[l]),v.ya[l]=k,ha.uv(k))))}}}}d||ga.error("Wrong objects for inheriting material!")};a.ZY=function(a,w,b,g){for(var c=0;c<a.I.length;c++)for(var d=
a.I[c].V,e=0;e<d.length;e++){var f=d[e];-1!=f.ud.indexOf(w)&&f.fj&&(f.fj[b]=g)}};a.YY=function(a,w,b,g,c,d){for(var e=0;e<a.I.length;e++)for(var f=a.I[e].V,C=0;C<f.length;C++){var t=f[C];-1!=t.ud.indexOf(w)&&t.Ce&&(t.Ce[3*b]=g,t.Ce[3*b+1]=c,t.Ce[3*b+2]=d)}};a.n5=function(a,w){return a.fj[w]};a.m5=function(a,w,b){b[0]=a.Ce[3*w];b[1]=a.Ce[3*w+1];b[2]=a.Ce[3*w+2];return b};a.bJ=function(a,w){var b;b=w[1];for(var g=2;g<w.length;g++)b+="%join%"+w[g];for(g=0;g<a.length;g+=2)if(a[g]==b)return a[g+1];return null};
a.ua=function(){Qa={}}};b4w.module.__boundings=function(a,m){function l(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(){return{G:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function x(a,b){for(var c=a[0],d=a[1],e=a[2],f=a[0],l=a[1],k=a[2],h=3;h<a.length;h+=3)var H=a[h],n=a[h+1],u=a[h+2],c=Math.max(c,H),d=Math.max(d,n),e=Math.max(e,u),
f=Math.min(f,H),l=Math.min(l,n),k=Math.min(k,u);b.max_x=c;b.max_y=d;b.max_z=e;b.min_x=f;b.min_y=l;b.min_z=k;return b}function q(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,e=a.max_z,f=a.min_x,l=a.min_y,k=a.min_z;b[0]=f;b[1]=l;b[2]=k;b[3]=c;b[4]=l;b[5]=k;b[6]=c;b[7]=d;b[8]=k;b[9]=f;b[10]=d;b[11]=k;b[12]=f;b[13]=l;b[14]=e;b[15]=c;b[16]=l;b[17]=e;b[18]=c;b[19]=d;b[20]=e;b[21]=f;b[22]=d;b[23]=e;return b}function A(){return{G:new Float32Array(3),Xa:0}}function h(a,b){b.G[0]=a.G[0];b.G[1]=
a.G[1];b.G[2]=a.G[2];b.Xa=a.Xa}function z(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),G:new Float32Array(3)}}function p(a,b){F.copy(a.Ga,b.Ga);F.copy(a.Ha,b.Ha);F.copy(a.Ia,b.Ia);F.copy(a.G,b.G);return b}function n(a){var b=z();p(a,b);return b}function k(a,b,c,d){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(c),G:new Float32Array([d[0],d[1],d[2]])}}function u(a,b){var c=J.XR(a,P),c=b?J.QR(a,c,f):D.identity(f),c=J.HU(c,d);F.copy(a,E);F.transformMat3(E,
c,E);for(var e=E[0],l=e,h=E[1],n=h,u=E[2],q=u,H=0,p=0,y=0,O=0,z=0,x=0,v=3;v<a.length;v+=3)E[0]=a[v],E[1]=a[v+1],E[2]=a[v+2],F.transformMat3(E,c,E),H=E[0],p=E[1],y=E[2],H>e&&(e=H),H<l&&(l=H),p>h&&(h=p),p<n&&(n=p),y>u&&(u=y),y<q&&(q=y);h-=n;u-=q;e=Math.max(e-l,1E-9);h=Math.max(h,1E-9);u=Math.max(u,1E-9);l=D.identity(f);l[0]=0!=e?1/e:1E8;l[4]=0!=h?1/h:1E8;l[8]=0!=u?1/u:1E8;D.transpose(c,r);E[0]=a[0];E[1]=a[1];E[2]=a[2];F.transformMat3(E,c,E);F.transformMat3(E,l,E);F.transformMat3(E,r,E);H=E[0];p=E[0];
y=E[1];O=E[1];z=E[2];x=E[2];for(v=3;v<a.length;v+=3)E[0]=a[v],E[1]=a[v+1],E[2]=a[v+2],F.transformMat3(E,c,E),F.transformMat3(E,l,E),F.transformMat3(E,r,E),H=Math.max(H,E[0]),p=Math.min(p,E[0]),y=Math.max(y,E[1]),O=Math.min(O,E[1]),z=Math.max(z,E[2]),x=Math.min(x,E[2]);v=Math.sqrt((H-p)*(H-p)+(y-O)*(y-O)+(z-x)*(z-x))/2;v=Math.min(v,1);B[0]=(H+p)/2;B[1]=(y+O)/2;B[2]=(z+x)/2;H=B;l=D.identity(f);l[0]=e;l[4]=h;l[8]=u;F.transformMat3(H,c,H);F.transformMat3(H,l,H);F.transformMat3(H,r,H);l=[c[0],c[3],c[6]];
p=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];F.scale(l,e*v,l);F.scale(p,h*v,p);F.scale(c,u*v,c);return k(l,p,c,H)}function e(a,b,c){F.add(b,c,a.G);F.scale(a.G,.5,a.G);a.Xa=F.distance(a.G,b);return a}var y=m("__tsr"),K=m("__util"),F=m("__vec3"),J=m("__math"),D=m("__mat3"),R=new Float32Array(24),E=new Float32Array(3),I=new Float32Array(3),B=new Float32Array(3),P=new Float32Array(3),d=new Float32Array(9),f=new Float32Array(9),r=new Float32Array(9);new Float32Array(9);a.Qd=l;a.lu=c;a.vn=b;a.I2=function(){return{max_x:1E12,
min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.y0=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Bl=function(a){var c=l();b(a,c);return c};a.RR=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.KA=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,f=a.min_y,l=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,
f);a.min_z=Math.min(b.min_z,l)};a.iG=x;a.yl=function(a,b,c){c||(c=l());a=q(a,R);y.Pk(a,b,a);return x(a,c)};a.aI=q;a.b9=function(a,b,c){c||(c=l());var d=b.min_x,e=b.max_x,f=b.min_y,k=b.max_y,h=b.min_z;b=b.max_z;if(d>=a.max_x||e<=a.min_x||f>=a.max_y||k<=a.min_y||h>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,e);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,k);c.min_z=Math.max(a.min_z,h);
c.max_z=Math.min(a.max_z,b);return c};a.o9=function(a,b,c){c||(c=l());var d=a.max_x-a.min_x,e=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*e;c.max_y=a.max_y+.5*(b-1)*e;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.eq=function(a,b,c){c||(c=A());y.Hc(a.G,b,c.G);b=y.td(b);c.Xa=a.Xa*(0>b?-b:b);return c};a.dq=function(a,b,c){c||(c=z());y.Hc(a.G,b,c.G);F.copy(a.Ga,c.Ga);F.copy(a.Ha,c.Ha);F.copy(a.Ia,c.Ia);y.Xc(c.Ga,
b,c.Ga);y.Xc(c.Ha,b,c.Ha);y.Xc(c.Ia,b,c.Ia);return c};a.Dz=function(a,b,d){d||(d=c());y.Hc(a.G,b,d.G);F.copy(a.Ga,d.Ga);F.copy(a.Ha,d.Ha);F.copy(a.Ia,d.Ia);y.Xc(d.Ga,b,d.Ga);y.Xc(d.Ha,b,d.Ha);y.Xc(d.Ia,b,d.Ia);return d};a.Gz=function(a,b){var c=A();F.copy(b,c.G);c.Xa=a;return c};a.uY=function(a,b,d,e,f){var l=c();F.copy(a,l.G);F.copy(b,l.Ga);F.copy(d,l.Ha);F.copy(e,l.Ia);F.scale(l.Ga,f[0],l.Ga);F.scale(l.Ha,f[1],l.Ha);F.scale(l.Ia,f[2],l.Ia);return l};a.Gh=A;a.cA=h;a.Jg=z;a.aA=p;a.rq=n;a.Cl=function(a){var b=
A();h(a,b);return b};a.$p=k;a.AR=function(){var a;a||(a=A());F.set(0,0,0,a.G);a.Xa=1E12;return a};a.tU=function(a,b){var c=F.subtract(b.G,a.G,F.create());0==F.length(c)&&F.set(1,0,0,c);var d=F.normalize(c,F.create()),c=F.scale(d,a.Xa,F.create());F.add(c,a.G,c);var e=F.scale(d,-a.Xa,F.create());F.add(e,a.G,e);var f=F.scale(d,b.Xa,F.create());F.add(f,b.G,f);var l=F.scale(d,-b.Xa,F.create());F.add(l,b.G,l);c=[c,e,f,l];d=F.normalize(d,F.create());e=c[0];f=c[0];for(l=1;l<c.length;l++){var k=F.dot(c[l],
d);k<F.dot(e,d)&&(e=c[l]);k>F.dot(f,d)&&(f=c[l])}d=[e,f];c=d[0];d=d[1];a.G=F.scale(F.add(c,d,F.create()),.5,F.create());a.Xa=F.length(F.subtract(d,c,F.create()))/2};a.OA=function(a,b){F.add(a.G,a.Ha,E);F.add(E,a.Ga,E);F.add(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.add(a.G,a.Ha,E);F.add(E,a.Ga,E);F.subtract(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.add(a.G,a.Ha,E);F.subtract(E,a.Ga,E);F.add(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.add(a.G,a.Ha,E);F.subtract(E,a.Ga,E);F.subtract(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.subtract(a.G,
a.Ha,E);F.add(E,a.Ga,E);F.add(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.subtract(a.G,a.Ha,E);F.add(E,a.Ga,E);F.subtract(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.subtract(a.G,a.Ha,E);F.subtract(E,a.Ga,E);F.add(E,a.Ia,E);b.push(E[0],E[1],E[2]);F.subtract(a.G,a.Ha,E);F.subtract(E,a.Ga,E);F.subtract(E,a.Ia,E);b.push(E[0],E[1],E[2])};a.ju=u;a.OS=function(a){var b=c();F.copy(a.Ga,b.Ga);F.copy(a.Ha,b.Ha);F.copy(a.Ia,b.Ia);F.copy(a.G,b.G);return b};a.Dq=function(a){var b=A(),c=0,c=F.length(a.Ga),d=F.length(a.Ha),e=F.length(a.Ia),
c=c>d?c:d;b.G=a.G;b.Xa=e>c?e:c;return b};a.OR=function(a,b){var c=n(a),d=y.jc(b,P);F.subtract(c.G,d,c.G);return c};a.DB=function(a,b){var c=F.length(a.Ga),d=F.length(a.Ha),e=F.length(a.Ia);return.75*b.Xa*b.Xa*b.Xa>c*d*e};a.kG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d-2*a);return{Xa:a,height:e,G:new Float32Array([0,0,(c+d)/2])}};a.mG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d);return{Xa:a,height:e,G:new Float32Array([0,0,(c+d)/2])}};a.lG=function(a,b){var c=b.max_z,d=b.min_z,
e=Math.max(0,c-d);return{Xa:a,height:e,G:new Float32Array([0,0,(c+d)/2])}};a.U2=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.bY=function(a){for(var b=0,c=0,d=0,e=0,f=0,l=0,k=0,h=0,H=0,n=0,q=0,r=0,p=0,y=0,v=0;v<a.submeshes.length;v++){var z=a.submeshes[v];if(z.position.length){b=e=z.position[0];c=f=z.position[1];d=l=z.position[2];break}}for(v=0;v<a.submeshes.length;v++){for(var z=a.submeshes[v],x=z.position,k=
n=z.position[0],h=q=z.position[1],H=r=z.position[2],ca=0;ca<x.length/3;ca++)var D=x[3*ca],B=x[3*ca+1],L=x[3*ca+2],b=Math.max(D,b),c=Math.max(B,c),d=Math.max(L,d),e=Math.min(D,e),f=Math.min(B,f),l=Math.min(L,l),k=Math.max(D,k),h=Math.max(B,h),H=Math.max(L,H),n=Math.min(D,n),q=Math.min(B,q),r=Math.min(L,r),p=Math.max(Math.sqrt(D*D+B*B+L*L),p),y=Math.max(Math.sqrt(D*D+B*B),y);x=z.boundings.bb;x.max_x=k;x.min_x=n;x.max_y=h;x.min_y=q;x.max_z=H;x.min_z=r;x=R;x[0]=n;x[1]=q;x[2]=r;x[3]=k;x[4]=q;x[5]=r;x[6]=
k;x[7]=h;x[8]=r;x[9]=n;x[10]=h;x[11]=r;x[12]=n;x[13]=q;x[14]=H;x[15]=k;x[16]=q;x[17]=H;x[18]=k;x[19]=h;x[20]=H;x[21]=n;x[22]=h;x[23]=H;k=u(x,!1);z.boundings.be_cen=k.G;z.boundings.be_ax=[k.Ga[0],k.Ha[1],k.Ia[2]]}v=a.b4w_boundings.bb;v.max_x=b;v.min_x=e;v.max_y=c;v.min_y=f;v.max_z=d;v.min_z=l;v=a.b4w_boundings.bb_src;v.max_x=b;v.min_x=e;v.max_y=c;v.min_y=f;v.max_z=d;v.min_z=l;a.b4w_boundings.bs_rad=p;a.b4w_boundings.bc_rad=y;x=R;x[0]=e;x[1]=f;x[2]=l;x[3]=b;x[4]=f;x[5]=l;x[6]=b;x[7]=c;x[8]=l;x[9]=e;
x[10]=c;x[11]=l;x[12]=e;x[13]=f;x[14]=d;x[15]=b;x[16]=f;x[17]=d;x[18]=b;x[19]=c;x[20]=d;x[21]=e;x[22]=c;x[23]=d;k=u(x,!1);a.b4w_boundings.be_cen=k.G;a.b4w_boundings.be_ax=[k.Ga[0],k.Ha[1],k.Ia[2]]};a.BV=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),d=a.subarray(12,15),f=a.subarray(18,21);a=F.subtract(c,b,E);F.normalize(a,a);var l=K.LV(b,c,d,I),l=F.cross(l,a,l);F.normalize(l,l);var k=F.create(),h=F.create();F.subtract(c,b,B);h[0]=F.dot(B,a);h[1]=F.dot(B,l);c=F.create();F.subtract(d,b,B);c[0]=
F.dot(B,a);c[1]=F.dot(B,l);d=F.create();F.subtract(f,b,B);d[0]=F.dot(B,a);d[1]=F.dot(B,l);f=A();d=[k,h,c,d];k=e(f,d[0],d[1]);for(f=2;f<d.length;f++)if(F.distance(k.G,d[f])>k.Xa){for(var n=k,k=d,h=d[f],c=f-1,n=e(n,h,k[0]),H=1;H<=c;H++)if(F.distance(n.G,k[H])>n.Xa){for(var u=n,n=k,q=h,r=k[H],p=H-1,u=e(u,q,r),y=0;y<=p;y++)if(F.distance(u.G,n[y])>u.Xa){var v=q,x=r,z=n[y],ca=F.subtract(x,z,B),ca=F.squaredLength(ca),D=F.subtract(v,z,B),J=F.squaredLength(D),D=F.subtract(v,x,B),L=F.squaredLength(D),D=ca*
(J+L-ca),Y=J*(L+ca-J),ca=L*(ca+J-L),J=D+Y+ca;F.copy(v,u.G);F.scale(u.G,D/J,u.G);F.scaleAndAdd(u.G,x,Y/J,u.G);F.scaleAndAdd(u.G,z,ca/J,u.G);u.Xa=F.distance(u.G,v)}n=u}k=n}f=k;a=F.scale(a,f.G[0],B);F.scaleAndAdd(a,l,f.G[1],a);F.add(a,b,f.G);return f}};b4w.module.__tsr=function(a,m){function l(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function x(a,b,c,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=b;e[4]=c[0];e[5]=c[1];e[6]=c[2];e[7]=c[3];return e}function q(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function A(a,b,c){var e=b[0],l=b[1],k=b[2],h=b[3],n=b[4],d=b[5],f=b[6];
b=b[7];var u=a[0]*h,g=a[1]*h,q=a[2]*h;a=b*u+d*q-f*g;var h=b*g+f*u-n*q,t=b*q+n*g-d*u,u=-n*u-d*g-f*q;c[0]=a*b+u*-n+h*-f-t*-d;c[1]=h*b+u*-d+t*-n-a*-f;c[2]=t*b+u*-f+a*-d-h*-n;c[0]+=e;c[1]+=l;c[2]+=k;return c}var h=m("__mat4"),z=m("__quat"),p=m("__util"),n=m("__vec3"),k=Math.sin(-Math.PI/4),u=-k,e=new Float32Array(3),y=new Float32Array(4);new Float32Array(4);var K=new Float32Array(16);a.create=l;a.clone=function(a){var c=l();b(a,c);return c};a.kI=function(a,b,c,e,k,h,n,u){var d=l();d[0]=a;d[1]=b;d[2]=
c;d[3]=e;d[4]=k;d[5]=h;d[6]=n;d[7]=u;return d};a.Hl=c;a.o3=function(a){var e=c();b(a,e);return e};a.t4=function(a,b,e,l,k,h,n,u){var d=c();d[0]=a;d[1]=b;d[2]=e;d[3]=l;d[4]=k;d[5]=h;d[6]=n;d[7]=u;return d};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.sg=x;a.pe=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Fe=function(a,b){b[3]=a;return b};a.pD=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.di=function(a,b){b[4]=a[0];
b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.F=function(a){return a.subarray(0,3)};a.jc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.td=function(a){return a[3]};a.QV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.N=function(a){return a.subarray(4,8)};a.Yd=q;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var e=a[0],l=a[1],k=a[2];y[0]=a[4];y[1]=a[5];y[2]=a[6];y[3]=a[7];z.invert(y,y);var h=y[0],n=y[1],d=y[2],f=y[3],e=e*c,l=l*c,u=k*c,k=f*e+n*u-d*l,g=f*l+d*e-h*u,q=f*u+h*l-n*e,
e=-h*e-n*l-d*u;b[0]=-(k*f+e*-h+g*-d-q*-n);b[1]=-(g*f+e*-n+q*-h-k*-d);b[2]=-(q*f+e*-d+k*-n-g*-h);b[3]=c;b[4]=h;b[5]=n;b[6]=d;b[7]=f;return b};a.nx=function(a,b){var c=a[3];h.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var e=0;12>e;e++)b[e]*=c;return b};a.Tg=function(a,b){var c=p.CK(a,e),l=p.BK(a),k=p.UB(a,y);x(c,l,k,b);return b};a.multiply=function(a,b,c){A(b,a,c);c[3]=a[3]*b[3];var e=a[4],l=a[5],k=a[6];a=a[7];var h=b[4],n=b[5],d=b[6];b=b[7];c[4]=e*b+a*h+l*d-k*n;c[5]=l*b+a*n+k*h-
e*d;c[6]=k*b+a*d+e*n-l*h;c[7]=a*b-e*h-l*n-k*d;return c};a.j_=function(a,b,c){var e=b[3];b=h.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),K);for(var l=0;12>l;l++)b[l]*=e;h.multiply(b,a,c);return c};a.Hc=A;a.wN=function(a,b,c){var e=b[3],l=a[0]-b[0],k=a[1]-b[1],h=a[2]-b[2];a=b[4];var n=b[5],d=b[6];b=b[7];var f=a*a+n*n+d*d+b*b,f=f?1/f:0;a=-a*f;n=-n*f;d=-d*f;b*=f;var f=b*l+n*h-d*k,u=b*k+d*l-a*h,g=b*h+a*k-n*l,l=-a*l-n*k-d*h;c[0]=f*b+l*-a+u*-d-g*-n;c[1]=u*b+l*-n+g*-a-f*-d;c[2]=g*b+l*-d+f*-n-
u*-a;c[0]/=e;c[1]/=e;c[2]/=e;return c};a.Pk=function(a,b,c,e){e||(e=0);var l=a.length,k=b[0],h=b[1],n=b[2],d=b[3],f=b[4],u=b[5],g=b[6];b=b[7];for(var q=0;q<l;q+=3){var t=a[q]*d,p=a[q+1]*d,y=a[q+2]*d,G=b*t+u*y-g*p,x=b*p+g*t-f*y,z=b*y+f*p-u*t,t=-f*t-u*p-g*y;c[e+q]=G*b+t*-f+x*-g-z*-u;c[e+q+1]=x*b+t*-u+z*-f-G*-g;c[e+q+2]=z*b+t*-g+G*-u-x*-f;c[e+q]+=k;c[e+q+1]+=h;c[e+q+2]+=n}return c};a.cE=function(a,b,c,e){e||(e=0);var l=a.length,k=b[3],h=b[4],n=b[5],d=b[6];b=b[7];for(var f=0;f<l;f+=3){var u=a[f]*k,g=
a[f+1]*k,q=a[f+2]*k,t=b*u+n*q-d*g,p=b*g+d*u-h*q,y=b*q+h*g-n*u,u=-h*u-n*g-d*q;c[e+f]=t*b+u*-h+p*-d-y*-n;c[e+f+1]=p*b+u*-n+y*-h-t*-d;c[e+f+2]=y*b+u*-d+t*-n-p*-h}return c};a.Xc=function(a,b,c){var e=b[3],l=b[4],k=b[5],h=b[6];b=b[7];var n=a[0]*e,d=a[1]*e,f=a[2]*e;a=b*n+k*f-h*d;var e=b*d+h*n-l*f,u=b*f+l*d-k*n,n=-l*n-k*d-h*f;c[0]=a*b+n*-l+e*-h-u*-k;c[1]=e*b+n*-k+u*-l-a*-h;c[2]=u*b+n*-h+a*-k-e*-l;return c};a.dE=function(a,b,c,e){e||(e=0);var l=a.length,k=b[3],h=b[4],n=b[5],d=b[6];b=b[7];for(var f=0;f<l;f+=
4){var u=a[f]*k,g=a[f+1]*k,q=a[f+2]*k,t=b*u+n*q-d*g,p=b*g+d*u-h*q,y=b*q+h*g-n*u,u=-h*u-n*g-d*q;c[e+f]=t*b+u*-h+p*-d-y*-n;c[e+f+1]=p*b+u*-n+y*-h-t*-d;c[e+f+2]=y*b+u*-d+t*-n-p*-h;c[e+f+3]=a[f+3]}return c};a.k_=function(a,b,c){b=q(b,y);z.multiply(b,a,c)};a.vN=function(a,b,c,e){e=e||0;b=q(b,y);p.sL(a,b,c,e)};a.translate=function(a,b,c){var e=a[3],l=a[4],k=a[5],h=a[6],n=a[7],d=b[0]*e,f=b[1]*e,u=b[2]*e;b=n*d+k*u-h*f;var e=n*f+h*d-l*u,g=n*u+l*f-k*d,d=-l*d-k*f-h*u;c[0]=a[0]+b*n+d*-l+e*-h-g*-k;c[1]=a[1]+e*
n+d*-k+g*-l-b*-h;c[2]=a[2]+g*n+d*-h+b*-k-e*-l;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.xr=function(a,b,c,e){n.lerp(a.subarray(0,3),b.subarray(0,3),c,e.subarray(0,3));var l=a[3];e[3]=l+c*(b[3]-l);z.slerp(a.subarray(4,8),b.subarray(4,8),c,e.subarray(4,8));return e};a.f4=function(a,b,c,e){var l=a.subarray(0,3),k=b.subarray(0,3),h=e.subarray(0,3);h[0]=k[0]*(c+1)-l[0]*c;h[1]=k[1]*(c+1)-l[1]*c;h[2]=k[2]*(c+1)-l[2]*c;e[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);l=e.subarray(4,
8);l[0]=b[0]*(c+1)-a[0]*c;l[1]=b[1]*(c+1)-a[1]*c;l[2]=b[2]*(c+1)-a[2]*c;l[3]=b[3]*(c+1)-a[3]*c;z.normalize(l,l);return e};a.nW=function(a,b,c,e,l){l[0]=a[0]+b*c[0];l[1]=a[1]+b*c[1];l[2]=a[2]+b*c[2];l[3]=a[3];c=e[0];var k=e[1];e=e[2];var h=a[4],n=a[5],d=a[6],f=a[7];l[4]=.5*(c*f+k*d-e*n);l[5]=.5*(k*f+e*h-c*d);l[6]=.5*(e*f+c*n-k*h);l[7]=.5*(-c*h-k*n-e*d);l[4]=a[4]+l[4]*b;l[5]=a[5]+l[5]*b;l[6]=a[6]+l[6]*b;l[7]=a[7]+l[7]*b;a=l[4];b=l[5];c=l[6];k=l[7];a=a*a+b*b+c*c+k*k;0<a&&(a=1/Math.sqrt(a),l[4]*=a,l[5]*=
a,l[6]*=a,l[7]*=a)};a.B9=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],e=a[5],l=a[6],h=a[7];b[4]=c*u+h*k;b[5]=e*u+l*k;b[6]=l*u-e*k;b[7]=h*u-c*k};a.A9=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__vec3=function(a){var m="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new m(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new m(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,l){var q=new m(3);q[0]=a;q[1]=b;q[2]=l;return q};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,l,q){q[0]=a;q[1]=b;q[2]=l;return q};a.add=function(a,b,l){l[0]=a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];
return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],
b[2]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;return l};a.scaleAndAdd=function(a,b,l,q){q[0]=a[0]+b[0]*l;q[1]=a[1]+b[1]*l;q[2]=a[2]+b[2]*l;return q};a.distance=function(a,b){var l=b[0]-a[0],q=b[1]-a[1],A=b[2]-a[2];return Math.sqrt(l*l+q*q+A*A)};a.dist=a.distance;a.squaredDistance=function(a,b){var l=b[0]-a[0],q=b[1]-a[1],A=b[2]-a[2];return l*l+q*q+A*A};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1];a=a[2];return Math.sqrt(b*b+l*l+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],l=a[1];a=a[2];return b*b+l*l+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var l=a[0],q=a[1],A=a[2],l=l*l+q*q+A*A;0<l&&(l=1/Math.sqrt(l),b[0]=a[0]*l,b[1]=a[1]*l,b[2]=a[2]*l);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,l){var q=a[0],A=a[1];a=a[2];var h=b[0],z=b[1];b=b[2];
l[0]=A*b-a*z;l[1]=a*h-q*b;l[2]=q*z-A*h;return l};a.lerp=function(a,b,l,q){var A=a[0],h=a[1];a=a[2];q[0]=A+l*(b[0]-A);q[1]=h+l*(b[1]-h);q[2]=a+l*(b[2]-a);return q};a.v6=function(a,b,l,q,A,h){var z=A*A,p=z*(2*A-3)+1,n=z*(A-2)+A,k=z*(A-1);A=z*(3-2*A);h[0]=a[0]*p+b[0]*n+l[0]*k+q[0]*A;h[1]=a[1]*p+b[1]*n+l[1]*k+q[1]*A;h[2]=a[2]*p+b[2]*n+l[2]*k+q[2]*A;return h};a.nG=function(a,b,l,q,A,h){var z=1-A,p=z*z,n=A*A,k=p*z,p=3*A*p,z=3*n*z;A*=n;h[0]=a[0]*k+b[0]*p+l[0]*z+q[0]*A;h[1]=a[1]*k+b[1]*p+l[1]*z+q[1]*A;h[2]=
a[2]*k+b[2]*p+l[2]*z+q[2]*A;return h};a.random=function(a,b){a=a||1;var x=2*l()*Math.PI,q=2*l()-1,A=Math.sqrt(1-q*q)*a;b[0]=Math.cos(x)*A;b[1]=Math.sin(x)*A;b[2]=q*a;return b};a.transformMat4=function(a,b,l){var q=a[0],A=a[1];a=a[2];var h=b[3]*q+b[7]*A+b[11]*a+b[15],h=h||1;l[0]=(b[0]*q+b[4]*A+b[8]*a+b[12])/h;l[1]=(b[1]*q+b[5]*A+b[9]*a+b[13])/h;l[2]=(b[2]*q+b[6]*A+b[10]*a+b[14])/h;return l};a.transformMat3=function(a,b,l){var q=a[0],A=a[1];a=a[2];l[0]=q*b[0]+A*b[3]+a*b[6];l[1]=q*b[1]+A*b[4]+a*b[7];
l[2]=q*b[2]+A*b[5]+a*b[8];return l};a.transformQuat=function(a,b,l){var q=a[0],A=a[1],h=a[2];a=b[0];var z=b[1],p=b[2];b=b[3];var n=b*q+z*h-p*A,k=b*A+p*q-a*h,u=b*h+a*A-z*q,q=-a*q-z*A-p*h;l[0]=n*b+q*-a+k*-p-u*-z;l[1]=k*b+q*-z+u*-a-n*-p;l[2]=u*b+q*-p+n*-z-k*-a;return l};a.rotateX=function(a,b,l,q){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[0];h[1]=A[1]*Math.cos(l)-A[2]*Math.sin(l);h[2]=A[1]*Math.sin(l)+A[2]*Math.cos(l);q[0]=h[0]+b[0];q[1]=h[1]+b[1];q[2]=h[2]+b[2];return q};a.rotateY=
function(a,b,l,q){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[2]*Math.sin(l)+A[0]*Math.cos(l);h[1]=A[1];h[2]=A[2]*Math.cos(l)-A[0]*Math.sin(l);q[0]=h[0]+b[0];q[1]=h[1]+b[1];q[2]=h[2]+b[2];return q};a.rotateZ=function(a,b,l,q){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[0]*Math.cos(l)-A[1]*Math.sin(l);h[1]=A[0]*Math.sin(l)+A[1]*Math.cos(l);h[2]=A[2];q[0]=h[0]+b[0];q[1]=h[1]+b[1];q[2]=h[2]+b[2];return q};a.forEach=function(){var c=a.create();return function(a,
l,q,A,h,z){l||(l=3);q||(q=0);for(A=A?Math.min(A*l+q,a.length):a.length;q<A;q+=l)c[0]=a[q],c[1]=a[q+1],c[2]=a[q+2],h(c,z,c),a[q]=c[0],a[q+1]=c[1],a[q+2]=c[2];return a}}();a.l2=function(c,b){var l=a.fromValues(c[0],c[1],c[2]),q=a.fromValues(b[0],b[1],b[2]);a.normalize(l,l);a.normalize(q,q);l=a.dot(l,q);return 1<l?0:Math.acos(l)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var m="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new m(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new m(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,l,q){var A=new m(4);A[0]=a;A[1]=b;A[2]=l;A[3]=q;return A};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,l,q,A){A[0]=a;A[1]=b;A[2]=l;A[3]=q;return A};a.add=function(a,b,l){l[0]=
a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];l[3]=a[3]+b[3];return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];l[3]=a[3]-b[3];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];l[3]=a[3]*b[3];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];l[3]=a[3]/b[3];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);l[3]=
Math.min(a[3],b[3]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],b[2]);l[3]=Math.max(a[3],b[3]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;l[3]=a[3]*b;return l};a.scaleAndAdd=function(a,b,l,q){q[0]=a[0]+b[0]*l;q[1]=a[1]+b[1]*l;q[2]=a[2]+b[2]*l;q[3]=a[3]+b[3]*l;return q};a.distance=function(a,b){var l=b[0]-a[0],q=b[1]-a[1],A=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(l*l+q*q+A*A+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var l=b[0]-a[0],q=b[1]-a[1],A=b[2]-a[2],h=b[3]-a[3];return l*l+q*q+A*A+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1],q=a[2];a=a[3];return Math.sqrt(b*b+l*l+q*q+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],l=a[1],q=a[2];a=a[3];return b*b+l*l+q*q+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var l=a[0],q=a[1],A=a[2],h=a[3],z=l*l+q*q+A*A+h*h;0<z&&(z=1/Math.sqrt(z),b[0]=l*z,b[1]=q*z,b[2]=A*z,b[3]=h*z);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,l,q){var A=a[0],h=a[1],z=a[2];a=a[3];q[0]=A+l*(b[0]-A);q[1]=h+l*(b[1]-h);q[2]=z+l*(b[2]-z);q[3]=a+l*(b[3]-a);return q};a.random=function(c,b){c=c||1;b[0]=l();b[1]=l();b[2]=l();b[3]=l();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,l){var q=a[0],A=a[1],h=
a[2];a=a[3];l[0]=b[0]*q+b[4]*A+b[8]*h+b[12]*a;l[1]=b[1]*q+b[5]*A+b[9]*h+b[13]*a;l[2]=b[2]*q+b[6]*A+b[10]*h+b[14]*a;l[3]=b[3]*q+b[7]*A+b[11]*h+b[15]*a;return l};a.transformQuat=function(a,b,l){var q=a[0],A=a[1],h=a[2],z=b[0],p=b[1],n=b[2];b=b[3];var k=b*q+p*h-n*A,u=b*A+n*q-z*h,e=b*h+z*A-p*q,q=-z*q-p*A-n*h;l[0]=k*b+q*-z+u*-n-e*-p;l[1]=u*b+q*-p+e*-z-k*-n;l[2]=e*b+q*-n+k*-p-u*-z;l[3]=a[3];return l};a.forEach=function(){var l=a.create();return function(a,x,q,A,h,z){x||(x=4);q||(q=0);for(A=A?Math.min(A*
x+q,a.length):a.length;q<A;q+=x)l[0]=a[q],l[1]=a[q+1],l[2]=a[q+2],l[3]=a[q+3],h(l,z,l),a[q]=l[0],a[q+1]=l[1],a[q+2]=l[2],a[q+3]=l[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,m){var l=m("__vec3"),c=m("__vec4"),b=m("__mat3"),x="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new x(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=l.create(),c=l.fromValues(1,0,0),h=l.fromValues(0,1,0);return function(z,p,n){var k=l.dot(z,p);if(-.9999999>k)return l.cross(c,z,b),1E-6>l.length(b)&&l.cross(h,z,b),l.normalize(b,b),a.setAxisAngle(b,Math.PI,n),n;if(.9999999<k)return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n;l.cross(z,
p,b);n[0]=b[0];n[1]=b[1];n[2]=b[2];n[3]=1+k;return a.normalize(n,n)}}();a.setAxes=function(){var l=b.create();return function(b,c,z,p){l[0]=c[0];l[3]=c[1];l[6]=c[2];l[1]=z[0];l[4]=z[1];l[7]=z[2];l[2]=-b[0];l[5]=-b[1];l[8]=-b[2];return a.normalize(a.fromMat3(l,p),p)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,l){b*=.5;var c=Math.sin(b);l[0]=c*a[0];l[1]=c*a[1];l[2]=c*a[2];l[3]=Math.cos(b);
return l};a.add=c.add;a.multiply=function(a,b,l){var c=a[0],p=a[1],n=a[2];a=a[3];var k=b[0],u=b[1],e=b[2];b=b[3];l[0]=c*b+a*k+p*e-n*u;l[1]=p*b+a*u+n*k-c*e;l[2]=n*b+a*e+c*u-p*k;l[3]=a*b-c*k-p*u-n*e;return l};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,l){b*=.5;var c=a[0],p=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);l[0]=c*b+a*k;l[1]=p*b+n*k;l[2]=n*b-p*k;l[3]=a*b-c*k;return l};a.rotateY=function(a,b,l){b*=.5;var c=a[0],p=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);l[0]=c*
b-n*k;l[1]=p*b+a*k;l[2]=n*b+c*k;l[3]=a*b-p*k;return l};a.rotateZ=function(a,b,l){b*=.5;var c=a[0],p=a[1],n=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);l[0]=c*b+p*k;l[1]=p*b-c*k;l[2]=n*b+a*k;l[3]=a*b-n*k;return l};a.calculateW=function(a,b){var l=a[0],c=a[1],p=a[2];b[0]=l;b[1]=c;b[2]=p;b[3]=Math.sqrt(Math.abs(1-l*l-c*c-p*p));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,l,c){var p=a[0],n=a[1],k=a[2];a=a[3];var u=b[0],e=b[1],y=b[2];b=b[3];var x,m,J;m=p*u+n*e+k*y+a*b;0>m&&(m=-m,u=-u,e=-e,
y=-y,b=-b);1E-6<1-m?(x=Math.acos(m),J=Math.sin(x),m=Math.sin((1-l)*x)/J,l=Math.sin(l*x)/J):m=1-l;c[0]=m*p+l*u;c[1]=m*n+l*e;c[2]=m*k+l*y;c[3]=m*a+l*b;return c};a.g9=function(){var b=a.create(),l=a.create();return function(c,z,p,n,k,u){a.slerp(c,n,k,b);a.slerp(z,p,k,l);a.slerp(b,l,2*k*(1-k),u);return u}}();a.invert=function(a,b){var l=a[0],c=a[1],p=a[2],n=a[3],k=l*l+c*c+p*p+n*n,k=k?1/k:0;b[0]=-l*k;b[1]=-c*k;b[2]=-p*k;b[3]=n*k;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var l=a[0]+a[4]+a[8];if(0<l)l=Math.sqrt(l+1),b[3]=.5*l,l=.5/l,b[0]=(a[5]-a[7])*l,b[1]=(a[6]-a[2])*l,b[2]=(a[1]-a[3])*l;else{var c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var p=(c+1)%3,n=(c+2)%3,l=Math.sqrt(a[3*c+c]-a[3*p+p]-a[3*n+n]+1);b[c]=.5*l;l=.5/l;b[3]=(a[3*p+n]-a[3*n+p])*l;b[p]=(a[3*p+c]+a[3*c+p])*l;b[n]=(a[3*n+c]+a[3*c+n])*l}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var m="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new m(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new m(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],x=a[2],q=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=x;c[7]=q}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=a[4],z=a[5],p=a[6],n=a[7],k=a[8],u=k*h-z*n,e=-k*m+z*p,y=
n*m-h*p,K=b*u+x*e+q*y;if(!K)return null;K=1/K;c[0]=u*K;c[1]=(-k*x+q*n)*K;c[2]=(z*x-q*h)*K;c[3]=e*K;c[4]=(k*b-q*p)*K;c[5]=(-z*b+q*m)*K;c[6]=y*K;c[7]=(-n*b+x*p)*K;c[8]=(h*b-x*m)*K;return c};a.adjoint=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=a[4],z=a[5],p=a[6],n=a[7],k=a[8];c[0]=h*k-z*n;c[1]=q*n-x*k;c[2]=x*z-q*h;c[3]=z*p-m*k;c[4]=b*k-q*p;c[5]=q*m-b*z;c[6]=m*n-h*p;c[7]=x*p-b*n;c[8]=b*h-x*m;return c};a.determinant=function(a){var c=a[3],b=a[4],x=a[5],q=a[6],m=a[7],h=a[8];return a[0]*(h*b-x*m)+a[1]*
(-h*c+x*q)+a[2]*(m*c-b*q)};a.multiply=function(a,c,b){var x=a[0],q=a[1],m=a[2],h=a[3],z=a[4],p=a[5],n=a[6],k=a[7];a=a[8];var u=c[0],e=c[1],y=c[2],K=c[3],F=c[4],J=c[5],D=c[6],R=c[7];c=c[8];b[0]=u*x+e*h+y*n;b[1]=u*q+e*z+y*k;b[2]=u*m+e*p+y*a;b[3]=K*x+F*h+J*n;b[4]=K*q+F*z+J*k;b[5]=K*m+F*p+J*a;b[6]=D*x+R*h+c*n;b[7]=D*q+R*z+c*k;b[8]=D*m+R*p+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var x=a[0],q=a[1],m=a[2],h=a[3],z=a[4],p=a[5],n=a[6],k=a[7];a=a[8];var u=c[0];c=c[1];b[0]=x;b[1]=q;b[2]=m;
b[3]=h;b[4]=z;b[5]=p;b[6]=u*x+c*h+n;b[7]=u*q+c*z+k;b[8]=u*m+c*p+a;return b};a.rotate=function(a,c,b){var x=a[0],q=a[1],m=a[2],h=a[3],z=a[4],p=a[5],n=a[6],k=a[7];a=a[8];var u=Math.sin(c);c=Math.cos(c);b[0]=c*x+u*h;b[1]=c*q+u*z;b[2]=c*m+u*p;b[3]=c*h-u*x;b[4]=c*z-u*q;b[5]=c*p-u*m;b[6]=n;b[7]=k;b[8]=a;return b};a.scale=function(a,c,b){var x=c[0];c=c[1];b[0]=x*a[0];b[1]=x*a[1];b[2]=x*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.UU=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.SU=function(a,c){var b=Math.sin(a),x=Math.cos(a);c[0]=x;c[1]=b;c[2]=0;c[3]=-b;c[4]=x;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.TU=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=b+b,z=x+x,p=q+q,b=b*h,n=x*h,x=x*z,k=q*h,u=
q*z,q=q*p,h=m*h,z=m*z,m=m*p;c[0]=1-x-q;c[3]=n-m;c[6]=k+z;c[1]=n+m;c[4]=1-b-q;c[7]=u-h;c[2]=k-z;c[5]=u+h;c[8]=1-b-x;return c};a.normalFromMat4=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=a[4],z=a[5],p=a[6],n=a[7],k=a[8],u=a[9],e=a[10],y=a[11],K=a[12],F=a[13],J=a[14],D=a[15],R=b*z-x*h,E=b*p-q*h,I=b*n-m*h,B=x*p-q*z,P=x*n-m*z,d=q*n-m*p,f=k*F-u*K,r=k*J-e*K,k=k*D-y*K,g=u*J-e*F,u=u*D-y*F,e=e*D-y*J,y=R*e-E*u+I*g+B*k-P*r+d*f;if(!y)return null;y=1/y;c[0]=(z*e-p*u+n*g)*y;c[1]=(p*k-h*e-n*r)*y;c[2]=(h*u-z*
k+n*f)*y;c[3]=(q*u-x*e-m*g)*y;c[4]=(b*e-q*k+m*r)*y;c[5]=(x*k-b*u-m*f)*y;c[6]=(F*d-J*P+D*B)*y;c[7]=(J*I-K*d-D*E)*y;c[8]=(K*P-F*I+D*R)*y;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.RU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var m="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new m(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new m(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],x=a[2],q=a[3],m=a[6],h=a[7],z=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=x;c[9]=m;c[11]=a[14];c[12]=q;c[13]=
h;c[14]=z}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=a[4],z=a[5],p=a[6],n=a[7],k=a[8],u=a[9],e=a[10],y=a[11],K=a[12],F=a[13],J=a[14],D=a[15],R=b*z-x*h,E=b*p-q*h,I=b*n-m*h,B=x*p-q*z,P=x*n-m*z,d=q*n-m*p,f=k*F-u*K,r=k*J-e*K,g=k*D-y*K,Q=u*J-e*F,t=u*D-y*F,aa=e*D-y*J,M=R*aa-E*t+I*Q+B*g-P*r+d*f;if(!M)return null;
M=1/M;c[0]=(z*aa-p*t+n*Q)*M;c[1]=(q*t-x*aa-m*Q)*M;c[2]=(F*d-J*P+D*B)*M;c[3]=(e*P-u*d-y*B)*M;c[4]=(p*g-h*aa-n*r)*M;c[5]=(b*aa-q*g+m*r)*M;c[6]=(J*I-K*d-D*E)*M;c[7]=(k*d-e*I+y*E)*M;c[8]=(h*t-z*g+n*f)*M;c[9]=(x*g-b*t-m*f)*M;c[10]=(K*P-F*I+D*R)*M;c[11]=(u*I-k*P-y*R)*M;c[12]=(z*r-h*Q-p*f)*M;c[13]=(b*Q-x*r+q*f)*M;c[14]=(F*E-K*B-J*R)*M;c[15]=(k*B-u*E+e*R)*M;return c};a.adjoint=function(a,c){var b=a[0],x=a[1],q=a[2],m=a[3],h=a[4],z=a[5],p=a[6],n=a[7],k=a[8],u=a[9],e=a[10],y=a[11],K=a[12],F=a[13],J=a[14],D=
a[15];c[0]=z*(e*D-y*J)-u*(p*D-n*J)+F*(p*y-n*e);c[1]=-(x*(e*D-y*J)-u*(q*D-m*J)+F*(q*y-m*e));c[2]=x*(p*D-n*J)-z*(q*D-m*J)+F*(q*n-m*p);c[3]=-(x*(p*y-n*e)-z*(q*y-m*e)+u*(q*n-m*p));c[4]=-(h*(e*D-y*J)-k*(p*D-n*J)+K*(p*y-n*e));c[5]=b*(e*D-y*J)-k*(q*D-m*J)+K*(q*y-m*e);c[6]=-(b*(p*D-n*J)-h*(q*D-m*J)+K*(q*n-m*p));c[7]=b*(p*y-n*e)-h*(q*y-m*e)+k*(q*n-m*p);c[8]=h*(u*D-y*F)-k*(z*D-n*F)+K*(z*y-n*u);c[9]=-(b*(u*D-y*F)-k*(x*D-m*F)+K*(x*y-m*u));c[10]=b*(z*D-n*F)-h*(x*D-m*F)+K*(x*n-m*z);c[11]=-(b*(z*y-n*u)-h*(x*y-m*
u)+k*(x*n-m*z));c[12]=-(h*(u*J-e*F)-k*(z*J-p*F)+K*(z*e-p*u));c[13]=b*(u*J-e*F)-k*(x*J-q*F)+K*(x*e-q*u);c[14]=-(b*(z*J-p*F)-h*(x*J-q*F)+K*(x*p-q*z));c[15]=b*(z*e-p*u)-h*(x*e-q*u)+k*(x*p-q*z);return c};a.determinant=function(a){var c=a[0],b=a[1],m=a[2],q=a[3],A=a[4],h=a[5],z=a[6],p=a[7],n=a[8],k=a[9],u=a[10],e=a[11],y=a[12],K=a[13],F=a[14];a=a[15];return(c*h-b*A)*(u*a-e*F)-(c*z-m*A)*(k*a-e*K)+(c*p-q*A)*(k*F-u*K)+(b*z-m*h)*(n*a-e*y)-(b*p-q*h)*(n*F-u*y)+(m*p-q*z)*(n*K-k*y)};a.multiply=function(a,c,b){var m=
a[0],q=a[1],A=a[2],h=a[3],z=a[4],p=a[5],n=a[6],k=a[7],u=a[8],e=a[9],y=a[10],K=a[11],F=a[12],J=a[13],D=a[14];a=a[15];var R=c[0],E=c[1],I=c[2],B=c[3];b[0]=R*m+E*z+I*u+B*F;b[1]=R*q+E*p+I*e+B*J;b[2]=R*A+E*n+I*y+B*D;b[3]=R*h+E*k+I*K+B*a;R=c[4];E=c[5];I=c[6];B=c[7];b[4]=R*m+E*z+I*u+B*F;b[5]=R*q+E*p+I*e+B*J;b[6]=R*A+E*n+I*y+B*D;b[7]=R*h+E*k+I*K+B*a;R=c[8];E=c[9];I=c[10];B=c[11];b[8]=R*m+E*z+I*u+B*F;b[9]=R*q+E*p+I*e+B*J;b[10]=R*A+E*n+I*y+B*D;b[11]=R*h+E*k+I*K+B*a;R=c[12];E=c[13];I=c[14];B=c[15];b[12]=R*m+
E*z+I*u+B*F;b[13]=R*q+E*p+I*e+B*J;b[14]=R*A+E*n+I*y+B*D;b[15]=R*h+E*k+I*K+B*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var m=c[0],q=c[1];c=c[2];var A,h,z,p,n,k,u,e,y,K,F,J;a===b?(b[12]=a[0]*m+a[4]*q+a[8]*c+a[12],b[13]=a[1]*m+a[5]*q+a[9]*c+a[13],b[14]=a[2]*m+a[6]*q+a[10]*c+a[14],b[15]=a[3]*m+a[7]*q+a[11]*c+a[15]):(A=a[0],h=a[1],z=a[2],p=a[3],n=a[4],k=a[5],u=a[6],e=a[7],y=a[8],K=a[9],F=a[10],J=a[11],b[0]=A,b[1]=h,b[2]=z,b[3]=p,b[4]=n,b[5]=k,b[6]=u,b[7]=e,b[8]=y,b[9]=K,b[10]=F,b[11]=J,
b[12]=A*m+n*q+y*c+a[12],b[13]=h*m+k*q+K*c+a[13],b[14]=z*m+u*q+F*c+a[14],b[15]=p*m+e*q+J*c+a[15]);return b};a.scale=function(a,c,b){var m=c[0],q=c[1];c=c[2];b[0]=a[0]*m;b[1]=a[1]*m;b[2]=a[2]*m;b[3]=a[3]*m;b[4]=a[4]*q;b[5]=a[5]*q;b[6]=a[6]*q;b[7]=a[7]*q;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,m){var q=b[0],A=b[1];b=b[2];var h=Math.sqrt(q*q+A*A+b*b),z,p,n,k,u,e,y,K,F,J,D,R,E,I,B,P,d,f,r,g;if(1E-7>Math.abs(h))return null;
h=1/h;q*=h;A*=h;b*=h;z=Math.sin(c);p=Math.cos(c);n=1-p;c=a[0];h=a[1];k=a[2];u=a[3];e=a[4];y=a[5];K=a[6];F=a[7];J=a[8];D=a[9];R=a[10];E=a[11];I=q*q*n+p;B=A*q*n+b*z;P=b*q*n-A*z;d=q*A*n-b*z;f=A*A*n+p;r=b*A*n+q*z;g=q*b*n+A*z;q=A*b*n-q*z;A=b*b*n+p;m[0]=c*I+e*B+J*P;m[1]=h*I+y*B+D*P;m[2]=k*I+K*B+R*P;m[3]=u*I+F*B+E*P;m[4]=c*d+e*f+J*r;m[5]=h*d+y*f+D*r;m[6]=k*d+K*f+R*r;m[7]=u*d+F*f+E*r;m[8]=c*g+e*q+J*A;m[9]=h*g+y*q+D*A;m[10]=k*g+K*q+R*A;m[11]=u*g+F*q+E*A;a!==m&&(m[12]=a[12],m[13]=a[13],m[14]=a[14],m[15]=a[15]);
return m};a.rotateX=function(a,c,b){var m=Math.sin(c);c=Math.cos(c);var q=a[4],A=a[5],h=a[6],z=a[7],p=a[8],n=a[9],k=a[10],u=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=q*c+p*m;b[5]=A*c+n*m;b[6]=h*c+k*m;b[7]=z*c+u*m;b[8]=p*c-q*m;b[9]=n*c-A*m;b[10]=k*c-h*m;b[11]=u*c-z*m;return b};a.rotateY=function(a,c,b){var m=Math.sin(c);c=Math.cos(c);var q=a[0],A=a[1],h=a[2],z=a[3],p=a[8],n=a[9],k=a[10],u=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=q*c-p*m;b[1]=A*c-n*m;b[2]=h*c-k*m;b[3]=z*c-u*m;b[8]=q*m+p*c;b[9]=A*m+n*c;b[10]=h*m+k*c;b[11]=z*m+u*c;return b};a.rotateZ=function(a,c,b){var m=Math.sin(c);c=Math.cos(c);var q=a[0],A=a[1],h=a[2],z=a[3],p=a[4],n=a[5],k=a[6],u=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=q*c+p*m;b[1]=A*c+n*m;b[2]=h*c+k*m;b[3]=z*c+u*m;b[4]=p*c-q*m;b[5]=n*c-A*m;b[6]=k*c-h*m;b[7]=u*c-z*m;return b};
a.UU=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.TU=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.SU=function(a,c,b){var m=c[0],q=c[1];c=c[2];var A=Math.sqrt(m*m+q*q+c*c),h;if(1E-7>Math.abs(A))return null;A=1/A;m*=A;q*=A;c*=A;A=Math.sin(a);a=Math.cos(a);h=1-a;b[0]=m*m*h+a;b[1]=q*m*h+c*
A;b[2]=c*m*h-q*A;b[3]=0;b[4]=m*q*h-c*A;b[5]=q*q*h+a;b[6]=c*q*h+m*A;b[7]=0;b[8]=m*c*h+q*A;b[9]=q*c*h-m*A;b[10]=c*c*h+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.q4=function(a,c){var b=Math.sin(a),m=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=m;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=m;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.r4=function(a,c){var b=Math.sin(a),m=Math.cos(a);c[0]=m;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=m;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.s4=function(a,c){var b=Math.sin(a),m=Math.cos(a);c[0]=m;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=m;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var m=a[0],q=a[1],A=a[2],h=a[3],z=m+m,p=q+q,n=A+A;a=m*z;var k=m*p,m=m*n,u=q*p,q=q*n,A=A*n,z=h*z,p=h*p,h=h*n;b[0]=1-(u+A);b[1]=k+h;b[2]=m-p;b[3]=0;b[4]=k-h;b[5]=1-(a+A);b[6]=q+z;b[7]=0;b[8]=m+p;b[9]=q-z;b[10]=1-(a+u);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.o4=function(a,c,b,m){var q=a[0],A=a[1],h=a[2],z=a[3],p=q+q,n=A+A,k=h+h;a=q*p;var u=q*n,q=q*k,e=A*n,A=A*k,h=h*k,p=z*p,n=z*n,z=z*k,k=b[0],y=b[1];b=b[2];m[0]=(1-(e+h))*k;m[1]=(u+z)*k;m[2]=(q-n)*k;m[3]=0;m[4]=(u-z)*y;m[5]=(1-(a+h))*y;m[6]=(A+p)*y;m[7]=0;m[8]=(q+n)*b;m[9]=(A-p)*b;m[10]=(1-(a+e))*b;m[11]=0;m[12]=c[0];m[13]=c[1];m[14]=c[2];m[15]=1;return m};a.p4=function(a,c,b,m,q){var A=a[0],h=a[1],z=a[2],p=a[3],n=A+A,k=h+h,u=z+z;a=A*n;var e=A*k,A=A*u,y=h*k,h=h*u,z=z*u,n=p*n,k=p*k,p=
p*u,u=b[0],K=b[1];b=b[2];var F=m[0],J=m[1];m=m[2];q[0]=(1-(y+z))*u;q[1]=(e+p)*u;q[2]=(A-k)*u;q[3]=0;q[4]=(e-p)*K;q[5]=(1-(a+z))*K;q[6]=(h+n)*K;q[7]=0;q[8]=(A+k)*b;q[9]=(h-n)*b;q[10]=(1-(a+y))*b;q[11]=0;q[12]=c[0]+F-(q[0]*F+q[4]*J+q[8]*m);q[13]=c[1]+J-(q[1]*F+q[5]*J+q[9]*m);q[14]=c[2]+m-(q[2]*F+q[6]*J+q[10]*m);q[15]=1;return q};a.fromQuat=function(a,c){var b=a[0],m=a[1],q=a[2],A=a[3],h=b+b,z=m+m,p=q+q,b=b*h,n=m*h,m=m*z,k=q*h,u=q*z,q=q*p,h=A*h,z=A*z,A=A*p;c[0]=1-m-q;c[1]=n+A;c[2]=k-z;c[3]=0;c[4]=n-
A;c[5]=1-b-q;c[6]=u+h;c[7]=0;c[8]=k+z;c[9]=u-h;c[10]=1-b-m;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,m,q,A,h){var z=1/(c-a),p=1/(m-b),n=1/(q-A);h[0]=2*q*z;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*q*p;h[6]=0;h[7]=0;h[8]=(c+a)*z;h[9]=(m+b)*p;h[10]=(A+q)*n;h[11]=-1;h[12]=0;h[13]=0;h[14]=A*q*2*n;h[15]=0;return h};a.perspective=function(a,c,b,m,q){a=1/Math.tan(a/2);var A=1/(b-m);q[0]=a/c;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=a;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=(m+b)*A;q[11]=-1;q[12]=
0;q[13]=0;q[14]=2*m*b*A;q[15]=0;return q};a.y7=function(a,c,b,m){var q=Math.tan(a.upDegrees*Math.PI/180),A=Math.tan(a.downDegrees*Math.PI/180),h=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var z=2/(h+a),p=2/(q+A);m[0]=z;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=p;m[6]=0;m[7]=0;m[8]=-((h-a)*z*.5);m[9]=(q-A)*p*.5;m[10]=b/(c-b);m[11]=-1;m[12]=0;m[13]=0;m[14]=b*c/(c-b);m[15]=0;return m};a.ortho=function(a,c,b,m,q,A,h){var z=1/(a-c),p=1/(b-m),n=1/(q-A);h[0]=-2*z;h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=-2*p;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*n;h[11]=0;h[12]=(a+c)*z;h[13]=(m+b)*p;h[14]=(A+q)*n;h[15]=1;return h};a.lookAt=function(l,c,b,m){var q,A,h,z,p,n,k,u,e=l[0],y=l[1];l=l[2];h=b[0];z=b[1];A=b[2];k=c[0];b=c[1];q=c[2];if(1E-7>Math.abs(e-k)&&1E-7>Math.abs(y-b)&&1E-7>Math.abs(l-q))return a.identity(m);c=e-k;b=y-b;k=l-q;u=1/Math.sqrt(c*c+b*b+k*k);c*=u;b*=u;k*=u;q=z*k-A*b;A=A*c-h*k;h=h*b-z*c;(u=Math.sqrt(q*q+A*A+h*h))?(u=1/u,q*=u,A*=u,h*=u):h=A=q=0;z=b*h-k*A;p=k*q-c*h;n=c*A-b*q;(u=Math.sqrt(z*
z+p*p+n*n))?(u=1/u,z*=u,p*=u,n*=u):n=p=z=0;m[0]=q;m[1]=z;m[2]=c;m[3]=0;m[4]=A;m[5]=p;m[6]=b;m[7]=0;m[8]=h;m[9]=n;m[10]=k;m[11]=0;m[12]=-(q*e+A*y+h*l);m[13]=-(z*e+p*y+n*l);m[14]=-(c*e+b*y+k*l);m[15]=1;return m};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.RU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__util=function(a,m){function l(a){return 0<a?1:0>a?-1:0}function c(a,b,d){var e=a[0],c=a[1];a=a[2];var f=Math.cos(e/2),w=Math.cos(c/2),g=Math.cos(a/2),C=Math.sin(e/2),c=Math.sin(c/2),k=Math.sin(a/2);if(-1<T.indexOf(b))var v=Math.cos((e+a)/2),n=Math.sin((e+a)/2),h=Math.cos((e-a)/2),H=Math.sin((e-a)/2),u=Math.cos((a-e)/2),t=Math.sin((a-e)/2);switch(b){case qa:d[0]=w*n;d[1]=c*h;d[2]=c*H;d[3]=w*v;break;case ja:d[0]=c*H;d[1]=w*n;d[2]=c*h;d[3]=w*v;break;case va:d[0]=c*h;d[1]=c*H;d[2]=w*n;d[3]=
w*v;break;case 3:d[0]=w*n;d[1]=c*t;d[2]=c*u;d[3]=w*v;break;case ta:d[0]=c*u;d[1]=w*n;d[2]=c*t;d[3]=w*v;break;case Ea:d[0]=c*t;d[1]=c*u;d[2]=w*n;d[3]=w*v;break;case 6:d[0]=C*w*g+f*c*k;d[1]=f*c*g-C*w*k;d[2]=f*w*k+C*c*g;d[3]=f*w*g-C*c*k;break;case 7:d[0]=f*w*k+C*c*g;d[1]=C*w*g+f*c*k;d[2]=f*c*g-C*w*k;d[3]=f*w*g-C*c*k;break;case 8:d[0]=f*c*g-C*w*k;d[1]=f*w*k+C*c*g;d[2]=C*w*g+f*c*k;d[3]=f*w*g-C*c*k;break;case 9:d[0]=C*w*g-f*c*k;d[1]=f*w*k-C*c*g;d[2]=f*c*g+C*w*k;d[3]=f*w*g+C*c*k;break;case 10:d[0]=f*c*g+
C*w*k;d[1]=C*w*g-f*c*k;d[2]=f*w*k-C*c*g;d[3]=f*w*g+C*c*k;break;case 11:d[0]=f*w*k-C*c*g,d[1]=f*c*g+C*w*k,d[2]=C*w*g-f*c*k,d[3]=f*w*g+C*c*k}return d}function b(a,b,d){var e=a[0],c=a[1],f=a[2];a=a[3];switch(b){case qa:d[0]=Math.atan2(e*c+f*a,c*a-e*f);d[1]=Math.acos(1-2*(c*c+f*f));d[2]=Math.atan2(e*c-f*a,e*f+c*a);break;case ja:d[0]=Math.atan2(e*a+c*f,f*a-e*c);d[1]=Math.acos(1-2*(e*e+f*f));d[2]=Math.atan2(c*f-e*a,e*c+f*a);break;case va:d[0]=Math.atan2(e*f+c*a,e*a-c*f);d[1]=Math.acos(1-2*(e*e+c*c));d[2]=
Math.atan2(e*f-c*a,e*a+c*f);break;case 3:d[0]=Math.atan2(e*f-c*a,e*c+f*a);d[1]=Math.acos(1-2*(c*c+f*f));d[2]=Math.atan2(e*f+c*a,f*a-e*c);break;case ta:d[0]=Math.atan2(e*c-f*a,e*a+c*f);d[1]=Math.acos(1-2*(e*e+f*f));d[2]=Math.atan2(e*c+f*a,e*a-c*f);break;case Ea:d[0]=Math.atan2(c*f-e*a,e*f+c*a);d[1]=Math.acos(1-2*(e*e+c*c));d[2]=Math.atan2(e*a+c*f,c*a-e*f);break;case 6:d[0]=Math.atan2(2*(e*a-c*f),1-2*(e*e+c*c));d[1]=Math.asin(2*(e*f+c*a));d[2]=Math.atan2(2*(f*a-e*c),1-2*(c*c+f*f));break;case 7:b=e*
c+f*a;.499999<b?(d[0]=0,d[1]=Math.PI/2,d[2]=2*Math.atan2(e,a)):-.499999>b?(d[0]=0,d[1]=-Math.PI/2,d[2]=-2*Math.atan2(e,a)):(d[0]=Math.atan2(2*(c*a-e*f),1-2*(c*c+f*f)),d[1]=Math.asin(2*(e*c+f*a)),d[2]=Math.atan2(2*(e*a-c*f),1-2*(e*e+f*f)));break;case 8:d[0]=Math.atan2(2*(f*a-e*c),1-2*(e*e+f*f));d[1]=Math.asin(2*(e*a+c*f));d[2]=Math.atan2(2*(c*a-e*f),1-2*(e*e+c*c));break;case 9:d[0]=Math.atan2(2*(e*a+c*f),1-2*(e*e+f*f));d[1]=Math.asin(2*(f*a-e*c));d[2]=Math.atan2(2*(e*f+c*a),1-2*(c*c+f*f));break;case 10:d[0]=
Math.atan2(2*(e*f+c*a),1-2*(e*e+c*c));d[1]=Math.asin(2*(e*a-c*f));d[2]=Math.atan2(2*(e*c+f*a),1-2*(e*e+f*f));break;case 11:b=c*a-e*f,.499999<b?(d[0]=0,d[1]=Math.PI/2,d[2]=-2*Math.atan2(f,a)):-.499999>b?(d[0]=0,d[1]=-Math.PI/2,d[2]=2*Math.atan2(f,a)):(d[0]=Math.atan2(2*(e*c+f*a),1-2*(c*c+f*f)),d[1]=Math.asin(2*(c*a-e*f)),d[2]=Math.atan2(2*(e*a+c*f),1-2*(e*e+c*c)))}return d}function x(a,b,d){var e=b.length,c=S;c[0]=a[0];c[1]=a[1];c[2]=a[2];t.normalize(c,c);e?(a=ba,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3],b=t.cross(a,c,ma),t.normalize(b,b),t.cross(c,b,a),e=ea,e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=c[0],e[4]=c[1],e[5]=c[2],e[6]=b[0],e[7]=b[1],e[8]=b[2],Q.fromMat3(e,d),d[3]=0<d[3]?d[3]+3.1E-5:d[3]-3.1E-5,(0<d[3]&&0>a[3]||0>d[3]&&0<a[3])&&Q.scale(d,-1,d),Q.normalize(d,d)):Q.rotationTo(ha,c,d);return d}function q(a,b){b||(b=new Float32Array(4));P.fromMat4(a,ea);var d=ea[0],e=ea[3],c=ea[6],f=ea[1],w=ea[4],g=ea[7],C=ea[2],k=ea[5],v=ea[8],d=Math.sqrt(d*d+e*e+c*c)||1,f=Math.sqrt(f*f+w*w+g*g)||1,C=Math.sqrt(C*
C+k*k+v*v)||1;ea[0]/=d;ea[3]/=d;ea[6]/=d;ea[1]/=f;ea[4]/=f;ea[7]/=f;ea[2]/=C;ea[5]/=C;ea[8]/=C;Q.fromMat3(ea,b);Q.normalize(b,b);return b}function A(a){var b=a[0],d=a[1],e=a[2],c=a[3],f=Math.sqrt(b*b+d*d+e*e),f=1/f;a[0]=b*f;a[1]=d*f;a[2]=e*f;a[3]=c*f}function h(a,b){var d=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var e in a)d=h(a[e],d);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(e=
0;e<a.length;e++)d=z(a[e],d);break;case Array:for(e=0;e<a.length;e++)d=h(a[e],d);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:d=z(0,d);break;default:F("Wrong object constructor")}else d=z(0,d);return d;case "number":return z(a,d);case "boolean":return z(a|0,d);case "string":return p(a,d);case "function":case "undefined":return z(0,d)}}function z(a,b){var d=b;L[0]=a;d=(d<<5)-d+Y[0];d&=d;d=(d<<5)-d+Y[1];return d&d}function p(a,
b){for(var d=b,e=0;e<a.length;e++)d=(d<<5)-d+a.charCodeAt(e),d&=d;return d}function n(a){return(34*a+1)*a%289}function k(a){return a-Math.floor(a)}function u(a){return e((34*a+5)*a)}function e(a){return a-289*Math.floor(a/289)}function y(a){return a-7*Math.floor(a/7)}function K(a,b,d){a<b&&(a=b);a>d&&(a=d);return a}function F(a){a&&r.error.apply(r,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function J(a,b,d){a-=b;d-=b;return b+(a-Math.floor(a/d)*d)}function D(a){return J(a,0,2*Math.PI)}function R(a,b){if(a&&b){var d=a instanceof Array;if(d!=b instanceof Array)return!1;var e=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(e!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(d){if(a.length!=b.length)return!1;for(d=0;d<a.length;d++)if(!E(a[d],b[d]))return!1}else if(e){if(a.length!=b.length)return!1;for(d=0;d<a.length;d++)if(a[d]!=b[d])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var c in a)if(!E(a[c],b[c]))return!1;for(c in b)if(!(c in a))return!1}return!0}return!(a||b)}function E(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return R(a,b);default:return!0}}function I(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var d=[],e=0;e<a.length;e++){var c=a[e];""!=c&&"."!=c&&(".."!=c||!b&&!d.length||d.length&&".."==d[d.length-1]?
d.push(c):d.length&&d.pop())}a=d.join("/");for(e=0;e<b;e++)a="/"+a;return a||"."}function B(){var a=[{}];a.length=0;return a}var P=m("__mat3"),d=m("__mat4"),f=m("__math"),r=m("__print"),g=m("__tsr"),Q=m("__quat"),t=m("__vec3"),aa=m("__vec4"),M=0,G={},T=[qa,ja,va,ta,Ea],S=new Float32Array(3),X=new Float32Array(3),H=new Float32Array(3),ma=new Float32Array(3),W=new Float32Array(3),O=new Float32Array(3),V=new Float32Array(3),ga=new Float32Array(3),v=new Float32Array(4),ba=new Float32Array(4),ea=new Float32Array(9),
ca=new Float32Array(16),na=new Float32Array(16),pa=Q.create(),L=new Float64Array(1),Y=new Uint32Array(L.buffer),xa=new Float32Array([0,0,0]),ya=new Float32Array([0,0,0,1]),oa=new Float32Array([0,0,0,1,0,0,0,1]),Z=new Float32Array([1,1,1]),fa=new Float32Array([1,0,0]),ha=new Float32Array([0,1,0]),N=new Float32Array([0,0,1]),ka=new Float32Array([-1,0,0]),C=new Float32Array([0,-1,0]),ia=new Float32Array([0,0,-1]),qa=0,ja=1,va=2,ta=4,Ea=5,Ca=Math.floor(44488.07041494893),Ba=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.rF=xa;a.jn=ya;a.c2=oa;a.hz=Z;a.ri=fa;a.zj=ha;a.Oc=N;a.Sx=ka;a.el=C;a.ad=ia;a.sF=qa;a.zF=ja;a.AF=va;a.uF=3;a.wF=ta;a.CF=Ea;a.tF=6;a.yF=7;a.iz=8;a.vF=9;a.xF=10;a.BF=11;a.AO=Ba;a.Tx=1;a.Hp=2;a.Aj=4;a.KE=4;
a.Sh=function(a){return"undefined"!=typeof a};a.nK=function(a,b,d){for(var e=[],c=d.length,f=0;f<c;f++){var w=d[f];w[a]==b&&e.push(w)}return e};a.Cf=function(a){return new Float32Array(a)};a.LU=function(a,b){var d=a.length,e=new Float32Array(d+b.length);e.set(a);e.set(b,d);return e};a.n_=function(a,b){var d=a.length,e=new Uint32Array(d+b.length);e.set(a);e.set(b,d);return e};a.nS=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.lR=function(a,b){var d=
[],e={},c=b.length,f,w;for(f=0;f<c;f++)e[b[f]]=!0;c=a.length;for(f=0;f<c;f++)w=a[f],w in e&&d.push(w);return d};a.sign=l;a.W6=function(a,b,d){for(var e=d.length,c=0;c<e;c++)if(d[c][a]==b)return!0;return!1};a.Dd=function(a,b,d){for(var e=0;e<d.length;e++){var c=d[e];if(c[a]===b)return c}return null};a.U6=function(a,b,d,e,c){for(var f=0;f<c.length;f++){var w=c[f];if(w[a]==b&&w[d]==e)return w}return null};a.FV=function(a,b){for(var d=0;d<a.length;d++)if(a[d].uuid==b)return d;return-1};a.eR=function(a,
b){for(var d=0;d<a.length;d++)if(a[d]==b)return;a.push(b)};a.g3=function(a){for(var b=0;b<a.length-1;b++)for(var d=a[b],e=b+1;e<a.length;e++)if(d==a[e])return!1;return!0};a.g_=function(a,b,e,c){c||(c=new Float32Array(16));d.identity(c);c[12]=a;c[13]=b;c[14]=e};var la=1;a.aY=function(){la=(69069*la+5)%Math.pow(2,32);return Math.round(la/65536)%32768/32767};a.OZ=function(a){la=a};a.qg=function(a){var b=a[0]%Ca*48271-3399*Math.floor(a[0]/Ca);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.wv=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.Wj=function(a,b){var d=S;d[0]=a[2];d[1]=a[1];d[2]=a[0];c(d,11,b);return b};a.pC=c;a.rL=b;a.sU=function(a){var b=P.create(),d=Math.cos(a[0]),e=Math.cos(a[1]),c=Math.cos(a[2]),f=Math.sin(a[0]),w=Math.sin(a[1]);a=Math.sin(a[2]);var g=d*c,C=d*a,k=f*c,v=f*a;b[0]=e*c;b[1]=e*a;b[2]=-w;b[3]=w*k-C;b[4]=w*v+g;b[5]=e*f;b[6]=w*g+v;b[7]=w*C-k;b[8]=e*d;return b};a.yw=function(a,d){var e=b(a,11,S);d[0]=e[2];d[1]=e[1];d[2]=e[0];return d};a.pc=function(a,b,d){d||(d=
new Float32Array(3));t.transformQuat(b,a,d);return d};a.DA=function(a,b,d){d||(d=new Float32Array(4));a=t.normalize(a,S);var e=t.dot(b,a);a=t.cross(b,a,H);e=Math.acos(e);d[0]=a[0]*Math.sin(e/2);d[1]=a[1]*Math.sin(e/2);d[2]=a[2]*Math.sin(e/2);d[3]=Math.cos(e/2);return d};a.h_=function(a,b,d,e){e||(e=new Float32Array(4));t.transformQuat(d,b,e);e[3]=-t.dot(a,e)};a.bU=function(a){var b=g.N(a.k.n),d=S;switch(a.type){case "CAMERA":d[0]=0;d[1]=-1;d[2]=0;t.transformQuat(d,b,d);H[0]=0;H[1]=0;H[2]=-1;break;
case "MESH":d[0]=0;d[1]=0;d[2]=1;t.transformQuat(d,b,d);H[0]=0;H[1]=0;H[2]=1;break;case "EMPTY":d[0]=0,d[1]=1,d[2]=0,t.transformQuat(d,b,d),H[0]=0,H[1]=1,H[2]=0}d[1]=0;t.normalize(d,d);a=t.dot(d,H);return Math.acos(a)*(0<-d[0]*H[2]?-1:1)};a.rG=function(a,b,d,e){if(0!=d){e=e||[];for(var c=0;c<a.length;c++)e[c]=(1-d)*a[c]+d*b[c]}};a.p_=function(){M++;return M.toString(10)};a.Js=function(a){G[a]||(G[a]=0);var b=a+G[a];G[a]++;return b};a.Kg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.fr=function(a,b,d){b=b||B();var e=b.length,c=a.length/3;d=d||new Float32Array(4*c);for(var f=0;f<c;++f){var w=S;w[0]=a[3*f];w[1]=a[3*f+1];w[2]=a[3*f+2];var g;e?(g=ba,g[0]=b[4*f],g[1]=b[4*f+1],g[2]=b[4*f+2],g[3]=b[4*f+3]):g=b;x(w,g,d.subarray(4*f,4*(f+1)))}return d};a.uJ=x;a.Eh=function(a){return JSON.parse(JSON.stringify(a))};a.R=function(b){if(!(b instanceof Object))return b;var d;d=b.constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:d=
new d(b);break;case Array:d=new d(b.length);for(var e=0;e<b.length;e++)d[e]=a.R(b[e]);break;default:for(e in d=new d,b)d[e]=a.R(b[e])}return d};a.sq=function(a){var b=a instanceof Array?[]:{},d;for(d in a)if(a[d]instanceof Object){var e=a[d].constructor;switch(e){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[d]=new e(a[d]);break;case Array:b[d]=a[d].slice(0);break;default:b[d]=a[d]}}else b[d]=a[d];return b};a.UB=
q;a.CK=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.BK=function(a){v[0]=.577350269189626;v[1]=.577350269189626;v[2]=.577350269189626;v[3]=0;aa.transformMat4(v,a,v);return aa.length(v)};a.In=function(a,b){var d=b.left,e=b.right,c=b.top,f=b.bottom,w=b.near,g=b.far;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];e[0]=a[3]-a[0];e[1]=a[7]-a[4];e[2]=a[11]-a[8];e[3]=a[15]-a[12];c[0]=a[3]-a[1];c[1]=a[7]-a[5];c[2]=a[11]-a[9];c[3]=a[15]-a[13];f[0]=a[3]+
a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];w[0]=a[3]+a[2];w[1]=a[7]+a[6];w[2]=a[11]+a[10];w[3]=a[15]+a[14];g[0]=a[3]-a[2];g[1]=a[7]-a[6];g[2]=a[11]-a[10];g[3]=a[15]-a[14];A(d);A(e);A(c);A(f);A(w);A(g)};a.JZ=function(a,b,d){return d<-f.pg(a,b.near)||d<-f.pg(a,b.left)||d<-f.pg(a,b.right)||d<-f.pg(a,b.top)||d<-f.pg(a,b.bottom)||d<-f.pg(a,b.far)?!0:!1};a.mU=function(a,b,d,e,c){var g=t.dot(d,b.far),w=t.dot(e,b.far),C=t.dot(c,b.far),g=Math.sqrt(g*g+w*w+C*C);if(g<-f.pg(a,b.near)||g<-f.pg(a,b.far))return!0;
g=t.dot(d,b.left);w=t.dot(e,b.left);C=t.dot(c,b.left);if(Math.sqrt(g*g+w*w+C*C)<-f.pg(a,b.left))return!0;g=t.dot(d,b.right);w=t.dot(e,b.right);C=t.dot(c,b.right);if(Math.sqrt(g*g+w*w+C*C)<-f.pg(a,b.right))return!0;g=t.dot(d,b.top);w=t.dot(e,b.top);C=t.dot(c,b.top);if(Math.sqrt(g*g+w*w+C*C)<-f.pg(a,b.top))return!0;g=t.dot(d,b.bottom);w=t.dot(e,b.bottom);C=t.dot(c,b.bottom);return Math.sqrt(g*g+w*w+C*C)<-f.pg(a,b.bottom)?!0:!1};a.wo=function(a,b,d,e){e||(e=0);for(var c=a.length,f=0;f<c;f+=3){var w=
a[f],g=a[f+1],C=a[f+2];d[e+f]=b[0]*w+b[4]*g+b[8]*C+b[12];d[e+f+1]=b[1]*w+b[5]*g+b[9]*C+b[13];d[e+f+2]=b[2]*w+b[6]*g+b[10]*C+b[14]}};a.Q9=function(a,b,d,e){e||(e=0);for(var c=a.length,f=0;f<c;f+=3){var w=a[f],g=a[f+1],C=a[f+2];d[e+f]=b[0]*w+b[4]*g+b[8]*C;d[e+f+1]=b[1]*w+b[5]*g+b[9]*C;d[e+f+2]=b[2]*w+b[6]*g+b[10]*C}return d};a.sL=function(a,b,d,e){e=e||0;for(var c=a.length,f=0;f<c;f+=4){pa[0]=a[f];pa[1]=a[f+1];pa[2]=a[f+2];pa[3]=a[f+3];var w=0<pa[3];Q.multiply(b,pa,pa);(w&&0>pa[3]||!w&&0<pa[3])&&aa.scale(pa,
-1,pa);d[e+f]=pa[0];d[e+f+1]=pa[1];d[e+f+2]=pa[2];d[e+f+3]=pa[3]}};a.j0=function(a,b,d){d||(d=new Float32Array(3));v[0]=a[0];v[1]=a[1];v[2]=a[2];v[3]=0;aa.transformMat4(v,b,v);d[0]=v[0];d[1]=v[1];d[2]=v[2]};a.n4=function(a,b){var d=a.length;d||F("flatten(): Wrong or empty array");var e=a[0].length;e||F("flatten(): Wrong or empty subarray");b||(b=new Float32Array(d*e));for(var c=0;c<d;c++)for(var f=0;f<e;f++)b[c*e+f]=a[c][f];return b};a.k0=function(a){for(var b=[],d=0;d<a.length;d+=3){var e=new Float32Array([a[d],
a[d+1],a[d+2]]);b[d/3]=e}return b};a.Xt=function(b,d,e,c){if(c<e)return e;var f=e+Math.floor((c-e)/2);return b[f]>d?a.Xt(b,d,e,f-1):b[f]<d?a.Xt(b,d,f+1,c):f};a.Nj=function(a,b){for(var d=0;d<a.length;d++)if(a[d]!=b[d])return!1;return!0};a.p3=function(a,b,d){for(var e=0;e<a.length;e++)if(Math.abs(a[e]-b[e])>d)return!1;return!0};a.Z7=function(a,b,d){d||(d=new Float32Array(16));for(var e=0;12>e;e++)d[e]=a[e]*b;d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.j_=function(a,b,e,c,f){f||(f=new Float32Array(16));
b=d.fromRotationTranslation(e,c,ca);d.multiply(b,a,f);return f};a.Hc=function(a,b,e,c,f){f||(f=new Float32Array(3));e=d.fromRotationTranslation(e,c,ca);1!==b&&(c=d.identity(na),b=t.set(b,b,b,S),d.scale(c,b,c),d.multiply(e,c,e));t.transformMat4(a,e,f);return f};a.D9=function(a,b,e,c,f){f||(f=new Float32Array(4));b=d.fromRotationTranslation(e,c,ca);aa.transformMat4(a,b,f);return f};a.K6=function(a,b,e,c,f){f||(f=new Float32Array(3));b=d.fromRotationTranslation(e,c,ca);d.invert(b,b);t.transformMat4(a,
b,f);return f};a.C9=function(a,b,e){e||(e=new Float32Array(16));d.fromRotationTranslation(b,a,e);a=a[3];for(b=0;12>b;b++)e[b]*=a;return e};a.i7=function(b,d,e){a.CK(b,d);d[3]=a.BK(b);q(b,e)};a.A2=function(a){for(var b=[],d=0;d<a.length;d++)b.push(a[d]);return JSON.stringify(b)};a.vY=function(a,b,d,e){e||(e=new Float32Array(3));var c=S;t.subtract(b,a,c);t.transformQuat(c,d,c);t.subtract(b,c,e)};a.$U=function(){var a=S;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),
f=new Float32Array(16),g=new Float32Array(16),w=new Float32Array(16);d.lookAt(a,[-1,0,0],[0,-1,0],b);d.scale(b,[-1,1,1],b);d.scale(b,[-1,1,-1],e);d.lookAt(a,[0,-1,0],[0,0,-1],c);d.scale(c,[1,1,-1],c);d.scale(c,[1,-1,-1],f);d.lookAt(a,[0,0,-1],[0,-1,0],g);d.scale(g,[-1,1,1],g);d.scale(g,[-1,1,-1],w);return[b,e,c,f,g,w]};a.dV=function(){var a=S;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16),w=new Float32Array(16);
d.lookAt(a,[1,0,0],[0,-1,0],b);d.scale(b,[-1,1,-1],e);d.lookAt(a,[0,1,0],[0,0,1],c);d.scale(c,[1,-1,-1],f);d.lookAt(a,[0,0,1],[0,-1,0],g);d.scale(g,[-1,1,-1],w);return[b,e,c,f,g,w]};a.WR=function(a){return h(a,0)};a.MJ=h;a.u6=p;a.jX=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.qL=function(a,b){b||(b=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(b[3]=2*Math.acos(a[3]),d=1/Math.sqrt(d),
b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Cb=function(a){return a*Math.PI/180};a.ne=function(a){return 180*a/Math.PI};a.zD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],d=Math.floor(a[0]+b),e=Math.floor(a[1]+b),c=.211324865405187*d+.211324865405187*e,b=a[0]-d+c;a=a[1]-e+c;var f=b>a?1:0,w=1-f,c=b+.211324865405187-f,g=a+.211324865405187-w,C=b+-.577350269189626,v=a+-.577350269189626,
d=d%289,e=e%289,h=n(n(e)+d),w=n(n(e+w)+d+f),H=n(n(e+1)+d+1),d=Math.max(.5-(b*b+a*a),0),e=Math.max(.5-(c*c+g*g),0),f=Math.max(.5-(C*C+v*v),0),u=2*k(.024390243902439*h)-1,t=2*k(.024390243902439*w)-1,l=2*k(.024390243902439*H)-1,h=Math.abs(u)-.5,w=Math.abs(t)-.5,H=Math.abs(l)-.5,u=u-Math.floor(u+.5),t=t-Math.floor(t+.5),l=l-Math.floor(l+.5),d=d*d*d*d*(1.79284291400159-.85373472095314*(u*u+h*h)),e=e*e*e*e*(1.79284291400159-.85373472095314*(t*t+w*w)),f=f*f*f*f*(1.79284291400159-.85373472095314*(l*l+H*H));
return 130*(d*(u*b+h*a)+e*(t*c+w*g)+f*(l*C+H*v))};a.GG=function(a){var b=1/7,d=b/2,c=e(Math.floor(a[0])),f=e(Math.floor(a[1])),g=k(a[0]);a=k(a[1]);var w=g-.5,C=g-1.5,g=a-.5;a-=1.5;var v=u(c),n=u(c+1),h=v,c=n,v=u(v+f),n=u(n+f),h=u(h+f+1),c=u(c+f+1),f=w+.7*(y(v)*b+d),H=C+.7*(y(n)*b+d),w=w+.7*(y(h)*b+d),C=C+.7*(y(c)*b+d),v=g+.7*(y(Math.floor(v*b))*b+d),g=g+.7*(y(Math.floor(n*b))*b+d),h=a+.7*(y(Math.floor(h*b))*b+d),b=a+.7*(y(Math.floor(c*b))*b+d);return Math.min(f*f+v*v,H*H+g*g,w*w+h*h,C*C+b*b)};a.JC=
function(a,b,d,e,c){c||(c=new Float32Array(4));a=t.transformQuat(b,a,S);b=d[0];var f=d[1];d=d[2];var w=ea;w[0]=f*f+d*d;w[1]=-f*b;w[2]=-d*b;w[3]=-b*f;w[4]=b*b+d*d;w[5]=-d*f;w[6]=-b*d;w[7]=-f*d;w[8]=b*b+f*f;t.transformMat3(a,w,a);t.normalize(a,a);Q.rotationTo(e,a,c);return c};a.Lz=function(a,b){b||(b=new Float32Array(4));var d=v,e=ba,d=Q.setAxisAngle([0,0,1],Math.PI,Q.create()),e=Q.setAxisAngle([1,0,0],Math.PI/2,Q.create());Q.multiply(d,e,d);Q.multiply(a,d,b);return b};a.ua=function(){M=0;G={}};a.W=
K;a.mc=function(a,b,d,e){d=Math.exp(-d/e);return(1-d)*a+d*b};a.ex=function(a,b,d,e,c){c||(c=new Float32Array(a.length));d=Math.exp(-d/e);for(e=0;e<c.length;e++)c[e]=(1-d)*a[e]+d*b[e];return c};a.MM=function(a,b,d,e,c){c||(c=new Float32Array(a.length));Q.slerp(a,b,Math.exp(-d/e),c)};a.CB=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.ik=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};
a.dA=function(a,b){var d=P.fromQuat(a,ea),e=S;e[0]=d[6];e[1]=d[7];e[2]=d[8];e=t.cross(N,e,e);t.normalize(e,e);var c=d[4];!b&&0<c&&(e[0]*=-1,e[1]*=-1,e[2]*=-1);H[0]=d[0];H[1]=d[1];H[2]=d[2];t.normalize(H,H);d=ba;Q.rotationTo(H,e,d);Q.multiply(d,a,a)};a.AI=function(a,b,d,e){d=d*b-.5;var c=e*b-.5;e=d-Math.floor(d);var f=c-Math.floor(c);d=Math.floor(d);var c=Math.floor(c),w=b-1,g=a[c*b+d],C=a[c*b+Math.min(d+1,w)],k=a[Math.min(c+1,w)*b+d];a=a[Math.min(c+1,w)*b+Math.min(d+1,w)];return(g*(1-e)+C*e)*(1-f)+
(k*(1-e)+a*e)*f};a.Gm=function(a){for(var b=0,d=0;3>d;d++)0<(a&1<<d)&&b++;return b};a.EL=function(a){for(var b=[0,0,0],d=0;3>d;d++)0<(a&1<<d)&&(b[2-d]=1);return b};a.Bo=function(a,b){var d=0;(1==b||2==b)&&0<(a&4)&&d++;2==b&&0<(a&2)&&d++;return d};a.UA=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.ir=function(a){var b=0,d;for(d in a)a.hasOwnProperty(d)&&b++;return b};a.tL=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.PJ=function(a,b,d){d||(d=new Float32Array(3));d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=0;t.normalize(d,d)};a.i_=function(a,b,d){var e=a[0],c=a[1];a=a[2];var f=b[0],w=b[1],g=b[2];b=b[3];var C=w*a-g*c,k=g*e-f*a,v=f*c-w*e,n=w*v-g*k,g=g*C-f*v,f=f*k-w*C;d[0]=e+2*C*b+2*n;d[1]=c+2*k*b+2*g;d[2]=a+2*v*b+2*f};a.assert=function(a){a||F("Assertion failed")};a.q=F;a.Dg=J;a.yi=D;a.cB=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.RZ=function(a,b){for(var d in a){var e=
!0,c=a[d],f=b[d];switch(typeof c){case "number":case "string":case "boolean":e=c==f;break;case "object":e=R(c,f)}if(!e)return!1}return!0};a.IC=function(a,b){var d=a[0],e=a[2],c=a[3];b[0]=a[1];b[1]=e;b[2]=c;b[3]=d};a.oI=function(a){a+=1;132651<a&&r.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var d=Math.floor(a/51);return new Float32Array([b/51,d/51,a%51/51])};a.PB=function(a,b,d,e){v.set(a);v[3]=b;a=ba;S[0]=d[3];S[1]=d[4];S[2]=d[5];a.set(S);a[3]=0;a=aa.dot(v,a);if(0==a)return null;
b=ba;t.copy(d,S);b.set(S);b[3]=1;a=-aa.dot(v,b)/a;e[0]=d[0]+a*d[3];e[1]=d[1]+a*d[4];e[2]=d[2]+a*d[5];return e};a.LV=function(a,b,d,e){var c=b[0]-a[0],f=d[0]-a[0],w=b[1]-a[1],g=d[1]-a[1];b=b[2]-a[2];a=d[2]-a[2];e[0]=w*a-b*g;e[1]=f*b-c*a;e[2]=c*g-w*f;return e};a.s3=function(a,b){for(var d=0;d<a.length;d++)b[d]=a[d];return b};a.aD=function(a,b,d){var e=S,c=t.dot(a,b);-.9999999>c?(t.cross(fa,a,e),1E-6>t.length(e)&&t.cross(ha,a,e),t.normalize(e,e),Q.setAxisAngle(e,Math.PI,d)):(t.cross(a,b,e),d.set(e),
d[3]=1+c,Q.normalize(d,d));return d};a.zl=function(a,b,d){if(b==d)return d-a;a=D(a);b=D(b);d=D(d);b=2*Math.PI-b;d=D(d+b);a=D(a+b);return a>d?(d-=a,a=2*Math.PI-a,-d>a?a:d):0};a.Lm=function(a,b,d){isFinite(b)&&isFinite(d)&&(a=K(a,b,d));return a*a*(3-2*a)};a.lerp=function(a,b,d){return b+a*(d-b)};a.mR=function(a,b){for(var d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(b[e]==a[d])return!0;return!1};a.C3=function(a){for(var b=Array(a),d=0;d<a;d++)b[d]=0;return b};a.$N=function(a,b){for(var d=Math.max(a.length,
b.length),e=0;e<d;e++){var c=l((e>=a.length?0:a[e])-(e>=b.length?0:b[e]));if(c)return c}return 0};a.$k=function(a){return a.join(".")};a.WM=function(a){return a.split(".").map(function(a){return a|0})};a.h9=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.Y6=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.hj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=I(b[1]),b.join("://")):I(a)};
a.mq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.lU=function(a,b,d,e){e[0]=a[0];e[1]=b[0];e[2]=d[0];e[3]=a[1];e[4]=b[1];e[5]=d[1];e[6]=a[2];e[7]=b[2];e[8]=d[2];return e};a.Sj=B;a.Wq=function(a){a=Math.round(32767.5*(a+1)-32768);return K(a?a:0,-32768,32767)};a.Z8=function(a){return K((a+32768)/32767.5-1,-1,1)};a.m_=function(a){return K(Math.round(255*a),0,255)};a.G9=function(a){return K(a/255,0,1)};a.eU=function(a,b,d,e){var c=t.subtract(d,b,S),f=t.subtract(e,d,X),w=t.subtract(b,e,
H);b=t.subtract(a,b,ma);d=t.subtract(a,d,W);a=t.subtract(a,e,O);e=t.cross(c,f,V);if(0<=t.dot(t.cross(e,c,ga),b)&&0<=t.dot(t.cross(e,f,ga),d)&&0<=t.dot(t.cross(e,w,ga),a))return w=t.length(e),f=t.dot(e,b),Math.abs(f/w);c=t.scale(c,K(t.dot(c,b)/t.length(c),0,1),ga);b=t.length(t.subtract(b,c,ga));f=t.scale(f,K(t.dot(f,d)/t.length(f),0,1),ga);f=t.length(t.subtract(d,f,ga));w=t.scale(w,K(t.dot(w,a)/t.length(w),0,1),ga);w=t.length(t.subtract(a,w,ga));return Math.min(Math.min(b,f),w)}};b4w.module.__math=function(a,m){function l(a,b){for(var c=a[1],k=1,n=2;n<a.length;n++)4!=n&&8!=n&&Math.abs(a[n])>Math.abs(c)&&(c=a[n],k=n);for(var h=Math.floor(k/3),k=k%3,c=.5*Math.atan(2*c/(a[3*h+h]-a[3*k+k])),n=0;n<b.length;n++)b[n]=0==n||4==n||8==n?1:0;b[k+3*h]=-Math.sin(c);b[h+3*k]=Math.sin(c);b[h+3*h]=Math.cos(c);b[k+3*k]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var k=(b+1>>1)-1,n=a.content[k];if(a.Hm(c)<a.Hm(n))a.content[k]=
c,a.content[b]=n,b=k;else break}}function x(a,b){for(var c=a.content.length,k=a.content[b],n=a.Hm(k);;){var h=b+1<<1,l=h-1,p=null;if(l<c){var q=a.Hm(a.content[l]);q<n&&(p=l)}h<c&&a.Hm(a.content[h])<(null===p?n:q)&&(p=h);if(null!==p)a.content[b]=a.content[p],a.content[p]=k,b=p;else break}}var q=m("__mat3"),A=m("__vec3"),h=new Float32Array(3),z=new Float32Array(9),p=new Float32Array(9),n=new Float32Array(9),k=new Float32Array(9);a.C5=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.D5=function(a,b){b=b||new Float32Array(3);return A.copy(a,b)};a.jM=function(a,b){A.copy(b,a)};a.kD=function(a,b){A.normalize(b,h);a[3]=h[0];a[4]=h[1];a[5]=h[2]};a.K2=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b};a.XR=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return A.scale(b,3/a.length,b)};a.QR=function(a,b,c){for(var k=0;k<c.length;k++)c[k]=0;for(k=0;k<a.length;k+=3){var n=a[k]-b[0],
h=a[k+1]-b[1],l=a[k+2]-b[2];c[0]+=n*n;c[1]+=n*h;c[2]+=n*l;c[4]+=h*h;c[5]+=h*l;c[8]+=l*l}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(k=0;k<c.length;k++)c[k]*=3/a.length;return c};a.HU=function(a,b){var h=q.copy(a,z);if(5E-4>c(h))return q.identity(b);var m=l(h,p),F=q.transpose(m,n);q.multiply(h,F,k);q.multiply(m,k,h);for(var x=q.copy(m,b),D=1;5E-4<=c(h)&&100>D;)m=l(h,p),F=q.transpose(m,n),q.multiply(h,F,k),q.multiply(m,k,h),q.multiply(m,x,x),D++;return x};a.pg=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.BR=function(a){return{content:[],Hm:a}};a.pG=function(a,e){a.content.push(e);b(a,a.content.length-1)};a.CR=function(a){var b=a.content[0],c=a.content.pop();0<a.content.length&&(a.content[0]=c,x(a,0));return b};a.J2=function(a,e){var c=a.content.indexOf(e),k=a.content.pop();c!==a.content.length-1&&(a.content[c]=k,a.Hm(k)<a.Hm(e)?b(c):x(c))};a.DR=function(a,e){b(a,a.content.indexOf(e))}};b4w.module.__print=function(a){function m(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var k=1;k<a.length;k++)c.push(a[k]);return c}function l(){q++;var a=m(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in h||(h[a]=a,l([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var x=!1,q=0,A=0,h={};a.iZ=function(a){x=a};a.ae=function(){console.log.apply(console,arguments)};a.log=function(){if(x){var a=m(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=l;a.O=c;a.Rb=b;a.Kh=function(a,h){switch(1<h.length){case !0:c(a+"() is deprecated, use "+h.slice(0,-1).join("(), ")+"() or "+h[h.length-1]+"() instead.");break;case !1:b(a,h[0])}};a.rU=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){A++;var a=m(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=m(arguments,"B4W INFO");console.info.apply(console,a)};a.uU=function(){q++;
var a=m(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.vU=function(){A++;var a=m(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){x&&console.time.apply(console,arguments)};a.timeEnd=function(){x&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.RV=function(){return A};a.tV=function(){return q};a.YG=function(){q=A=0}};b4w.module.print=b4w.module.__print;b4w.module.__config=function(a,m){function l(){return b4w.module_check(a.De.au)}function c(){for(var c=a.De,l=null,h=document.getElementsByTagName("script"),m=0;m<h.length;m++){for(var p=h[m].src,n=0;n<c.iK.length;n++)if(0<=p.indexOf(c.iK[n])){l=p;break}if(null!==l)break}l||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),l=document.location.href);c=l.indexOf("?");0<=c&&(l=l.substring(0,c));return l.substring(0,l.lastIndexOf("/"))}var b=m("__print"),
x=m("__util");a.Gp=1;a.hl=2;a.hn=3;a.jF=4;a.Fp=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.hH=x.R(a.context);a.B={alpha_sort:!0,alpha_sort_threshold:.1,rm:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,gI:1,NU:5,background_color:[0,0,0,0],canvas_resolution_factor:1,bp:3,allow_cors:!1,fI:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,G3:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,hO:!1,Xq:!0,lw:!0,jd:!0,water_dynamic:!0,Hk:!0,Ww:!0,MN:!0,precision:"highp",quality:a.hl,Nt:!0,yX:!1,sD:!1,EA:!1,aO:!1,is_mobile_device:!1,xB:!1,Uz:!1,d9:!1,rs:!1,allow_hidpi:!1,CM:!1,bC:!1,enable_selectable:!0,enable_outlining:!0,Ui:!0,Sn:!1,dI:!1,RB:[0,0],Tq:!1,oL:!0,Yw:!1,url_params:null,gc:!0,Fc:4,zq:!1,HL:!1,IL:!1,XC:!1,TG:!1,TJ:!1,media_auto_activation:!0,DK:4,Pv:!1,gl_debug:!1,NG:!1,NF:!1,nz:!1,Aq:"dds",Y8:"16x",srgb_type:"SRGB_SIMPLE",oz:!1};a.NH=x.R(a.B);
a.ql={Lu:-1,jI:!1,Ul:1};a.controls={tX:1/120};a.Pd={path:"",IX:"B4W_ASSETS_PATH=deploy/assets/",ZX:"B4W_PROJ_ASSETS_PATH=deploy/assets/",nX:15,prevent_caching:!0,aC:!1,yA:!1,ww:!1};a.aG=x.R(a.Pd);a.De={shaders_path:"",rZ:"../shaders/",AM:"include/",X8:"postprocessing/",au:"built_in_data",iK:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js terraform.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.$V={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Vi:.064,Ij:.035,Ck:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],an:.11,bk:.062,Jj:.004}};a.C={enabled:!0,max_fps:60,Ms:"",a0:"B4W_URANIUM_PATH=uranium.js",Iz:!1,ping:!1,Vs:!0};a.bL=x.R(a.C);a.Do={rr:1024,qu:256,EH:32,TT:128,ST:256,dL:.25,QX:.5,PX:1};a.LL=x.R(a.Do);a.X={tE:!0,Wv:!1,eG:!1,UG:!1,SH:!1};a.yM=x.R(a.X);a.Wc={outlining_overview_mode:!1,ij:[1,.4,.05],qk:.2,rk:3.8,tk:1};
a.Lq={enabled:!1,WZ:0,VZ:0,uZ:"COLOR"};a.LH=x.R(a.Lq);a.Fi={mX:8,Rv:64,YB:8,Sv:8,ZB:15,EK:0,Mr:128,$i:1024,VB:4096,Ec:4096,$B:[4096,4096]};a.gH=x.R(a.Fi);a.qn=function(){var b=a.B,c=a.C,h=a.Do;switch(b.quality){case a.hn:b.shadows=!0;b.Hk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Xq=!0;b.lw=!0;b.jd=!0;h.rr=2048;h.qu=512;b.bp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Ww=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ui=!0;b.Fc=16;b.srgb_type="SRGB_PROPER";c.max_fps=120;break;case a.hl:b.shadows=!0;b.Hk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Xq=!0;b.lw=!0;b.jd=!0;h.rr=1024;h.qu=256;b.bp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Ww=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Ui=!0;b.srgb_type="SRGB_SIMPLE";
b.Fc=4;c.max_fps=60;break;case a.Gp:b.shadows=!1;b.Hk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Xq=!1;b.lw=!1;b.jd=!1;h.rr=512;h.qu=256;b.bp=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.Ww=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Ui=!1;b.srgb_type="SRGB_SIMPLE";b.Fc=1;c.max_fps=60;break;case a.Fp:x.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(c,l){switch(c){case "allow_cors":a.B.allow_cors=l;break;case "allow_hidpi":a.B.allow_hidpi=l;break;case "alpha":a.context.alpha=l;break;case "alpha_sort":a.B.alpha_sort=l;break;case "alpha_sort_threshold":a.B.alpha_sort_threshold=l;break;case "anaglyph_use":b.rU();a.B.stereo=l?"ANAGLYPH":a.B.stereo;break;case "animation_framerate":a.ql.Lu=l;break;case "anisotropic_filtering":a.B.anisotropic_filtering=l;break;case "antialiasing":a.B.antialiasing=l;break;case "assets_dir":case "assets_path":a.Pd.path=
l;break;case "assets_dds_available":a.Pd.yA=l;break;case "assets_pvr_available":a.Pd.ww=l;break;case "assets_min50_available":a.Pd.aC=l;break;case "audio":a.X.tE=l;break;case "background_color":a.B.background_color=l;break;case "bloom":a.B.bloom=l;break;case "built_in_module_name":a.De.au=l;break;case "canvas_resolution_factor":a.B.canvas_resolution_factor=l;break;case "console_verbose":a.B.console_verbose=l;break;case "compositing":a.B.compositing=l;break;case "dof":a.B.dof=l;break;case "do_not_load_resources":a.B.do_not_load_resources=
l;break;case "god_rays":a.B.god_rays=l;break;case "stereo":a.B.stereo=l;break;case "max_fps":a.B.max_fps=l;break;case "max_fps_physics":a.C.max_fps=l;break;case "media_auto_activation":a.B.media_auto_activation=l;break;case "motion_blur":a.B.motion_blur=l;break;case "physics_enabled":a.C.enabled=l;break;case "physics_uranium_path":a.C.Ms=l;break;case "physics_calc_fps":a.C.Iz=l;break;case "physics_use_workers":a.C.Vs=l;break;case "precision":a.B.precision=l;break;case "prevent_caching":a.Pd.prevent_caching=
l;break;case "quality":a.B.quality=l;break;case "reflections":a.B.reflections=l;break;case "refractions":a.B.refractions=l;break;case "sfx_mix_mode":a.X.Wv=l;break;case "shaders_dir":case "shaders_path":a.De.shaders_path=l;break;case "shadows":a.B.shadows=l;break;case "show_hud_debug_info":a.B.show_hud_debug_info=l;break;case "smaa":a.B.smaa=l;break;case "smaa_search_texture_path":a.De.smaa_search_texture_path=l;break;case "smaa_area_texture_path":a.De.smaa_area_texture_path=l;break;case "ssao":a.B.ssao=
l;break;case "debug_view":a.B.debug_view=l;break;case "enable_selectable":a.B.enable_selectable=l;break;case "enable_outlining":a.B.enable_outlining=l;break;case "outlining_overview_mode":a.Wc.outlining_overview_mode=l;break;case "glow_materials":a.B.Ui=l;break;case "url_params":a.B.url_params=l;break;case "use_min50":a.B.use_min50=l;break;case "gl_debug":a.B.gl_debug=l;break;case "srgb_type":a.B.srgb_type=l;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.B.allow_cors;
case "allow_hidpi":return a.B.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.B.alpha_sort;case "alpha_sort_threshold":return a.B.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.B.stereo;case "animation_framerate":return a.ql.Lu;case "anisotropic_filtering":return a.B.anisotropic_filtering;case "antialiasing":return a.B.antialiasing;case "assets_dir":case "assets_path":return a.Pd.path;case "assets_dds_available":return a.Pd.yA;case "assets_pvr_available":return a.Pd.ww;
case "assets_min50_available":return a.Pd.aC;case "audio":return a.X.tE;case "background_color":return a.B.background_color;case "bloom":return a.B.bloom;case "built_in_module_name":return a.De.au;case "canvas_resolution_factor":return a.B.canvas_resolution_factor;case "console_verbose":return a.B.console_verbose;case "compositing":return a.B.compositing;case "dof":return a.B.dof;case "do_not_load_resources":return a.B.do_not_load_resources;case "is_mobile_device":return a.B.is_mobile_device;case "god_rays":return a.B.god_rays;
case "stereo":return a.B.stereo;case "max_fps":return a.B.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.B.media_auto_activation;case "motion_blur":return a.B.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.Ms;case "physics_calc_fps":return a.C.Iz;case "physics_use_workers":return a.C.Vs;case "precision":return a.B.precision;case "prevent_caching":return a.Pd.prevent_caching;case "quality":return a.B.quality;case "reflections":return a.B.reflections;
case "refractions":return a.B.refractions;case "sfx_mix_mode":return a.X.Wv;case "shaders_dir":case "shaders_path":return a.De.shaders_path;case "shadows":return a.B.shadows;case "show_hud_debug_info":return a.B.show_hud_debug_info;case "smaa":return a.B.smaa;case "smaa_search_texture_path":return a.De.smaa_search_texture_path;case "smaa_area_texture_path":return a.De.smaa_area_texture_path;case "ssao":return a.B.ssao;case "debug_view":return a.B.debug_view;case "enable_selectable":return a.B.enable_selectable;
case "enable_outlining":return a.B.enable_outlining;case "outlining_overview_mode":return a.Wc.outlining_overview_mode;case "glow_materials":return a.B.Ui;case "url_params":return a.B.url_params;case "use_min50":return a.B.use_min50;case "gl_debug":return a.B.gl_debug;case "srgb_type":return a.B.srgb_type;default:b.error("Unknown config property: "+c)}};a.reset=function(){for(var b in a.hH)a.context[b]=a.hH[b];for(b in a.NH)a.B[b]=a.NH[b];for(b in a.aG)a.Pd[b]=a.aG[b];for(b in a.bL)a.C[b]=a.bL[b];
for(b in a.LL)a.Do[b]=a.LL[b];for(b in a.yM)a.X[b]=a.yM[b];for(b in a.LH)a.Lq[b]=a.LH[b]};a.VC=function(){for(var b in a.gH)a.Fi[b]=a.gH[b]};a.YJ=l;a.$Y=function(){var b=a.De,m=a.C;l()||""!=b.shaders_path||(b.shaders_path=c()+"/"+b.rZ);m.enabled&&""==m.Ms&&(m.Ms=c()+"/"+m.a0.replace("B4W_URANIUM_PATH=",""))};a.Pu=function(b){var l=a.Pd;if(l.path)return l.path;var h=l.IX,m="B4W_ASSETS_PATH=";b&&(h=l.ZX,m="B4W_PROJ_ASSETS_PATH=",h=h.replace("__NAME__",b));h=h.replace(m,"");return h=h.replace("__JS__",
c())}};b4w.module.__extensions=function(a,m){function l(a){if(a in h)return h[a];var b=A.getExtension(a)||null;h[a]=b;x.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in h)return h[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=A;break;case "EXT_disjoint_timer_query":(b=A.getExtension("EXT_disjoint_timer_query")||null)||(b=A.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}h[a]=b;x.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=m("__config"),x=m("__print"),q=b.B,A=null,h={};a.Lf=function(a){A=a};a.lJ=function(){return l("WEBGL_compressed_texture_s3tc")||l("WEBKIT_WEBGL_compressed_texture_s3tc")||l("MOZ_WEBGL_compressed_texture_s3tc")};a.hJ=function(){return l("WEBKIT_WEBGL_compressed_texture_pvrtc")||l("WEBGL_compressed_texture_pvrtc")};a.qV=function(){return q.gc?c("WEBGL_depth_texture"):l("WEBGL_depth_texture")||l("WEBKIT_WEBGL_depth_texture")||
l("MOZ_WEBGL_depth_texture")};a.zI=function(){return l("EXT_texture_filter_anisotropic")||l("WEBKIT_EXT_texture_filter_anisotropic")||l("MOZ_EXT_texture_filter_anisotropic")};a.pV=function(){return l("WEBGL_debug_shaders")};a.Wu=function(){return l("WEBGL_debug_renderer_info")};a.MI=function(){return q.gc?c("OES_element_index_uint"):l("OES_element_index_uint")};a.lB=function(){return q.gc?c("OES_standard_derivatives"):l("OES_standard_derivatives")};a.bB=function(){var a=q.gc?c("EXT_disjoint_timer_query"):
l("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},uI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},vI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},tI:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return A.createQuery()},beginQuery:function(b){A.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){A.endQuery(a.TIME_ELAPSED_EXT)},uI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT_AVAILABLE)},vI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT)},tI:function(){return a.GPU_DISJOINT_EXT}}};a.HV=function(){if(q.gc)return c("ANGLE_instanced_arrays");var a=l("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,k,h,e){a.drawElementsInstancedANGLE(b,c,k,h,e)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,
c,k,h){a.drawArraysInstancedANGLE(b,c,k,h)}}};a.mB=function(){if(q.gc)return c("OES_vertex_array_object");var a=l("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.ua=function(){h={}};a.reset=function(){A=null}};b4w.module.__graph=function(a,m){function l(a,b,d){d||(d=null);c(a,b)?Q.q("Graph already has node with given ID"):a.Y.push(b,d)}function c(a,b){for(var d=a.Y,c=0;c<d.length;c+=2)if(d[c]==b)return!0;return!1}function b(a,b,d,e){e||(e=null);c(a,b)&&c(a,d)?a.Pa.push(b,d,e):Q.q("Wrong node IDs")}function x(a,b){c(a,b)||Q.q("Node not found");for(var d=a.Y,e=0;e<d.length;e+=2)d[e]==b&&(d.splice(e,2),e-=2)}function q(a,b,c,e){d(a,b,c)||Q.q("Edge not found");a=a.Pa;for(var f=0,g=0;g<a.length;g+=3)if(a[g]==
b&&a[g+1]==c){if(-1==e)a.splice(g,3);else{if(e==f){a.splice(g,3);break}f++}g-=3}}function A(a){a=a.Y;for(var b=-1,d=0;d<a.length;d+=2)b=Math.max(b,a[d]);return++b}function h(a,b){for(var d=a.Y,c=0;c<d.length;c+=2)if(d[c+1]==b)return d[c];return-1}function z(a){var b=[],d={};p(a,d);for(var c=a.Y,e=0;e<c.length;e+=2)0==I(a,c[e])&&n(a,c[e],d,b);return{Y:b,Pa:a.Pa.slice(0)}}function p(a,b){for(var d=a.Y,c=0;c<d.length;c+=2)b[d[c]]=!1}function n(a,b,d,c){if(!d[b]){d[b]=!0;for(var e=0;e<E(a,b);e++)n(a,
B(a,b,e),d,c);c.unshift(b,R(a,b))}}function k(a,b,d,c){if(!d[b]){d[b]=!0;if(10==c||30==c)for(var e=0;e<E(a,b);e++){var f=B(a,b,e);k(a,f,d,c)}if(20==c||30==c)for(e=0;e<I(a,b);e++)f=P(a,b,e),k(a,f,d,c)}}function u(a){for(var b=a.Pa,d=0;d<b.length;d+=3){var e=b[d+1];c(a,b[d])&&c(a,e)||(b.splice(d,3),d-=3)}}function e(a){for(var b=[],d=a.Y,c=0;c<d.length;c+=2){var e=d[c];E(a,e)||b.push(e)}return b}function y(a){var b=a.Y;a=a.Pa;for(var d=[],c=[],e=[],f=0;f<b.length;f++)e[b[2*f]]=f,d.push(f,b[2*f+1]);
for(f=0;f<a.length;f+=3)c.push(e[a[f]],e[a[f+1]],a[f+2]);return{Y:d,Pa:c}}function K(a,b,d){if(d.Fh==d.lk){for(var c=0,e=0;c<d.lk;c++)-1!=d.Gi[c]&&(a[e]=c,b[e]=d.Gi[c],e++);return!0}if(d.lk>d.mo||d.Mk>d.Nk||d.Zo>d.ap||d.Yo>d.$o)return!1;for(var e=c=-1,f=!1;!f&&F(d,t,c,e);)if(c=t[0],e=t[1],J(d,c,e)){var g;g=d;f={};f.dr=g.dr;f.er=g.er;f.mC=g.mC;f.Cu=g.Cu;f.lk=g.lk;f.mo=g.mo;f.pk=g.pk;f.Fh=f.gw=g.Fh;f.Yo=g.Yo;f.Zo=g.Zo;f.Mk=g.Mk;f.$o=g.$o;f.ap=g.ap;f.Nk=g.Nk;f.Np=-1;f.Gi=g.Gi;f.Fl=g.Fl;f.fm=g.fm;f.gm=
g.gm;f.xm=g.xm;f.ym=g.ym;f.Vw=g.Vw;g.Vw[0]+=1;var f=g=f,k=c,n=e,h=f.dr,l=f.er,u=f.lk,v=f.mo,p=f.Gi,r=f.Fl,m=f.fm,y=f.gm,q=f.xm,L=f.ym;D(k<u);D(n<v);D(f.Fh<u);D(f.Fh<v);u=++f.Fh;f.Np=k;m[k]||(m[k]=u,f.Yo++,q[k]&&f.Mk++);q[k]||(q[k]=u,f.Zo++,m[k]&&f.Mk++);y[n]||(y[n]=u,f.$o++,L[n]&&f.Nk++);L[n]||(L[n]=u,f.ap++,y[n]&&f.Nk++);p[k]=n;r[n]=k;for(p=0;p<I(h,k);p++)r=P(h,k,p),m[r]||(m[r]=u,f.Yo++,q[r]&&f.Mk++);for(p=0;p<E(h,k);p++)r=B(h,k,p),q[r]||(q[r]=u,f.Zo++,m[r]&&f.Mk++);for(p=0;p<I(l,n);p++)r=P(l,n,
p),y[r]||(y[r]=u,f.$o++,L[r]&&f.Nk++);for(p=0;p<E(l,n);p++)r=B(l,n,p),L[r]||(L[r]=u,f.ap++,y[r]&&f.Nk++);f=K(a,b,g);D(1>=g.Fh-g.gw);D(-1!=g.Np);r=g.dr;k=g.er;n=g.Fh;h=g.Np;l=g.Gi;m=g.Fl;u=g.fm;y=g.gm;v=g.xm;q=g.ym;if(g.gw<n){u[h]==n&&(u[h]=0);for(L=0;L<I(r,h);L++)p=P(r,h,L),u[p]==n&&(u[p]=0);v[h]==n&&(v[h]=0);for(L=0;L<E(r,h);L++)p=B(r,h,L),v[p]==n&&(v[p]=0);r=l[h];y[r]==n&&(y[r]=0);for(L=0;L<I(k,r);L++)p=P(k,r,L),y[p]==n&&(y[p]=0);q[r]==n&&(q[r]=0);for(L=0;L<E(k,r);L++)p=B(k,r,L),q[p]==n&&(q[p]=
0);l[h]=-1;m[r]=-1;g.Fh=g.gw;g.Np=-1}}return f}function F(a,b,d,c){-1==d&&(d=0);-1==c?c=0:c++;var e=a.Mk,f=a.Nk,g=a.Zo,k=a.ap,n=a.Yo,h=a.$o,l=a.Fh,t=a.lk,v=a.mo,u=a.Gi,p=a.Fl,r=a.fm,m=a.gm,y=a.xm,L=a.ym;if(e>l&&f>l)for(;d<t&&(-1!=u[d]||0==y[d]||0==r[d]);)d++,c=0;else if(g>l&&k>l)for(;d<t&&(-1!=u[d]||0==y[d]);)d++,c=0;else if(n>l&&h>l)for(;d<t&&(-1!=u[d]||0==r[d]);)d++,c=0;else if(0==d&&0!=a.pk){for(r=0;r<t&&-1!=u[d=a.pk[r]];)r++;r==t&&(d=t)}else for(;d<t&&-1!=u[d];)d++,c=0;if(e>l&&f>l)for(;c<v&&(-1!=
p[c]||0==L[c]||0==m[c]);)c++;else if(g>l&&k>l)for(;c<v&&(-1!=p[c]||0==L[c]);)c++;else if(n>l&&h>l)for(;c<v&&(-1!=p[c]||0==m[c]);)c++;else for(;c<v&&-1!=p[c];)c++;return d<t&&c<v?(b[0]=d,b[1]=c,!0):!1}function J(a,b,c){var e=a.dr,g=a.er,k=a.mo,n=a.Gi,h=a.Fl,l=a.fm,t=a.gm,u=a.xm,p=a.ym;D(b<a.lk);D(c<k);D(-1==n[b]);D(-1==h[c]);if(!(0,a.mC)(R(e,b),R(g,c)))return!1;for(var v=k=0,r=0,m=0,y=0,q=0,Q=0;Q<E(e,b);Q++){var L=B(e,b,Q);if(-1!=n[L]){var Y=n[L];if(!d(g,c,Y)||!f(a.Cu,e,b,L,g,c,Y))return!1}else l[L]&&
r++,u[L]&&k++,l[L]||u[L]||y++}for(Q=0;Q<I(e,b);Q++)if(L=P(e,b,Q),-1!=n[L]){if(Y=n[L],!d(g,Y,c)||!f(a.Cu,e,L,b,g,Y,c))return!1}else l[L]&&r++,u[L]&&k++,l[L]||u[L]||y++;for(Q=0;Q<E(g,c);Q++)if(Y=B(g,c,Q),-1!=h[Y]){if(L=h[Y],!d(e,b,L))return!1}else t[Y]&&m++,p[Y]&&v++,t[Y]||p[Y]||q++;for(Q=0;Q<I(g,c);Q++)if(Y=P(g,c,Q),-1!=h[Y]){if(L=h[Y],!d(e,L,b))return!1}else t[Y]&&m++,p[Y]&&v++,t[Y]||p[Y]||q++;return r<=m&&k<=v&&y<=q}function D(a){a||Q.q("Assertion failed")}function R(a,b){for(var d=a.Y,c=0;c<d.length;c+=
2)if(d[c]==b)return d[c+1];return null}function E(a,b){for(var d=a.Pa,c=0,e=0;e<d.length;e+=3)d[e]==b&&c++;return c}function I(a,b){for(var d=a.Pa,c=0,e=0;e<d.length;e+=3)d[e+1]==b&&c++;return c}function B(a,b,d){a=a.Pa;for(var c=0,e=0;e<a.length;e+=3)if(a[e]==b){if(c==d)return a[e+1];c++}return-1}function P(a,b,d){a=a.Pa;for(var c=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(c==d)return a[e];c++}return-1}function d(a,b,d){a=a.Pa;for(var c=0;c<a.length;c+=3)if(a[c]==b&&a[c+1]==d)return!0;return!1}function f(a,
b,d,c,e,f,k){for(var n=r(b,d,c),h=r(e,f,k),l=0;l<n;l++){for(var t=!1,u=0;u<h;u++)if(a(g(b,d,c,l),g(e,f,k,u))){t=!0;break}if(!t)return!1}return!0}function r(a,b,d){var c=0;a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==d&&c++;return c}function g(a,b,d,c){a=a.Pa;for(var e=0,f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==d){if(e==c)return a[f+2];e++}return null}m("__print");var Q=m("__util"),t=[-1,-1];a.$y=-1;a.R0=10;a.ft=20;a.d2=30;a.create=function(){for(var a=arguments,b=[],d=[],c=0;c<a.length;c++){var e=
a[c];switch(e.length){case 2:b.push(e[0],e[1]);break;case 3:d.push(e[0],e[1],e[2]);break;default:Q.q("Wrong graph constructor params")}}return{Y:b,Pa:d}};a.clone=function(a,b,d){if(b)for(var c=Array(a.Y.length),e=0;e<a.Y.length;e+=2)c[e]=a.Y[e],c[e+1]=b(a.Y[e+1]);else c=Q.R(a.Y);if(d)for(b=Array(a.Pa.length),e=0;e<a.Pa.length;e+=3)b[e]=a.Pa[e],b[e+1]=a.Pa[e+1],b[e+2]=d(a.Pa[e+2]);else b=Q.R(a.Pa);return a={Y:c,Pa:b}};a.w3=function(a,b){for(var d=[],c=[],e=0;e<a.length;e++)d.push(a[e][0],a[e][1]);
for(e=0;e<b.length;e++)c.push(b[e][0],b[e][1],b[e][2]);return{Y:d,Pa:c}};a.Gj=l;a.o6=c;a.fd=b;a.rg=x;a.Ak=q;a.zo=function(a,b,c,e){d(a,b,c)||Q.q("Edge not found");a=a.Pa;for(var f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c&&a[f+2][0]==e[0]&&a[f+2][1]==e[1]){a.splice(f,3);break}};a.J=function(a,b){if(-1==h(a,b)){var d=A(a);l(a,d,b);return d}Q.q("Non-unique attribute")};a.mY=function(a,b,d,c,e){a=a.Pa;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==d&&a[f+2]==c&&(a[f+2]=e)};a.bR=function(a,d,c){var e;c=c||
[];e=e||[];for(var f={},g=0;g<a.Y.length;g+=2){var k=a.Y[g],n=a.Y[g+1],h=A(d);l(d,h,n);f[k]=h}for(g=0;g<a.Pa.length;g+=3)n=f[a.Pa[g]],h=f[a.Pa[g+1]],k=a.Pa[g+2],b(d,n,h,k);for(g=0;g<c.length;g+=3)n=f[c[g]],a=c[g+1],k=c[g+2],b(d,n,a,k);for(g=0;g<e.length;g+=3)c=e[g],h=f[e[g+1]],k=e[g+2],b(d,c,h,k)};a.Zl=A;a.eh=h;a.r=function(a,d,c,e){d=h(a,d);c=h(a,c);-1!=d&&-1!=c?b(a,d,c,e):Q.q("Attributes not found")};a.pa=function(a,b){for(var d=a.Y,c=0;c<d.length&&!b(d[c],d[c+1]);c+=2);};a.vg=function(a,b){for(var d=
a.Pa,c=0;c<d.length&&!b(d[c],d[c+1],d[c+2]);c+=3);};a.li=function(a,b,d){for(var c=a.Pa,e=0;e<c.length;e+=3)if(c[e+1]==b){var f=c[e];if(d(f,R(a,f),c[e+2]))break}};a.Qk=function(a,b,d){for(var c=a.Pa,e=0;e<c.length;e+=3)if(c[e]==b){var f=c[e+1];if(d(f,R(a,f),c[e+2]))break}};a.UD=z;a.f_=function(a){a=z(a).Y;for(var b=[],d=0;d<a.length;d+=2)b.push(a[d+1]);return b};a.L6=function(){};a.ix=function(a,b,d){c(a,b)||Q.q("No such node");var e={};p(a,e);k(a,b,e,d);b=[];for(var f in e)e[f]&&(f=Number(f),b.push(f,
R(a,f)));a={Y:b,Pa:a.Pa.slice(0)};u(a);return a};a.Sz=u;a.MV=function(a){for(var b=[],d=a.Y,c=0;c<d.length;c+=2){var e=d[c];I(a,e)||b.push(e)}return b};a.mr=e;a.match=function(a,b,d,c){var e={};e.dr=y(a);e.er=y(b);e.mC=d||function(a,b){return a==b};e.Cu=c||function(a,b){return a==b};c=a.Y.length/2;var f=b.Y.length/2;e.lk=c;e.mo=f;e.pk=0;e.Fh=e.gw=0;e.Mk=e.Yo=e.Zo=0;e.Nk=e.$o=e.ap=0;e.Np=-1;e.Gi=Array(c);e.Fl=Array(f);e.fm=Array(c);e.gm=Array(f);e.xm=Array(c);e.ym=Array(f);e.Vw=[1];for(d=0;d<c;d++)e.Gi[d]=
-1,e.fm[d]=0,e.xm[d]=0;for(d=0;d<f;d++)e.Fl[d]=-1,e.gm[d]=0,e.ym[d]=0;f=Array(c);c=Array(c);if(K(f,c,e)){for(d=0;d<f.length;d++)f[d]=a.Y[2*f[d]],c[d]=b.Y[2*c[d]];return[f,c]}return null};a.JV=function(a,b){for(var d=a.Y,c=1;c<d.length;c+=2)if(d[c]==b)return d[c-1];return null};a.Va=R;a.og=E;a.Vn=I;a.Ug=B;a.Si=P;a.O4=r;a.Xd=g;a.replace=function(a,b,d){for(var c=a.Pa,e=A(a),f=0;f<b.length;f++){var g=b[f];x(a,g);for(var k=0;k<c.length;k+=3)c[k]==g&&(c[k]=e),c[k+1]==g&&(c[k+1]=e),c[k]==c[k+1]&&(c.splice(k,
3),k-=3)}l(a,e,d)};a.cY=function(a,b,c,e,f){d(a,b,c)||Q.q("Edge not found");a=a.Pa;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&(a[g]=e,a[g+1]=f)};a.qU=function(a,b){function d(a,b){if(-1!=n.indexOf(a)){var c=n.slice(n.indexOf(a));if(-1!=f[c[c.length-1]].indexOf(c[0])){h.push([a,c[c.length-1]]);return}}n.push(a);for(c=0;c<b.length;c++)b[c]in f&&d(b[c],f[b[c]])}b||(b=e(a)[0]);var c=a.Pa;if(c.length&&-1!=c.indexOf(b)){for(var f={},g=0,k=0;k<c.length;k+=3)c[k+1]in f?f[c[k+1]].push(c[k]):f[c[k+1]]=
[c[k]],g++;var n=[],h=[];d(b,f[b]);for(k=0;k<h.length;k++)for(var l=g=0;l<c.length;l+=3)h[k][1]==c[l+1]&&h[k][0]==c[l]&&q(a,c[l],c[l+1],g),g++}};a.WT=function(a,b,d){var c=a.Y;a=a.Pa;var e;e="digraph debug {\n    node [shape=box];\n";for(var f=0;f<c.length;f+=2){var g=c[f],k=c[f+1],k=b?b(g,k):String(g);e+="    ";e+=String(g)+' [label="'+k.replace(/\"/g,'\\"')+'"];\n'}for(f=0;f<a.length;f+=3)b=a[f],c=a[f+1],k=a[f+2],e+="    ",e+=String(b)+" -> "+String(c),d&&(e+=' [label="'+d(b,c,k)+'"]'),e+=";\n";
return e+="}"}};b4w.module.__nodemat=function(a,m){function l(a,b,d,g,k){var v=Ea.A(),v=h(b,k,v.uuid);if(v in wa)return wa[v];var t={Wa:null,id:v,VG:!0};d||(Ga={},Qa=0);if("SHADOW"!=k&&"COLOR_ID"!=k){b=C.create();for(var H=a.nodes,r=0;r<H.length;r++)if(null==aa(b,H[r],0,g,k))return wa[v]=null,t;if(d&&-1==Q(a,b,"GROUP_OUTPUT","group"))return t;r=L(b);H=d?a.links:a.links.slice();if(!Y(b,H,r))return t;if(d)return t.Wa=b,t;for(r=0;r<H.length;r++){d=H[r];for(var m=y(d.from_node,b),O=y(d.to_node,b),ca=0;ca<m.length;ca++)for(var Z=
0;Z<O.length;Z++){var W=m[ca],G=O[Z],B=C.Va(b,W),ba=C.Va(b,G);if(!na(b,W,G,B,ba,d))return wa[v]=null,t}}e(b);"GLOW"==k?r=Q(a,b,"B4W_GLOW_OUTPUT","material",!0):(r=Q(a,b,"OUTPUT","material",!1,!0),-1==r&&(r=Q(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==r&&(b=p(),r=0);K(b);a=C.ix(b,r,C.ft);c(a,g);q(a,g);n(a);J(a);f(a);u(a,g,k);ha(a)}else g=l(a,b,d,g,"MAIN"),g=C.clone(g.Wa,function(a){var b=Ca.sq(a);b.L=Ca.R(a.L);b.fb=Ca.R(a.fb);return b}),r=Q(a,g,"OUTPUT","material",!1,!0),-1==r&&(r=Q(a,g,"OUTPUT_MATERIAL",
"material",!1,!0)),z(g,r),a=C.ix(g,r,C.ft),n(a);t.Wa=a;return wa[v]=t}function c(a,d){var c=[];C.pa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||c.push({Qr:a,node:b})});for(var e=0;e<c.length;++e){var f=c[e].Qr,g=c[e].node,k=C.Zl(a);C.Gj(a,k,g.data.kX);var n=C.Zl(a);C.Gj(a,n,g.data.lX);C.fd(a,k,n,[4,2]);for(var v={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},h=C.Vn(a,f),l=[],t=[],H=[],u={},r=0;r<h;r++){var p=C.Si(a,f,
r);p in u||(u[p]=0);var L=C.Xd(a,p,f,u[p]++);l.push([p,f,L]);var m=v[L[1]];if(m)switch(m[0]){case "MATERIAL_END":t.push([p,n,[L[0],m[1]]]);break;case "LIGHTING_APPLY":H.push([p,[L[0],m[1]]])}else t.push([p,k,L])}b(a,g.data.value,k,n,H,d);for(r=0;r<l.length;r++)C.zo(a,l[r][0],l[r][1],l[r][2]);for(r=0;r<t.length;r++)C.fd(a,t[r][0],t[r][1],t[r][2]);g=C.og(a,f);k=[];v=[];h={};for(r=0;r<g;r++)l=C.Ug(a,f,r),l in h||(h[l]=0),L=C.Xd(a,f,l,h[l]++),k.push([f,l,L]),v.push([n,l,L]);for(r=0;r<k.length;r++)C.zo(a,
k[r][0],k[r][1],k[r][2]);for(r=0;r<v.length;r++)C.fd(a,v[r][0],v[r][1],v[r][2]);C.rg(a,f)}}function b(a,b,d,c,e,f){var g={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=aa(a,g,0,f,null),n=k;x(a,d,k,"E");x(a,d,k,"A");x(a,d,k,"D");k=Ea.A();k=ja.Vb(k,"LAMP",ja.nc);if(!b.Je)for(var v,h,l,t=0;t<k.length;t++){l=k[t].ub;g={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};v=aa(a,g,0,f,null);g={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};h=aa(a,g,0,f,null);x(a,n,h,"color");x(a,n,h,"specular");x(a,v,h,"ldir");
x(a,d,h,"normal");x(a,d,h,"D");x(a,d,h,"S");x(a,v,h,"lcolorint");x(a,d,v,"shadow_factor");n="SPECULAR_"+b.Ds;g={name:n,type:n,use_tangent_shading:b.Wm};n=aa(a,g,0,f,null);x(a,v,n,"ldir");x(a,v,n,"lfac");x(a,d,n,"normal");x(a,n,h,"sfactor");x(a,v,n,"norm_fac");x(a,d,n,"sp_params");n="HEMI"==l.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Nq;g={name:n,type:n,use_tangent_shading:b.Wm};l=aa(a,g,0,f,null);x(a,v,l,"ldir");x(a,v,l,"lfac");x(a,d,l,"normal");x(a,v,l,"norm_fac");x(a,l,h,"lfactor");"DIFFUSE_LAMBERT"!=
n&&x(a,d,l,"dif_params");for(v=0;v<e.length;v++)C.fd(a,e[v][0],h,e[v][1]);n=h}x(a,n,c,"color");x(a,n,c,"specular")}function x(a,b,d,c){for(var e=C.Va(a,b),f=C.Va(a,d),g,k=0;k<f.L.length;k++)if(c==f.L[k].identifier){g=k;break}if(void 0!==g){for(var n,k=0;k<e.fb.length;k++)if(c==e.fb[k].identifier){n=k;break}void 0!==n&&C.fd(a,b,d,[n,g])}}function q(a,b){var d=[];C.pa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&d.push({Qr:a,node:b})});for(var c=0;c<d.length;++c){var e=d[c].Qr,f=d[c].node,g=C.Zl(a);C.Gj(a,
g,f.data.KR);var k=C.Zl(a);C.Gj(a,k,f.data.LR);C.fd(a,g,k,[4,2]);for(var n=C.Vn(a,e),v=[],h=[],l={},t=0;t<n;t++){var r=C.Si(a,e,t),H=C.Va(a,r);r in l||(l[r]=0);var u=C.Xd(a,r,e,l[r]++);v.push([r,e,u]);h.push([r,g,u]);if("BSDF_GLOSSY"==H.type||"BSDF_DIFFUSE"==H.type||"MIX_SHADER"==H.type||"EMISSION"==H.type){h.push([r,g,[1,1]]);h.push([r,g,[2,2]]);h.push([r,g,[3,3]]);h.push([r,g,[4,4]]);h.push([r,g,[5,5]]);h.push([r,g,[6,6]]);h.push([r,g,[7,7]]);h.push([r,g,[8,8]]);var p=[];C.pa(a,function(a,b){"MIX_SHADER"==
b.type&&p.push({Qr:a,node:b})});for(u=0;u<p.length;++u)for(var r=p[u].Qr,H=C.Vn(a,r),L=0;L<H;L++){var m=C.Si(a,r,L),y=C.Va(a,m),O=C.Xd(a,m,r,0);0==O[1]||"BSDF_GLOSSY"!=y.type&&"BSDF_DIFFUSE"!=y.type&&"MIX_SHADER"!=y.type&&"EMISSION"!=y.type||(y=1==O[1]?3:11,h.push([m,r,[1,y]]),h.push([m,r,[2,y+1]]),h.push([m,r,[3,y+2]]),h.push([m,r,[4,y+3]]),h.push([m,r,[5,y+4]]),h.push([m,r,[6,y+5]]),h.push([m,r,[7,y+6]]),h.push([m,r,[8,y+7]]))}}}A(a,f.data.value,g,k,b);for(t=0;t<v.length;t++)C.zo(a,v[t][0],v[t][1],
v[t][2]);for(t=0;t<h.length;t++)C.fd(a,h[t][0],h[t][1],h[t][2]);f=C.og(a,e);g=[];n=[];v={};for(t=0;t<f;t++)h=C.Ug(a,e,t),h in v||(v[h]=0),u=C.Xd(a,e,h,v[h]++),g.push([e,h,u]),n.push([k,h,u]);for(t=0;t<g.length;t++)C.zo(a,g[t][0],g[t][1],g[t][2]);for(t=0;t<n.length;t++)C.fd(a,n[t][0],n[t][1],n[t][2]);C.rg(a,e)}}function A(a,b,d,c,e){var f=[],g={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=aa(a,g,0,e,null),n=k;x(a,d,k,"E");x(a,d,k,"A");x(a,d,k,"D");for(var k=Ea.A(),k=ja.Vb(k,"LAMP",ja.nc),h,v,
l=0;l<k.length;l++){g={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};h=aa(a,g,0,e,null);g={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};v=aa(a,g,0,e,null);x(a,n,v,"color");x(a,n,v,"specular");x(a,h,v,"ldir");x(a,d,v,"normal");x(a,d,v,"D");x(a,d,v,"S");x(a,h,v,"lcolorint");x(a,d,h,"shadow_factor");n=b.MR;g={name:n,type:n};n=aa(a,g,0,e,null);x(a,h,n,"ldir");x(a,h,n,"lfac");x(a,d,n,"normal");x(a,h,n,"norm_fac");x(a,d,n,"bsdf_params");x(a,n,v,"lfactor");x(a,n,v,"sfactor");for(n=0;n<f.length;n++)C.fd(a,f[n][0],
v,f[n][1]);n=v}x(a,d,c,"s_color");x(a,d,c,"metalness");x(a,d,c,"e_color");x(a,d,c,"emission");x(a,n,c,"color");x(a,n,c,"specular")}function h(a,b,d){switch(b){case "GLOW":return a+d+"11";case "COLOR_ID":case "SHADOW":return a+d+"00";default:return a+d+"10"}}function z(a,b){C.vg(a,function(d,c,e){var f=C.Va(a,c);c==b&&"Color"==f.L[e[1]].identifier&&C.zo(a,d,c,e)})}function p(){var a=C.create(),b={data:null,Tb:[],rb:[],L:[{Da:new Float32Array([0,0,0]),identifier:"Color",ab:!1,name:"Color"},{Da:1,identifier:"Alpha",
ab:!1,name:"Alpha"}],fb:[],type:"OUTPUT",oi:[]};C.Gj(a,0,b);return a}function n(a){C.pa(a,function(b,d){for(var c=d.L,e=d.fb,f=0;f<c.length;f++)k(a,c[f],b,f,1);for(f=0;f<e.length;f++)k(a,e[f],b,f,0)})}function k(a,b,d,c,e){if(b.ab){var f=!0;C.vg(a,function(a,b,w){if(!e&&a==d&&w[0]==c||e&&b==d&&w[1]==c)f=!1});f&&(b.ab=!1)}}function u(a,b,d){var c=[];C.vg(a,function(e,f,g){var k=C.Va(a,e),n=C.Va(a,f),k=Ca.ik(k.fb[g[0]].Da),n=Ca.ik(n.L[g[1]].Da);if(k!=n){var v,h={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},l={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};k&&!n?v=t("vector_to_scalar","B4W_VECTOSCAL",[h],[l]):!k&&n&&(v=t("scalar_to_vector","B4W_SCALTOVEC",[l],[h]));aa(a,v,0,b,d);c.push([e,f,a.Y[a.Y.length-2],g])}});for(var e=0;e<c.length;++e)C.zo(a,c[e][0],c[e][1],c[e][3]),C.fd(a,c[e][0],c[e][2],[c[e][3][0],0]),C.fd(a,c[e][2],c[e][1],[0,c[e][3][1]])}function e(a){var b=[];C.pa(a,function(d,c){switch(c.type){case "B4W_TRANSLUCENCY":C.vg(a,function(e,f,g){var k=
C.Va(a,f);e==d&&"MATERIAL_EXT"==k.type&&"Translucency"==c.fb[g[0]].name&&b.push(e,f,[g[0]+1,g[1]+1])})}});for(var d=0;d<b.length;d+=3)C.fd(a,b[d],b[d+1],b[d+2])}function y(a,b){var d=[];C.pa(b,function(b,c){c.name==a.name&&d.push(b)});if(d.length)return d;Ca.q("Node not found")}function K(a){var b=[];C.pa(a,function(a,d){"B4W_PARALLAX"!=d.type&&"REROUTE"!=d.type||b.push(a,d)});for(var d=0;d<b.length;d+=2){var c=b[d],e=b[d+1];if("B4W_PARALLAX"==e.type)F(a,c,e);else if("REROUTE"==e.type){for(var f=
C.Si(a,c,0),g=C.og(a,c),k=[],n=[],v=[],h=0;h<g;h++){var l=C.Ug(a,c,h),t=n.indexOf(l),r=0<=t?v[r]:0,u=C.Xd(a,c,l,r);if(u){var u=u[1],H=e.L[0].Da,u=C.Va(a,l).L[u];switch(typeof H){case "number":if("object"==typeof u.Da)for(var p=u.Da,u=0;u<p.length;u++)p[u]=H;else"number"==typeof u.Da&&(u.Da=H);break;case "object":if("object"==typeof u.Da)for(p=u.Da,u=0;u<p.length;u++)p[u]=H[u];else"number"==typeof u.Da&&(u.Da=.35*H[0]+.45*H[1]+.2*H[2])}}H=e.fb;for(u=0;u<H.length;u++)H[u].Da=e.L[0].Da;-1!=t?v[t]+=1:
(n.push(l),v.push(1),k.push(c,l))}if(-1!=f)for(e=C.Xd(a,f,c,0)[0],h=0;h<n.length;h++)for(u=0;u<v[h];u++)g=C.Xd(a,c,n[h],u)[1],C.fd(a,f,n[h],[e,g]);for(h=0;h<k.length;h+=2)C.Ak(a,k[h],k[h+1],-1)}}}function F(a,b,d){var c;a:{c=a.Pa;for(var e=0;e<c.length;e+=3)if(c[e+1]==b&&1==c[e+2][1]){c=c[e];break a}c=-1}-1!=c&&(e=C.Va(a,c),d.data=e.data,C.Ak(a,c,b,-1),0==C.og(a,c)&&(b=C.Si(a,c,0),-1!=b&&C.Ak(a,b,c,-1),C.rg(a,c)));d.L.splice(1,1)}function J(a){R(a);B(a);D(a)}function D(a){var b=[],c="",e="",f={};
C.pa(a,function(a,d){if("GEOMETRY_UV"==d.type||"UVMAP"==d.type||"TEX_COORD_UV"==d.type){b.push(a,d);var w=d.data.value;c?c==w||e||(e=w,f[e]=0):(c=w,f[c]=0);f[w]++}});for(var g in f)if(2>f[g]){for(var k=0;k<b.length;k+=2)b[k+1].data.value==g&&b.splice(k,2);delete f[g];c==g&&(c=e,e="");e==g&&(e="")}if(!(3>b.length)){var k={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},n={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};g=t("merged_uv","UV_MERGED",
[],[k,n]);g.uv_layer=c;aa(a,g,0,"",void 0);var h=a.Y[a.Y.length-2];g=a.Y[a.Y.length-1];if(e){n=t("merged_uv","UV_MERGED",[],[k,n]);n.uv_layer=e;aa(a,n,0,"",void 0);var v=a.Y[a.Y.length-2],n=a.Y[a.Y.length-1]}else n=null;for(var l=-1,u=null,k=0;k<b.length;k+=2){var r=b[k],H=b[k+1];d(H,b[1])?(l=h,u=g):n&&(l=v,u=n);for(var p=[],L=C.og(a,r),m={},y=0;y<L;y++){var O=C.Ug(a,r,y);O in m||(m[O]=0);var Y=C.Xd(a,r,O,m[O]++);p.push(r,O,Y);Y=Y.splice(0,Y.length);switch(H.type){case "GEOMETRY_UV":Y[0]=0;u.fb[0].ab=
!0;break;case "UVMAP":case "TEX_COORD_UV":Y[0]=1,u.fb[1].ab=!0}C.fd(a,l,O,Y)}for(var y=0;y<p.length;y+=3)C.Ak(a,p[y],p[y+1],0);C.rg(a,r)}}}function R(a){var b=[];C.pa(a,function(a,d){"GEOMETRY_VC"!=d.type&&"GEOMETRY_NO"!=d.type&&"GEOMETRY_FB"!=d.type&&"GEOMETRY_VW"!=d.type&&"GEOMETRY_GL"!=d.type&&"GEOMETRY_LO"!=d.type&&"GEOMETRY_OR"!=d.type&&"GEOMETRY_BF"!=d.type&&"GEOMETRY_IN"!=d.type||b.push(a,d)});for(var d=[],c=0;c<b.length;c+=2){for(var e=b[c],f=b[c+1],g=!0,k=0;k<d.length;k++){var n=d[k];if(P(f,
n.yf)){g=[];k=C.og(a,e);for(l=0;l<k;l++){var h=C.Ug(a,e,l),v=C.Xd(a,e,h,0);g.push(e,h,v);C.fd(a,n.id,h,v)}for(var l=0;l<g.length;l+=3)C.Ak(a,g[l],g[l+1],0);C.rg(a,e);g=!1;break}}g&&(n={id:e,yf:f},d.push(n))}}function E(a){for(var b={},d=0;d<a.Y.length;d+=2){var c=a.Y[d];b[c]={Vp:{},$J:!1}}for(d=0;d<a.Pa.length;d+=3)b[a.Pa[d+1]].Vp[a.Pa[d]]=!0;for(c in b)I(c,b);for(c in b)b[c]=Object.keys(b[c].Vp).map(function(a){return parseInt(a)});return b}function I(a,b){var d=b[a];if(!d.$J){var c=Ca.R(d),e;for(e in d.Vp){I(e,
b);var d=b[e],f;for(f in d.Vp)c.Vp[f]=!0}c.$J=!0;b[a]=c}}function B(a){var b=[];C.pa(a,function(a,d){"TEXTURE_COLOR"!=d.type&&"TEXTURE_NORMAL"!=d.type||b.push(a,d)});if(b.length){for(var d=E(a),c=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],k=!0,n=0;n<c.length;n++){var h=c[n];if(!(3<=h.ko.length||!P(g,h.yf)||-1<d[f].indexOf(h.id)||-1<d[h.id].indexOf(f))){for(var v=!1,l=0;l<h.ko.length;l++){var t=h.ko[l].id;if(-1<d[f].indexOf(t)||-1<d[t].indexOf(f)){v=!0;break}}if(!v){for(var n=[],t=C.Vn(a,f),u=
{},l=0;l<t;l++)v=C.Si(a,f,l),v in u||(u[v]=0),k=C.Xd(a,v,f,u[v]++),n.push(v,f,k);for(var t=[],u=C.og(a,f),r={},l=0;l<u;l++)v=C.Ug(a,f,l),v in r||(r[v]=0),k=C.Xd(a,f,v,r[v]++),t.push(f,v,k);k=n.concat(t);for(l=0;l<k.length;l+=3)C.Ak(a,k[l],k[l+1],0);C.rg(a,f);l={id:f,yf:g,jU:n,kU:t};h.ko.push(l);k=!1;break}}}k&&(h={id:f,yf:g,ko:[]},c.push(h))}for(e=0;e<c.length;e++){h=c[e];d=h.ko.length;for(n=0;n<d;n++){g=h.ko[n];l=g.yf;f=g.jU;g=g.kU;h.yf.L[n+1].ab=l.L[0].ab;h.yf.L[n+1].Da=l.L[0].Da;h.yf.fb[2*(n+1)].ab=
l.fb[0].ab;h.yf.fb[2*(n+1)].Da=l.fb[0].Da;h.yf.fb[2*(n+1)+1].ab=l.fb[1].ab;h.yf.fb[2*(n+1)+1].Da=l.fb[1].Da;for(l=0;l<f.length;l+=3)v=f[l],k=f[l+2],k[1]+=n+1,C.fd(a,v,h.id,k);for(l=0;l<g.length;l+=3)v=g[l+1],k=g[l+2],k[0]+=2*(n+1),C.fd(a,h.id,v,k);h.yf.Tb.push(["USE_uv"+(n+2),1])}C.rg(a,h.id);C.Gj(a,h.id,h.yf)}}}function P(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.Fz==b.data.value.Fz&&a.data.value.Un==b.data.value.Un;default:return!1}}function d(a,b){var d=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=d.indexOf(a.type)&&-1!=d.indexOf(b.type)?a.data.value==b.data.value:!1}function f(a){var b=[],d=[];C.pa(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c);"GEOMETRY_VW"==c.type&&d.push(a,c)});r(a,b);g(a,d)}function r(a,b){for(var d=0;d<b.length;d+=2){for(var c=b[d],e=b[d+1],f=!1,g=[],k=[],n=[[],
[],[]],h=C.og(a,c),v=0;v<h;v++){var l=C.Ug(a,c,v);if("SEPRGB"!=C.Va(a,l).type){f=!1;break}g.push(c,l);for(var t={},u=C.og(a,l),f=0;f<u;f++){var r=C.Ug(a,l,f);r in t||(t[r]=0);var H=C.Xd(a,l,r,t[r]++);g.push(l,r);n[H[0]].push(c,r,H)}k.push(l);f=!0}if(f){for(v=c=h=0;v<n.length;v++)n[v].length&&(h++,c|=1<<2-v);if(h){e.type+=h;e.fb=[];for(v=0;v<n.length;v++)if(n[v].length)for(e.fb.push({Da:0,identifier:"RGB"[v],ab:!0,name:"RGB"[v]}),f=0;f<n[v].length;f+=3)n[v][f+2][0]=Ca.Bo(c,v);for(v=0;v<g.length;v+=
2)C.Ak(a,g[v],g[v+1],0);for(v=0;v<k.length;v++)C.rg(a,k[v]);for(v=0;v<n.length;v++)for(f=0;f<n[v].length;f+=3)C.fd(a,n[v][f],n[v][f+1],n[v][f+2])}}}}function g(a,b){for(var d=0;d<b.length;d+=2){for(var c=b[d],e=!0,f=[],g=C.og(a,c),k=0;k<g;k++){var n=C.Ug(a,c,k);if("B4W_REFLECT"==C.Va(a,n).type){var v=C.Xd(a,c,n,0),h=C.Xd(a,c,n,1);v&&1==v[1]||h&&1==h[1]?e=!1:f.push(c,n)}else e=!1}for(k=0;k<f.length;k+=2)g=a,v=f[k],n=f[k+1],h=C.Va(g,n),h.type+="_WORLD",C.Ak(g,v,n,0),h.L.splice(0,1),v=C.Si(g,n,0),v!=
C.$y&&(C.Xd(g,v,n,0)[1]=0);e&&C.rg(a,c)}}function Q(a,b,d,c,e,f){a=a.nodes;for(var g=null,k=0;k<a.length;k++){var n=a[k];e?"GROUP"==n.type&&n.node_tree_name==d&&(g=n):n.type==d&&(g=n)}return g?y(g,b)[0]:(f||va.error('No "'+d+'" node in node '+c),-1)}function t(a,b,d,c){return{name:a,type:b,inputs:d,outputs:c}}function aa(a,b,d,c,e){var f=b.name,g=b.type,k=[],n=[],h=[],l=[],t=null,u=[];switch(g){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":n=
ba(b);h=ea(b);va.warn(g+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":n=ba(b);h=ea(b);break;case "MIX_SHADER":n.push(O(b,"Fac"));var r=O(b,"Shader"),h=r.ab;n.push(r);(r=O(b,"Shader_001"))||(r=O(b,"Shader.001"));var p=r.ab;n.push(r);n.push(v("d_color1","d_color1",[0,0,0],h));n.push(v("d_roughness1","d_roughness1",0,h));n.push(v("s_color1","s_color1",[0,0,0],h));n.push(v("s_roughness1","s_roughness1",0,h));n.push(v("metalness1","metalness1",0,h));n.push(v("normal1",
"normal1",[0,0,0],h));n.push(v("e_color1","e_color1",[0,0,0],h));n.push(v("emission1","emission1",0,h));n.push(v("d_color2","d_color2",[0,0,0],p));n.push(v("d_roughness2","d_roughness2",0,p));n.push(v("s_color2","s_color2",[0,0,0],p));n.push(v("s_roughness2","s_roughness2",0,p));n.push(v("metalness2","metalness2",0,p));n.push(v("normal2","normal2",[0,0,0],p));n.push(v("e_color2","e_color2",[0,0,0],p));n.push(v("emission2","emission2",0,p));h=V(b,"Shader");r=h.ab;h=[h,v("d_color","d_color",[0,0,0],
r),v("d_roughness","d_roughness",0,r),v("s_color","s_color",[0,0,0],r),v("s_roughness","s_roughness",0,r),v("metalness","metalness",0,r),v("normal","normal",[0,0,0],r),v("e_color","e_color",[0,0,0],r),v("emission","emission",0,r)];break;case "OBJECT_INFO":var n=ba(b),h=[],r=V(b,"Location"),p=V(b,"Object Index"),L=V(b,"Material Index"),m=V(b,"Random");h.push(r);h.push(p);h.push(L);h.push(m);u.push(["USE_LOCATION_OUT",r.ab|0]);u.push(["USE_OBJ_IND_OUT",p.ab|0]);u.push(["USE_MAT_IND_OUT",L.ab|0]);u.push(["USE_RANDOM_OUT",
m.ab|0]);break;case "UVMAP":(r=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(t=S("param_"+g+"_a"),p=S("param_"+g+"_v"),k.push(ca(t)),k.push(ca(p)),l.push(ca(p)),t={name:t,value:r});h=ea(b);break;case "UV_MERGED":t=S("param_UV_MERGED_a");p=S("param_UV_MERGED_v");k.push(ca(t));k.push(ca(p));h.push(V(b,"UV_geom"));h.push(V(b,"UV_cycles"));l.push(ca(p));t={name:t,value:b.uv_layer};break;case "CAMERA":n=[];h=ea(b);break;case "COMBRGB":case "COMBHSV":n=ba(b);h=ea(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
g?(N(b,0,0)&&u.push(["READ_R",1]),N(b,1,0)&&u.push(["READ_G",1]),N(b,2,0)&&u.push(["READ_B",1]),N(b,3,0)&&u.push(["READ_A",1])):(N(b,0,-1)&&u.push(["READ_R",1]),N(b,1,-1)&&u.push(["READ_G",1]),N(b,2,-1)&&u.push(["READ_B",1]));n=ba(b);h=ea(b);t={value:b};break;case "PARTICLE_INFO":n=ba(b);h=ea(b);for(r=0;r<b.outputs.length;r++){p=b.outputs[r];L=p.identifier;m=ca("v_param_PART_INFO_"+L.replace(" ",""));if(p.is_linked)switch(L){case "Size":u.push(["PART_INFO_SIZE",ta.M(1)]);break;case "Age":u.push(["PART_INFO_AGE",
ta.M(1)]);break;case "Lifetime":u.push(["PART_INFO_LT",ta.M(1)]);break;case "Location":u.push(["PART_INFO_LOC",ta.M(1)]);break;case "Index":var y=ca("a_param_PART_INFO_"+p.identifier.replace(" ","")),t=y;u.push(["PART_INFO_IND",ta.M(1)]);break;case "Velocity":u.push(["PART_INFO_VEL",ta.M(1)]);break;case "Angular Velocity":u.push(["PART_INFO_A_VEL",ta.M(1)])}"Age"!=L&&"Lifetime"!=L&&"Size"!=L&&(k.push(m),l.push(m))}y&&k.push(y);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!X(b))return!0;g=H(b,d);if(!g)return va.error("Geometry output is not supported"),
null;switch(g){case "GEOMETRY_UV":(r=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(t=S("param_GEOMETRY_UV_a"),p=S("param_GEOMETRY_UV_v"),k.push(ca(t)),k.push(ca(p)),l.push(ca(p)),t={name:t,value:r});h.push(V(b,"UV"));break;case "GEOMETRY_VC":(r=b.color_layer)||(g="EMPTY_VC");"EMPTY_VC"!=g&&(t=S("param_GEOMETRY_VC_a"),p=S("param_GEOMETRY_VC_v"),k.push(ca(t)),k.push(ca(p)),l.push(ca(p)),t={name:t,value:r});h.push(V(b,"Vertex Color"));break;case "GEOMETRY_NO":h.push(V(b,"Normal"));break;case "GEOMETRY_TRN":g=
"GEOMETRY_NO";h.push(V(b,"True Normal"));va.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":h.push(V(b,"Front/Back"));break;case "GEOMETRY_VW":h.push(V(b,"View"));break;case "GEOMETRY_GL":h.push(V(b,"Global")||V(b,"Position"));break;case "GEOMETRY_LO":h.push(V(b,"Local"));break;case "GEOMETRY_OR":r=S("param_GEOMETRY_OR_v");k.push(ca(r));h.push(V(b,"Orco"));l.push(ca(r));break;case "GEOMETRY_IN":h.push(V(b,"Incoming"));break;case "GEOMETRY_BF":h.push(V(b,"Backfacing"))}break;
case "TEX_COORD":if(!X(b))return!0;g=ma(b,d);switch(g){case "TEX_COORD_UV":(r=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(t=S("param_TEX_COORD_UV_a"),p=S("param_TEX_COORD_UV_v"),k.push(ca(t)),k.push(ca(p)),l.push(ca(p)),t={name:t,value:b.uv_layer});h.push(V(b,"UV"));break;case "TEX_COORD_NO":h.push(V(b,"Normal"));break;case "TEX_COORD_GE":r=S("param_TEX_COORD_GE_v");k.push(ca(r));h.push(V(b,"Generated"));l.push(ca(r));break;case "TEX_COORD_OB":h.push(V(b,"Object"));break;case "TEX_COORD_CA":h.push(V(b,
"Camera"));break;case "TEX_COORD_WI":h.push(V(b,"Window"));break;case "TEX_COORD_RE":h.push(V(b,"Reflection"))}break;case "GROUP":r=b.node_tree_name;switch(r){case "B4W_LINEAR_TO_SRGB":if(!M(b,[1],[1])){t=G(b,c,e);break}g="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!M(b,[1],[1])){t=G(b,c,e);break}g="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!M(b,[1],[1])){t=G(b,c,e);break}g="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!M(b,[1,1],[1])){t=G(b,c,e);break}g=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!M(b,[1,0],[1])){t=G(b,c,e);break}g="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!M(b,[1,1,0,0,0],[1])){t=G(b,c,e);break}p=S("param_B4W_PARALLAX_texture");l.push(ca(p));g="B4W_PARALLAX";break;case "B4W_CLAMP":if(!M(b,[1],[1])){t=G(b,c,e);break}g="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!M(b,[0,0,0,0,0],[0])){t=G(b,c,e);break}g="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!M(b,[],[0])){t=G(b,c,e);break}g="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!M(b,
[0,0,0],[0])){t=G(b,c,e);break}g="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":g="B4W_GLOW_OUTPUT";break;default:t=G(b,c,e)}n=ba(b);h=ea(b);"B4W_TRANSLUCENCY"==r&&(r=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),r.ab=h[0].ab,h.push(r));break;case "LAMP":t=b.lamp;if(!t)return va.error("There is no lamp in node: "+b.name),null;h.push(V(b,"Color"));h.push(V(b,"Light Vector"));h.push(V(b,"Distance"));h.push(V(b,"Visibility Factor"));t.uuid in Ga?u.push(["LAMP_INDEX",String(Ga[t.uuid])]):(Ga[t.uuid]=
Qa,u.push(["LAMP_INDEX",String(Qa++)]));t=Ga;break;case "LIGHTING_AMBIENT":n=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0)];h=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":h=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("translucency_color",
"translucency_color",0,!0),v("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":n=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":n=[v("shadow_factor","shadow_factor",0,!0)];h=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac",
"norm_fac",0,!0)];h=[v("lfactor","lfactor",0,!0)];u.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("dif_params","dif_params",[0,0],!0)];h=[v("lfactor","lfactor",0,!0)];u.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":n=
[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];h=[v("sfactor","sfactor",0,!0)];u.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];h=[v("sfactor","sfactor",0,!0)];u.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0)];h=[v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":n=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0),v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0),v("ldir","ldir",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("translucency_params",
"translucency_params",[0,0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("translucency_color","translucency_color",0,!0)];h=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "NORMAL":n=ba(b);h=ea(b);r=V(b,"Normal");l.push(ca(S("param_NORMAL_Normal"),r.Da,3));break;case "MAPPING":r=b.vector_type;g="MAPPING";n.push(O(b,"Vector"));h.push(V(b,"Vector"));var p=Ca.Cf(b.rotation),L=Ca.Cf(b.scale),m=Ca.Cf(b.translation),y=ia.create(),
Y=Ca.sU(p);"TEXTURE"==r&&(L[0]=L[0]||1,L[1]=L[1]||1,L[2]=L[2]||1);var q=new Float32Array([L[0],0,0,0,L[1],0,0,0,L[2]]);ia.multiply(Y,q,y);y=Ca.jX(y,qa.create());switch(r){case "POINT":y[12]=m[0];y[13]=m[1];y[14]=m[2];break;case "TEXTURE":y[12]=m[0];y[13]=m[1];y[14]=m[2];y=qa.invert(y,y);break;case "NORMAL":qa.invert(y,y),qa.transpose(y,y)}switch(r){case "NORMAL":u.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":u.push(["MAPPING_TRS_MATRIX_DEF",1]);u.push(["MAPPING_TRS_MATRIX",ta.M(y,16)]);break;case "POINT":0!==
Ba.length(p)?(u.push(["MAPPING_TRS_MATRIX_DEF",1]),u.push(["MAPPING_TRS_MATRIX",ta.M(y,16)])):(0!==Ba.length(L)&&(u.push(["MAPPING_SCALE_DEF",1]),u.push(["MAPPING_SCALE",ta.M(L,3)])),0!==Ba.length(m)&&(u.push(["MAPPING_TRANS_DEF",1]),u.push(["MAPPING_TRANS",ta.M(m,3)])));break;case "VECTOR":0!==Ba.length(p)?(u.push(["MAPPING_TRS_MATRIX_DEF",1]),u.push(["MAPPING_TRS_MATRIX",ta.M(y,16)])):0!==Ba.length(L)&&(u.push(["MAPPING_SCALE_DEF",1]),u.push(["MAPPING_SCALE",ta.M(L,3)]))}b.use_min&&(u.push(["MAPPING_MIN_CLIP_DEF",
1]),u.push(["MAPPING_MIN_CLIP",ta.M(b.min,3)]));b.use_max&&(u.push(["MAPPING_MAX_CLIP_DEF",1]),u.push(["MAPPING_MAX_CLIP",ta.M(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":t=[];r=[];p=[];L=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0)];m=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),
v("normal","normal",[0,0,0],!0)];y=[V(b,"Color"),V(b,"Alpha"),V(b,"Normal")];Y=[];q=O(b,"Color");q.Da.splice(3);p.push(q);n.push(q);q=O(b,"Spec");q.Da.splice(3);p.push(q);n.push(q);(q=O(b,"DiffuseIntensity"))||(q=O(b,"Refl"));q.Da=b.diffuse_intensity;p.push(q);n.push(q);var Z=O(b,"Normal");Z.Da.splice(3);p.push(Z);n.push(Z);"MATERIAL_EXT"==g?((q=O(b,"Emit"))||(q=v("Emit","Emit",0)),p.push(q),n.push(q),(q=O(b,"Translucency"))?(q.Da=0,q.name="Translucency",q.identifier="Translucency"):q=v("Translucency",
"Translucency",0),n.push(q),(q=O(b,"Translucency"))?(q.Da=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams"):q=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),n.push(q),h=O(b,"Reflectivity"),q=O(b,"Ray Mirror"),h?(q=h,h="Reflectivity"):q?h="Ray Mirror":(q=h,h="Reflectivity"),q||(q=v(h,h,0)),n.push(q),m.push(q),(q=O(b,"SpecTra"))||(q=v("SpecTra","SpecTra",0)),n.push(q),m.push(q),(q=O(b,"Alpha"))||(q=v("Alpha","Alpha",b.alpha)),n.push(q),m.push(q),y.push(V(b,"Diffuse")),
y.push(V(b,"Spec")),t.push(["MATERIAL_EXT",1]),r.push(["MATERIAL_EXT",1])):(p.push(v("emit_intensity","emit_intensity",0)),m.push(v("reflect_factor","reflect_factor",0)),m.push(v("specular_alpha","specular_alpha",0)),m.push(v("alpha_in","alpha_in",0)),y.push(v("diffuse_out","diffuse_out",0)),y.push(v("spec_out","spec_out",0)),t.push(["MATERIAL_EXT",0]),r.push(["MATERIAL_EXT",0]));Y.push(ca(S("param_MATERIAL_alpha"),b.alpha));Y.push(ca(S("param_MATERIAL_spec_alpha"),b.specular_alpha));h=y;t.push(["USE_MATERIAL_NORMAL",
Z.ab|0]);b.use_diffuse&&(t.push(["USE_MATERIAL_DIFFUSE",1]),r.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&r.push(["USE_MATERIAL_SPECULAR",1]);var q=[],Q=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":Z=b.specular_hardness;break;case "WARDISO":Z=b.specular_slope;break;case "TOON":Z=b.specular_toon_size;Q=b.specular_toon_smooth;break;case "BLINN":Z=b.specular_ior;Q=b.specular_hardness;break;default:va.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),Z=b.specular_hardness}var z,B;switch(b.diffuse_shader){case "LAMBERT":B=z=0;break;case "OREN_NAYAR":z=b.roughness;B=0;break;case "FRESNEL":z=b.diffuse_fresnel;B=b.diffuse_fresnel_factor;break;case "MINNAERT":z=b.darkness;B=0;break;case "TOON":z=b.diffuse_toon_size;B=b.diffuse_toon_smooth;break;default:va.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),B=z=0}q.push(ca(S("param_MATERIAL_diffuse"),[z,B],2));q.push(ca(S("param_MATERIAL_spec"),[b.specular_intensity,
Z,Q],3));t.push(["SHADELESS_MAT",b.use_shadeless?1:0]);Z={name:b.name,value:{Ds:b.specular_shader,Nq:b.diffuse_shader,Je:b.use_shadeless,Wm:b.use_tangent_shading}};t={name:b.name,value:{Ds:b.specular_shader,Nq:b.diffuse_shader,Je:b.use_shadeless,Wm:b.use_tangent_shading},kX:{name:"material_begin",type:"MATERIAL_BEGIN",L:p,fb:L,rb:q,data:Z,Tb:t,oi:[]},lX:{name:"material_end",type:"MATERIAL_END",L:m,fb:y,rb:Y,data:Z,Tb:r,oi:[]}};break;case "BSDF_DIFFUSE":n=ba(b);u.push(["USE_NORMAL_IN",n[2].ab|0]);
h=V(b,"BSDF");r=h.ab;h=[h,v("d_color","d_color",[0,0,0],r),v("d_roughness","d_roughness",0,r),v("s_color","s_color",[0,0,0],r),v("s_roughness","s_roughness",0,r),v("metalness","metalness",0,r),v("normal","normal",[0,0,0],r),v("e_color","e_color",[0,0,0],r),v("emisson","emisson",0,r)];break;case "BSDF_GLOSSY":n=ba(b);u.push(["USE_NORMAL_IN",n[2].ab|0]);h=V(b,"BSDF");r=h.ab;h=[h,v("d_color","d_color",[0,0,0],r),v("d_roughness","d_roughness",0,r),v("s_color","s_color",[0,0,0],r),v("s_roughness","s_roughness",
0,r),v("metalness","metalness",1,r),v("normal","normal",[0,0,0],r),v("e_color","e_color",[0,0,0],r),v("emisson","emisson",0,r)];break;case "EMISSION":n=ba(b);h=V(b,"Emission");r=h.ab;h=[h,v("d_color","d_color",[0,0,0],r),v("d_roughness","d_roughness",0,r),v("s_color","s_color",[0,0,0],r),v("s_roughness","s_roughness",0,r),v("metalness","metalness",1,r),v("normal","normal",[0,0,0],r),v("e_color","e_color",[0,0,0],r),v("emisson","emisson",1,r)];break;case "MATH":switch(b.operation){case "ADD":g="MATH_ADD";
break;case "SUBTRACT":g="MATH_SUBTRACT";break;case "MULTIPLY":g="MATH_MULTIPLY";break;case "DIVIDE":g="MATH_DIVIDE";break;case "SINE":g="MATH_SINE";break;case "COSINE":g="MATH_COSINE";break;case "TANGENT":g="MATH_TANGENT";break;case "ARCSINE":g="MATH_ARCSINE";break;case "ARCCOSINE":g="MATH_ARCCOSINE";break;case "ARCTANGENT":g="MATH_ARCTANGENT";break;case "POWER":g="MATH_POWER";break;case "LOGARITHM":g="MATH_LOGARITHM";break;case "MINIMUM":g="MATH_MINIMUM";break;case "MAXIMUM":g="MATH_MAXIMUM";break;
case "ROUND":g="MATH_ROUND";break;case "LESS_THAN":g="MATH_LESS_THAN";break;case "GREATER_THAN":g="MATH_GREATER_THAN";break;case "MODULO":g="MATH_MODULO";break;case "ABSOLUTE":g="MATH_ABSOLUTE";break;default:return va.error("Unsupported MATH operation: "+b.operation),null}u.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);n=ba(b);h=ea(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":g="MIX_RGB_MIX";break;case "ADD":g="MIX_RGB_ADD";break;case "MULTIPLY":g="MIX_RGB_MULTIPLY";break;case "SUBTRACT":g=
"MIX_RGB_SUBTRACT";break;case "SCREEN":g="MIX_RGB_SCREEN";break;case "DIVIDE":g="MIX_RGB_DIVIDE";break;case "DIFFERENCE":g="MIX_RGB_DIFFERENCE";break;case "DARKEN":g="MIX_RGB_DARKEN";break;case "LIGHTEN":g="MIX_RGB_LIGHTEN";break;case "OVERLAY":g="MIX_RGB_OVERLAY";break;case "DODGE":g="MIX_RGB_DODGE";break;case "BURN":g="MIX_RGB_BURN";break;case "HUE":g="MIX_RGB_HUE";break;case "SATURATION":g="MIX_RGB_SATURATION";break;case "VALUE":g="MIX_RGB_VALUE";break;case "COLOR":g="MIX_RGB_COLOR";break;case "SOFT_LIGHT":g=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":g="MIX_RGB_LINEAR_LIGHT";break;default:return va.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}u.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);n=ba(b);h=ea(b);break;case "OUTPUT":n=ba(b);h=[];break;case "OUTPUT_MATERIAL":ba(b);n=O(b,"Surface");h=n.ab;t=[n,v("d_color","d_color",[0,0,0],h),v("d_roughness","d_roughness",0,h),v("s_color","s_color",[0,0,0],h),v("s_roughness","s_roughness",0,h),v("metalness","metalness",0,h),v("normal","normal",
[0,0,0],h),v("e_color","e_color",[0,0,0],h),v("emission","emission",0,h)];r=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];p=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),v("normal","normal",
[0,0,0],!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];L=[];n=t;h=L;t={name:b.name,value:{MR:"BSDF_COMPUTE"},KR:{name:"bsdf_begin",type:"BSDF_BEGIN",L:t,fb:r,rb:[],data:null,Tb:[],oi:[]},LR:{name:"bsdf_end",type:"BSDF_END",L:p,fb:L,rb:[],data:null,Tb:[],oi:[]}};break;case "RGB":r=b.name;r={name:"-1",value:r};l.push(r);h.push(V(b,"Color"));break;case "SEPRGB":case "SEPHSV":n=ba(b);h=ea(b);break;case "TEX_ENVIRONMENT":(r=
b.image)?(g="TEXTURE_ENVIRONMENT","NONE"==b.color_space?u.push(["NON_COLOR",1]):u.push(["NON_COLOR",0]),n.push(O(b,"Vector")),h.push(V(b,"Color")),p=S("param_TEXTURE_texture"),l.push(ca(p)),t=la.kH(128),t.source="ENVIRONMENT_MAP",la.RF(t,r),t={name:p,value:t}):g="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(r=b.image){g="TEXTURE_COLOR";"NONE"==b.color_space?u.push(["NON_COLOR",1]):u.push(["NON_COLOR",0]);u.push(["CONVERT_UV",0]);for(p=0;4>p;++p)p?(q=v("Vector"+p,"Vector"+p,[0,0,0],!1),L=v("Color"+p,"Color"+
p,[0,0,0],!1),m=v("Alpha"+p,"Alpha"+p,0,!1)):(q=O(b,"Vector"),L=V(b,"Color"),m=V(b,"Alpha")),n.push(q),h.push(L),h.push(m);p=S("param_TEXTURE_texture");l.push(ca(p));t=la.Jl(la.wh,!1);t.repeat="REPEAT"==b.extension;t.source="IMAGE";la.RF(t,r);t={Ez:b.name,name:p,value:t}}else g="TEXTURE_EMPTY";break;case "TEXTURE":g=W(b);if("TEXTURE_EMPTY"==g)h.push(V(b,"Color")),h.push(V(b,"Normal")),h.push(V(b,"Value"));else if("TEXTURE_ENVIRONMENT"==g)n.push(O(b,"Vector")),h.push(V(b,"Color")),h.push(V(b,"Value"));
else{if("TEXTURE_NORMAL"==g&&"ENVIRONMENT_MAP"==b.texture.type)return va.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==g&&(r=!1,(p=b.texture.image)&&"Non-Color"==p.colorspace_settings_name&&(r=!0),u.push(["NON_COLOR",Number(r)]),u.push(["CONVERT_UV",1]));for(p=0;4>p;++p)r="TEXTURE_COLOR"==g?"Color":"Normal",p?(q=v("Vector"+p,"Vector"+p,[0,0,0],!1),L=v(r+p,r+p,[0,0,0],!1),m=v("Value"+p,"Value"+p,0,!1)):(q=O(b,"Vector"),L=V(b,r),m=V(b,"Value")),n.push(q),h.push(L),
h.push(m)}"TEXTURE_EMPTY"!=g&&(p=S("param_TEXTURE_texture"),l.push(ca(p)),t=b.texture.s,t={Ez:b.texture.name,name:p,value:t});break;case "VALTORGB":n=ba(b);h=ea(b);t={value:b};r=b.color_ramp.interpolation;"CONSTANT"!=r&&"LINEAR"!=r&&va.warn("Color Ramp node is not fully supported.");break;case "VALUE":g="VALUE";r=b.name;r={name:"-1",value:r};l.push(r);h.push(V(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":g="VECT_MATH_ADD";break;case "SUBTRACT":g="VECT_MATH_SUBTRACT";break;case "AVERAGE":g=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":g="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":g="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":g="VECT_MATH_NORMALIZE";break;default:return va.error("Unsupported VECT_MATH operation: "+b.operation),null}n=ba(b);h=ea(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":u.push(["VECTOR_TYPE",ta.M(0)]);break;case "VECTOR":u.push(["VECTOR_TYPE",ta.M(1)]);break;case "NORMAL":u.push(["VECTOR_TYPE",ta.M(2)]);break;default:return va.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}n=b.convert_from;h=b.convert_to;r=0;if("WORLD"==n)if("WORLD"==h)r=0;else if("OBJECT"==h)r=1;else if("CAMERA"==h)r=2;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==n)if("WORLD"==h)r=3;else if("OBJECT"==h)r=4;else if("CAMERA"==h)r=5;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==n)if("WORLD"==h)r=6;else if("OBJECT"==h)r=7;else if("CAMERA"==h)r=8;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return va.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;u.push(["CONVERT_TYPE",ta.M(r)]);n=ba(b);h=ea(b);break;case "NORMAL_MAP":r=0;switch(b.space){case "TANGENT":r=0;break;case "OBJECT":r=1;break;case "WORLD":r=2;break;case "BLENDER_OBJECT":r=3;break;case "BLENDER_WORLD":r=4;break;default:return va.error("Unsupported NORMAL_MAP space: "+b.space),null}u.push(["SPACE",ta.M(r)]);n.push(O(b,"Strength"));n.push(O(b,"Color"));h.push(V(b,"Normal"));break;
case "FRESNEL":Z=O(b,"Normal");n.push(O(b,"IOR"));n.push(Z);h.push(V(b,"Fac"));u.push(["USE_FRESNEL_NORMAL",Z.ab|0]);break;case "LAYER_WEIGHT":Z=O(b,"Normal");n.push(O(b,"Blend"));n.push(Z);h=ea(b);u.push(["USE_NORMAL_IN",Z.ab|0]);break;case "BUMP":Z=O(b,"Normal"),u.push(["INVERT",b.invert?1:0]),u.push(["USE_NORMAL_IN",Z.ab|0]),ba(b),ea(b);default:n=ba(b),h=ea(b)}g={name:f,type:g,oi:k,L:n,fb:h,rb:l,data:t,Tb:u};f=C.Zl(a);C.Gj(a,C.Zl(a),g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{g=b.outputs;for(l=k=0;l<g.length;l++)if(g[l].is_linked&&k++>d){g=!0;break a}g=!1}g=!g}return g||null!=aa(a,b,++d,c,e)?f:null}function M(a,b,d){for(var c=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var k=c[g],h=b[g];if(!k||k.default_value instanceof Array!=h)return va.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<d.length;g++)if(b=e[g],c=d[g],!b||b.default_value instanceof Array!=c)return va.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function G(a,b,d){var c=a.node_group.node_tree,e={},f;for(f in c)if("links"==f||"nodes"==f){e[f]=[];for(var g=0;g<c[f].length;g++){e[f][g]={};for(var k in c[f][g])if("links"==f){e[f][g][k]={};for(var h in c[f][g][k])e[f][g][k][h]=T(c[f][g][k][h])}else e[f][g][k]=T(c[f][g][k])}}else e[f]=T(c[f]);c=a.node_tree_name;if("B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==c)f=t("Group input","GROUP_INPUT",[],a.inputs),g=t("Group output",
"GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==c&&(Aa.quality==ka.Gp||Aa.fI)?{from_node:f,from_socket:f.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:g,to_socket:g.inputs[0]},e.nodes=[f,g],e.links=[k];c=a.name;f=e.nodes;g=e.links;for(k=0;k<f.length;k++)f[k].name=pa(f[k].type,c,f[k].name);for(k=0;k<g.length;k++)g[k].from_node.name=pa(g[k].from_node.type,c,g[k].from_node.name),g[k].to_node.name=pa(g[k].to_node.type,c,g[k].to_node.name);
return{zX:l(e,a.node_group.uuid,!0,b,d).Wa,AX:e.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ca.sq(a):a}function S(a){ua[a]||(ua[a]=0);var b=a+"_"+ua[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ua[a]++;return b}function X(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function H(a,b){for(var d=a.outputs,c=0,e=0;e<d.length;e++){var f=d[e];if(f.is_linked&&!(c++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ma(a,b){for(var d=a.outputs,c=0,e=0;e<d.length;e++){var f=d[e];if(f.is_linked&&!(c++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function W(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,d=!1,c=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":d=!0;break;case "Normal":c=!0;break;case "Value":e=!0;break;default:Ca.q("Unknown texture output")}}if(d)return c&&
va.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(c)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function O(a,b){for(var d=a.inputs,c=0;c<d.length;c++){var e=d[c];if(e.identifier==b)return ga(e)}return null}function V(a,b){for(var d=a.outputs,c=0;c<d.length;c++){var e=d[c];if(e.identifier==b)return ga(e)}return null}function ga(a){var b=
a.name,d=a.identifier,c=a.is_linked;a=a.default_value;a=Ca.ik(a)?a.slice(0):a;return{name:b,identifier:d,ab:c,Da:a}}function v(a,b,d,c){return{name:a,identifier:b,ab:c,Da:d}}function ba(a){for(var b=[],d=0;d<a.inputs.length;d++){var c=ga(a.inputs[d]);c.Da.length&&c.Da.splice(3);b.push(c)}return b}function ea(a){for(var b=[],d=0;d<a.outputs.length;d++){var c=ga(a.outputs[d]);b.push(c)}return b}function ca(a,b,d){b=null===b||void 0===b?null:ta.M(b,d);return{name:a,value:b}}function na(a,b,d,c,e,f){var g=
[],k=f.from_socket.identifier;f=f.to_socket.identifier;var h=c.fb;for(c=0;c<h.length;c++)if(h[c].identifier==k){g.push(c);break}e=e.L;for(c=0;c<e.length;c++)if(e[c].identifier==f){g.push(c);break}2==g.length&&C.fd(a,b,d,g);return!0}function pa(a,b,d){return"GROUP_INPUT"==a?b+"*GI*"+d:"GROUP_OUTPUT"==a?b+"*GO*"+d:b+"%join%"+d}function L(a){var b=[];C.pa(a,function(a,d){"GROUP"==d.type&&b.push(d)});return b}function Y(a,b,d){for(var c=0;c<d.length;c++){var e=d[c].data.zX,f=d[c].data.AX;if(!e)return!1;
C.pa(e,function(b,d){C.Gj(a,C.Zl(a),d)});for(e=0;e<f.length;e++)b.push(f[e]);fa(d[c],b,a)}return!0}function xa(a,b,d,c,e,f){switch(a.type){case "GROUP":a.name==b&&c.push(d);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(d);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(d)}}function ya(a,b,d){for(var c=[],e=0;e<d.length;e++){for(var f=d[e],g=null,k=0;k<b.length;k++)if(f.from_socket.identifier==b[k].to_socket.identifier){g=b[k];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):
c.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return c}function oa(a,b){if(b.length)for(var d=b[0].from_node.name,c=0;c<a.length;c++)a[c].from_node.name==d&&b.push(a[c])}function Z(a,b,d,c){for(var e=0;e<c.length;e++){for(var f=c[e],g,k=0;k<d.L.length;k++)if(f.from_socket.identifier==d.L[k].identifier){g=d.L[k].Da;break}for(var k=f,h=b,n=g,v=y(k.to_node,h),l=0;l<v.length;l++)for(var t=C.Va(h,v[l]),r=0;r<t.L.length;r++){var u=t.L[r];if(u.identifier==k.to_socket.identifier){t=u.Da instanceof
Object?0:1;if((n instanceof Object?0:1)==t)u.Da=n;else switch(t){case 0:u=u.Da;u[0]=u[1]=u[2]=n;break;case 1:u.Da=(n[0]+n[1]+n[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function fa(a,b,d){for(var c=a.name,e=[],f=[],g=[],k=[],h=0;h<b.length;h++){var n=b[h];xa(n.from_node,c,n,e,g,k);xa(n.to_node,c,n,f,g,k)}f=ya(b,f,g);e=ya(b,k,e);oa(b,f);Z(b,d,a,f);if(e.length){var v;C.pa(d,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(c+"*GO*")||(v=b)});Z(b,d,v,e)}}function ha(a){var b=[],d=[];C.pa(a,
function(a,c){switch(c.type){case "VALTORGB":b.push(c);break;case "CURVE_VEC":case "CURVE_RGB":d.push(c)}});var c=0,e=a=null,f=b.length+d.length;if(b.length){a=la.wU(b,la.qO);for(var g=0;g<b.length;g++)b[g].Tb.push(["NODE_TEX_ROW",ta.M((c+.5)/f)]),c++}if(d.length)for(e=la.AU(d,la.FE),g=0;g<d.length;g++)d[g].Tb.push(["NODE_TEX_ROW",ta.M((c+.5)/f)]),c++;g=null;a&&e?(g=new Uint8Array(a.length+e.length),g.set(a),g.set(e,a.length)):g=a?a:e;a=g?la.jH(g,la.FE):null;for(g=0;g<b.length;g++)b[g].data.jb=a;
for(g=0;g<d.length;g++)d[g].data.jb=a}function N(a,b,d){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<d+.01&&a[0][1]<d+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ka=m("__config");m("__debug");var C=m("__graph"),ia=m("__mat3"),qa=m("__mat4"),ja=m("__objects"),va=m("__print"),ta=m("__shaders"),Ea=m("__scenes"),Ca=m("__util"),Ba=m("__vec3"),la=m("__textures"),ua={},wa={},Pa={},Ga={},Qa=0;new Float32Array(4);var Aa=ka.B;a.i2=0;a.yQ=1;a.xQ=2;a.wQ=3;a.h2=4;a.vQ=5;a.uQ=6;a.tQ=7;a.g2=8;a.iP=0;
a.hP=1;a.Z1=2;a.gP=3;a.Y1=4;a.aJ=function(a){return wa[a]};a.AS=function(a){delete wa[a]};a.IS=l;a.jA=function(a,d,c){var e=Ea.A();a=h(a,"MAIN",e.uuid);if(a in Pa)return Pa[a];var e=C.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=aa(e,f,0,d,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=aa(e,f,0,d,null);b(e,c,g,f,[[g,[8,10]],[g,[9,6]]],d);n(e);return Pa[a]=e};a.fu=function(a){var b=[],d={};ua={};var c=C.UD(a);C.pa(c,function(a,c){var e;e=[];for(var f=[],g=[],w=[],k=[],h=[],n=0;n<
c.L.length;n++){var v=c.L[n];if(v.ab)e.push(null),f.push(null);else{e.push(S("in_"+c.type+"_"+v.identifier.replace(/\./g,"")));var C=ta.M(v.Da,0);Aa.sD&&(0<=c.type.indexOf("MIX_RGB_")&&("Color1"==v.identifier||"Color2"==v.identifier||"Fac"==v.identifier)||0<=c.type.indexOf("MATH_")&&("Value"==v.identifier||"Value_001"==v.identifier||"Value.001"==v.identifier)||0<=c.type.indexOf("VECT_MATH_")&&("Vector_001"==v.identifier||"Vector.001"==v.identifier)||0<=c.type.indexOf("LIGHTING_APPLY")||0<=c.type.indexOf("MATERIAL_END")||
0<=c.type.indexOf("MATERIAL_BEGIN"))&&(v=C,v=v.replace(/(,)/g,"$1 "),v=v.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),v=v.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),C=v=v.replace(/\s+/g,""));f.push(C)}}for(n=0;n<c.fb.length;n++)v=c.fb[n],v.ab?g.push(null):g.push(S("out_"+c.type+"_"+v.identifier.replace(/\./g,"")));for(n=0;n<c.rb.length;n++)v=c.rb[n],w.push(v.name),k.push(v.value);for(n=0;n<c.oi.length;n++)h.push(c.oi[n].name);e={id:c.type,L:e,yB:f,fb:g,rb:w,mw:k,oi:h,Tb:JSON.parse(JSON.stringify(c.Tb))};
b.push(e);d[a]=e});C.vg(c,function(a,b,e){var f=C.Va(c,a);C.Va(c,b);var g=f.fb[e[0]];a=d[a].fb;b=d[b].L;f=a[e[0]]||S("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.OG=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var d=a.node_tree.nodes[b];if("GROUP"==d.type&&"B4W_GLOW_OUTPUT"==d.node_tree_name)return!0}return!1};a.ua=function(){for(var a in wa)delete wa[a];for(a in Pa)delete Pa[a];for(var b in Ga)delete Ga[b];Qa=0}};b4w.module.__debug=function(a,m){function l(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(){var a=n.bB();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=r;return b&&b.debug_view_mode==a.xp}function x(a,b,d){var c=n.bB(),e=0;if(c)for(d&&c.endQuery(),d=0;d<a.length;d++){var f=a[d],g=c.uI(f),k=I.getParameter(c.tI());g&&!k&&(e=c.vI(f)/1E6,b&&(e=D.mc(e,b,1,10)),a.splice(d,1),d--)}else e=performance.now()-
a.pop(),b&&(e=D.mc(e,b,1,10));return e}function q(a,b){A(a)||D.q("Structure assertion failed: invalid first object value");A(b)||D.q("Structure assertion failed: invalid second object value");h(a,b)||D.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.CB(a)||a instanceof Array)){for(var d in a)A(a[d])||D.q("Structure assertion failed: invalid value for key in the first object: "+d),d in b||D.q("Structure assertion failed: missing key in the first object: "+
d);for(d in b)A(b[d])||D.q("Structure assertion failed: invalid value for key in the second object: "+d),d in a||D.q("Structure assertion failed: missing key in the second object: "+d),h(a[d],b[d])||D.q("Structure assertion failed: incompatible types for key "+d)}}function A(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function h(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var d=a instanceof Array,c=b instanceof Array;if(d&&!c||!d&&c)return!1;
d=D.CB(a);c=D.CB(b);if(d&&!c||!d&&c)return!1}return!0}var z=m("__compat"),p=m("__config"),n=m("__extensions"),k=m("__graph"),u=m("__objects"),e=m("__print"),y=m("__scenes"),K=m("__subscene"),F=m("__textures"),J=m("__time"),D=m("__util"),R=p.B,E={},I=null,B={},P=[],d=-1,f=-1,r=null,g=null,Q=!1,t={};a.jt=0;a.fy=1;a.kt=2;a.ey=3;a.it=4;a.dy=5;a.cy=6;a.xp=7;a.Lf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),d;
for(d in b){var c=b[d];c in a&&(E[a[c]]=c)}I=a};a.IY=function(a){r=a};a.N4=function(){return r};a.FU=function(a,b,d,c,e){t[a]||(t[a]={qZ:b,Se:{}});d in t[a].Se||(t[a].Se[d]=c);e&&(t[a].Se[d]=0)};a.AG=function(){var a=0,b;for(b in t)for(var d in t[b].Se)a+=t[b].Se[d];return a};a.DM=function(){var a={},b;for(b in t)for(var d in t[b].Se){var c=t[b].Se[d];if(c){var f=t[b].qZ;f in a||(a[f]={VD:0,Se:{}});d in a[f].Se||(a[f].Se[d]=0);a[f].Se[d]+=c;a[f].VD+=c}}for(f in a){e.groupCollapsed(f,a[f].VD);for(d in a[f].Se)e.ae(d,
a[f].Se[d]);e.groupEnd()}};a.jL=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),d=0,c=0,f=u.Vb(y.Nh(),"MESH",u.nc),g=0;g<f.length;g++)for(var k=0;k<f[g].I.length;k++)for(var n=0;n<f[g].I[k].V.length;n++){var h=D.Eh(f[g].I[k].V[n]),l=h.hb.wg+"/"+h.hb.Ye;h["shaders_info.directives"]=h.hb.Ki;h["shaders_info.node_elements"]=h.hb.lg;delete h.hb;for(var t=0;t<b.length;t++)delete h[b[t]];
if(f[g].Ra)c++;else{d++;h.type in a||(a[h.type]={});l in a[h.type]||(a[h.type][l]={});for(var v in h)v in a[h.type][l]||(a[h.type][l][v]=[]),t=JSON.stringify(h[v]),-1==a[h.type][l][v].indexOf(t)&&a[h.type][l][v].push(t)}}e.group("Batches statistics:");e.ae("STATIC/DYNAMIC count:",d+"/"+c);e.group("STATIC batches diversity:");for(var r in a)for(l in a[r]){b=[];for(v in a[r][l])1<a[r][l][v].length&&b.push([v,a[r][l][v]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){e.groupCollapsed(r+" "+l);for(g=0;g<b.length;g++)e.ae(b[g][1].length,b[g][0],b[g][1]);e.groupEnd()}}e.groupEnd();e.groupEnd()};a.Qz=function(a){if(R.gl_debug){var b=I.getError();b!=I.NO_ERROR&&(b in E?D.q("GL Error: "+b+", gl."+E[b]+" ("+a+")"):D.q("Unknown GL error: "+b+" ("+a+")"))}};a.hS=function(){if(R.gl_debug||R.NG)switch(I.checkFramebufferStatus(I.FRAMEBUFFER)){case I.FRAMEBUFFER_COMPLETE:break;case I.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case I.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case I.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case I.FRAMEBUFFER_UNSUPPORTED:e.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case I.S0:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:e.error("FRAMEBUFFER CHECK FAILED")}};a.lS=function(){if(-1!=
d)return d;I.bindFramebuffer(I.FRAMEBUFFER,I.createFramebuffer());var a=F.Jl(F.ll,!1);F.resize(a,1,1);I.framebufferTexture2D(I.FRAMEBUFFER,I.DEPTH_ATTACHMENT,a.nb,a.sb,0);I.checkFramebufferStatus(I.FRAMEBUFFER)!=I.FRAMEBUFFER_COMPLETE?(d=!0,e.warn("depth-only issue was found")):d=!1;I.bindFramebuffer(I.FRAMEBUFFER,null);return d};a.rS=function(){if(1==R.Fc)return!1;if(-1!=f)return f;I.bindRenderbuffer(I.RENDERBUFFER,I.createRenderbuffer());I.renderbufferStorageMultisample(I.RENDERBUFFER,R.Fc,I.RGBA8,
1,1);var a=I.getRenderbufferParameter(I.RENDERBUFFER,I.RENDERBUFFER_SAMPLES);a!=R.Fc?(f=!0,e.warn("multisample issue was found: requested "+R.Fc+", got "+a),I.getError()==I.INVALID_OPERATION&&e.warn("the error from multisample issue detected, ignoring")):f=!1;I.bindRenderbuffer(I.RENDERBUFFER,null);return f};a.oS=function(){return z.Rz("Firefox")&&I.getError()==I.OUT_OF_MEMORY?(e.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.AL=function(a,b,d){R.gl_debug&&(d=l(d),e.error("shader compilation failed:\n"+
d+"\n"+I.getShaderInfoLog(a)+" ("+b+")"))};a.oY=function(a,b,d,c){R.gl_debug&&(d=l(d),c=l(c),e.error("shader linking failed:\n"+d+"\n\n\n"+c+"\n"+I.getProgramInfoLog(a)+" ("+b+")"))};a.SC=function(a){if(R.show_hud_debug_info||a.type==K.Ep)a.GA||a.Ll.push(c())};a.jY=function(a){"MAIN"==a.type&&b()&&a.Ll.push(c())};a.TC=function(a){if((R.show_hud_debug_info||a.type==K.Ep)&&!a.GA){var b=x(a.Ll,a.Af,!0);b&&(a.Af=b)}};a.kY=function(a){if("MAIN"==a.type&&b()){var d=x(a.Ll,a.Af,!0);d&&(a.Af=d)}};a.bK=b;
a.YX=function(a){var b=x(a.Ll,a.Af,!1);b&&(a.Af=b)};a.a4=function(a){B[a]=a in B?B[a]+1:1};a.update=function(){for(var a in B)e.log(a,B[a]),B[a]=0};a.Hu=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var d=arguments[b];if(D.ik(d))for(var c=0;c<d.length;c++)a.push(d[c]);else a.push(arguments[b])}P.push(a)};a.GK=function(){for(var a=1,b=0;b<P.length;b++){var d=P[b];d[1]==arguments[0]&&a++}d=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.ik(a))for(var c=0;c<a.length;c++)d.push(a[c]);
else d.push(arguments[b]);P.push(d)};var aa=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.kL=function(a){a||(a=1);for(var b=0,d={},c=Math.max(0,performance.now()-1E3*a),f=0;f<P.length;f++){var g=P[f];a=g[0];if(!(a<c)){var k=String(g[1]);d[k]||(d[k]=aa[b++%aa.length]);a=["%c"+(a/1E3).toFixed(6),d[k],k];for(k=2;k<g.length;k++)a.push(g[k]);e.log.apply(this,a)}}P.splice(0)};a.CC=function(a){a||(a=1);for(var b={},d=Math.max(0,performance.now()-1E3*a),c=0;c<P.length;c++){var f=
P[c];a=f[0];if(!(a<d))for(var g=2;g<f.length;g++){var k=String(f[1]);3<f.length&&(k+="_"+String(g-2));b[k]||(b[k]=k+"\n");b[k]+=String(a)+" "+f[g]+"\n"}}a="";for(k in b)a+=b[k]+"\n\n";e.log(a);P.splice(0)};a.V2=function(a){function b(a){return-1<d.indexOf(a)?!0:!1}var d=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.MG=function(a){if(D.ik(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.B2=function(a,b){a.constructor!=b&&D.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.D2=q;a.E2=function(a){Q?q(a,g):Q=!0;g=null!=a&&"object"==typeof a?D.sq(a):a};a.cI=function(a,
b,d,c,e){(a=a||null)||D.q("Stage load callback is undefined");b=b||5E3;d=d||0;c=c||100;100<c&&D.q("Max percentage must be less than 100");0>d&&D.q("Min percentage must be greater than 0");d>c&&D.q("Max percentage must be greater than min percentage");var f=J.Fj(d,c,b,function(b){b=b.toFixed();a(b);100==b&&(J.tn(f),e&&e())})};a.m7=function(a){return k.WT(a,function(a,b){var d=b.type+"("+b.name+")",c=b.L,d=d+"\n\nINPUTS:";if(c.length)for(var e=0;e<c.length;e++)d+="\n"+c[e].identifier+": ",d=c[e].ab?
d+"linked":d+c[e].Da;else d+="\n---";c=b.fb;d+="\n\nOUTPUTS:";if(c.length)for(e=0;e<c.length;e++)d+="\n"+c[e].identifier+": ",d=c[e].ab?d+("linked(default "+c[e].Da+")"):d+"not used";else d+="\n---";e="";switch(b.type){case "GEOMETRY_UV":e="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":e="\ntexture: "+b.data.value.name+"\n("+b.data.value.Tn+")"}""==e&&(e="\n---");return d=d+"\n\nDATA:"+e},function(b,d,c){b=k.Va(a,b);d=k.Va(a,d);return b.fb[c[0]].identifier+"\n==>\n"+
d.L[c[1]].identifier})};a.Su=function(){return I};a.ua=function(){r=null;t={}};a.reset=function(){I=null}};b4w.module.__compat=function(a,m){function l(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var x=m("__config"),q=m("__debug"),A=m("__extensions"),
h=m("__print"),z=m("__renderer"),p="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.$E=256;var n=x.ql,k=x.B,u=x.Lq,e=x.context,y=x.Fi,K=x.X,F=x.C,J=x.Pd;a.aU=function(a){a.getError()==a.INVALID_ENUM&&h.warn("Possible Tegra invalid enum issue detected, ignoring")};a.fM=function(m,R){function E(a){R&&h.warn(a)}y.mX=m.getParameter(m.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
y.Rv=m.getParameter(m.MAX_FRAGMENT_UNIFORM_VECTORS);y.YB=m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS);y.Sv=m.getParameter(m.MAX_VARYING_VECTORS);y.ZB=m.getParameter(m.MAX_VERTEX_ATTRIBS);y.EK=m.getParameter(m.MAX_VERTEX_TEXTURE_IMAGE_UNITS);y.Mr=m.getParameter(m.MAX_VERTEX_UNIFORM_VECTORS);y.$i=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE);y.VB=m.getParameter(m.MAX_RENDERBUFFER_SIZE);y.Ec=m.getParameter(m.MAX_TEXTURE_SIZE);y.$B=m.getParameter(m.MAX_VIEWPORT_DIMS);k.gc&&!u.enabled&&(k.zq=!0);k.gc?(k.Fc=
Math.min(k.Fc,m.getParameter(m.MAX_SAMPLES)),l("Firefox")&&(E("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),k.NG=!0),l("Windows")&&l("Chrome")&&(E("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),k.Fc=1)):k.Fc=1;l("Firefox")&&"NONE"!==k.stereo&&(E("Firefox and Stereo rendering detected, disable texture reusage"),k.dI=!0);if(k.gc&&q.rS()||l("Firefox"))E("Firefox detected, disabling multisample"),k.Fc=1;z.LY();var I=Boolean(A.qV());
l("Firefox/28.0")&&(l("Linux")||l("Macintosh"))&&(E("Firefox 28 detected, applying depth hack"),I=!1);l("Windows Phone")||(l("iPad")||l("iPhone")?(E("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),e.alpha||(k.background_color[3]=1),k.IL=!0,k.aO=!0,k.smaa=!1,k.ssao=!1,k.precision="highp",k.xB=!0,Boolean(A.hJ())&&J.ww&&(k.Aq="pvr")):l("Mac OS X")&&l("Safari")&&
!l("Chrome")&&(E("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),k.HL=!0,K.eG=!0,K.UG=!0));l("Windows")&&(l("Chrome/40")||l("Firefox/33")||l("Firefox/34")||l("Firefox/35")||l("Firefox/36"))&&(E("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),k.Uz=!0);l("Chrome")&&!c()&&x.YJ()&&(E('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
k.TG=!0);l("Mac OS X")&&(k.Pv=!0,E("OS X detected, applying shadows hack."));c()&&(E("Mobile detected, applying various hacks for video textures."),k.is_mobile_device=!0,l("iPad")||l("iPhone")||l("Windows Phone")||(E("Mobile (not iOS) detected, disable playback rate for video textures."),K.SH=!0));(l("Firefox/35.0")||l("Firefox/36.0"))&&l("Windows")&&(E("Windows/Firefox 35/36 detected, applying shadows slink hack"),k.CM=!0);if(l("iPhone")||b()||l("Edge"))E("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
k.rs=!0;10>y.Sv&&(E("Not enough varyings, disable shadows on blend objects"),k.EA=!0);l("Windows Phone")&&(E("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),k.debug_view=!1,k.precision="highp",k.Ui=!1,k.ssao=!1,k.smaa=!1,k.shadows=!1,k.reflections=!1,k.refractions=!1,k.oL=!1);if(l("UCBrowser")||l("Chrome")&&l("Nexus")&&k.is_mobile_device)E("Mobile Nexus Chrome or UCBrowser detected, disable workers."),F.Vs=!1;var B=A.Wu();if(B){var P=
m.getParameter(B.UNMASKED_VENDOR_WEBGL),B=m.getParameter(B.UNMASKED_RENDERER_WEBGL),d=/\b4\d{2}\b/;-1<P.indexOf("ARM")&&d.test(B)&&(E("ARM Mali-400 series detected, applying depth and frames blending hacks"),I=!1,n.jI=!0);-1<P.indexOf("ARM")&&-1<B.indexOf("Mali-T604")&&(E('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),k.precision="highp",k.shadows=!1);-1<P.indexOf("ARM")&&-1<B.indexOf("Mali-T760")&&(E('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),k.precision=
"highp",k.ssao=!1,k.Yw=!0,k.gc&&(k.Fc=1,E("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<P.indexOf("Qualcomm")&&-1<B.indexOf("Adreno")&&(E("Qualcomm Adreno detected, applying shader constants hack."),k.sD=!0,-1<B.indexOf("305")&&(E('Qualcomm Adreno305 detected, set "highp" precision.'),k.precision="highp"),-1<B.indexOf("330")&&(E('Qualcomm Adreno330 detected, set "highp" precision.'),k.precision="highp"),-1<B.indexOf("420")&&(E("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
y.Ec=4096,y.$i=4096));-1<P.indexOf("NVIDIA")&&-1<B.indexOf("Tegra 3")&&(E("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),k.fI=!0);l("Windows")&&l("Chrome")&&!l("Edge")&&(B.match(/NVIDIA GeForce 8..0/)||B.match(/NVIDIA GeForce 9..0/)||B.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(E("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),y.$i=a.$E,k.XC=!0);-1<B.indexOf("AMD")&&l("Windows")&&l("Chrome")&&
(k.oz=!0);-1<B.indexOf("PowerVR")&&(E("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),k.XC=!0,k.Yw=!0,k.shadows=!1);P="";for(d=0;d<p.length;d++)if(-1<B.indexOf(p[d])){P=p[d];break}P&&(E("Architecture "+P+" detected. Blending between frames and shadows on blend objects will be disabled."),k.Yw=!0,k.EA=!0)}0==y.EK&&(E("Vertex textures are not allowed. Disabling vertex textures"),k.Nt=!1);I||(k.Xq=!1,k.jd=!1,k.water_dynamic=
!1,k.Hk=!1,k.Ww=!1,k.smaa=!1);k.MN=Boolean(A.lJ())||"pvr"==k.Aq;k.xu=I;if(m.getShaderPrecisionFormat)var f=m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.HIGH_FLOAT);m.getShaderPrecisionFormat&&0!==f.precision||(k.precision="mediump");if(b()&&l("Touch")||l("Edge"))E("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),k.Sn=!0;if(b()||l("Edge"))k.TJ=!0;c()&&l("Firefox")&&(h.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
k.bC=!0,y.Ec=4096,y.$i=4096);l("Edge")&&(E("Microsoft Edge detected, set up new minimal texture size."),k.Tq=!0)};a.Rz=l;a.Cn=c;a.gR=function(){l("Firefox/35.0")&&l("Windows")&&(h.warn("Windows/Firefox 35 detected, forcing context's alpha"),x.context.alpha=!0)};a.Br=b};b4w.module.__renderer=function(a,m){function l(a){for(var c=a.p,f=a.Qa,g=null,h=K.jc(c.n,aa),n=0;n<f.length;n++){var l=f[n];if(l.dc){var r=l.zb,l=l.sa;if(r.$h!=g){d.useProgram(r.$h);for(var g=a,v=c,u=r,m=u.xN,y=m.length;y--;){var Q=m[y];Q.On(d,Q.ef,g,v)}if(u.Pr&&!u.bw)for(u.yC.length||q(u),u=u.yC,y=u.length;y--;)Q=u[y],Q.On(d,Q.ef,g,v);g=r.$h}for(v=0;v<l.length;v++)if(m=l[v],m.dc){u=m.gf;y=m.za;p.jY(y);p.bK()&&"DEBUG_VIEW"==y.type&&(y.Jq=F.mc(A.wR(y.An),y.Jq,1,15));if(T.alpha_sort&&y.rf){var Q=u,
m=m.vv,z=h,L=y.Ba,Y=D.dist(z,m.nO),B=T.alpha_sort_threshold*Math.min(m.zR,1);if(Y>B||Q.ar)k.A_(L,m,Q.n,z),D.copy(z,m.nO),Q.ar=!1}Q=a;m=y;z=r;B=z.yN;for(L=B.length;L--;)Y=B[L],Y.On(d,Y.ef,u,m);if(z.Pr&&!z.bw){z.Xr.length||q(z);B=z.Xr;for(L=B.length;L--;)Y=B[L],Y.On(d,Y.ef,u,m);z.Pr=!1}d.depthMask(m.Ua);m.$b?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE);L=m.ya;Y=d;for(B=0;B<L.length;B++){var I=L[B];Y.activeTexture(Y.TEXTURE0+B);Y.bindTexture(I.nb,I.sb)}if(Q.type==e.Bg){u=Q;z=z.Rm;L=u.p.vc.sb;Y=u.Kl;
for(B=0;6>B;B++)if(I=b(B),T.Uz?(d.bindTexture(d.TEXTURE_CUBE_MAP,L),d.texImage2D(I,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,P)):(d.uniformMatrix4fv(z.u_cube_view_matrix,!1,Y[B]),d.uniform4fv(z.u_sky_tex_fac,u.cx),d.uniform3fv(z.u_sky_tex_color,u.ax),d.uniform1f(z.u_sky_tex_dvar,u.bx),d.uniform3fv(z.u_horizon_color,u.je),d.uniform3fv(z.u_zenith_color,u.te),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,I,L,0),t(m,0)),u.$v&&3!=B){var I=u,x=B,Z=G;T.Uz?Z.set(P):(d.readPixels(191,191,1,1,d.RGBA,
d.UNSIGNED_BYTE,Z),255!=Z[0]&&255!=Z[1]&&255!=Z[2]||d.readPixels(191,220,1,1,d.RGBA,d.UNSIGNED_BYTE,Z));var fa=Z[0],ha=Z[1],Z=Z[2],fa=fa/255,ha=ha/255,Z=Z/255;2===x?(I.ye[3]=fa,I.ye[7]=ha,I.ye[11]=Z):2>x?(I.ye[4*x]=fa,I.ye[4*x+1]=ha,I.ye[4*x+2]=Z):(I.ye[4*(x-2)]=fa,I.ye[4*(x-2)+1]=ha,I.ye[4*(x-2)+2]=Z)}Q.Kq+=6}else t(m,u.yx),Q.Kq++;p.kY(y);p.bK()&&"MAIN"==y.type&&A.xR(y.id,y.Af)}}}}function c(a){if(a){var b=(a.wb?d.COLOR_BUFFER_BIT:0)|(a.Bb?d.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case e.ge:a=
B;break;case e.dd:a=R;break;case e.wf:a=E;break;case e.sf:case e.si:case e.cn:a=I;break;case e.Ag:case e.Ip:case e.Ct:a=B;break;default:a=T.background_color}}else b=d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT,a=T.background_color;d.colorMask(!0,!0,!0,!0);d.depthMask(!0);d.clearColor(a[0],a[1],a[2],a[3]);d.clear(b)}function b(a){switch(a){case 0:return d.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return d.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return d.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return d.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return d.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return d.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function x(a){var b=n.mB(),c=a.Wp,e=a.Ba,f=e.ld;a.Le.length=0;var g=1,k;for(k in f)g=Math.max(g,f[k].frames);for(f=0;f<g;f++){k=b.createVertexArray();Q(k);e.eg&&d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,e.eg);for(var h=0;h<e.Md.length;h++){d.bindBuffer(d.ARRAY_BUFFER,e.Md[h].Wk);for(var v=0;v<c.length;v++){var l=c[v];l.XN==e.Md[h].type&&(d.enableVertexAttribArray(l.ef),d.vertexAttribPointer(l.ef,l.Kc,l.bv,l.bv==d.FLOAT?
!1:!0,l.Pm,l.gG+l.hI*f),r(l.ef,l.Qq))}}Q(null);a.Le.push(k)}}function q(a){var b=a.Rm,d=a.yN,c=a.Xr,e=a.xN,f=a.yC;d.length=0;c.length=0;e.length=0;f.length=0;for(var g in b){var k=!1,h=null,n=null;switch(g){case "u_proj_matrix":h=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.xb)};k=!0;break;case "u_view_refl_matrix":h=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.Dx)};k=!0;break;case "u_view_tsr":case "u_view_tsr_frag":h=function(a,b,d,c){c.qc?a.uniformMatrix3fv(b,!1,c.gs):a.uniformMatrix3fv(b,!1,c.pf)};
k=!0;break;case "u_view_tsr_inverse":h=function(a,b,d,c){c.qc?a.uniformMatrix3fv(b,!1,c.Aw):a.uniformMatrix3fv(b,!1,c.Ex)};k=!0;break;case "u_shadow_cast_billboard_view_tsr":h=function(a,b,d,c){a.uniformMatrix3fv(b,!1,c.ys)};k=!0;break;case "u_view_proj_prev":h=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.FC)};k=!0;break;case "u_view_proj_matrix":h=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.md)};k=!0;break;case "u_view_proj_inverse":h=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.Cx)};k=!0;break;case "u_sky_vp_inverse":h=
function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.tg)};k=!0;break;case "u_camera_eye":case "u_camera_eye_frag":h=function(a,b,d,c){a.uniform3fv(b,K.jc(c.n,aa))};k=!0;break;case "u_camera_quat":h=function(a,b,d,c){a.uniform4fv(b,K.Yd(c.n,M))};k=!0;break;case "u_view_max_depth":h=function(a,b,d,c){a.uniform1f(b,c.far)};k=!0;break;case "u_camera_range":h=function(a,b,d,c){a.uniform2f(b,c.near,c.far)};break;case "u_csm_center_dists":h=function(a,b,d,c){a.uniform4fv(b,c.pu)};break;case "u_height":h=function(a,
b,d,c){a.uniform1f(b,c.height)};k=!0;break;case "u_pcf_blur_radii":h=function(a,b,d,c){a.uniform4fv(b,c.so)};break;case "u_dof_dist":h=function(a,b,d,c){c.dof_on?a.uniform1f(b,c.dof_distance):a.uniform1f(b,0)};k=!0;break;case "u_dof_front_start":h=function(a,b,d,c){a.uniform1f(b,c.dof_front_start)};k=!0;break;case "u_dof_front_end":h=function(a,b,d,c){a.uniform1f(b,c.dof_front_end)};k=!0;break;case "u_dof_rear_start":h=function(a,b,d,c){a.uniform1f(b,c.dof_rear_start)};k=!0;break;case "u_dof_rear_end":h=
function(a,b,d,c){a.uniform1f(b,c.dof_rear_end)};k=!0;break;case "u_dof_bokeh_intensity":h=function(a,b,d,c){a.uniform1f(b,c.dof_bokeh_intensity)};k=!0;break;case "u_camera_direction":h=function(a,b,d,c){a.uniform3fv(b,c.direction)};k=!0;break;case "u_cam_water_depth":h=function(a,b,d){a.uniform1f(b,d.Mz)};k=!0;break;case "u_waves_height":h=function(a,b,d){a.uniform1f(b,d.rE)};break;case "u_waves_length":h=function(a,b,d){a.uniform1f(b,d.sE)};break;case "u_fog_color_density":h=function(a,b,d){a.uniform4fv(b,
d.Ae)};break;case "u_fog_params":h=function(a,b,d){a.uniform4fv(b,d.ag)};break;case "u_underwater_fog_color_density":h=function(a,b,d){a.uniform4fv(b,d.pi)};break;case "u_bloom_key":h=function(a,b,d){a.uniform1f(b,d.Zt)};break;case "u_bloom_edge_lum":h=function(a,b,d){a.uniform1f(b,d.Yt)};break;case "u_time":h=function(a,b,d){a.uniform1f(b,d.time)};k=!0;break;case "u_wind":h=function(a,b,d){a.uniform3fv(b,d.yj)};k=!0;break;case "u_sky_tex_dvar":h=function(a,b,d){a.uniform1f(b,d.bx)};break;case "u_sky_tex_fac":h=
function(a,b,d){a.uniform4fv(b,d.cx)};break;case "u_sky_tex_color":h=function(a,b,d){a.uniform3fv(b,d.ax)};break;case "u_horizon_color":h=function(a,b,d){a.uniform3fv(b,d.je)};break;case "u_zenith_color":h=function(a,b,d){a.uniform3fv(b,d.te)};break;case "u_environment_energy":h=function(a,b,d){a.uniform1f(b,d.Pg)};break;case "u_sky_color":h=function(a,b,d){a.uniform3fv(b,d.Oo)};break;case "u_rayleigh_brightness":h=function(a,b,d){a.uniform1f(b,d.rayleigh_brightness)};break;case "u_mie_brightness":h=
function(a,b,d){a.uniform1f(b,d.mie_brightness)};break;case "u_spot_brightness":h=function(a,b,d){a.uniform1f(b,d.spot_brightness)};break;case "u_scatter_strength":h=function(a,b,d){a.uniform1f(b,d.scatter_strength)};break;case "u_rayleigh_strength":h=function(a,b,d){a.uniform1f(b,d.rayleigh_strength)};break;case "u_mie_strength":h=function(a,b,d){a.uniform1f(b,d.mie_strength)};break;case "u_rayleigh_collection_power":h=function(a,b,d){a.uniform1f(b,d.rayleigh_collection_power)};break;case "u_mie_collection_power":h=
function(a,b,d){a.uniform1f(b,d.mie_collection_power)};break;case "u_mie_distribution":h=function(a,b,d){a.uniform1f(b,d.mie_distribution)};break;case "u_light_positions":h=function(a,b,d){a.uniform4fv(b,d.Jr)};break;case "u_light_directions":h=function(a,b,d){a.uniform3fv(b,d.OB)};break;case "u_light_color_intensities":h=function(a,b,d){a.uniform4fv(b,d.Ir)};break;case "u_sun_quaternion":h=function(a,b,d){a.uniform4fv(b,d.cN)};break;case "u_sun_intensity":h=function(a,b,d){a.uniform3fv(b,d.bN)};
break;case "u_sun_direction":h=function(a,b,d){a.uniform3fv(b,d.HD)};break;case "u_debug_view_mode":h=function(a,b,d){a.uniform1i(b,d.debug_view_mode)};break;case "u_debug_colors_seed":h=function(a,b,d){a.uniform1f(b,d.debug_colors_seed)};break;case "u_debug_render_time_threshold":h=function(a,b,d){a.uniform1f(b,d.KH)};break;case "u_subpixel_jitter":h=function(a,b,d){a.uniform2fv(b,d.BW)};k=!0;break;case "u_subsample_indices":h=function(a,b,d){a.uniform4fv(b,d.DW)};k=!0;break;case "u_radial_blur_step":h=
function(a,b,d){a.uniform1f(b,d.zw)};break;case "u_god_rays_intensity":h=function(a,b,d){a.uniform1f(b,d.god_rays_intensity)};break;case "u_ssao_radius_increase":h=function(a,b,d){a.uniform1f(b,d.To)};break;case "u_ssao_blur_discard_value":h=function(a,b,d){a.uniform1f(b,d.ssao_blur_discard_value)};k=!0;break;case "u_ssao_influence":h=function(a,b,d){a.uniform1f(b,d.So)};break;case "u_ssao_dist_factor":h=function(a,b,d){a.uniform1f(b,d.Ro)};break;case "u_texel_size":h=function(a,b,d){a.uniform2fv(b,
d.RD)};k=!0;break;case "u_normal_offset":h=function(a,b,d){a.uniform1f(b,d.self_shadow_normal_offset)};break;case "u_v_light_ts":h=function(a,b,d){a.uniform4fv(b,d.xx)};k=!0;break;case "u_v_light_r":h=function(a,b,d){a.uniform4fv(b,d.wx)};k=!0;break;case "u_v_light_tsr":h=function(a,b,d){a.uniformMatrix3fv(b,!1,d.mE)};k=!0;break;case "u_p_light_matrix0":h=function(a,b,d){a.uniformMatrix4fv(b,!1,d.zm[0])};k=!0;break;case "u_p_light_matrix1":h=function(a,b,d){a.uniformMatrix4fv(b,!1,d.zm[1])};k=!0;
break;case "u_p_light_matrix2":h=function(a,b,d){a.uniformMatrix4fv(b,!1,d.zm[2])};k=!0;break;case "u_p_light_matrix3":h=function(a,b,d){a.uniformMatrix4fv(b,!1,d.zm[3])};k=!0;break;case "u_outline_color":h=function(a,b,d){a.uniform3fv(b,d.ij)};break;case "u_draw_outline":h=function(a,b,d){a.uniform1f(b,d.IA)};k=!0;break;case "u_glow_mask_small_coeff":h=function(a,b,d){a.uniform1f(b,d.small_glow_mask_coeff)};k=!0;break;case "u_glow_mask_large_coeff":h=function(a,b,d){a.uniform1f(b,d.large_glow_mask_coeff)};
k=!0;break;case "u_brightness":h=function(a,b,d){a.uniform1f(b,d.brightness)};break;case "u_contrast":h=function(a,b,d){a.uniform1f(b,d.contrast)};break;case "u_exposure":h=function(a,b,d){a.uniform1f(b,d.exposure)};break;case "u_saturation":h=function(a,b,d){a.uniform1f(b,d.saturation)};break;case "u_enable_hmd_stereo":h=function(a,b,d){a.uniform1i(b,d.enable_hmd_stereo)};break;case "u_distortion_params":h=function(a,b,d){a.uniform4fv(b,d.Ol)};break;case "u_chromatic_aberration_coefs":h=function(a,
b,d){a.uniform4fv(b,d.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":h=function(a,b,d){a.uniform1f(b,d.FK)};k=!0;break;case "u_motion_blur_decay_threshold":h=function(a,b,d){a.uniform1f(b,d.mb_decay_threshold)};k=!0;break;case "u_model_tsr":n=function(a,b,d){a.uniformMatrix3fv(b,!1,d.n)};k=!0;break;case "u_model_tsr_inverse":n=function(a,b,d){a.uniformMatrix3fv(b,!1,d.Mx)};k=!0;break;case "u_transb":n=function(a,b,d){a.uniform4fv(b,d.se)};k=!0;break;case "u_transa":n=function(a,b,d){a.uniform4fv(b,
d.Ie)};k=!0;break;case "u_arm_rel_trans":n=function(a,b,d){a.uniform4fv(b,d.Up)};k=!0;break;case "u_arm_rel_quat":n=function(a,b,d){a.uniform4fv(b,d.Tp)};k=!0;break;case "u_quat":n=function(a,b,d){a.uniform4fv(b,K.Yd(d.n,M))};k=!0;break;case "u_quatsb":n=function(a,b,d){a.uniform4fv(b,d.me)};k=!0;break;case "u_quatsa":n=function(a,b,d){a.uniform4fv(b,d.Ee)};k=!0;break;case "u_frame_factor":n=function(a,b,d){a.uniform1f(b,d.Ze)};k=!0;break;case "au_center_pos":n=function(a,b,d){a.uniform3fv(b,d.kq)};
k=!0;break;case "au_wind_bending_amp":n=function(a,b,d){a.uniform1f(b,d.rh)};k=!0;break;case "au_wind_bending_freq":n=function(a,b,d){a.uniform1f(b,d.sh)};k=!0;break;case "au_detail_bending_freq":n=function(a,b,d){a.uniform1f(b,d.Ng)};k=!0;break;case "au_detail_bending_amp":n=function(a,b,d){a.uniform1f(b,d.Mg)};k=!0;break;case "au_branch_bending_amp":n=function(a,b,d){a.uniform1f(b,d.Hg)};k=!0;break;case "u_node_values":n=function(a,b,d,c){a.uniform1fv(b,c.fj)};k=!0;break;case "u_node_rgbs":n=function(a,
b,d,c){a.uniform3fv(b,c.Ce)};k=!0;break;case "u_diffuse_color":n=function(a,b,d,c){a.uniform4fv(b,c.Xf)};k=!0;break;case "u_diffuse_intensity":n=function(a,b,d,c){a.uniform1f(b,c.Nl)};k=!0;break;case "u_diffuse_params":n=function(a,b,d,c){a.uniform2fv(b,c.Ud)};k=!0;break;case "u_emit":n=function(a,b,d,c){a.uniform1f(b,c.Vj)};k=!0;break;case "u_ambient":n=function(a,b,d,c){a.uniform1f(b,c.Ej)};k=!0;break;case "u_specular_color":n=function(a,b,d,c){a.uniform3fv(b,c.Mm)};k=!0;break;case "u_specular_alpha":n=
function(a,b,d,c){a.uniform1f(b,c.Cs)};k=!0;break;case "u_specular_params":n=function(a,b,d,c){a.uniform3fv(b,c.Kk)};k=!0;break;case "u_reflect_factor":n=function(a,b,d,c){a.uniform1f(b,c.yo)};k=!0;break;case "u_mirror_factor":n=function(a,b,d,c){a.uniform1f(b,c.Nr)};k=!0;break;case "u_grass_map_dim":n=function(a,b,d,c){a.uniform3fv(b,c.ie)};k=!0;break;case "u_grass_size":n=function(a,b,d,c){a.uniform1f(b,c.qr)};k=!0;break;case "u_scale_threshold":n=function(a,b,d,c){a.uniform1f(b,c.dv)};k=!0;break;
case "u_cube_fog":n=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.ye)};break;case "u_jitter_amp":n=function(a,b,d,c){a.uniform1f(b,c.Hv)};k=!0;break;case "u_jitter_freq":n=function(a,b,d,c){a.uniform1f(b,c.Iv)};k=!0;break;case "u_wireframe_edge_color":n=function(a,b,d,c){a.uniform3fv(b,c.wireframe_edge_color)};break;case "u_cluster_id":n=function(a,b,d,c){a.uniform1f(b,c.tq)};k=!0;break;case "u_batch_debug_id_color":n=function(a,b,d,c){a.uniform1f(b,c.su)};k=!0;break;case "u_batch_debug_main_render_time":n=
function(a,b,d,c){a.uniform1f(b,c.Jq)};k=!0;break;case "u_refr_bump":n=function(a,b,d,c){a.uniform1f(b,c.Bw)};k=!0;break;case "u_line_width":n=function(a,b,d,c){a.uniform1f(b,c.Kv)};k=!0;break;case "u_lamp_light_positions":n=function(a,b,d,c){a.uniform3fv(b,c.eo)};break;case "u_lamp_light_directions":n=function(a,b,d,c){a.uniform3fv(b,c.Gr)};break;case "u_lamp_light_color_intensities":n=function(a,b,d,c){a.uniform3fv(b,c.Fr)};break;case "u_halo_size":n=function(a,b,d,c){a.uniform1f(b,c.mv)};k=!0;
break;case "u_halo_hardness":n=function(a,b,d,c){a.uniform1f(b,c.jv)};k=!0;break;case "u_halo_rings_color":n=function(a,b,d,c){a.uniform3fv(b,c.lv)};k=!0;break;case "u_halo_lines_color":n=function(a,b,d,c){a.uniform3fv(b,c.kv)};k=!0;break;case "u_halo_stars_blend":n=function(a,b,d,c){a.uniform1f(b,c.nv)};k=!0;break;case "u_halo_stars_height":n=function(a,b,d,c){a.uniform1f(b,c.ov)};k=!0;break;case "u_fresnel_params":n=function(a,b,d,c){a.uniform4fv(b,c.Ni)};k=!0;break;case "u_texture_scale":n=function(a,
b,d,c){a.uniform3fv(b,c.ji)};k=!0;break;case "u_parallax_scale":n=function(a,b,d,c){a.uniform1f(b,c.qo)};k=!0;break;case "u_color_id":n=function(a,b,d){a.uniform3fv(b,d.Oj)};k=!0;break;case "u_line_points":n=function(a,b,d,c){a.uniform3fv(b,c.Z6)};k=!0;break;case "u_diffuse_color_factor":n=function(a,b,d,c){a.uniform1f(b,c.Ml)};k=!0;break;case "u_alpha_factor":n=function(a,b,d,c){a.uniform1f(b,c.nl)};k=!0;break;case "u_specular_color_factor":n=function(a,b,d,c){a.uniform1f(b,c.Qo)};k=!0;break;case "u_normal_factor":n=
function(a,b,d,c){a.uniform1f(b,c.dw)};k=!0;break;case "u_normalmap0_scale":n=function(a,b,d,c){a.uniform2fv(b,c.gj[0])};k=!0;break;case "u_normalmap1_scale":n=function(a,b,d,c){a.uniform2fv(b,c.gj[1])};k=!0;break;case "u_normalmap2_scale":n=function(a,b,d,c){a.uniform2fv(b,c.gj[2])};k=!0;break;case "u_normalmap3_scale":n=function(a,b,d,c){a.uniform2fv(b,c.gj[3])};k=!0;break;case "u_foam_factor":n=function(a,b,d,c){a.uniform1f(b,c.Mn)};k=!0;break;case "u_foam_uv_freq":n=function(a,b,d,c){a.uniform2fv(b,
c.Ku)};k=!0;break;case "u_foam_mag":n=function(a,b,d,c){a.uniform2fv(b,c.Ju)};k=!0;break;case "u_foam_scale":n=function(a,b,d,c){a.uniform2fv(b,c.Yq)};k=!0;break;case "u_water_norm_uv_velocity":n=function(a,b,d,c){a.uniform1f(b,c.np)};k=!0;break;case "u_shallow_water_col":n=function(a,b,d,c){a.uniform3fv(b,c.Ho)};k=!0;break;case "u_shore_water_col":n=function(a,b,d,c){a.uniform3fv(b,c.Jo)};k=!0;break;case "u_water_shallow_col_fac":n=function(a,b,d,c){a.uniform1f(b,c.Io)};k=!0;break;case "u_water_shore_col_fac":n=
function(a,b,d,c){a.uniform1f(b,c.Ko)};k=!0;break;case "u_p_length":n=function(a,b,d,c){a.uniform1f(b,c.gb.pN)};k=!0;break;case "u_p_cyclic":n=function(a,b,d,c){a.uniform1i(b,c.gb.Sd)};k=!0;break;case "u_p_max_lifetime":n=function(a,b,d,c){a.uniform1f(b,c.gb.sK)};k=!0;break;case "u_p_fade_in":n=function(a,b,d,c){a.uniform1f(b,c.gb.Sl)};k=!0;break;case "u_p_fade_out":n=function(a,b,d,c){a.uniform1f(b,c.gb.Df)};k=!0;break;case "u_p_size":n=function(a,b,d,c){a.uniform1f(b,c.gb.size)};k=!0;break;case "u_p_alpha_start":n=
function(a,b,d,c){a.uniform1f(b,c.gb.PF)};k=!0;break;case "u_p_alpha_end":n=function(a,b,d,c){a.uniform1f(b,c.gb.OF)};k=!0;break;case "u_p_nfactor":n=function(a,b,d,c){a.uniform1f(b,c.gb.lC)};k=!0;break;case "u_p_gravity":n=function(a,b,d,c){a.uniform1f(b,c.gb.HJ)};k=!0;break;case "u_p_mass":n=function(a,b,d,c){a.uniform1f(b,c.gb.Vh)};k=!0;break;case "u_p_color_ramp":n=function(a,b,d,c){a.uniform4fv(b,c.gb.bH)};k=!0;break;case "u_p_wind_fac":n=function(a,b,d,c){a.uniform1f(b,c.gb.iO)};k=!0;break;
case "u_p_time":n=function(a,b,d,c){a.uniform1f(b,c.gb.time)};k=!0;break;case "u_p_tilt":n=function(a,b,d,c){a.uniform1f(b,c.gb.nN)};k=!0;break;case "u_p_tilt_rand":n=function(a,b,d,c){a.uniform1f(b,c.gb.oN)};k=!0;break;case "u_position":n=function(a,b,d,c){a.uniform3fv(b,c.ol)};k=!0;break;case "u_va_frame_factor":n=function(a,b,d){a.uniform1f(b,d.zx)};k=!0;break;case "u_refl_plane":n=function(a,b,d){a.uniform4fv(b,d.qc)};k=!0;break;case "u_outline_intensity":n=function(a,b,d){a.uniform1f(b,d.gh)};
k=!0;break;case "u_obj_info":n=function(a,b,d,c){a.uniform3fv(b,c.oo)},k=!0}n&&(n={name:g,On:n,ef:b[g]},k?d.push(n):c.push(n));h&&(n={name:g,On:h,ef:b[g]},k?e.push(n):f.push(n))}if(c.length||f.length){a=a.zC;for(var l in a)delete a[l];for(l=0;l<c.length;l++)n=c[l],a[n.name]=n;for(l=0;l<f.length;l++)n=f[l],a[n.name]=n}else a.bw=!0}var A=m("__batch"),h=m("__camera"),z=m("__config"),p=m("__debug"),n=m("__extensions"),k=m("__geometry"),u=m("__quat"),e=m("__subscene"),y=m("__textures"),K=m("__tsr"),F=
m("__util"),J=m("__version"),k=m("__geometry"),D=m("__vec3"),R=[1,1,1,1],E=[1,1,1,1],I=[0,0,0,1],B=[0,0,0,0],P=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var d=null,f=null,r=null,g=null,Q=null,t=null,aa=new Float32Array(3),M=u.create(),G=new Uint8Array(4),T=z.B;a.Lf=function(a){var b=T.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);d=a};a.Gn=function(a){if(a.dc)if(a.type==e.kn){p.SC(a);var f=a.p;d.bindFramebuffer(d.READ_FRAMEBUFFER,f.br);d.bindFramebuffer(d.DRAW_FRAMEBUFFER,f.$e);var g=0;f.vc&&(g|=d.COLOR_BUFFER_BIT);f.We&&(g|=d.DEPTH_BUFFER_BIT);d.blitFramebuffer(0,0,f.width,f.height,0,0,f.width,f.height,g,d.NEAREST);p.TC(a);p.Qz("draw resolve")}else if(a.type==e.Wx)p.SC(a),f=a.p,d.bindFramebuffer(d.FRAMEBUFFER,
f.br),d.bindTexture(d.TEXTURE_2D,f.vc.sb),d.copyTexSubImage2D(d.TEXTURE_2D,0,0,0,0,0,f.width,f.height,0),p.TC(a),p.Qz("draw copy");else{p.SC(a);f=a.p;d.bindFramebuffer(d.FRAMEBUFFER,f.$e);a.vz&&(g=f.vc,d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,g.nb,g.sb,0));d.viewport(0,0,f.width,f.height);a.type!=e.nd&&a.type!=e.Pe&&c(a);a.Lb?d.enable(d.BLEND):d.disable(d.BLEND);a.Td?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST);switch(a.type){case e.dd:d.enable(d.POLYGON_OFFSET_FILL);d.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);d.cullFace(d.BACK);break;case e.Nd:case e.vf:d.disable(d.POLYGON_OFFSET_FILL);d.cullFace(d.FRONT);break;case e.uf:d.enable(d.POLYGON_OFFSET_FILL);d.polygonOffset(-4,-4);d.cullFace(d.BACK);break;case e.ge:if(1<T.Fc||T.IL){d.enable(d.POLYGON_OFFSET_FILL);d.polygonOffset(-2,-2);break}default:d.disable(d.POLYGON_OFFSET_FILL),d.cullFace(d.BACK)}if(a.type==e.nd||a.type==e.Pe)for(var f=a.p,g=f.vc.sb,k=0;6>k;k++){var n=b(k);f.Ob=a.Kl[k];K.Tg(f.Ob,f.pf);h.Jz(f);d.framebufferTexture2D(d.FRAMEBUFFER,
d.COLOR_ATTACHMENT0,n,g,0);c(a);for(var n=a.Qa,t=0;t<n.length;t++)for(var r=0;r<n[t].sa.length;r++){var u=n[t].sa[r];u.dc=u.HA[k]}l(a)}else l(a);p.TC(a);p.Qz("draw subscene: "+e.GD(a))}};a.clear=function(a){d.bindFramebuffer(d.FRAMEBUFFER,a.p.$e);c(a)};a.nR=function(a){var b=a.Wp;b.length=0;var d=a.Ba,c=d.ld,e=a.zb.attributes,f;for(f in e){var g=c[f],n=k.pr(f),h=k.EV(f),l=k.wJ(f);b.push({XN:n,bv:h,ef:e[f],gG:g.offset*l,hI:1<g.frames?g.length*l:0,Kc:g.Kc,Pm:g.Pm*l,Qq:g.Qq})}if("DEBUG"==J.type())for(f in c)n=
k.pr(f),b=k.AY(d.Md,n),b=d.Md[b],g=a.hb.wg+" | "+a.hb.Ye,n=c[f].length*c[f].frames*k.wJ(f),p.FU(b.XT,g,f,n,f in e);T.nz&&x(a)};a.sR=x;a.CS=function(a){for(var b=n.mB(),d=0;d<a.Le.length;d++)b.deleteVertexArray(a.Le[d]);a.Le.length=0};a.ES=function(a){for(var b=[],d=0;d<a.length;d++)b.push(a[d]);return b};a.rR=q;a.cG=function(a){var b=a.zb,c=a.ya;a=a.Ld;d.useProgram(b.$h);for(var e=0;e<c.length;e++)d.uniform1i(b.Rm[a[e]],e)};a.NC=function(a,b,c,e,f,g){e||(e=1);f||(f=1);g||(g=new Uint8Array(4*e*f));
g.length!=4*e*f&&F.q("read_pixels(): Wrong storage");d.bindFramebuffer(d.FRAMEBUFFER,a);d.readPixels(b,c,e,f,d.RGBA,d.UNSIGNED_BYTE,g);d.bindFramebuffer(d.FRAMEBUFFER,null);return g};a.w_=function(a){var b=a.zb;b.bw||(d.useProgram(b.$h),b.Xr.length||q(b),b=b.zC.u_cube_fog,b.On(d,b.ef,null,a))};a.iY=function(a,b){var c=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,c);if(y.Zn(a)){var e=a.Me;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,e)}else if(y.bo(a)){var f=
a,e=f.sb,f=f.nb==d.TEXTURE_CUBE_MAP?d.TEXTURE_CUBE_MAP_NEGATIVE_Z:f.nb;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,f,e,0)}y.Zn(b)?(e=b.Me,d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,e)):y.bo(b)&&(f=b,e=f.sb,f=f.nb,d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,f,e,0));p.hS();d.bindFramebuffer(d.FRAMEBUFFER,null);return c};a.hY=function(a,b,c,e,f){null==a?(d.bindFramebuffer(d.FRAMEBUFFER,a),d.viewport(0,0,e,f),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)):
(y.Zn(b)?d.deleteRenderbuffer(b.Me):y.bo(b)&&d.deleteTexture(b.sb),y.Zn(c)?d.deleteRenderbuffer(c.Me):y.bo(c)&&d.deleteTexture(c.sb),d.deleteFramebuffer(a))};a.E6=function(){};a.gU=function(a,b,c,e,f,g){a=a.sb;d.viewport(0,0,c,c);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,b,a,0);b=A.lA("FLIP_CUBEMAP_COORDS");a=b.zb;d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,f);var k=f=0;c!=e&&(f=1/(6*e),k=1/(4*e));d.uniform1i(a.Rm.u_tex_number,g);d.uniform2fv(a.Rm.u_delta,[f,k]);d.useProgram(a.$h);
t(b,0);d.bindTexture(d.TEXTURE_2D,null)};a.hU=function(a,b,c,e,f){d.bindFramebuffer(d.FRAMEBUFFER,e);e=a.sb;a=a.nb;d.bindTexture(a,e);d.viewport(0,0,b,c);d.texImage2D(a,0,d.RGBA,b,c,0,d.RGBA,d.UNSIGNED_BYTE,null);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,a,e,0);b=A.lA("NONE");c=b.zb;d.activeTexture(d.TEXTURE0);d.bindTexture(a,f);d.useProgram(c.$h);t(b,0);d.bindFramebuffer(d.FRAMEBUFFER,null);d.bindTexture(a,null)};a.ua=function(){};a.LY=function(){var a=n.HV(),b=n.mB();T.NF=a?!0:!1;
T.nz=b?!0:!1;a?(f=function(b,c,e,f){a.drawElementsInstanced(d.TRIANGLES,b,c,e,f)},r=function(b,d){a.vertexAttribDivisor(b,d)},g=function(b,c,e){a.drawArraysInstanced(d.TRIANGLES,b,c,e)}):(f=function(a,b,c){d.drawElements(d.TRIANGLES,a,b,c)},r=function(){},g=function(a,b){d.drawArrays(d.TRIANGLES,a,b)});b?(Q=function(a){b.bindVertexArray(a)},t=function(a,b){var d=a.Ba;Q(a.Le[b]);d.eg?f(d.count,d.dm,0,d.hm):g(0,d.count,d.hm);Q(null)}):t=function(a,b){for(var c=a.Ba,e=a.Wp,k=0;k<c.Md.length;k++){d.bindBuffer(d.ARRAY_BUFFER,
c.Md[k].Wk);for(var n=0;n<e.length;n++){var h=e[n];h.XN==c.Md[k].type&&(d.enableVertexAttribArray(h.ef),d.vertexAttribPointer(h.ef,h.Kc,h.bv,h.bv==d.FLOAT?!1:!0,h.Pm,h.gG+h.hI*b),r(h.ef,h.Qq))}}c.eg?(d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c.eg),f(c.count,c.dm,0,c.hm)):g(0,c.count,c.hm);for(k=0;k<e.length;k++)h=e[k],d.disableVertexAttribArray(h.ef)}};a.reset=function(){Q=g=r=f=d=null}};b4w.module.__camera=function(a,m){function l(a,b,d,c,e){N.Gc(a,b);d&&D(a,b,d);B(a,c);P(a,e)}function c(a,b,d,c,e,f,k,n){var h=a.k;N.Gc(a,b);h.pivot.set(d);D(a,b,d);B(a,c);P(a,e);g(a,f);Q(a,k);h.use_panning=n}function b(a,b,c,e,f,g,k,h){var n=a.k;N.Gc(a,b);n.Wb.set(c);D(a,b,c);r(a,e);d(a,f);t(a,g);aa(a,k);n.Jh=h}function x(a,b,d){var c=a.k,e=ka.F(c.n),f=ka.N(c.n),c=wa;c.set(C.Oc);c[3]=0;a=u(a,va)[1];f=C.pc(f,C.ad,Ea);xa.jM(Aa,e);xa.kD(Aa,f);if(!C.PB(c,-b,Aa,d)||Math.abs(a)<ja)oa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
d[0]=e[0],d[1]=0,d[2]=e[2];return d}function q(b){for(var d=b.k,c=0;c<b.I.length;c++){var e=b.I[c].da[0];if(e.type==a.we)switch(d.vb){case a.Kb:var f=ka.F(d.n);d.ck=ia.dist(f,d.pivot);d.dk=e.top;break;case a.cd:f=ka.F(d.n),d.ck=ia.dist(f,d.Wb),d.dk=e.top}}}function A(a){a={type:a,name:"",EM:1,width:0,height:0,$e:null,br:null,vc:null,We:null,Ab:0,Wd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,kd:qa.create(),n:new Float32Array(9),Ob:new Float32Array(16),Dx:new Float32Array(16),xb:new Float32Array(16),
md:new Float32Array(16),Cx:new Float32Array(16),FC:new Float32Array(16),tg:new Float32Array(16),direction:new Float32Array(3),pf:ka.Hl(),Ex:ka.Hl(),gs:ka.Hl(),Aw:ka.Hl(),ys:ka.Hl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,TH:!1,Cd:!1,dof_on:!1,Nv:new Float32Array(3),Lh:z(),Lk:0,lf:0,qc:null,Hh:null,Hq:null,pu:new Float32Array(4),so:new Float32Array(4)};a.kd[0]=a.kd[2]=45;a.kd[1]=a.kd[3]=55;return a}function h(a,
b){var d=A(a.type);d.name=a.name;d.EM=a.EM;d.width=a.width;d.height=a.height;b||(d.$e=a.$e,d.br=a.br,d.vc=a.vc,d.We=a.We);d.Ab=a.Ab;d.Wd=a.Wd;d.near=a.near;d.far=a.far;d.left=a.left;d.right=a.right;d.top=a.top;d.bottom=a.bottom;qa.copy(a.kd,d.kd);ka.copy(a.n,d.n);Y.copy(a.Ob,d.Ob);Y.copy(a.xb,d.xb);Y.copy(a.md,d.md);Y.copy(a.Cx,d.Cx);Y.copy(a.FC,d.FC);Y.copy(a.tg,d.tg);ka.copy(a.pf,d.pf);ka.copy(a.Ex,d.Ex);ka.copy(a.gs,d.gs);ka.copy(a.Aw,d.Aw);ka.copy(a.ys,d.ys);d.dof_distance=a.dof_distance;d.dof_front_start=
a.dof_front_start;d.dof_front_end=a.dof_front_end;d.dof_rear_start=a.dof_rear_start;d.dof_rear_end=a.dof_rear_end;d.dof_power=a.dof_power;d.dof_bokeh_intensity=a.dof_bokeh_intensity;d.dof_object=a.dof_object;d.TH=a.TH;d.Cd=a.Cd;d.dof_on=a.dof_on;ia.copy(a.Nv,d.Nv);var c=a.Lh,e=d.Lh;qa.copy(c.left,e.left);qa.copy(c.right,e.right);qa.copy(c.top,e.top);qa.copy(c.bottom,e.bottom);qa.copy(c.near,e.near);qa.copy(c.far,e.far);d.Lk=a.Lk;d.lf=a.lf;a.qc&&(d.qc=qa.clone(a.qc));if(a.Hh){c=a.Hh.length;d.Hh=Array(c);
for(e=0;e<c;e++)d.Hh[e]=ia.clone(a.Hh[e]);d.Hq=new Float32Array(a.Hq)}qa.copy(a.pu,d.pu);qa.copy(a.so,d.so);return d}function z(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function p(b){switch(b){case "STATIC":return a.zg;case "TARGET":return a.Kb;case "EYE":return a.od;case "HOVER":return a.cd;default:C.q("Unknown move style")}}function n(b){var d=
A(b);if(b==a.qd)return d;switch(b){case a.Od:y(d,40,.1,1E3);break;case a.we:y(d,2.5,.1,1E3);break;case a.yh:break;case a.xh:break;case a.xi:break;case a.Rc:case a.ed:case a.Qe:case a.Re:C.q("Stereo camera may only be created from perspective one");break;default:C.q("Unknown camera type")}return d}function k(b,d,c){b.type!=a.Rc&&b.type!=a.ed&&b.type!=a.Qe&&b.type!=a.Re&&C.q("set_stereo_params(): wrong camera type");if(b.type==a.Rc||b.type==a.ed)b.Lk=d;b.lf=c;W(b,b.Ab);if(fa.Ca()&&(d=fa.A(),b=d.s.xd))for(d=
ya.ka(fa.Mh(d),d).da,c=0;c<d.length;c++)v(d[c],b)}function u(a,b){var d=ka.N(a.k.n);return e(d,b)}function e(a,b){var d=C.pc(a,C.Oc,Ea),c=C.pc(a,C.el,Ca),e=-Math.asin(d[2]/ia.length(d)),d=Math.abs(e)>Math.PI/4?ia.scale(c,-C.sign(e),Ba):ia.scale(d,-C.sign(c[2]),Ba),f=Math.atan(Math.abs(d[0]/d[1]));0<c[2]&&(e=C.sign(e)*Math.PI-e);c=f;0<d[1]&&(c=Math.PI-c);0>d[0]&&(c=2*Math.PI-c);b[0]=c;b[1]=e;return b}function y(b,d,c,e,f){switch(b.type){case a.Od:case a.Rc:case a.ed:b.Wd=d;b.Ab=1;break;case a.we:b.top=
d;b.Ab=1;break;case a.yh:b.Wd=d;b.Ab=f/d;break;case a.xh:b.top=d;b.Ab=f/d;break;case a.Qe:case a.Re:break;default:oa.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=c;b.far=e}function K(b,d){var c=ka.jc(d.k.n,Ea),e=ka.Yd(d.k.n,la),f=Y.fromRotationTranslation(e,c,Ga);Y.invert(f,b.Ob);if(fa.Ca())var f=fa.A(),g=fa.La(f,ha.wi);if(b.type==a.Rc||g&&g.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]+=b.lf/2;else if(b.type==a.ed||g&&g.enable_hmd_stereo&&b.type==a.Re)b.Ob[12]-=b.lf/2;if(b.qc){ka.Tg(b.Ob,
b.gs);ka.invert(b.gs,b.Aw);var f=b.qc[0],g=b.qc[1],k=b.qc[2],n=b.qc[3],h=b.Dx;h[0]=1-2*f*f;h[1]=-2*f*g;h[2]=-2*f*k;h[3]=0;h[4]=-2*f*g;h[5]=1-2*g*g;h[6]=-2*g*k;h[7]=0;h[8]=-2*f*k;h[9]=-2*g*k;h[10]=1-2*k*k;h[11]=0;h[12]=-2*f*n;h[13]=-2*g*n;h[14]=-2*k*n;h[15]=1;Y.multiply(b.Ob,b.Dx,b.Ob);W(b,b.Ab,!0);f=wa;g=Ga;Y.invert(b.Ob,g);Y.transpose(g,g);qa.transformMat4(b.qc,g,f);g=Pa;g[0]=(C.sign(f[0])+b.xb[8])/b.xb[0];g[1]=(C.sign(f[1])+b.xb[9])/b.xb[5];g[2]=-1;g[3]=(1+b.xb[10])/b.xb[14];qa.scale(f,2/(f[0]*
g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.xb[2]=f[0];b.xb[6]=f[1];b.xb[10]=f[2]+1;b.xb[14]=f[3];ia.transformMat4(c,b.Dx,c)}ka.Tg(b.Ob,b.pf);ka.invert(b.pf,b.Ex);V(b);O(b);ka.sg(c,1,e,b.n)}function F(b,d,c,e){Y.lookAt(d,c,e,b.Ob);c=fa.A();c=fa.La(c,ha.wi);fa.Ca()&&(c=fa.A(),c=fa.La(c,ha.wi));if(b.type==a.Rc||c&&c.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]+=b.lf/2;else if(b.type==a.ed||c&&c.enable_hmd_stereo&&b.type==a.Re)b.Ob[12]-=b.lf/2;ka.Tg(b.Ob,b.pf);V(b);O(b);ka.pe(d,b.n)}function J(a,b,d){d=ia.subtract(d,
b,Ea);ia.length(d)&&(ia.normalize(d,d),d=C.aD(C.ad,d,la),N.ei(a,d));N.Gc(a,b)}function D(a,b,d){var c=a.k,e=I(a);J(a,b,d);e?(b=ia.copy(c.of,Ea),ia.negate(b,b),pa.Rj(a,b,!0)):pa.Rj(a,c.of,!0)}function R(a,b){for(var d=a.k,c=b.da,e=ka.Yd(d.n,la),e=C.pc(e,C.ad,Ea),f=ka.jc(d.n,Ca),g=b.BM,k=0;k<g.length;k++){var h=g[k];ia.copy(e,h.direction);ka.jc(d.n,h.Nv)}for(k=0;k<c.length;k++)h=c[k],K(h,a),ia.copy(e,h.direction),C.In(h.md,h.Lh),h.dof_object&&h.dof_on&&(d=N.Zd(h.dof_object,Ba),d=ia.dist(f,d),h.dof_distance=
d)}function E(b){var d=b.k;d.vb==a.Kb&&(d.Ok=I(b))}function I(a){a=ka.N(a.k.n);return 0>C.pc(a,C.zj,Ea)[2]}function B(b,d){var c=b.k;if(d){c.mb=c.mb||{};c.mb.left=d.left;c.mb.right=d.right;c.mb.fo=d.left;c.mb.Co=d.right;c.mb.camera_space=Boolean(d.camera_space);var e=b.k;!(c=e.mb)||e.vb!=a.od&&e.vb!=a.Kb||(e=u(b,va),c.camera_space?(c.left+=e[0],c.right+=e[0]):(c.fo-=e[0],c.Co-=e[0]),c.left=C.yi(c.left),c.right=C.yi(c.right),c.fo=C.yi(c.fo),c.Co=C.yi(c.Co))}else c.mb=null}function P(a,b){var d=a.k;
b?(d.la=d.la||{},d.la.down=b.down,d.la.up=b.up,d.la.Fn=b.down,d.la.fp=b.up,d.la.camera_space=Boolean(b.camera_space),f(a)):d.la=null}function d(a,b){var d=a.k;if(!b){var c=u(a,va);b={down:c[1],up:c[1]}}d.la=d.la||{};d.la.down=b.down;d.la.up=b.up;f(a);d.tb&&d.la&&ma(a)}function f(b){var d=b.k,c=d.la;if(c)switch(d.vb){case a.od:case a.Kb:b=u(b,va);c.camera_space?(c.up+=b[1],c.down+=b[1]):(c.fp-=b[1],c.Fn-=b[1]);c.up=C.Dg(c.up,-Math.PI,Math.PI);c.down=C.Dg(c.down,-Math.PI,Math.PI);c.fp=C.Dg(c.fp,-Math.PI,
Math.PI);c.Fn=C.Dg(c.Fn,-Math.PI,Math.PI);break;case a.cd:c.up=C.Dg(c.up,-Math.PI,Math.PI),c.down=C.Dg(c.down,-Math.PI,Math.PI),c.up=C.W(c.up,-Math.PI/2,0),c.down=C.W(c.down,-Math.PI/2,0)}}function r(a,b){var d=a.k;if(!b){var c=N.po(a,d.Wb);b={min:c,max:c}}d.tb=d.tb||{};d.tb.min=b.min;d.tb.max=b.max;d.tb&&d.la&&ma(a)}function g(a,b){var d=a.k;b?(d.tb=d.tb||{},d.tb.min=b.min,d.tb.max=b.max):d.tb=null}function Q(a,b){var d=a.k;b?(d.ce=d.ce||{},d.ce.min_z=b.min_z,d.ce.max_z=b.max_z):d.ce=null}function t(a,
b){var d=a.k;b?(d.Bc=d.Bc||{},d.Bc.min=b.min,d.Bc.max=b.max):d.Bc=null}function aa(a,b){var d=a.k;b?(d.Cc=d.Cc||{},d.Cc.min=b.min,d.Cc.max=b.max):d.Cc=null}function M(b){var d=b.k;if(ya.xa(b))for(var c=b.I,e=0;e<c.length;e++){var f=c[e].da;if(f[0].type===a.we){switch(d.vb){case a.Kb:var g=ka.F(d.n),g=ia.dist(g,d.pivot),g=g/d.ck*d.dk;break;case a.cd:g=ka.F(d.n);g=ia.distance(g,d.Wb);g=g/d.ck*d.dk;break;default:g=f[0].top}for(var k=0;k<f.length;k++){var h=f[k];h.top=g;W(h,h.Ab)}R(b,c[e])}}}function G(b){var d=
b.k,c=d.vb;if(c===a.Kb||c===a.od){if(d.mb){var e=d.mb.left,f=d.mb.right,g=u(b,va);(g=c==a.Kb?C.zl(g[0],e,f):C.zl(g[0],f,e))&&(c==a.Kb?S(b,g,0):T(b,g,0))}d.la&&(e=d.la.down,f=d.la.up,g=u(b,va),(g=c==a.Kb?C.zl(g[1],f,e):C.zl(g[1],e,f))&&(c==a.Kb?S(b,0,g):T(b,0,g)));if(c===a.Kb&&d.tb){var g=b.k,e=ka.F(g.n),f=ia.subtract(e,g.pivot,Ea),k=ia.length(f);k>g.tb.max?(ia.scale(f,g.tb.max/k,f),ia.add(g.pivot,f,e)):k<g.tb.min&&(k=ka.N(g.n),k=C.pc(k,C.ad,Ca),ia.scale(k,100*g.tb.min,k),ia.add(f,k,f),ia.scale(f,
-g.tb.min/ia.length(f),f),ia.add(g.pivot,f,e))}}c===a.Kb&&d.ce&&(d=b.k,g=d.pivot[2],e=C.W(d.pivot[2],d.ce.min_z,d.ce.max_z),e!=g&&(g=ia.set(0,0,e-g,Ea),ia.add(d.pivot,g,d.pivot),d=ka.F(d.n),ia.add(d,g,d)));c===a.cd&&(c=b.k,c.Bc&&(g=C.W(c.Wb[0],c.Bc.min,c.Bc.max)-c.Wb[0],c.Wb[0]+=g,d=ka.F(c.n),d[0]+=g),c.Cc&&(g=C.W(c.Wb[1],c.Cc.min,c.Cc.max)-c.Wb[1],c.Wb[1]+=g,d=ka.F(c.n),d[1]+=g),c=b.k,d=u(b,va)[1],(c=C.zl(d,c.la.up,c.la.down))&&X(b,0,c))}function T(a,b,d,c,e){var f=a.k,g=b,k=d;if(c||e)a=u(a,ta),
c&&(g=b-a[0]),e&&(k=d-a[1]);if(g||k)b=Z.identity(la),g&&(g=Z.setAxisAngle(f.of,g,ua),Z.multiply(b,g,b)),f=ka.N(f.n),k&&(g=C.pc(f,C.ri,Ea),k=Z.setAxisAngle(g,k,ua),Z.normalize(k,k),Z.multiply(b,k,b)),Z.multiply(b,f,f)}function S(a,b,d,c,e){var f=a.k,g=b,k=d;if(c||e){var h=u(a,ta);c&&(g=b-h[0]);e&&(k=d-h[1])}H(a,a.k.pivot,g,k);a=u(a,ta);a=C.Dg(a[1],-Math.PI,Math.PI);f.Ok=Math.abs(a)>Math.PI/2}function X(a,b,d,c,e){var f=a.k,g=b,k=d;if(c||e){var h=u(a,ta);c&&(g=b-h[0]);e&&(k=d-h[1])}f.Jh||(g=0);H(a,
f.Wb,g,k);k&&ma(a)}function H(a,b,d,c){var e=a.k;if(d||c){a=Z.identity(la);d&&(d=Z.setAxisAngle(C.Oc,d,ua),Z.multiply(a,d,a));d=ka.N(e.n);if(c){var f=C.pc(d,C.ri,Ea);c=Z.setAxisAngle(f,c,ua);Z.normalize(c,c);Z.multiply(a,c,a)}c=ka.F(e.n);C.vY(c,b,a,c);Z.multiply(a,d,d)}}function ma(a){var b=a.k,d=u(a,va)[1],c=a.k;a=c.la;c=c.tb;a.down-a.up?(d=(a.down-d)/(a.down-a.up),d=Math.max(d,0)):d=0;d=d*(c.max-c.min)+c.min;a=ka.F(b.n);c=ka.N(b.n);c=C.pc(c,C.ad,Ea);ia.normalize(c,c);ia.scale(c,d,c);ia.subtract(b.Wb,
c,a)}function W(b,d,c){switch(b.type){case a.Od:d||C.q("No aspect ratio"),b.Ab=d;case a.yh:Y.perspective(C.Cb(b.Wd),b.Ab,b.near,b.far,b.xb);break;case a.we:d||C.q("No aspect ratio"),b.Ab=d;case a.xh:d=b.top*b.Ab;Y.ortho(-d,d,-b.top,b.top,b.near,b.far,b.xb);break;case a.xi:Y.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb);break;case a.Rc:case a.ed:d||C.q("No aspect ratio");b.Ab=d;var e=Math.tan(b.Wd*Math.PI/360);d=b.near*e;var f=b.Ab*b.Lk*e;b.type==a.Rc?(e=f-b.lf/2,f+=b.lf/2):(e=f+b.lf/2,f-=
b.lf/2);e=-(b.near/b.Lk*e);f*=b.near/b.Lk;Y.frustum(e,f,-d,d,b.near,b.far,b.xb);b.left=e;b.right=f;break;case a.Qe:case a.Re:if(fa.Ca())if(e=fa.A(),(e=fa.La(e,ha.wi))&&e.enable_hmd_stereo){d=Math.tan(C.Cb(b.kd[0]));var e=Math.tan(C.Cb(b.kd[1])),f=Math.tan(C.Cb(b.kd[2])),g=Math.tan(C.Cb(b.kd[3]));b.top=b.near*d;b.right=b.near*e;b.bottom=-b.near*f;b.left=-b.near*g;Y.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb)}else d||(d=b.Ab),Y.perspective(C.Cb(b.Wd),d,b.near,b.far,b.xb);break;case a.qd:return;
default:C.q("Wrong camera type: "+b.type)}c||(V(b),O(b))}function O(a){Y.copy(a.Ob,a.tg);a.tg[12]=0;a.tg[13]=0;a.tg[14]=0;a.tg[15]=1;Y.multiply(a.xb,a.tg,a.tg);Y.invert(a.tg,a.tg)}function V(a){Y.copy(a.Ob,a.md);Y.multiply(a.xb,a.md,a.md);Y.invert(a.md,a.Cx)}function ga(b,d,c,e,f){e||(e=new Float32Array(24));d||(d=b.near);c||(c=b.far);var g,k,h,n,l,v,t,r;switch(b.type){case a.qd:C.q("Extraction from NONE camera is not possible");break;case a.Od:case a.yh:g=d*Math.tan(b.Wd*Math.PI/360);n=-g;k=g*b.Ab;
h=-k;l=c/d*g;r=-l;v=l*b.Ab;t=-v;break;case a.we:case a.xh:h=b.top*b.Ab;g=l=b.top;k=v=h;n=r=-b.top;h=t=-h;break;case a.xi:g=l=b.top;k=v=b.right;n=r=b.bottom;h=t=b.left;break;case a.Rc:case a.ed:l=d/b.near;g=d*Math.tan(b.Wd*Math.PI/360);n=-g;k=b.right*l;h=b.left*l;t=c/d;l=g*t;r=-l;v=k*t;t*=h;break;case a.Qe:case a.Re:l=d/b.near;g=b.top*l;n=b.bottom*l;k=b.right*l;h=b.left*l;t=c/d;l=g*t;r=n*t;v=k*t;t*=h;break;default:C.q("Wrong camera type: "+b.type)}e[0]=h;e[1]=n;e[2]=-d;e[3]=k;e[4]=n;e[5]=-d;e[6]=k;
e[7]=g;e[8]=-d;e[9]=h;e[10]=g;e[11]=-d;e[12]=t;e[13]=r;e[14]=-c;e[15]=t;e[16]=l;e[17]=-c;e[18]=v;e[19]=l;e[20]=-c;e[21]=v;e[22]=r;e[23]=-c;f&&(d=Ga,Y.invert(b.Ob,d),C.wo(e,d,e,0));return e}function v(a,b){if(b.enable_csm){var d=b.csm_num;if(!a.Hh){var c=b.csm_num;a.Hh=Array(c);for(var e=0;e<c;e++)a.Hh[e]=new Float32Array(3);a.Hq=new Float32Array(c)}for(c=0;c<d;c++){var e=0==c?a.near:ba(b,a,c-1),f=ba(b,a,c),e=ga(a,e,f,Qa),e=na.BV(e);a.Hh[c].set(e.G);a.Hq[c]=e.Xa;a.pu[c]=ia.length(e.G);a.so[c]=ea(b.first_cascade_blur_radius,
b.last_cascade_blur_radius,d,c)}}else a.so[0]=b.first_cascade_blur_radius}function ba(a,b,d){var c=a.csm_num,e=C.W(a.csm_first_cascade_border,b.near,b.far);a=C.W(a.csm_last_cascade_border,b.near,b.far);return C.W(ea(e,a,c,d),b.near,b.far)}function ea(a,b,d,c){switch(c){case 0:break;case d-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,c/(d-1))}return a}function ca(a,b){b||(b=new Float32Array(3));var d=ka.F(a.k.n);ia.copy(d,b);return b}var na=m("__boundings");m("__config");var pa=m("__constraints"),L=
m("__container"),Y=m("__mat4"),xa=m("__math"),ya=m("__obj_util"),oa=m("__print"),Z=m("__quat"),fa=m("__scenes"),ha=m("__subscene"),N=m("__transform"),ka=m("__tsr"),C=m("__util"),ia=m("__vec3"),qa=m("__vec4");a.qd=10;a.Od=20;a.we=30;a.yh=40;a.xh=50;a.xi=60;a.Rc=70;a.ed=80;a.Qe=90;a.Re=100;a.zg=0;a.Kb=2;a.od=3;a.cd=4;var ja=C.Cb(.5),va=new Float32Array(2),ta=new Float32Array(2),Ea=new Float32Array(3),Ca=new Float32Array(3),Ba=new Float32Array(3),la=new Float32Array(4),ua=new Float32Array(4),wa=new Float32Array(4),
Pa=new Float32Array(4),Ga=new Float32Array(16),Qa=new Float32Array(24),Aa=new Float32Array(6);a.$R=function(d,e){var f=e.k,g=d.data;switch(g.type){case "PERSP":var k=n(a.Od);if(g.angle_y)var v=C.ne(g.angle_y);y(k,v,g.clip_start,g.clip_end);break;case "ORTHO":k=n(a.we),y(k,g.ortho_scale/2,g.clip_start,g.clip_end)}k.name=e.name;v=e.I;v[0].da.push(k);for(var t=1;t<v.length;t++){var r=h(k,!1);v[t].da.push(r)}f.vb=p(g.b4w_move_style);f.dof_distance=g.dof_distance;k=g.dof_object;f.dof_object=k?k.pb:null;
f.dof_front_start=g.b4w_dof_front_start;f.dof_front_end=g.b4w_dof_front_end;f.dof_rear_start=g.b4w_dof_rear_start;f.dof_rear_end=g.b4w_dof_rear_end;f.dof_power=g.b4w_dof_power;f.dof_bokeh=g.b4w_dof_bokeh;f.dof_bokeh_intensity=g.b4w_dof_bokeh_intensity;f.Cd=g.b4w_dof_foreground_blur;f.Yk=g.b4w_trans_velocity;f.Xk=g.b4w_rot_velocity;f.Zk=g.b4w_zoom_velocity;k=e.k.vb;v=d.data;t=null;k!=a.Kb&&k!=a.od||!v.b4w_use_horizontal_clamping||(t={left:v.b4w_rotation_left_limit,right:v.b4w_rotation_right_limit,
camera_space:"LOCAL"==v.b4w_horizontal_clamping_type},k==a.od&&(t.left*=-1,t.right*=-1));k=t;v=e.k.vb;t=d.data;r=null;v!=a.Kb&&v!=a.od||!t.b4w_use_vertical_clamping?v==a.cd&&t.b4w_use_zooming&&(t.b4w_hover_angle_min<=t.b4w_hover_angle_max?(r={down:t.b4w_hover_angle_min,up:t.b4w_hover_angle_max},r.down*=-1,r.up*=-1):oa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(r={down:t.b4w_rotation_down_limit,up:t.b4w_rotation_up_limit,camera_space:"LOCAL"==t.b4w_vertical_clamping_type},
v==a.Kb&&(r.down*=-1,r.up*=-1));var v=r,t=e.k.vb,r=d.data,u=null;t==a.Kb&&r.b4w_use_target_distance_limits&&r.b4w_distance_min<=r.b4w_distance_max?u={min:r.b4w_distance_min,max:r.b4w_distance_max}:t===a.cd&&r.b4w_use_zooming&&(r.b4w_distance_min<=r.b4w_distance_max?u={min:r.b4w_distance_min,max:r.b4w_distance_max}:oa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));t=u;r=d.data;u=null;e.k.vb==a.cd&&r.b4w_use_horizontal_clamping&&r.b4w_horizontal_translation_min<=r.b4w_horizontal_translation_max&&
(u={min:r.b4w_horizontal_translation_min,max:r.b4w_horizontal_translation_max});var r=u,u=d.data,m=null;e.k.vb==a.cd&&u.b4w_use_vertical_clamping&&u.b4w_vertical_translation_min<=u.b4w_vertical_translation_max&&(m={min:u.b4w_vertical_translation_min,max:u.b4w_vertical_translation_max});var u=m,m=d.data,H=null;e.k.vb==a.Kb&&m.b4w_use_pivot_limits&&(H={min_z:m.b4w_pivot_z_min,max_z:m.b4w_pivot_z_max});m=H;switch(f.vb){case a.od:f=ka.F(e.k.n);l(e,f,null,k,v);break;case a.Kb:f=ka.F(e.k.n);c(e,f,g.b4w_target,
k,v,t,m,g.b4w_use_panning);break;case a.cd:f=ka.F(e.k.n),k=x(e,d.data.b4w_hover_zero_level,Ca),b(e,f,k,t,v,r,u,g.b4w_enable_hover_hor_rotation)}G(e);q(e)};a.vM=l;a.xM=c;a.wM=b;a.Wn=q;a.Jc=h;a.WS=z;a.k7=p;a.hd=n;a.S2=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.vc);case "DEPTH":return Boolean(a.We);case "SCREEN":return!Boolean(a.vc)&&!Boolean(a.We);default:C.q("Wrong attachment type: "+b)}};a.Iw=function(a,b,d){switch(b){case "COLOR":case "CUBEMAP":a.vc=d;break;case "DEPTH":a.We=
d;break;case "SCREEN":a.vc=null;a.We=null;break;default:C.q("Wrong attachment type: "+b)}};a.z4=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.vc;case "DEPTH":return a.We;case "SCREEN":return null;default:C.q("Wrong attachment type: "+b)}};a.Qv=function(b,d){(b.type!=a.Od||d!=a.Rc&&d!=a.ed&&d!=a.Qe&&d!=a.Re)&&C.q("make_stereo(): wrong camera type");b.type=d;k(b,6,.065)};a.dZ=k;a.Qn=u;a.$A=e;a.hr=function(a,b){u(a,b);b[0]=C.yi(b[0]+Math.PI);b[1]*=-1;return b};a.Lw=y;a.PY=function(b,d,
c,e,f,g,k){switch(b.type){case a.xi:b.left=d;b.right=c;b.bottom=e;b.top=f;b.near=g;b.far=k;break;default:oa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.am=function(a){return a.k.vb};a.kZ=K;a.Q8=F;a.qD=function(a,b,d){var c=Ea;c[0]=0;c[1]=0;c[2]=-1;ia.transformQuat(c,d,c);c[0]+=b[0];c[1]+=b[1];c[2]+=b[2];var e=Ca;e[0]=0;e[1]=1;e[2]=0;ia.transformQuat(e,d,e);F(a,b,c,e)};a.Pw=J;a.WY=D;a.E_=R;a.D_=function(b){var d=b.k;G(b);M(b);switch(d.vb){case a.Kb:var c=ka.F(d.n),e=ka.N(d.n);
pa.wY(c,e,d.pivot);for(e=0;e<b.I.length;e++)for(var f=b.I[e].da,g=0;g<f.length;g++){var h=f[g];h.type!=a.Rc&&h.type!=a.ed||k(h,ia.dist(c,d.pivot),h.lf)}pa.Rj(b,d.of);break;case a.od:b.oc||pa.Rj(b,d.of)}E(b)};a.hE=E;a.gM=B;a.rM=P;a.rv=d;a.qv=r;a.KY=g;a.aZ=Q;a.QY=t;a.jZ=aa;a.N_=M;a.ms=T;a.Cw=S;a.ns=X;a.N6=function(b){switch(b.type){case a.Od:case a.we:case a.Rc:case a.ed:return!0;default:return!1}};a.wI=function(b){switch(b.type){case a.Od:case a.yh:case a.Rc:case a.ed:return C.Cb(b.Wd);default:return oa.error("get_angular_diameter(): Unsupported camera type: "+
b.type),0}};a.Gk=W;a.FY=function(b,d,c,e,f){var g=1/Math.max(f,e);switch(b.type){case a.Od:case a.yh:f/=2;e/=2;c=-(c-f)/f*Math.tan(C.Cb(b.Wd)/2);d=(d-e)/e*Math.tan(C.Cb(b.Wd)/2)*b.Ab;e=b.near*(c+g);f=b.near*(d+g);c=b.near*(c-g);d=b.near*(d-g);Y.frustum(d,f,c,e,b.near,b.far,b.xb);break;case a.we:case a.xh:b.right=b.top*b.Ab;c=-c/f;d/=e;e=b.top+(c+g)*(b.top+b.top);f=-b.right+(d+g)*(b.right+b.right);c=b.top+(c-g)*(b.top+b.top);d=-b.right+(d-g)*(b.right+b.right);Y.ortho(d,f,c,e,b.near,b.far,b.xb);break;
case a.xi:c=-c/f,d/=e,e=b.top+(c+g)*(b.top-b.bottom),f=b.left+(d+g)*(b.right-b.left),c=b.top+(c-g)*(b.top-b.bottom),d=b.left+(d-g)*(b.right-b.left),Y.ortho(d,f,c,e,b.near,b.far,b.xb)}Y.copy(b.Ob,b.md);Y.multiply(b.xb,b.md,b.md);C.In(b.md,b.Lh)};a.Jz=O;a.BG=V;a.xU=ga;a.oR=function(a){a=a.k;var b=na.Qd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.P=b;var d=na.Gz(1,C.Cf([0,0,0]));a.wa=d;a.Xp=na.kG(1,b);a.Zp=na.mG(1,b);a.Yp=na.lG(1,b)};a.ao=function(b){return ya.xa(b)&&b.k&&b.k.vb==
a.zg};a.Ea=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.Kb};a.xc=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.od};a.$a=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.cd};a.Dv=function(b){return ya.xa(b)&&b.k&&b.I[0].da[0].type==a.we};a.gE=v;a.QT=ba;a.GC=function(b,d,c){b=b.I[0].da[0];switch(b.type){case a.Od:case a.yh:case a.we:case a.xh:case a.Rc:case a.ed:case a.Qe:case a.Re:var e=wa;e.set(d);e[3]=1;qa.transformMat4(e,b.md,e);d=-e[1]/e[3];c[0]=(e[0]/e[3]+1)/2*b.width;c[1]=(d+1)/2*b.height;L.o0(c[0],
c[1],c,b);2<c.length&&(c[2]=(e[2]/Math.abs(e[3])+1)/2);return c;default:return oa.error("Non-compatible camera"),c}};a.uV=function(a){return a.I[0].da[0]};a.Rn=function(b,d){switch(b.type){case a.Od:case a.yh:case a.Rc:case a.ed:var c=Math.tan(C.Cb(b.Wd)/2);switch(d){case "LEFT":return-c*b.Ab;case "RIGHT":return c*b.Ab;case "TOP":return c;case "BOTTOM":return-c}break;case a.we:case a.xh:switch(d){case "LEFT":return-b.top*b.Ab;case "RIGHT":return b.top*b.Ab;case "TOP":return b.top;case "BOTTOM":return-b.top}break;
case a.xi:switch(d){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Qe:case a.Re:switch(d){case "LEFT":return-Math.tan(C.Cb(Math.min(b.kd[1],b.kd[3])));case "RIGHT":return Math.tan(C.Cb(Math.min(b.kd[1],b.kd[3])));case "TOP":return Math.tan(C.Cb(Math.min(b.kd[0],b.kd[2])));case "BOTTOM":return-Math.tan(C.Cb(Math.min(b.kd[0],b.kd[2])))}break;default:C.q("Unknown camera type")}};a.zW=function(b){switch(b.type){case a.we:case a.xh:case a.xi:return!0;
default:return!1}};a.zV=function(b,d){switch(b.type){case a.Od:case a.yh:case a.Rc:case a.ed:var c=C.Cb(b.Wd);return d?c*b.Ab:c;default:return 0}};a.ws=function(a,b,d){a=a.k;ka.pe(b,a.n);ia.copy(d,a.pivot)};a.Nw=function(a,b){var d=a.k,c=ia.subtract(b,d.Wb,Ea),e=ka.F(d.n),c=ia.add(c,e,c);N.Gc(a,c);ia.copy(b,d.Wb)};a.eZ=function(a,b){var d=a.k,c=ia.subtract(b,d.pivot,Ea),e=ka.F(d.n),c=ia.add(c,e,c);N.Gc(a,c);ia.copy(b,d.pivot)};a.OI=ca;a.jD=function(d,c){d.k.vb=c;d.k.mb=null;d.k.la=null;d.k.tb=null;
d.k.Bc=null;d.k.Cc=null;q(d);switch(c){case a.cd:var e=ka.F(d.k.n),f=x(d,0,Ca);b(d,e,f,null,null,null,null,d.k.Jh);break;case a.Kb:e=ca(d,Ea),f=ka.N(d.k.n),f=C.pc(f,C.ad,Ca),f=ia.scaleAndAdd(e,f,10,f),ia.copy(f,d.k.pivot)}};a.$s=function(a){a=a.k;a.vb=0;ia.set(0,0,0,a.pivot);ia.set(0,0,0,a.Wb);a.Ok=!1;a.use_panning=!1;a.mb=null;a.la=null;a.tb=null;a.Bc=null;a.Cc=null;a.ce=null;a.Jh=!0};a.eD=function(a,b){for(var d=0;d<a.length;d++){var c=a[d];70!=c.type&&80!=c.type&&90!=c.type&&100!=c.type||k(c,c.Lk,
b)}};a.iD=function(a,b,d){var c=fa.A();a=ya.ka(a,c).da;for(c=0;c<a.length;c++){var e=a[c];if(90==e.type||100==e.type)90==e.type&&qa.copy(b,e.kd),100==e.type&&qa.copy(d,e.kd),e.qc||W(e),V(e),O(e)}}};b4w.module.__constraints=function(a,m){function l(a){var b={};b.type=a;return b}function c(a,d){a.oc&&a.oc.Fa&&b(a.oc.Fa,a);if(d.Fa){var c=d.Fa;-1==c.Ue.indexOf(a)?c.Ue.push(a):y.q("Descendant object override is forbidden")}a.oc=d}function b(a,b){var d=a.Ue.indexOf(b);-1!=d?a.Ue.splice(d,1):y.q("No descendant object")}function x(a,b,c){switch(b.type){case 1:var k=e.N(a.k.n),l=b.Fa.k.n;c=e.N(b.Fa.k.n);b.oe?(u.copy(b.oe,k),u.multiply(c,k,k)):u.copy(c,k);var m=e.Hc(b.offset,l,D);e.pe(m,a.k.n);m=e.td(b.Fa.k.n);
e.Fe(b.os*m,a.k.n);break;case 9:m=e.F(a.k.n);k=e.N(a.k.n);l=b.Fa.k.n;c=e.N(b.Fa.k.n);u.multiply(u.invert(b.Am,b.Am),k,k);u.multiply(c,k,k);e.Hc(b.offset,l,m);u.copy(c,b.Am);break;case 10:m=e.F(a.k.n);k=e.N(a.k.n);l=b.Fa.k.n;c=e.N(b.Fa.k.n);u.multiply(u.invert(b.Am,b.Am),k,k);u.multiply(c,k,k);e.Hc(b.offset,l,m);u.copy(c,b.Am);m=e.N(a.k.n);k=e.N(b.Fa.k.n);k=u.multiply(k,b.oe,B);k=p.$A(k,F);m=p.$A(m,J);p.ms(a,y.zl(m[0],k[0]+b.xS,k[0]+b.wS),y.zl(m[1],k[1]+b.vS,k[1]+b.yS));break;case 13:var m=e.F(a.k.n),
k=e.N(a.k.n),l=b.Fa.k.n,q=e.F(l),I=b.yZ,x=D,H=B;e.Hc(b.offset,l,x);y.ex(x,m,c,I,m);l=D;K.sub(q,m,l);K.normalize(l,l);var R=k,m=P,q=m.subarray(0,3),x=m.subarray(3,6),W=m.subarray(6,9);K.copy(l,W);K.negate(W,W);K.normalize(W,W);Boolean(.999999<Math.abs(K.dot(l,y.Oc)))?(l=n.fromQuat(u.normalize(R,H),d),K.copy(l.subarray(0,3),q)):K.cross(y.Oc,W,q);K.normalize(q,q);K.cross(W,q,x);K.normalize(x,x);u.fromMat3(m,H);u.normalize(H,H);y.MM(H,k,c,.16*I,k);break;case 2:k=e.N(a.k.n);c=f;z.Qu(b.Fa,b.xl,!0,c);e.multiply(b.Fa.k.n,
c,c);k[0]=c[4];k[1]=c[5];k[2]=c[6];k[3]=c[7];b.oe&&(u.copy(b.oe,k),u.multiply(k,b.oe,k));e.Fe(b.os*c[3],a.k.n);m=e.F(a.k.n);e.Hc(b.offset,c,m);break;case 3:m=e.F(a.k.n);k=e.N(a.k.n);c=e.F(b.Fa.k.n);A(m,k,c);break;case 4:m=e.F(a.k.n);k=e.N(a.k.n);c=b.target;A(m,k,c);break;case 5:m=e.F(a.k.n);k=e.N(a.k.n);c=e.F(b.Fa.k.n);A(m,k,c);k=K.dist(m,c);if(k=k>b.dist_max?k-b.dist_max:k<b.Oq?k-b.Oq:0)K.sub(c,m,D),K.normalize(D,D),K.scale(D,k,D),K.add(m,D,m);break;case 6:m=e.F(a.k.n);k=e.N(a.k.n);c=b.target;A(m,
k,c);k=K.dist(m,c);if(k=k>b.dist_max?k-b.dist_max:k<b.Oq?k-b.Oq:0)K.sub(c,m,D),K.normalize(D,D),K.scale(D,k,D),K.add(m,D,m);break;case 7:l=b.Fa.k.n;m=e.F(a.k.n);e.Hc(b.offset,l,m);break;case 8:q=e.F(b.Fa.k.n);m=e.F(a.k.n);K.add(q,b.offset,m);break;case 14:k=e.N(a.k.n);l=b.Fa.k.n;c=e.N(b.Fa.k.n);b.oe?(u.copy(b.oe,k),u.multiply(c,k,k)):u.copy(c,k);m=e.F(a.k.n);e.Hc(b.offset,l,m);break;case 11:e.multiply(b.Fa.k.n,b.sx,a.k.n);break;case 12:m=b.sx;c=f;z.Qu(b.Fa,b.xl,!0,c);e.multiply(b.Fa.k.n,c,c);e.multiply(c,
m,a.k.n);break;case 15:k=b.Fa,c=p.uV(k),m=e.F(a.k.n),l=p.Rn(c,"LEFT"),q=p.Rn(c,"RIGHT"),I=p.Rn(c,"TOP"),H=p.Rn(c,"BOTTOM"),x="heights"==b.hor_units?I-H:q-l,b.rK?(l=p.Rn(c,"LEFT"),m[0]=l+x*b.MB):(q=p.Rn(c,"RIGHT"),m[0]=q-x*b.MB),l="heights"==b.vert_units?I-H:q-l,m[1]=b.rN?I-l*b.TD:H+l*b.TD,p.zW(c)?m[2]=-b.distance:(m[2]=-1,K.normalize(m,m),K.scale(m,b.distance/Math.abs(m[2]),m)),e.Xc(m,k.k.n,m),c=e.F(k.k.n),K.add(c,m,m),m=e.N(a.k.n),k=e.N(k.k.n),b.oe?(u.copy(b.oe,m),u.multiply(k,m,m)):u.copy(k,m)}"CAMERA"==
a.k.type&&(m=a.k.of,10==b.type&&(c=e.N(b.Fa.k.n),m=K.transformQuat(m,c,r)),p.hE(a),h(a,m))}function q(a,b){switch(b.type){case 1:var d=b.target.k.n,c=f;e.invert(a.k.n,c);e.multiply(c,d,c);z.EY(a,b.xl,c)}a.kC=!0}function A(a,b,d){var c=D;y.pc(b,y.ad,c);K.normalize(c,c);var e=R;K.subtract(d,a,e);K.normalize(e,e);a=y.aD(c,e,I);u.multiply(a,b,b);u.normalize(b,b)}function h(a,b,d){var c=a.k,f=e.N(c.n),k=y.pc(f,y.Oc,D);K.normalize(k,k);if(.999999<Math.abs(K.dot(b,k)))k=u.identity(B);else{var h=K.cross(b,
k,R);K.normalize(h,h);c.vb==p.Kb?c.Ok&&K.negate(h,h):(c=y.pc(f,y.el,E),0<K.dot(c,b)&&K.negate(h,h));c=y.pc(f,y.ri,E);K.normalize(c,c);var n=y.W(K.dot(c,h),-1,1),k=-.999999>=n?u.setAxisAngle(k,Math.acos(n),B):u.rotationTo(c,h,B);u.normalize(k,k)}u.multiply(k,f,f);d&&(d=y.pc(f,y.zj,D),0>K.dot(b,d)&&u.rotateZ(f,Math.PI,f));p.hE(a)}var z=m("__armature"),p=m("__camera"),n=m("__mat3"),k=m("__print"),u=m("__quat"),e=m("__tsr"),y=m("__util"),K=m("__vec3");a.L0=1;a.K0=2;a.P0=3;a.Q0=4;a.F0=5;a.G0=6;a.M0=7;
a.E0=8;a.J0=9;a.I0=10;a.C0=11;a.D0=12;a.H0=13;a.N0=14;a.O0=15;a.A0=1;var F=new Float32Array(2),J=new Float32Array(2),D=new Float32Array(3),R=new Float32Array(3),E=new Float32Array(3),I=new Float32Array(4),B=new Float32Array(4),P=new Float32Array(9),d=new Float32Array(9),f=e.create(),r=new Float32Array(3);a.TF=function(a,b,d,e,f){var k=l(1);k.Fa=b;k.offset=new Float32Array(d);k.oe=e?new Float32Array(e):null;k.os=f;c(a,k);x(a,k,0)};a.YQ=function(a,b,d,e,f){var k=l(2);k.Fa=b;k.xl=d;k.offset=new Float32Array(e);
k.oe=null;k.os=f;c(a,k);x(a,k,0)};a.WQ=function(a,b){var d=l(9);e.N(a.k.n);var f=e.N(b.k.n);d.Fa=b;d.offset=new Float32Array([0,-.8,1.2]);d.Am=new Float32Array(f);c(a,d);x(a,d,0)};a.VQ=function(a,b,d,f,k,h,n,r){var m=l(10),p=e.N(a.k.n),q=e.N(b.k.n);m.Fa=b;m.offset=new Float32Array(d);m.Am=new Float32Array(q);m.wS=y.yi(k);m.xS=y.yi(h);m.yS=y.Dg(n,-Math.PI,Math.PI);m.vS=y.Dg(r,-Math.PI,Math.PI);f?(m.oe=new Float32Array(f),u.copy(f,p),u.multiply(q,p,p)):m.oe=u.create();c(a,m);x(a,m,0)};a.TQ=function(a,
b,d,e){var f=l(13);f.Fa=b;f.offset=new Float32Array(d);f.yZ=e;c(a,f);x(a,f,0)};a.aR=function(a,b,d,e){var f=l(14);f.Fa=b;f.offset=new Float32Array(d);f.os=1;f.oe=e?new Float32Array(e):null;c(a,f);x(a,f,0)};a.M7=b;a.cR=function(a,b){var d=l(3);d.Fa=b;c(a,d);x(a,d,0)};a.dR=function(a,b){var d=l(4);d.target=new Float32Array(b);c(a,d);x(a,d,0)};a.OQ=function(a,b,d,e){var f=l(5);f.Fa=b;f.Oq=d;f.dist_max=e;c(a,f);x(a,f,0)};a.PQ=function(a,b,d,e){var f=l(6);f.target=new Float32Array(b);f.Oq=d;f.dist_max=
e;c(a,f);x(a,f,0)};a.$Q=function(a,b,d){var e=l(7);e.Fa=b;e.offset=new Float32Array(d);c(a,e);x(a,e,0)};a.MQ=function(a,b,d){var e=l(8);e.Fa=b;e.offset=new Float32Array(d);c(a,e);x(a,e,0)};a.KQ=function(a,b,d){var e=l(11);e.Fa=b;e.sx=new Float32Array(d);c(a,e);x(a,e,0)};a.LQ=function(a,b,d,e){var f=l(12);f.Fa=b;f.xl=d;f.sx=new Float32Array(e);c(a,f);x(a,f,0)};a.sz=function(a,b,d){var e=l(15);e.Fa=b;if(y.Sh(d.left))e.rK=!0,e.MB=d.left;else if(y.Sh(d.right))e.rK=!1,e.MB=d.right;else{k.error("append_stiff_viewport: Wrong positioning params");
return}if(y.Sh(d.top))e.rN=!0,e.TD=d.top;else if(y.Sh(d.bottom))e.rN=!1,e.TD=d.bottom;else{k.error("append_stiff_viewport: Wrong positioning params");return}y.Sh(d.distance)?(e.distance=d.distance,e.oe=y.Sh(d.rotation)?new Float32Array(d.rotation):null,e.hor_units=y.Sh(d.hor_units)?d.hor_units:"widths",e.vert_units=y.Sh(d.vert_units)?d.vert_units:"heights",c(a,e),x(a,e,0)):k.error("append_stiff_viewport: Wrong positioning params")};a.F_=function(a,b){a.oc&&x(a,a.oc,b)};a.ZQ=function(a,b,d,c,e){var f=
l(1);f.xl=d;f.target=b;f.offset=new Float32Array(c);f.oe=e?new Float32Array(e):null;f.os=1;b=f.target;d=f.xl;c=a.k.Fg[d];e=b.$z;for(var k=0;k<e;k++){var h=e[k];if(h[0]==a&&h[1]==d){e.splice(k,1);break}}b.$z.push([a,d]);c.oc=f;q(a,f)};a.x_=function(a,b){var d=a.k.Fg[b];d.oc&&q(a,d.oc)};a.wY=A;a.Rj=h;a.kS=function(a){return a.oc?!0:!1};a.remove=function(a){a.oc.Fa&&b(a.oc.Fa,a);a.oc=null};a.P5=function(a){return a.oc?a.oc.type:null};a.dg=function(a){a=a.oc;return!a||11!=a.type&&12!=a.type?!1:!0};a.Ru=
function(a){if((a=a.oc)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=f;z.Qu(a.Fa,a.xl,!0,b);e.multiply(a.Fa.k.n,b,b);return b}return null};a.cg=function(a){a=a.oc;return!a||11!=a.type&&12!=a.type?null:a.sx}};b4w.module.__armature=function(a,m){function l(a){a=a.k;for(var b=a.No,c=a.Tv,k=0;k<b.length;k++){for(var h=b[k],n=c[k],l=0;l<n.length;l+=2)for(var u=n[l],m=n[l+1],p=0;4>p;p++)h.me[u+p]=a.me[m+p],h.Ee[u+p]=a.Ee[m+p],h.se[u+p]=a.se[m+p],h.Ie[u+p]=a.Ie[m+p];h.Ze=a.Ze}}function c(a,b,k,h){var n=a.zN,l=a.Rk,u=a.rx,m=a.aL;m?(m=m.rx,b?x.multiply(m,n,u):(b=p,x.invert(m,b),x.multiply(b,u,n))):b?x.copy(n,u):x.copy(u,n);n=z;x.invert(l,n);x.multiply(u,n,n);l=a.Kj;k[4*l]=n[0];k[4*l+1]=n[1];k[4*l+2]=n[2];k[4*
l+3]=n[3];h[4*l]=n[4];h[4*l+1]=n[5];h[4*l+2]=n[6];h[4*l+3]=n[7];a=a.QH;for(l=0;l<a.length;l++)u=a[l],u.oc||c(u,!0,k,h)}var b=m("__util"),x=m("__tsr"),q=m("__quat"),A=m("__mat4"),h=m("__vec3"),z=x.create(),p=x.create(),n=new Float32Array(4),k=new Float32Array(4),u=new Float32Array(4);a.Uk=function(a,c){for(var k=a.data.bones,n=a.pose.bones,l={},u=0;u<n.length;u++){var m=n[u],p=m.bone,q=p.name,B=l[q]={Kj:0,bO:-1,aL:null,QH:[],du:[],oc:null,eE:x.create(),zN:x.create(),Rk:x.create(),rx:x.create(),px:x.create(),
fE:x.create(),qx:!1,gN:new Float32Array(3)},q=new Float32Array(p.matrix_local),P=new Float32Array(16);A.invert(q,P);var m=new Float32Array(m.matrix_basis),d=B.gN;h.subtract(b.Cf(p.tail_local),b.Cf(p.head_local),d);b.j0(d,P,d);x.Tg(q,B.Rk);x.Tg(m,B.px);x.copy(B.Rk,B.rx)}for(u=0;u<k.length;u++){q=k[u].name;m=b.Dd("name",q,n);B=l[q];p=m.parent_recursive;B.du.push(B);for(P=0;P<p.length;P++)m=p[P],m=m.name,m=l[m],B.du.push(m);p.length?(m=p[0],m=m.name,m=l[m],B.aL=m,x.invert(m.Rk,z),x.multiply(z,B.Rk,B.eE),
m.QH.push(B)):x.copy(B.Rk,B.eE);B.Kj=u;B.name=q;x.multiply(B.eE,B.px,B.zN)}c.k.Fg=l};a.Qu=function(a,b,c,h){var l=a.k,m=l.Ze;b=l.Fg[b];var R=b.Kj;a=b.Rk;var E=l.se,I=l.Ie,B=l.me,l=l.Ee,P=E[4*R+1],d=E[4*R+2],f=E[4*R+3],r=I[4*R+1],g=I[4*R+2],Q=I[4*R+3];n[0]=(1-m)*E[4*R]+m*I[4*R];n[1]=(1-m)*P+m*r;n[2]=(1-m)*d+m*g;n[3]=(1-m)*f+m*Q;k[0]=B[4*R];k[1]=B[4*R+1];k[2]=B[4*R+2];k[3]=B[4*R+3];u[0]=l[4*R];u[1]=l[4*R+1];u[2]=l[4*R+2];u[3]=l[4*R+3];q.slerp(k,u,m,k);m=z;x.pD(n,m);x.di(k,m);c?(c=p,x.translate(a,b.gN,
c),x.multiply(m,c,m)):x.multiply(m,a,m);x.copy(m,h)};a.EY=function(a,b,k){var h=a.k;b=h.Fg[b];var n=h.se,u=h.me;x.copy(k,b.rx);c(b,!1,n,u);h.Ze=0;l(a)};a.U_=l;a.y_=c;a.gS=function(a,b){return b in a.k.Fg}};b4w.module.__container=function(a,m){var l,c,b,x,q;function A(a,b){l=a;c=b}function h(){var a=P.getBoundingClientRect();A(a.left,a.top)}function z(){return E.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function p(b,c,k){if(!b||!c){b=a.Zx;c=a.Yx;var h=f;h.style.width=a.Zx+"px";h.style.height=a.Yx+"px"}var h=P,l=d;!1!==k&&(h.style.width=b+"px",h.style.height=c+"px",l&&(l.style.width=b+"px",l.style.height=c+"px"));l&&(l.width=b,l.height=c,e.Ks());k=Math.floor(b*E.canvas_resolution_factor);c=Math.floor(c*
E.canvas_resolution_factor);z()&&(k*=window.devicePixelRatio,c*=window.devicePixelRatio);if(l=F.Nh())l=l.s,k=Math.floor(k*l.Ao),c=Math.floor(c*l.Ao);h.width=k;h.height=c;var l=Math.min(B.drawingBufferWidth,I.VB,I.$B[0]),r=Math.min(B.drawingBufferHeight,I.VB,I.$B[1]);if(k>l||c>r)K.warn("Canvas size exceeds platform limits, downscaling"),l=Math.min(l/k,r/c),k*=l,c*=l,h.width=k,h.height=c;F.uM(k,c,k/b);F.Ca()&&D.D(F.A().Cj);u.J_(h.width,h.height);u.Yg()&&(n.update(),F.update(J.cm(),0),n.LN())}var n=
m("__anchors"),k=m("__config"),u=m("__data"),e=m("__hud"),y=m("__input"),K=m("__print"),F=m("__scenes"),J=m("__time"),D=m("__transform"),R=m("__util"),E=k.B,I=k.Fi,B=null,P=null,d=null,f=null,r=!1;x=b=0;q=1;l=c=0;a.Zx=320;a.Yx=240;a.Lf=function(a){B=a};a.Qi=function(){return P};a.FI=function(){return d};a.af=function(){return f};a.Vg=function(a,b){a&&a.parentNode?(P=a,d=b,f=a.parentNode):R.q("canvas container is not available")};a.xv=function(a,b){b=b||"LAST";switch(b){case "FIRST":f.insertBefore(a,
f.firstElementChild);break;case "JUST_BEFORE_CANVAS":f.insertBefore(a,P);break;case "JUST_AFTER_CANVAS":P.nextElementSibling?f.insertBefore(a,P.nextElementSibling):f.appendChild(a,P);break;case "LAST":f.appendChild(a,P);break;default:K.error(b+" invalid stack order")}};a.zJ=function(){return b};a.yJ=function(){return x};a.PL=A;a.CN=h;a.pZ=function(a,d,c){b=a;x=d;q=c;h()};a.SA=function(){r=!0};a.oq=function(a,b,d){d||(d=new Float32Array(2));var e=d;r&&(h(),r=!1);e[0]=a-l;a=d;r&&(h(),r=!1);a[1]=b-c;
return d};a.cu=function(a,d,c,e){c||(c=new Float32Array(2));c[0]=a*q;c[1]=d*q;e&&(a=e.width/b,c[0]*=a,c[1]*=a);return c};a.o0=function(a,d,c,e){c||(c=new Float32Array(2));c[0]=a/q;c[1]=d/q;e&&(a=e.width/b,c[0]/=a,c[1]/=a)};a.ZJ=function(b){return b&&b.parentNode?b.parentNode==f?!0:a.ZJ(b.parentNode):!1};a.vW=z;a.KU=function(a){var b=document.getElementsByTagName("script");a=R.hj(a);for(var d=0;d<b.length;d++)if(b[d].src==a)return b[d];return null};a.resize=p;a.Bk=function(a){var b=f,d=P,c=b.clientWidth,
b=b.clientHeight;if(a||c!=d.clientWidth||b!=d.clientHeight)(a="HMD"===E.stereo&&y.DJ())&&a.isPresenting||p(c,b,!0)};a.reset=function(){f=d=P=B=null}};b4w.module.__data=function(a,m){function l(a,b){Ta[b.id]=null;za[b.id]=null}function c(a,b,d,c){a instanceof ArrayBuffer&&(a=N.EJ(a,c));c=a.width;a=a.height;wa.log("%cLOAD IMAGE "+c+"x"+a,"color: #"+(2048<c||2048<a?"a00":1024<c||1024<a?"aa0":"0a0"),b);-1==b.indexOf(hb)&&d&&wa.warn("image",b,"is not from app root.")}function b(a,b,d,c,e,f){(c=b.Qg)||Da.q("Nothing requested");oa.Vd([{id:c,type:oa.dn,url:c,Wg:b.fk}],function(c,f,k,g){if(c){wa.log("%cLOAD METADATA","color: #616",g);f=Da.WM(c.b4w_format_version);
switch(Da.$N(f,sa.rm)){case -1:f[0]<sa.rm[0]?Da.q("JSON version is too old relative to B4W engine: "+Da.$k(f)+", required: "+Da.$k(sa.rm)+". Reexport scene with the latest B4W addon to fix it."):wa.warn("JSON version is a bit old relative to B4W engine: "+Da.$k(f)+", required: "+Da.$k(sa.rm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>sa.rm[0]?Da.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
wa.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}sa.RB=f;for(var h in c)a[h]=c[h];b.Mb&&(Va=Aa.Iu(a.scenes));(c=a.binaries[0].binfile)?b.qG=c:(qa.Zw(b,"load_binaries"),qa.Zw(b,"prepare_bindata"));sa.is_mobile_device||qa.Zw(b,"mobile_media_start");sa.antialiasing&&sa.smaa||qa.Zw(b,"load_smaa_textures");if(a.b4w_export_errors)for(c=0;c<a.b4w_export_errors.length;c++)h=a.b4w_export_errors[c],(b.Mb&&"PRIMARY"==h.type||
"ALL"==h.type)&&wa.uU(h.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(c=0;c<a.b4w_export_warnings.length;c++)h=a.b4w_export_warnings[c],(b.Mb&&"PRIMARY"==h.type||"ALL"==h.type)&&wa.vU(h.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.fk&&D(a);e(b,d)}else qa.GF(b)},null,function(a){f(b,d,a)})}function x(a,b,d,c,e,f){(c=pa(b.Qg)+b.qG)||Da.q("Binary data is missing");oa.Vd([{id:c,
type:oa.at,url:c,Wg:b.fk}],function(c,f,k,g){c?(wa.log("%cLOAD BINARY","color: #616",g),a.bin_data=c,c=h(c),f=Da.WM(a.b4w_format_version),c[0]!=f[0]&&Da.q("BIN version does not match to JSON version: "+Da.$k(c)+", required: "+Da.$k(sa.rm)+". Couldn't load the scene. Reexport scene to fix it."),c[1]!=f[1]&&wa.warn("BIN version does not match to JSON version: "+ +Da.$k(c)+", required: "+Da.$k(sa.rm)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,d)):qa.GF(b)},null,function(a){f(b,
d,a)})}function q(a,b,d,c,e){Za.RG()&&e(b,d)}function A(a,b,d,c,e){c=a.bin_data;var f=a.binaries[0],k=a.objects,g=a.meshes;a=a.actions;var n=Da.nS();h(c);for(var l=["indices"],C=["position","texcoord","texcoord2","shade_tangs"],v=["normal","tangent"],r=["group"],u=["color"],m=0;m<g.length;m++)for(var t=g[m].submeshes,p=0;p<t.length;p++){for(var y in t[p]){var H=t[p][y][1];if(-1!=l.indexOf(y)){var w=t[p][y][0]*Da.KE+f["int"]+12,q=t[p],Y=y,O=c;if(n)var Z=new Uint32Array(O,w,H);else for(var Z=new Uint32Array(H),
O=new DataView(O),L=0;L<H;L++)Z[L]=O.getUint32(w+L*Da.KE,!0);q[Y]=Z}else if(-1!=C.indexOf(y))w=t[p][y][0]*Da.Aj+f["float"]+12,t[p][y]=z(c,w,H,n);else if(-1!=v.indexOf(y)){w=t[p][y][0]*Da.Hp+f["short"]+12;q=t[p];Y=y;O=c;Z=new Float32Array(H);O=new DataView(O);for(L=0;L<H;L++)Z[L]=O.getInt16(w+L*Da.Hp,!0)/32767;q[Y]=Z}else if(-1!=r.indexOf(y)){w=t[p][y][0]*Da.Hp+f.ushort+12;q=t[p];Y=y;O=c;Z=new Float32Array(H);O=new DataView(O);for(L=0;L<H;L++)Z[L]=O.getUint16(w+L*Da.Hp,!0)/65535;q[Y]=Z}else if(-1!=
u.indexOf(y)){w=t[p][y][0]*Da.Tx+f.uchar+12;q=t[p];Y=y;O=c;Z=new Float32Array(H);O=new DataView(O);for(L=0;L<H;L++)Z[L]=O.getUint8(w+L*Da.Tx,!0)/255;q[Y]=Z}}H=t[p];if(g[m].b4w_shape_keys.length)for(w=H.base_length,q=H.normal.length/w/3,H.tbn_quat=Da.fr(H.normal.subarray(0,3*w),H.tangent.subarray(0,4*w),new Float32Array(H.normal.length/3*4)),Y=1;Y<q;Y++)for(O=Y*w,Z=0;Z<w;Z++){var B=H.normal.subarray(3*Z,3*(Z+1)),L=ra.add(H.normal.subarray(3*(O+Z),3*(O+Z+1)),B,eb);if(H.tangent.length){var W=H.tangent.subarray(4*
Z,4*(Z+1)),xa=U.add(H.tangent.subarray(4*(O+Z),4*(O+Z+1)),W,ob),B=Da.uJ(B,W,$a),L=Da.uJ(L,xa,sb);Pa.invert(B,$a);L=Pa.multiply(L,B,$a)}else L=Pa.rotationTo(B,L,$a);H.tbn_quat.set(L,4*(O+Z))}else H.tbn_quat=Da.fr(H.normal,H.tangent)}for(y=0;y<k.length;y++)for(g=k[y].particle_systems,l=0;l<g.length;l++)C=g[l],C.transforms=z(c,C.transforms[0]*Da.Aj+f["float"]+12,C.transforms[1],n);for(k=0;k<a.length;k++){y=a[k];g=y.fcurves;l=y.frame_range;v=l[0];r=l[1];u=ya.kV(v,r);l=null;0>u&&(u=0);var t=m=!1,I;for(I in g)m|=
-1<I.indexOf("rotation_euler"),t|=-1<I.indexOf("rotation_quaternion");C=[];for(I in g)if(m&&t&&-1<I.indexOf("rotation_euler"))delete g[I];else{var p=g[I],P;for(P in p)H=p[P],w=z(c,f["float"]+H.bin_data_pos[0]*Da.Aj+12,H.bin_data_pos[1],n),q=new Float32Array(u),null===l&&(l=new Int8Array(u)),ya.kR(H,w,q,l,v,r),H.xf=q;-1<I.indexOf("rotation_euler")&&(ya.EU(g[I]),C.push(I))}for(v=0;v<C.length;v++)r=C[v],u=r.replace("euler","quaternion"),g[u]=g[r],delete g[r];y.zQ=l}e(b,d)}function h(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function z(a,b,d,c){if(c)c=new Float32Array(a,b,d);else{c=new Float32Array(d);a=new DataView(a);for(var e=0;e<d;e++)c[e]=a.getFloat32(b+e*Da.Aj,!0)}return c}function p(a,b,c,e,f){var g=a.cameras,h=a.groups,n=a.materials,l=a.meshes,C=a.node_groups,v=a.objects,r=a.particles,m=a.scenes,t=a.speakers,p=a.lamps,H=a.textures,q=a.worlds;C||(wa.warn('"node_groups" datablock undefined. reexport main scene.'),C=a.node_groups=[]);
for(var Y="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),O={},Z=0;Z<Y.length;Z++)for(var L=a[Y[Z]],z=0;z<L.length;z++){var B=L[z];O[B.uuid]=B}for(var W=0;W<m.length;W++){for(var xa=m[W],I=xa.objects,fa=0;fa<I.length;fa++)d(I,fa,O);xa.camera&&d(xa,"camera",O);xa.world&&d(xa,"world",O)}for(W=0;W<h.length;W++)for(var Q=h[W].objects,fa=0;fa<Q.length;fa++)d(Q,fa,O);for(W=0;W<v.length;W++){var ba=v[W];
ba.dupli_group&&d(ba,"dupli_group",O);ba.parent&&d(ba,"parent",O);ba.dg_parent&&d(ba,"dg_parent",O);if(ba.animation_data){var ia=ba.animation_data;ia.action&&d(ia,"action",O);if(ia.nla_tracks)for(fa=0;fa<ia.nla_tracks.length;fa++)for(var x=ia.nla_tracks[fa],ha=0;ha<x.strips.length;ha++)x.strips[ha].action&&d(x.strips[ha],"action",O)}switch(ba.type){case "MESH":ba.data||Da.q("mesh not found for object "+ba.name);d(ba,"data",O);for(var V=!1,F=ba.modifiers,fa=0;fa<F.length;fa++){var Ea=F[fa];"ARMATURE"==
Ea.type?(V&&wa.warn('Object "'+ba.name+'" has more than one armature modifiers. Only the first one will be used.'),V=!0,d(Ea,"object",O)):"CURVE"==Ea.type&&d(Ea,"object",O)}var N=ba.particle_systems;if(N)for(fa=0;fa<N.length;fa++)d(N[fa],"settings",O);break;case "ARMATURE":d(ba,"data",O);for(var G=ba.pose.bones,ma=ba.data.bones,fa=0;fa<G.length;fa++){var R=G[fa];R.bone=ma[R.bone];var J=R.constraints;if(J)for(ha=0;ha<J.length;ha++){var E=J[ha];E.target&&d(E,"target",O)}for(var Ca=R.parent_recursive,
ha=0;ha<Ca.length;ha++)Ca[ha]=G[Ca[ha]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":d(ba,"data",O)}if(J=ba.constraints)for(fa=0;fa<J.length;fa++)E=J[fa],E.target&&d(E,"target",O);var ca=ba.lod_levels;if(ca)for(fa=0;fa<ca.length;fa++){var oa=ca[fa];oa.object&&d(oa,"object",O)}}for(W=0;W<l.length;W++)for(var T=l[W].materials,fa=0;fa<T.length;fa++)d(T,fa,O);for(W=0;W<n.length;W++){for(var A=n[W],la=A.texture_slots,fa=0;fa<la.length;fa++)d(la[fa],"texture",O);var qa=A.node_tree;qa&&P(qa,
O)}for(W=0;W<C.length;W++)(qa=C[W].node_tree)&&P(qa,O);for(W=0;W<H.length;W++){var ea=H[W],M=ea.type;"IMAGE"!=M&&"ENVIRONMENT_MAP"!=M||d(ea,"image",O)}for(W=0;W<g.length;W++){var ga=g[W];ga.dof_object&&d(ga,"dof_object",O)}for(W=0;W<t.length;W++){var ja=t[W];ja.sound&&d(ja,"sound",O);if(ja.animation_data&&(ia=ja.animation_data,ia.action&&d(ia,"action",O),ia.nla_tracks))for(fa=0;fa<ia.nla_tracks.length;fa++)for(x=ia.nla_tracks[fa],ha=0;ha<x.strips.length;ha++)x.strips[ha].action&&d(x.strips[ha],"action",
O)}for(W=0;W<r.length;W++){for(var X=r[W],la=X.texture_slots,fa=0;fa<la.length;fa++)d(la[fa],"texture",O);X.dupli_group&&d(X,"dupli_group",O);X.dupli_object&&d(X,"dupli_object",O)}for(W=0;W<p.length;W++){var ka=p[W];if(ka.animation_data&&(ia=ka.animation_data,ia.action&&d(ia,"action",O),ia.nla_tracks))for(fa=0;fa<ia.nla_tracks.length;fa++)for(x=ia.nla_tracks[fa],ha=0;ha<x.strips.length;ha++)x.strips[ha].action&&d(x.strips[ha],"action",O)}for(W=0;W<q.length;W++){var va=q[W];if(la=va.texture_slots)for(fa=
0;fa<la.length;fa++)d(la[fa],"texture",O);if(va.animation_data&&(ia=va.animation_data,ia.action&&d(ia,"action",O),ia.nla_tracks))for(fa=0;fa<ia.nla_tracks.length;fa++)for(x=ia.nla_tracks[fa],ha=0;ha<x.strips.length;ha++)x.strips[ha].action&&d(x.strips[ha],"action",O)}Ga.iS(a);D(a);for(var na=pa(b.Qg),aa=a.textures,ta=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Va.b4w_anisotropic_filtering,U=0;U<aa.length;U++)b.Mb||"SCENE"!=aa[U].b4w_source_type||(aa[U].b4w_source_id=""),Fa.MT(aa[U],ta,a.scenes,b.id,
na);for(var Pa={},Za=a.objects,da=0;da<Za.length;da++){var Qa=Za[da];if("MESH"===Qa.type&&!Qa.particle_systems.length)for(var ub=Qa.data,Na=ub.name,ra=ub.submeshes,sb=ub.materials,sa=0;sa<ra.length;sa++)0!==ra[sa].base_length||Pa[Na]||(sb[sa]&&wa.warn('material "'+sb[sa].name+'" is not assigned to any face (object "'+Qa.name+'").'),Pa[Na]=!0)}for(var lb=a.meshes,Ia=0;Ia<lb.length;Ia++){var fb=lb[Ia];fb.materials.length||fb.uv_textures.length&&wa.warn('mesh "'+fb.name+'" has a UV map but has no exported material.')}a.materials.push(Ga.bT());
for(var La=a.meshes,Ja=Da.Dd("name","DEFAULT",a.materials),Sa=0;Sa<La.length;Sa++){var Ta=La[Sa];0==Ta.materials.length&&Ta.materials.push(Ja)}for(var wb=a.actions,hb=b.id,vb=0;vb<wb.length;vb++){var eb=wb[vb];eb.AQ=hb;ya.JQ(eb)}for(var $a=a.scenes,mb=0;mb<$a.length;mb++){for(var ob=$a[mb],Nb=[],Zb=[],Vb=$a[mb].objects,cb=0;cb<Vb.length;cb++){var mc=Vb[cb];S(Vb,mc,null,Nb,Zb);var Ac=mc.dupli_group;if(Ac)for(var Ic=Ac.objects,Cb=0;Cb<Ic.length;Cb++)S(Ic,Ic[Cb],mc,Nb,Zb)}for(cb=0;cb<Zb.length;cb++)for(var Wb=
Zb[cb],Bc=[ob],Qb=0;Qb<Bc.length;Qb++){for(var rb=Bc[Qb].objects,Uc=0;Uc<rb.length;Uc++){var Vc=rb[Uc].dupli_group;if(Vc){var db=Vc.objects,Ya=db.indexOf(Wb);-1<Ya&&db.splice(Ya,1)}}var Ya=rb.indexOf(Wb);-1<Ya&&rb.splice(Ya,1)}for(cb=0;cb<Nb.length;cb++)Da.eR(Nb[cb][0],Nb[cb][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[Aa.Iu(a.scenes)],wa.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Jc=b.Mb?Va:Aa.Iu(a.scenes);Ec.OY(Va.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Va),
1),a.scenes.unshift(Va));for(var Nc=0;Nc<a.scenes.length;Nc++){var Cc=a.scenes[Nc];Cc.s={};Cc.EF=Cc==Jc;Cc.BQ=b.Mb;Ra.enabled&&Cc.b4w_enable_physics&&(b.Mb||!ua.Dw(Va)&&Cc==Aa.Iu(a))&&ua.kW(Cc)}for(var ec=0;ec<a.scenes.length;ec++){for(var Zc=a.scenes[ec],Xb=u(Zc),Oc=0;Oc<Xb.length;Oc++){var Dc=Xb[Oc];Ba.jS(Dc,Zc,a)&&(Dc.rd||(Dc.rd=[]),Dc.rd.push(b.Mb?Zc:Va))}for(var qd=Xb,md=0;md<qd.length;md++){var nd=qd[md];if(nd.rd&&"WORLD"!=nd.type)for(var wd=nd.particle_systems,rd=0;rd<wd.length;rd++){var fd=
wd[rd].settings;if("HAIR"==fd.type)if("OBJECT"==fd.render_type){var sc=fd.dupli_object;sc.rd||(sc.rd=nd.rd.slice())}else if("GROUP"==fd.render_type)for(var gd=fd.dupli_group,sd=0;sd<gd.objects.length;sd++)sc=gd.objects[sd],sc.rd||(sc.rd=nd.rd.slice())}}}for(var hd=a.scenes,td=[],Hb=0;Hb<hd.length;Hb++)y(hd[Hb].objects,0,b.Mb,td);za[b.id]=[];for(Hb=0;Hb<td.length;Hb++)for(var xd=td[Hb],Wc=0;Wc<xd.length;Wc++)for(var Jd=xd[Wc],zd=0;zd<Jd.length;zd++)za[b.id].push(Jd[zd]);for(var Ad=a.particles,Hb=0;Hb<
Ad.length;Hb++){var ud=Ad[Hb].dupli_object;ud&&(ud.DF=!0,za[b.id].push(ud));var Kd=Ad[Hb].dupli_group;if(Kd)for(var Ld=Kd.objects,Wc=0;Wc<Ld.length;Wc++)ud=Ld[Wc],ud.DF=!0,za[b.id].push(ud)}for(var Bd=za[b.id],Hb=Bd.length-1;0<=Hb;Hb--)Bd[Hb].rd||Bd.splice(Hb,1);for(var Md=za[b.id],ec=0;ec<Md.length;ec++)if(Dc=Md[ec],!b.Mb&&Dc.parent&&-1<Mb.indexOf(Dc.parent.type)&&(Dc.parent=""),"MESH"==Dc.type){var Cd=Ga.hR(Dc);Cd&&(a.meshes.push(Cd),Dc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],
Ed=Nd.world;Ed.rd||(Ed.rd=[]);Ed.rd.push(b.Mb?Nd:Va)}for(var Od=a.node_groups,Pd=a.materials,od=0;od<Od.length;od++){var vd=Od[od].node_tree;if(vd){var yd=[];k(vd,yd,!0);vd.jz=yd}}for(od=0;od<Pd.length;od++)if(vd=Pd[od].node_tree)yd=[],k(vd,yd,!1),vd.jz=yd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=u(Gd);Ga.pR(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Mb?Rd:Va;Boolean(K(b.id,Id,"SPEAKER").length)&&!Id.Sc&&w.uR(Id)}f(b,
c)}function n(a,b){for(var d=pa(b.Qg),c=[],e=[],f=0;f<a.speakers.length;f++){var k=a.speakers[f],g=k.sound.uuid;if(-1==e.indexOf(g)){e.push(g);switch(k.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var h=oa.Px;break;case "BACKGROUND_MUSIC":h=oa.Qx}var k=Da.hj(d+k.sound.filepath),n=oa.Nm(k)[1].toLowerCase();w.yu(n);aa(c,g,h,k,b.fk)}}c.length&&oa.Vd(c,function(){},function(){})}function k(a,b,d){a=a.nodes;for(var c=0;c<a.length;c++){var e=a[c],f=e.type;if("GROUP"==f&&e.node_group){if(e=e.node_group.node_tree)if(d)k(e,
b,!0);else for(e=e.jz,f=0;f<e.length;f++){var g=e[f];-1==b.indexOf(g)&&b.push(g)}}else-1!=Nb.indexOf(f)&&-1==b.indexOf(f)&&b.push(f)}}function u(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);e(a.objects,"ALL",b);return b}function e(a,b,d){for(var c=0;c<a.length;c++){var f=a[c];"ALL"!=b&&b!=f.type||d.push(f);(f=f.dupli_group)&&e(f.objects,b,d)}}function y(a,b,d,c){c[b]=c[b]||[];for(var e=c[b],f=0;f<a.length;f++){var k=a[f],g=Y(k);e[g]=e[g]||[];(d||-1==Mb.indexOf(k.type))&&-1==
e[g].indexOf(k)&&e[g].push(k);(k=k.dupli_group)&&y(k.objects,b+1,d,c)}}function K(a,b,d){var c=[];a=za[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==d||"ALL"==d)for(var k=0;k<f.rd.length;k++)b==f.rd[k]&&c.push(f)}return c}function F(a,b,d,c,e){var f=za[b.id],k=a.worlds;c=b.id;for(var g=0;g<f.length;g++){for(var h=f[g],n=la.Fq(h.name,h.type,h.origin_name),l=0;l<h.rd.length;l++)la.Sp(n,h.rd[l]);h.pb=n;Ba.Uk(h,n);n.k.Ve=c;n.Ar=h.DF||!1}for(c=0;c<k.length;c++){g=k[c];h="%meta_world%"+g.name;h=
la.Fq(h,"WORLD",h);for(n=0;n<g.rd.length;n++)la.Sp(h,g.rd[n]);g.pb=h;Ba.Y_(g,h)}c=Ba.Pi(b.id);for(g=0;g<f.length;g++)h=f[g],n=h.pb,va.Uk(h,n);for(g=0;g<k.length;g++)h=k[g],va.Uk(h,h.pb);if(b.Mb)for(k=b.id,g=0;g<a.scenes.length;g++)for(var h=a.scenes[g],n=0,l=Ba.Vb(h,"LAMP",k),C=0;C<l.length;C++)la.ka(l[C],h).pm=n++;for(g=0;g<f.length;g++)h=f[g],n=h.pb,n.Ar||(Ba.L_(h,n),Na.D(n));for(a=0;a<f.length;a++)if(k=f[a],g=k.pb,la.$d(g)||la.Xn(g))if(h=k.lod_levels.length)for(n=g,g.k.Yn=!0,l=0;l<h;l++)if(C=k.lod_levels[l].object){C=
C.pb;C.k.Yn=!0;C.k.ah=g.k.ah;n.k.ff=k.lod_levels[l].distance;C.k.$g=k.lod_levels[l].distance;if(k.lod_levels[l+1])C.k.ff=k.lod_levels[l+1].distance;else{C.k.ff=la.Bp;break}n=C}else{n.k.ff=k.lod_levels[l].distance;break}for(f=0;f<c.length;f++)if(a=c[f],"MESH"==a.type&&(k=a.St)){var k=k.k,g=a.k.Ci,h=[],v;for(v in g)n=g[v],h.push(4*n.zA,4*n.Kj);k.Tv.push(h);k.No.push(a.k)}f=v=-1;a=ya.YI();for(k=0;k<c.length;k++)g=c[k],h=g.k,la.$d(g)&&h.gk&&(g=h.bh,g>v&&(v=g),a>=g&&g>f&&(f=g));for(k=0;k<c.length;k++)g=
c[k],h=g.k,la.$d(g)&&h.gk&&(h.Vl=!0,v<a?h.bh=v:h.bh<=a?h.bh=f:(wa.warn('too many bones for "'+g.name+'" / '+h.bh+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),h.bh=v,h.Vl=!1),h.Vl=h.Vl&&!La.jI);for(v=0;v<c.length;v++)if(f=c[v],f.bf)if(a=f.nf,"CHASSIS"==a.hf){f.v={};f.v.$q=a.$q;f.v.gq=a.gq;f.v.ID=a.ID;f.v.KD=a.KD;f.v.JD=a.JD;f.v.vE=a.vE;f.v.ZC=a.ZC;f.v.XB=a.XB;f.v.Hn=0;f.v.fq=1;f.v.Uo=0;f.v.speed=0;f.v.xk=[];f.v.cs=[];f.v.Wo=null;g=(k=la.Ri(f))?
la.aB(k,c):c;for(k=0;k<g.length;k++)h=g[k],h.bf&&(n=h.nf,ua.rW(h)&&a.name==n.name?(n=ua.x0(h.nf.hf),f.v.xk[n]=h,f.v.cs[n]=new Float32Array(8)):ua.gK(h)&&a.name==n.name?(f.v.Wo=h,f.v.Vo=n.Vo,f.v.Gs=n.Gs,f.v.yr=n.yr,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.UM=h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.TM=n):ua.fK(h)&&a.name==n.name?(f.v.BD=h,f.v.Es=n.Es,f.v.jo=n.jo,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.PM=h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.OM=
n):ua.hK(h)&&a.name==n.name&&(f.v.MD=h,f.v.Mq=n.Mq,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.fN=h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.eN=n));4!=f.v.xk.length&&Da.q("Not enough wheels for chassis "+f.name)}else if("HULL"==a.hf)for(f.v={},f.v.xk=[],f.v.cs=[],f.v.$q=a.$q,f.v.gq=a.gq,f.v.Tl=a.Tl,f.v.Zm=a.Zm,f.v.$m=a.$m,f.v.Hn=0,f.v.fq=1,f.v.Uo=0,f.v.speed=0,f.v.Wo=null,g=(k=la.Ri(f))?la.aB(k,c):c,k=0;k<g.length;k++)h=g[k],h.bf&&(n=h.nf,ua.qW(h)&&a.name==n.name?(f.v.xk.push(h),
f.v.cs.push(new Float32Array(8))):ua.gK(h)&&a.name==n.name?(f.v.Wo=h,f.v.Vo=n.Vo,f.v.Gs=n.Gs,f.v.yr=n.yr,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.UM=h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.TM=n):ua.fK(h)&&a.name==n.name?(f.v.BD=h,f.v.Es=n.Es,f.v.jo=n.jo,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.PM=h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.OM=n):ua.hK(h)&&a.name==n.name&&(f.v.MD=h,f.v.Mq=n.Mq,n=da.invert(f.k.n,da.create()),h=da.multiply(n,h.k.n,n),f.v.fN=
h,n=new Float32Array([1,0,0]),da.Xc(n,h,n),f.v.eN=n));for(v=0;v<c.length;v++)if(f=c[v],f.km&&(a=f.Ln,"MAIN_BODY"==a.hf))for(f.$f={},f.$f.Tl=a.Tl,f.$f.Zm=a.Zm,f.$f.$m=a.$m,f.$f.$t=[],k=(k=la.Ri(f))?la.aB(k,c):c,g=0;g<k.length;g++)h=k[g],h.km&&(n=h.Ln,ua.uW(h)&&a.name==n.name&&(f.$f.$t.push(h),h.wG=h.Ln.dN));e(b,d)}function J(a,b,d,c,e){for(c=0;c<a.scenes.length;c++){var f=a.scenes[c];f.Cj=f.camera.pb}for(c=0;c<a.scenes.length;c++){var f=b.Mb?a.scenes[c]:Va,k=b.Mb?Ba.Vb(f,"LAMP",b.id):Ba.Vb(f,"LAMP",
0),g=Ba.Vb(f,"ALL",b.id),h=K(b.id,f,"MESH"),n=K(b.id,f,"EMPTY");K(b.id,f,"WORLD");b.Mb&&Aa.QQ(f,g,k,h,n);for(var g=!1,l=0;l<n.length;l++)for(var C=n[l].pb,v=C.I,r=0;r<v.length;r++){var u=v[r].yb,m=Aa.EN(u,C);f.name==u.name&&(g=g||m)}b.Mb&&f.s.Nc&&!g&&wa.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');n=[];Aa.Hw(f);Z.gV(f,h,k,n);l=K(b.id,f,"LINE");Z.fV(f,l);C=Aa.dB(f);if(b.Mb){g=f.s.$w;l=f.world;if(g.zL||g.procedural_skydome)v=l.pb,Z.XQ(f,g,v),Z.iA(v,C,f);Aa.qI(f,C);(g=
f.s.pp)&&g.Qs&&Z.NQ(f,l.pb)}for(l=0;l<h.length;l++)Z.iA(h[l].pb,C,f);for(l=0;l<n.length;l++)Z.iA(n[l],C,f),Ba.BX(n[l]);g=Ba.Vb(f,"ALL",b.id);Aa.qR(f,g,k);for(l=0;l<g.length;l++)C=g[l],C.k.Ke&&Ba.z_(C),la.qS(C)&&(C.LK=!0)}Aa.RQ(Va,a.textures,b.id);b.Mb&&Va.s.mp.length&&(b.sB=!0);e(b,d)}function D(a){var b=a.materials;a=a.images;for(var d=0;d<a.length;d++){var c=a[d],e=Boolean("FILE"==c.source&&-1<c.filepath.indexOf(".dds")&&"dds"==sa.Aq);c.zh=e;c.Mp=e?"dds":""}if((Ia.yA||Ia.ww)&&sa.MN)for(a=0;a<b.length;a++){for(var c=
b[a],f=c.texture_slots,d=0;d<f.length;d++){var e=f[d],k=e.texture;if("IMAGE"==k.type||"ENVIRONMENT_MAP"==k.type){var g=k.image;g&&!g.zh&&(e=!k.b4w_disable_compression&&!e.use_map_normal&&"ENVIRONMENT_MAP"!=k.type&&!k.b4w_shore_dist_map&&"MOVIE"!=g.source,R(g,e))}}if(d=c.node_tree)for(c=d.nodes,d=0;d<c.length;d++){f=c[d];e=!1;if("TEXTURE"==f.type){if((k=f.texture)&&(g=k.image)&&!g.zh&&(e=!k.b4w_disable_compression&&"MOVIE"!=k.image.source&&"ENVIRONMENT_MAP"!=k.type)){a:{e=f.outputs;for(f=0;f<e.length;f++)if(k=
e[f],k.is_linked&&"Normal"==k.identifier){e=!0;break a}e=!1}e=!e}}else"TEX_IMAGE"==f.type?(g=f.image)&&!g.zh&&(e="MOVIE"!=g.source):"TEX_ENVIRONMENT"==f.type&&(e=!1);g&&!g.zh&&R(g,e)}}}function R(a,b){-1<a.filepath.indexOf(".dds")?(a.zh=!0,a.Mp="dds"):(a.zh=b)?(a.Mp=sa.Aq,a.filepath="dds"==sa.Aq?a.filepath+".dds":oa.Nm(a.filepath)[0]+".pvr"):a.Mp=""}function E(a,b,d,c,e){c=a.groups;for(var f=a.objects,k={},g={},h={},n={},l=0;l<c.length;l++){var C=c[l];k[C.uuid]=C;h[C.uuid]=C}for(l=0;l<f.length;l++)C=
f[l],g[C.uuid]=C,n[C.uuid]=C;a=a.scenes;for(l=0;l<a.length;l++)I(a[l].objects,null,n,h,null);for(var v in h)v in k||c.push(h[v]);for(v in n)v in g||f.push(n[v]);e(b,d)}function I(a,b,d,c,e){for(var f=[],k=0;k<a.length;k++){var g=a[k],h=d[g.uuid];if(g=h.proxy){b&&-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var n=d[g.uuid],l=n.constraints,g=0;g<l.length;g++){var C=Da.Eh(l[g]);C.name+="_CLONE";h.constraints.push(C)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(n.animation_data=
Da.Eh(h.animation_data)),n.b4w_use_default_animation=h.b4w_use_default_animation,n.b4w_auto_skel_anim=h.b4w_auto_skel_anim,n.b4w_anim_behavior=h.b4w_anim_behavior,n.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(k=0;k<f.length;k++)h=Da.FV(a,f[k]),-1<h&&a.splice(h,1);f={};if(b)for(k=0;k<a.length;k++)g=a[k],h=d[g.uuid],l=Da.Eh(h),n="origin_name"in h?h.origin_name:h.name,l.name=la.pI(b.name,n),l.origin_name=n,l.dg_parent={uuid:b.uuid},B(l),d[l.uuid]=l,f[g.uuid]=l.uuid,g.uuid=l.uuid,e&&e[h.uuid]&&
(l.b4w_cluster_data=e[h.uuid]);for(k=0;k<a.length;k++)g=a[k],h=d[g.uuid],h.dupli_group&&(g=h.dupli_group,e=c[g.uuid],l=Da.Eh(e),l.name=Da.Js(e.name+"_CLONE"),l.uuid=ja.NJ("Group"+l.name),c[l.uuid]=l,g.uuid=l.uuid,I(l.objects,h,d,c,h.b4w_cluster_data));if(b)for(k=0;k<a.length;k++){g=a[k];h=d[g.uuid];h.parent&&h.parent.uuid in f?h.parent.uuid=f[h.parent.uuid]:h.parent&&(wa.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);l=h.constraints;for(g=0;g<l.length;g++)b=
l[g],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=h.pose)for(c=b.bones,g=0;g<c.length;g++)if(e=c[g].constraints)for(l=0;l<e.length;l++)b=e[l],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)c=b[g],c.object&&c.object.uuid in f&&(c.object.uuid=f[c.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var v in f)Ja[v]=f[v]}function B(a){a.uuid=
ja.NJ("Object"+a.name)}function P(a,b){for(var c=a.nodes,e=0;e<c.length;e++){var k=c[e];"TEXTURE"==k.type&&k.texture&&d(k,"texture",b);"LAMP"==k.type&&k.lamp&&(k.lamp.uuid in Ja&&(k.lamp.uuid=Ja[k.lamp.uuid]),b[k.lamp.uuid]||(k.lamp=null));"GROUP"==k.type&&k.node_group&&d(k,"node_group",b);"TEX_IMAGE"!=k.type&&"TEX_ENVIRONMENT"!=k.type||!k.image||d(k,"image",b)}k=a.links;for(e=0;e<k.length;e++){var g=k[e];f(g,"from_node",c);f(g,"to_node",c);r(g,"from_socket",g.from_node.outputs);r(g,"to_socket",g.to_node.inputs)}if(c=
a.animation_data)if(c.action&&d(c,"action",b),c.nla_tracks)for(e=0;e<c.nla_tracks.length;e++)for(k=c.nla_tracks[e],g=0;g<k.strips.length;g++)k.strips[g].action&&d(k.strips[g],"action",b)}function d(a,b,d){(d=d[a[b].uuid])||wa.error("Dangling link found:",b,a);a[b]=d}function f(a,b,d){d=Da.Dd("name",a[b].name,d);a[b]=d}function r(a,b,d){d=Da.Dd("identifier",a[b].identifier,d);a[b]=d}function g(a,b,d,e,f,k){var g=[],h={};e=a.images;for(var n=Fa.XI(),l=pa(b.Qg),C=0;C<e.length;C++){var v=e[C],r=v.uuid;
if(r){var u=Da.hj(l+v.filepath),m=v.source;if("FILE"===m){var m=v.zh?oa.at:oa.bt,t=oa.Nm(u),p=t[1].toLowerCase();if(!oa.pS(p)){wa.error("image ",v," has unsupported format.");continue}Ia.aC&&sa.use_min50&&("dds"==t[1]?(u=oa.Nm(t[0]),u=u[0]+".min50."+u[1]+".dds"):u=t[0]+".min50."+t[1])}else if("MOVIE"===m)if(sa.rs)t=oa.Nm(u),u=t[0]+".altconv.seq",m=oa.dt;else{t=oa.Nm(u);p=t[1].toLowerCase();m=w.CA(p);if(""==m){wa.error("failed to load video file (unsupported format)",u);continue}u=m!=p?t[0]+".altconv."+
m:t[0]+"."+t[1];m=oa.et}else{wa.error('Image "'+v.name+'" has unsupported format "'+m+'".');continue}if(!b.fk)for((r in h)||(h[r]=[]),t=0;t<n.length;t++)p=n[t],p.Un==r&&p.em==v.Mp&&h[r].push(p);h[r].length&&g.push({id:r,type:m,url:u,Wg:b.fk})}}if(g.length){var y=0;oa.Vd(g,function(e,f,n,l){if(e){var C=n;if(!b.fk){f=h[f];for(C=0;C<f.length;C++){var v=f[C];if(n==oa.dt)v.ps=e.Sg,Fa.Ls(v,e.images,b.id);else if(Fa.Ls(v,e,b.id),"ENVIRONMENT_MAP"==v.source)for(v=0;v<a.scenes.length;v++)Aa.iE(a.scenes[v])}C=
f[0].em}n==oa.et||n==oa.dt?(n==oa.et?(n=e.videoWidth,e=e.videoHeight):(n=e.images[0].width,e=e.images[0].height),wa.log("%cLOAD VIDEO "+n+"x"+e,"color: #"+(2048<n||2048<e?"a00":1024<n||1024<e?"aa0":"0a0"),l),-1==l.indexOf(hb)&&wa.warn("video",l,"is not from app root.")):c(e,l,!0,C)}l=++y/g.length;k(b,d,l)},function(){wa.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function Q(a,b,d,c,e){a=Aa.gB();for(c=0;c<a.length;c++){var f=a[c];if(f.b4w_use_nla){var k=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&
(k=!1);va.R_(f,k,b.id)}}e(b,d)}function t(a,b,d,c,e,f){a=pa(b.Qg);var k=[],g={};c=Ba.Pi(b.id);for(var h=0;h<c.length;h++){var n=c[h];if(la.$n(n)&&w.NM(n)!=w.CE){var l=n.X.vj;"BACKGROUND_MUSIC"==w.kB(n)?(l=Da.UA(),b.qB=!0):"NONE"!=w.kB(n)&&sa.xB&&(b.wB=!0);if(!(l in g)){g[l]=[];var C=Da.hj(a+n.X.Qg);switch(w.NM(n)){case w.Ox:var v=oa.Px;break;case w.BE:v=oa.Qx}aa(k,l,v,C,b.fk)}g[l].push(n)}}if(k.length){var r=0;oa.Vd(k,function(a,c,e,h){if(a)for(wa.log("%cLOAD SOUND","color: #0aa",h),-1==h.indexOf(hb)&&
wa.warn("sound",h,"is not from app root."),c=g[c],e=0;e<c.length;e++)w.W_(c[e],a);a=++r/k.length;f(b,d,a)},function(){wa.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,d)})}else e(b,d)}function aa(a,b,d,c,e){var f=oa.Nm(c),k=f[1].toLowerCase(),g=w.yu(k);""!=g?(c=g!=k?f[0]+".altconv."+g:f[0]+"."+f[1],a.push({id:b,type:d,url:c,Wg:e})):wa.error("failed to load audio file (unsupported format)",c)}function M(a,b,d){a=Ba.Vb(a,"SPEAKER",b);for(b=0;b<a.length;b++){var c=a[b];la.$n(c)&&(w.pW(c)||d)&&w.sw(c)}}
function G(a,b){for(var d=a.s.mp,c=0;c<d.length;c++){var e=d[c].s;a.b4w_use_nla&&d[c].b4w_nla_video||!d[c].use_auto_refresh||b!=e.Ys||(Fa.DL(e),Fa.fL(e))}}function T(a,b,d,c,e){va.start();wa.log("%cSTART NLA","color: #0a0");e(b,d)}function S(a,b,d,c,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,k=0;k<f;k++){var g=b.lod_levels[k],h=g.object;if(h){var n=Da.sq(h);n.name=b.name+"_LOD_"+String(k+1);n.b4w_cluster_data=b.b4w_cluster_data;B(n);n.lod_levels=[];d&&(n.dg_parent=d);c.push([a,
n]);e.push(h);g.object=n}}}function X(a,b,d,c,e){c=!0;for(var f=0;f<a.scenes.length;f++)if(!ua.uS(a.scenes[f])){c=!1;break}c&&(e(b,d),wa.log("%cPHYSICS READY","color: #0a0"))}function H(a,b,d,c,e){for(c=0;c<a.scenes.length;c++){var f=a.scenes[c];if(b.Mb)var k=ua.Dw(f);else k=ua.Dw(Va)||ua.Dw(f),f=Va;if(Ra.enabled&&k)for(k=0;k<Zb.length;k++)for(var g=Ba.Vb(f,Zb[k],b.id),h=0;h<g.length;h++){var n=g[h];n.k.Ve==b.id&&(ua.on(n,f),b.uK&&ua.oa(n)&&ua.FA(n))}}e(b,d)}function ma(a,b,d,e,f){var k={};e=[];for(var g=
a.scenes,h=0;h<a.scenes.length;h++){var n=g[h];if(n.s.Nc){var l=n.s.Nc.Ik;if(l&&"FILE"===l.source){var n=l.uuid,C=Da.hj(pa(b.Qg)+l.filepath);e.push({id:n,type:l.zh?oa.at:oa.bt,url:C});k[n]=l}}}e.length?oa.Vd(e,function(a,d,e,f){if(a){c(a,f,!0);e=[];f=Fa.XI();for(var h=0;h<f.length;h++){var n=f[h];n.uri===d&&e.push(n)}for(d=0;d<e.length;d++)Fa.Ls(e[d],a,b.id);for(d=0;d<g.length;d++)if(e=g[d],e.s.Nc&&(f=e.s.Nc.Ik,f===l)){var n=a,C=document.createElement("canvas");f=l.size[0];h=l.size[1];C.width=f;C.height=
h;C=C.getContext("2d");C.drawImage(n,0,0);n=C.getImageData(0,0,f,h).data;C=new Float32Array(4);C[0]=1/16581375;C[1]=1/65025;C[2]=1/255;C[3]=1;f*=h;for(var h=new Float32Array(f),v=0;v<f;v++)h[v]=C[1]*n[4*v+2]+C[2]*n[4*v+3];e.s.vD=h}}else for(a=k[d],d=0;d<g.length;d++)e=g[d],f=e.s.Nc.Ik,f===a&&(e.s.Nc.Ik=null,wa.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function W(a,b,d,e,f){e=a.scenes[0];a=[];for(var k=[ub.Ct,ub.Ip,ub.Dt,ub.dz],g=0;g<k.length;g++){var h=
Aa.La(e,k[g]);h&&a.push(h)}if(a.length){e=[];g=oa.bt;e.push({id:"SEARCH_TEXTURE",type:g,Qg:fa.De.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:g,url:fa.De.smaa_area_texture_path});for(g=0;g<a.length;g++)if(k=a[g],k.type==ub.Ip){a=k.Ya;for(g=0;g<a.length;g++)if(k=a[g],"u_search_tex"==k.to)var n=k.jb;else if("u_area_tex"==k.to)var l=k.jb;break}e.length?oa.Vd(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?n:l,d.source="IMAGE",Fa.Ls(d,a,b.id),Fa.fD(d,Fa.K,Fa.K))},function(){f(b,d)}):
f(b,d)}else f(b,d)}function O(a,b,d,c){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];b.Mb||(e=Va);for(var f=Ba.Vb(e,"LAMP",b.id),k=0;k<f.length;k++){var g=f[k];g.k.Ve==b.id&&c.mz.push({yb:e,ea:g})}f=Ba.Vb(e,"ALL",b.id);for(k=0;k<f.length;k++)g=f[k],"LAMP"!=g.type&&g.k.Ve==b.id&&(b.uK&&la.$d(g)&&Aa.lq(g,!0),c.mz.push({yb:e,ea:g}))}}function V(a,b,d,c,e,f){var k=c.mz;e=c.RK;if(k.length){a=k[e].ea;var g=k[e].yb;e=la.ka(a,g);Aa.on(g,a,!1);!a.anchor||g.s.pv||g.s.anaglyph_use||xa.append(a);c=++c.RK/
k.length;k=e.Hi;if(-1!=a.k.Rd&&k){var h=ra.copy(a.k.lb.G,eb);Aa.DN(k,h)}k=a.ks;if(k.length&&g.s.ai)for(g=da.F(a.k.n),a=da.N(a.k.n),e=e.Yh,h=0;h<e.length;h++)Aa.GN(e[h],g,a),la.HN(k,e[h].p.qc)}else c=1;f(b,d,c)}function ga(a,b,d,c,e){if(b.Mb){c=Aa.Nh();Aa.iE(c);var f=Aa.gB();for(a=0;a<f.length;a++){var k=f[a];Aa.iE(k);Aa.XX(k,c)}Aa.Hw(c)}else Aa.IN(Va);c=Ba.Pi(b.id);Ba.M_(c);for(f=0;f<c.length;f++)for(k=c[f],a=0;a<k.I.length;a++)for(var g=k.I[a].V,h=0;h<g.length;h++)null==g[h].zb&&g.splice(h--,1);
e(b,d)}function v(a,b,d,c,e){if(b.Mb)for(a=Aa.gB(),c=0;c<a.length;c++){var f=a[c];f.b4w_use_logic_editor&&ta.vB(f,b.id)}e(b,d)}function ba(a,b,d,c,e){if(b.Mb)for(c=0;c<a.scenes.length;c++)G(a.scenes[c],b.id),M(a.scenes[c],b.id,!1);else G(Va,b.id),M(Va,b.id,!1);e(b,d)}function ea(a,b,d,c,e){for(c=0;c<a.scenes.length;c++)a.scenes[c].camera=null;sa.media_auto_activation&&(b.sB||b.qB||b.wB)?fb||ca(a,e,b,d):e(b,d)}function ca(a,b,d,c){var e=mb.parentElement;wb=e.style.zIndex;e.style.zIndex="999";fb=document.createElement("div");
fb.style.position="relative";fb.style.height="88px";fb.style.width="88px";var f=Math.round(mb.offsetWidth/2-44);fb.style.top=Math.round(mb.offsetHeight/2-44).toString()+"px";fb.style.left=f.toString()+"px";fb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
fb.style.backgroundSize="88px";lb=document.createElement("div");lb.style.position="relative";lb.style.height=mb.offsetHeight.toString()+"px";lb.style.width=mb.offsetWidth.toString()+"px";lb.style.background="rgba(0, 0, 0, 0.5)";lb.style.zIndex="999";e.appendChild(lb);lb.appendChild(fb);fb.addEventListener("click",function(){d.sB&&(Fa.play(),Fa.pause(),Fa.reset());if(d.qB){if(d.Mb)for(var e=0;e<a.scenes.length;e++)M(a.scenes[e],d.id,!0);else M(Va,d.id,!0);w.pause()}d.wB&&w.eL();na();b(d,c)},!1)}function na(){if(fb){var a=
mb.parentElement;a.style.zIndex=wb;lb.removeChild(fb);a.removeChild(lb);fb=lb=null;wb=0}}function pa(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function L(a){ya.Dc(a)&&ya.remove(a);Ea.fY(a);Ba.nq(a);ha.Al(a)&&ha.Fm(a);ua.oa(a)&&ua.ls(a);Aa.gY(a);la.$n(a)&&w.FZ(a);xa.oW(a)&&xa.remove(a)}function Y(a){var b=ya.DI(a);return(a=b&&b.parent==a?null:a.parent||b)?1+Y(a):0}var xa=m("__anchors"),ya=m("__animation"),oa=m("__assets"),Z=m("__batch"),fa=m("__config"),ha=m("__controls"),N=m("__texcomp"),
ka=m("__debug"),C=m("__extensions"),ia=m("__input"),qa=m("__loader"),ja=m("__md5"),va=m("__nla"),ta=m("__logic_nodes"),Ea=m("__particles"),Ca=m("__nodemat"),Ba=m("__objects"),la=m("__obj_util"),ua=m("__physics"),wa=m("__print"),Pa=m("__quat"),Ga=m("__reformer"),Qa=m("__renderer"),Aa=m("__scenes"),w=m("__sfx"),Za=m("__shaders"),ub=m("__subscene"),Fa=m("__textures"),Ec=m("__time"),Na=m("__transform"),da=m("__tsr"),Da=m("__util"),ra=m("__vec3"),U=m("__vec4"),La=fa.ql,sa=fa.B,Ia=fa.Pd,Ra=fa.C,vb=fa.X,
Ta=null,za=null,hb="",Va=null,Ja={},eb=new Float32Array(3),ob=new Float32Array(4),$a=new Float32Array(4),sb=new Float32Array(4),fb=null,lb=null,wb=0,Sa=!1,Mb=["LAMP","CAMERA"],Zb=["MESH","CAMERA","EMPTY"],Nb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],mb=null;a.Yg=function(a){return qa.Yg(a)};a.update=function(){qa.S_(Ta)};a.mZ=function(a){mb=a};a.J_=function(a,b){if(fb){lb.style.height=b.toString()+"px";lb.style.width=a.toString()+"px";var d=Math.round(a/2-44);fb.style.top=Math.round(b/2-44).toString()+"px";
fb.style.left=d.toString()+"px"}};a.load=function(a,d,c,e,f){var k={load_main:{Nb:qa.xg,Sb:!1,L:[],Xb:!1,Zb:500,lc:!1,bc:b},duplicate_objects:{Nb:qa.ue,Sb:!1,L:["load_main"],Xb:!1,Zb:50,lc:!1,bc:E},load_binaries:{Nb:qa.xg,Sb:!1,L:["load_main"],Xb:!1,Zb:500,lc:!1,bc:x},wait_for_shaders:{Nb:qa.ue,Sb:!1,L:[],Xb:!1,Zb:50,lc:!0,Mj:q},prepare_bindata:{Nb:qa.ue,Sb:!1,L:["duplicate_objects","load_binaries"],Xb:!1,Zb:100,lc:!1,bc:A},prepare_bpy_data:{Nb:qa.ue,Sb:!1,L:["duplicate_objects","prepare_bindata"],
Xb:!1,Zb:100,lc:!1,bc:p},process_objects:{Nb:qa.ue,Sb:!1,L:["prepare_bpy_data"],Xb:!1,Zb:150,lc:!1,bc:F},process_scenes:{Nb:qa.ue,Sb:!1,L:["process_objects","wait_for_shaders"],Xb:!1,Zb:300,lc:!1,bc:J},load_smaa_textures:{Nb:qa.xg,Sb:!1,L:["process_scenes"],Xb:!1,Zb:30,lc:!0,bc:W},load_shoremap:{Nb:qa.xg,Sb:!1,L:["process_scenes"],Xb:!1,Zb:30,lc:!0,bc:ma},load_images:{Nb:qa.xg,Sb:!0,L:["process_scenes"],Xb:!0,Zb:500,lc:!1,bc:g},update_scenes_nla:{Nb:qa.ue,Sb:!1,L:["process_scenes","load_images"],
Xb:!1,Zb:50,lc:!1,bc:Q},wait_physics_workers:{Nb:qa.ue,Sb:!1,L:["load_shoremap"],Xb:!1,Zb:20,lc:!1,Mj:X},add_physics_objects:{Nb:qa.ue,Sb:!1,L:["wait_physics_workers"],Xb:!1,Zb:50,lc:!1,bc:H},add_objects:{Nb:qa.ue,Sb:!1,L:["add_physics_objects"],Xb:!1,Zb:600,lc:!1,bc:O,Mj:V,iq:ga,jq:{mz:[],RK:0}},init_logic_nodes:{Nb:qa.ue,Sb:!1,L:["update_scenes_nla","add_objects"],Xb:!1,Zb:50,lc:!1,bc:v},load_speakers:{Nb:qa.xg,Sb:!0,L:["add_objects"],Xb:!0,Zb:100,lc:!1,bc:t},mobile_media_start:{Nb:qa.ue,Sb:!1,
L:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Xb:!0,Zb:5,lc:!1,bc:ea,Mj:ea},synchronize_media:{Nb:qa.ue,Sb:!0,L:["mobile_media_start"],Xb:!0,Zb:50,lc:!1,bc:ba},start_nla:{Nb:qa.ue,Sb:!0,L:["mobile_media_start"],Xb:!1,Zb:5,lc:!0,bc:T}},h=qa.hB();h||(h=qa.uH(),Ta={},za={},Ja={});Ta[h.oh.length]={};return qa.zH(k,a,d,c,l,e||vb.eG,sa.do_not_load_resources,f,!1)};a.ux=function(a){var b=qa.hB();if(!b||!b.oh.length||a&&!qa.d_(b.oh[a]))wa.error("Unable to unload data!");else{if(0==
a)wa.log("%cUNLOAD ALL","color: #00a"),xa.ua(),ya.ua(),w.ua(),Z.ua(),Aa.ua(),qa.ua(),ha.ua(),ua.ua(),Ba.ua(),Da.ua(),Qa.ua(),Ca.ua(),Za.ua(),C.ua(),oa.ua(),Fa.ua(),ta.ua(),Ea.ua(),ia.ua(),ka.ua(),za=null,Ja={},Ta=Va=null,Sa=!1;else{wa.log("%cUNLOAD DATA "+a,"color: #00a");ya.dY(a);for(var b=Ba.Pi(Ba.nc),d=0;d<b.length;d++){var c=b[d];la.fB(c)!=a&&Ba.fw(c,!1,!1,!1)}b=Ba.Pi(a);for(d=b.length-1;0<=d;d--)c=b[d],L(c),Ba.ls(c);b=Ba.Pi(Ba.nc);for(d=0;d<b.length;d++)Ba.fw(b[d],!0,!0,!0)}va.ua(a);na()}};a.WX=
L;a.WL=function(a){hb=a};a.KF=function(){Sa||sa.media_auto_activation||(Fa.play(),Fa.pause(),Fa.reset(),M(Va,Ba.nc,!0),w.pause(),sa.xB&&w.eL(),Sa=!0)};a.reset=function(){mb=null};a.gL=function(a,d,c){var e={load_main:{Nb:qa.xg,Sb:!1,L:[],Xb:!1,Zb:500,lc:!1,bc:b},load_binaries:{Nb:qa.xg,Sb:!1,L:["load_main"],Xb:!1,Zb:500,lc:!1,bc:x},load_images:{Nb:qa.xg,Sb:!1,L:["load_main"],Xb:!1,Zb:500,lc:!1,bc:g},preload_sounds:{Nb:qa.xg,Sb:!1,L:["load_main"],Xb:!1,Zb:500,lc:!1,bc:n}},f=qa.hB();f||(f=qa.uH(),Ta=
{},za={},Ja={});Ta[f.oh.length]={};return qa.zH(e,a,d,c,l,!1,sa.do_not_load_resources,!1,!0)};a.BN=function(){oa.DS()}};b4w.module.__animation=function(a,m){function l(a,b){var d=a.ia[b];d&&d.RA&&d.Vq&&(d.Vq=!1,d.RA(a,b))}function c(a,b,d){d=a.ia[d];d.type=30;var c=b.va,e=b.Za-c+1;d.start=c;d.length=e;d.zf=c;d.Ai=b.name;for(e=c=0;e<a.Zc.length;e++){var f=a.Zc[e];if(f==b)break;else c+=f.Za-f.va+1}d.UN=c}function b(a,b){a.type=50;a.Ai=b.name;a.start=b.va;a.length=b.Za-a.start;b.Sd||(a.length+=b.NB)}function x(a){return a.replace(/_B4W_BAKED$/,"")}function q(a,b){return{no:a,action:b}}function A(a,b,d){if(a.animation_data){var c=
a.animation_data.action;c&&60==c.s.type&&b.push(q(d,c))}a=a.nodes;for(c=0;c<a.length;c++){var e=a[c];if(e.node_group){var f=e.node_group.node_tree;if(f){var k=d.slice();k.push(e.name);A(f,b,k)}}}}function h(a){return O.$d(a)&&a.k.Zc?!0:!1}function z(a,b,d){var c=a.ia;if(-1==d)for(d=0;8>d;d++){var e=c[d];e&&(e.zf=b,n(a,0,d,!0))}else if(e=c[d])e.zf=b,n(a,0,d,!0)}function p(a,b,d){if(-1==b)for(b=0;8>b;b++){var c=a[b];c&&d(c)}else(c=a[b])&&d(c)}function n(a,b,d,c){D(a,b,d,c);l(a,d);a.k.zi&&(I(a,b),E(a,
b))}function k(a,b,d,c){var f=d.frame_range;if(f[0]>f[1])return v.warn('Incompatible action "'+d.name+'" has been applied to object "'+a.name+'"'),!1;var k=d.s,g=a.ia[c];g.Ai=d.name;g.lz=f;g.JF=k.cL;g.HF=k.oG;g.Ei.set(k.Ei);g.start=f[0];g.length=f[1]-f[0];g.zf=f[0];switch(k.type){case 10:if(O.im(a)){g.type=10;var h=u(a,b,d);if(!h){for(var h=a.k.Fg,f=[],n=[],l=d.s.nC,C=0;C<l;C++){for(var r in h){var m=h[r],t=m.px,p=d.s.Cz[r];p?xa.copy(p.subarray(8*C,8*C+8),t):xa.identity(t);m.qx=!1}m=B(h);f.push(m.trans);
n.push(m.Eb)}h={trans:f,Eb:n};e(a,b,d,h)}g.trans=h.trans;g.Eb=h.Eb;b=h;g=a.k;h=g.No;f=a.ia[c];r=f.xD;a:{n=g.Xw;for(l=0;l<n.length;l+=2)if(d==n[l]){n=n[l+1];break a}n=null}if(n)f.xD=n;else{for(f=0;f<h.length;f++){n=h[f].Ci;l=[];C=[];m=b.trans;t=b.Eb;for(p=0;p<m.length;p++){var H=P(m[p],t[p],n);l.push(H.trans);C.push(H.Eb)}r.push({trans:l,Eb:C})}g.Xw.push(d,r)}g.zi&&(d=g.ep,c>d[1]?(b=d[1],d[1]=c,d[0]=b):c>d[0]&&c<d[1]&&(d[0]=c),y(a))}break;case 40:O.$n(a)&&(g.volume=k.rb.volume||null,g.pitch=k.rb.pitch||
null,g.type=40);break;case 70:O.Xg(a)&&(g.color=k.rb.color||null,g.Bf=k.rb.energy||null,g.type=70);break;case 60:if("MESH"==a.type){g.type=60;r=u(a,b,d);if(!r){r=[];f=[];n=[];l=[];C=[];m=d.s;t=b?b[0]:null;for(h in m.rb){p=b;H=h.match(/"(.*?)"/)[1];if(p&&1<p.length){for(var q=p[1],Y=2;Y<p.length;Y++)q=q+"%join%"+p[Y];q+="%join%"+H}else q=H;p=q;for(H=0;H<a.I.length;H++)for(q=a.I[H].V,Y=0;Y<q.length;Y++){var Z=q[Y];if(!t||-1!=Z.ud.indexOf(t)){var L=Z.dj,z=F(h,p,m,f,r,Z.ej),L=F(h,p,m,l,n,L);(z||L)&&C.push(Z)}}}r=
{i0:r,values:f,sY:n,tY:l,cw:C};e(a,b,d,r)}g.ej=r.i0;g.OK=r.values;g.dj=r.sY;g.NK=r.tY;g.cw=r.cw}break;case 20:if(h=k.rb.tsr){g.type=20;r=u(a,b,d);if(!r){r=d.s.nC;f=[];n=[];for(l=0;l<r;l++)f.push(h.subarray(8*l,8*l+4)),n.push(h.subarray(8*l+4,8*l+8));r={trans:f,Eb:n};e(a,b,d,r)}g.trans=r.trans;g.Eb=r.Eb;V.oC(a)&&V.X_(a,g.trans[0],g.Eb[0])}else return v.warn('Incompatible action "'+d.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:O.HB(a)&&(g.Bf=k.rb["light_settings.environment_energy"]||
null,g.je=k.rb.horizon_color||null,g.te=k.rb.zenith_color||null,g.Zq=k.rb["mist_settings.intensity"]||null,g.fog_depth=k.rb["mist_settings.depth"]||null,g.fog_start=k.rb["mist_settings.start"]||null,g.fog_height=k.rb["mist_settings.height"]||null,g.eI=k.rb.b4w_fog_color||null,g.type=80)}O.im(a)&&10!=k.type&&K(a,c);return!0}function u(a,b,d){a=a.Lt;b=b?b.join("%join%"):null;for(var c=0;c<a.length;c+=3)if(d==a[c]&&b==a[c+1])return a[c+2];return null}function e(a,b,d,c){a.Lt.push(d,b?b.join("%join%"):
null,c)}function y(a){var b=a.k.ep;if(-1!=b[0]&&-1!=b[1]){var d=a.ia;a=d[b[1]].zf;var c=Math.floor(a),e=a-c,b=d[b[0]];a=b.zf;c=Math.floor(a);b.zf=c+e}}function K(a,b){var d=a.k.ep,c=d[1];d[0]=-1;d[1]=-1;if(-1!=b)for(var e=a.ia;0<=c;c--){var f=e[c];if(f&&10==f.type)if(c>d[1])d[1]=c;else{c>d[0]&&(d[1]=c);break}}}function F(a,b,d,c,e,f){if(!f)return!1;for(var k=!1,g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),c.push(new Float32Array(d.rb[a])),k=!0);return k}function J(a){a=a.s;for(var b in a.rb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function D(a,b,d,c){if((d=a.ia[d])&&null!=d.type&&(d.play||c)){var e=a.k,f=d.zf,k=d.start,g=d.length,f=f+d.speed*b*L.sd(),h=d.type,n=d.speed;if(0<=n&&f>=k+g||0>n&&f<k)switch(c||(d.Vq=!0),d.behavior){case 10:f=0<=n?(f-k)%g+k:k+g-1E-6;break;case 20:f=0<=n?k:k+g-1E-6;d.play=!1;break;case 30:f=0<=n?k+g-1E-6:k,d.play=!1}d.zf=f;switch(h){case 10:if(!e.zi){c=R(d);b=c[0];var l=c[1];c=c[2];e.me=d.Eb[b];e.Ee=d.Eb[l];e.se=d.trans[b];e.Ie=d.trans[l];e.Ze=c;c=e.No;d=d.xD;for(var v=
0;v<c.length;v++){var r=c[v],u=d[v];r.me=u.Eb[b];r.Ee=u.Eb[l];r.se=u.trans[b];r.Ie=u.trans[l];r.Ze=e.Ze}Y.D(a)}break;case 20:c=R(d);var e=N,l=c[0],v=c[1],r=c[2],u=d.trans,m=u[l][1],f=u[l][2],k=u[v][1],g=u[v][2];e[0]=(1-r)*u[l][0]+r*u[v][0];e[1]=(1-r)*m+r*k;e[2]=(1-r)*f+r*g;l=C;f=c[0];v=c[1];r=c[2];u=d.Eb;m=ia;m[0]=u[f][0];m[1]=u[f][1];m[2]=u[f][2];m[3]=u[f][3];f=qa;f[0]=u[v][0];f[1]=u[v][1];f[2]=u[v][2];f[3]=u[v][3];ba.slerp(m,f,r,l);v=c[2];r=d.trans;c=(1-v)*r[c[0]][3]+v*r[c[1]][3];a.parent&&a.qw&&
(v=ja,xa.sg(e,c,l,v),xa.multiply(a.qw,v,v),xa.jc(v,e),xa.Yd(v,l),c=xa.td(v));d.bE&&(v=ka,Y.Zd(a,v),ya.ex(e,v,b,d.bE,e));d.KC&&(v=ia,Y.bm(a,v),ya.MM(l,v,b,d.KC,l));f=d.Ei;f[0]&&Y.Tw(a,e);f[1]&&Y.Rw(a,l);f[2]&&Y.oD(a,c);Y.D(a);ga.H(a);break;case 30:c=d.zf-d.start;0>c&&(c=0);c>=d.length&&(c=d.length);a=Math.floor(c);b=a+1;c-=a;10!=d.behavior&&b==d.length&&(b=--a,c=1);d=d.UN;ha[0]=a+d;ha[1]=b+d;ha[2]=c;c=ha;e.yx=c[0];e.zx=c[2];break;case 40:c=R(d);b=c[0];e=c[1];c=c[2];d.volume&&na.rD(a,(1-c)*d.volume[b]+
c*d.volume[e]);d.pitch&&na.BC(a,(1-c)*d.pitch[b]+c*d.pitch[e]);break;case 50:b=10==d.behavior?(f-k)/L.sd():f/L.sd();V.fZ(a,d.Ai,b);break;case 60:c=R(d);b=c[0];e=c[1];c=c[2];u=d.OK;m=d.ej;a=d.NK;l=d.dj;v=d.cw;for(d=0;d<m.length;d++)for(f=u[d],r=m[d],k=(1-c)*f[b]+c*f[e],f=0;f<v.length;f++)v[f].fj[r]=k;for(d=0;d<l.length;d++)for(u=a[d],r=l[d],u=oa.lerp(u.subarray(3*b,3*b+3),u.subarray(3*e,3*e+3),c,N),f=0;f<v.length;f++)v[f].Ce[3*r]=u[0],v[f].Ce[3*r+1]=u[1],v[f].Ce[3*r+2]=u[2];break;case 70:c=R(d);b=
c[0];e=c[1];c=c[2];f=d.Ei;(g=d.Bf)&&f[0]&&W.vs(a.ub,(1-c)*g[b]+c*g[e]);(d=d.color)&&f[1]&&(N[0]=(1-c)*d[3*b]+c*d[3*e],N[1]=(1-c)*d[3*b+1]+c*d[3*e+1],N[2]=(1-c)*d[3*b+2]+c*d[3*e+2],W.Ow(a.ub,N));k=a.I;for(d=0;d<k.length;d++)ca.H_(a,k[d].yb);break;case 80:c=R(d);b=c[0];e=c[1];c=c[2];f=d.Ei;k=a.I;n=ca.La(k[0].yb,pa.Pb);g=d.Bf;g=f[0]?(1-c)*g[b]+c*g[e]:n.Bf;h=d.je;f[1]?(N[0]=(1-c)*h[3*b]+c*h[3*e],N[1]=(1-c)*h[3*b+1]+c*h[3*e+1],N[2]=(1-c)*h[3*b+2]+c*h[3*e+2],h=N):h=n.je;var t=d.te;f[2]?(ka[0]=(1-c)*t[3*
b]+c*t[3*e],ka[1]=(1-c)*t[3*b+1]+c*t[3*e+1],ka[2]=(1-c)*t[3*b+2]+c*t[3*e+2],n=ka):n=n.te;t=d.Zq;f[3]&&(l=(1-c)*t[b]+c*t[e]);t=d.fog_depth;f[4]&&(v=(1-c)*t[b]+c*t[e]);t=d.fog_start;f[5]&&(r=(1-c)*t[b]+c*t[e]);t=d.fog_height;f[6]&&(u=(1-c)*t[b]+c*t[e]);d=d.eI;f[7]&&(C[0]=(1-c)*d[3*b]+c*d[3*e],C[1]=(1-c)*d[3*b+1]+c*d[3*e+1],C[2]=(1-c)*d[3*b+2]+c*d[3*e+2],m=C);for(d=0;d<k.length;d++)b=a.I[d].yb,(f[0]||f[1]||f[2])&&ca.Kw(b,g,h,n),f[3]&&ca.aM(b,l),f[4]&&ca.ZL(b,v),f[5]&&ca.bM(b,r),f[6]&&ca.$L(b,u),f[7]&&
ca.hD(b,m);break;default:ya.q("Unknown animation type:"+h)}}}function R(a){var b=a.lz[0],d=a.lz[1]-b,b=a.zf-b;0>b&&(b=0);b>=d&&(b=d);b/=a.JF;d=Math.floor(b);a=a.HF[d]?b-d:0;b=Math.ceil(d+a);ha[0]=d;ha[1]=b;ha[2]=a;return ha}function E(a,b){var d=a.k,c=d.Bh,e=d.ep,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var k=a.ia[f];if(k.play||0==b){var g=R(k),h=g[0],n=g[1];d.Ze=g[2];var g=k.Eb[h],l=k.Eb[n],h=k.trans[h],n=k.trans[n]}else c=1}else c=1;e=a.ia[e];if(e.play||0==b){var f=R(e),v=f[0],r=f[1];d.Ze=f[2]}else if(-1!=
f&&k.play)c=0;else return;f=e.Eb[v];k=e.Eb[r];v=e.trans[v];r=e.trans[r];if(1==c)d.me.set(f),d.Ee.set(k),d.se.set(v),d.Ie.set(r);else if(0==c)d.me.set(g),d.Ee.set(l),d.se.set(h),d.Ie.set(n);else{for(e=0;e<g.length;e+=4){for(var u=C,m=ia,t=0;4>t;t++)u[t]=g[e+t],m[t]=f[e+t];ba.slerp(u,m,c,u);for(t=0;4>t;t++)d.me[e+t]=u[t];for(t=0;4>t;t++)u[t]=l[e+t],m[t]=k[e+t];ba.slerp(u,m,c,u);for(t=0;4>t;t++)d.Ee[e+t]=u[t]}ya.rG(h,v,c,d.se);ya.rG(n,r,c,d.Ie)}Y.D(a);H.U_(a)}}function I(a,b){var d=a.k,c=d.Bh,e=d.Pp;
if(0!=e){var c=d.Op-c,f=e*b;ya.sign(c)==ya.sign(e)&&Math.abs(f)<Math.abs(c)?d.Bh+=f:(d.Bh=d.Op,d.Pp=0)}}function B(a){var b=[],d=[],c=new Float32Array(4),e=new Float32Array(4),f;for(f in a){var k=a[f],g=c,h=e,n=k.du,l=n[n.length-1],v=l.fE;l.qx||xa.identity(v);for(l=n.length-1;0<=l;l--){var C=n[l],r=C.fE;if(C.qx)v=r;else{var u=C.Rk,m=C.px;xa.invert(u,ja);xa.multiply(m,ja,ja);xa.multiply(u,ja,ja);xa.multiply(v,ja,r);v=r;C.qx=!0}}n=C.fE;g[0]=n[0];g[1]=n[1];g[2]=n[2];g[3]=n[3];h[0]=n[4];h[1]=n[5];h[2]=
n[6];h[3]=n[7];ba.normalize(h,h);k=k.Kj;for(g=0;4>g;g++)h=4*k+g,b[h]=c[g],d[h]=e[g]}return{trans:b,Eb:d}}function P(a,b,d){var c=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in d)for(var k=d[f],g=k.Kj,k=k.zA,h=0;4>h;h++){var n=4*k+h,l=4*g+h;c[n]=a[l];e[n]=b[l]}c=new Float32Array(c);e=new Float32Array(e);return{trans:c,Eb:e}}function d(a){var b=a.s,d;if(b.Cz)d=10;else if(b.rb)if("volume"in b.rb||"pitch"in b.rb)d=40;else if(J(a))d=60;else{var c;a:{if(a.s.rb){c=a.fcurves;for(var e in c)if("color"==
e&&!c[e][3]){c=!0;break a}if("energy"==e){c=!0;break a}}c=!1}if(c)d=70;else if(c=a.s.rb,"light_settings.environment_energy"in c||"horizon_color"in c||"zenith_color"in c||"mist_settings.intensity"in c||"mist_settings.depth"in c||"mist_settings.start"in c||"mist_settings.height"in c||"b4w_fog_color"in c)d=80;else{a:{if(a.s.rb)for(d in a=a.fcurves,a)if("location"==d||"rotation_quaternion"==d||"scale"==d){d=!0;break a}d=!1}d=d?20:0}}else d=0;b.type=d}function J(a){if(a=a.s.rb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;
return!1}function f(a,b){b[0]=b[1]=b[2]=0;for(var d in a)"location"==d?b[0]=1:"rotation_quaternion"==d?b[1]=1:"scale"==d&&(b[2]=1)}function r(a,b){b[0]=b[1]=0;for(var d in a)"energy"==d?b[0]=1:"color"==d&&(b[1]=1)}function g(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var d in a)"light_settings.environment_energy"==d?b[0]=1:"horizon_color"==d?b[1]=1:"zenith_color"==d?b[2]=1:"mist_settings.intensity"==d?b[3]=1:"mist_settings.depth"==d?b[4]=1:"mist_settings.start"==d?b[5]=1:"mist_settings.height"==
d?b[6]=1:"b4w_fog_color"==d&&(b[7]=1)}function Q(a,b,d,c,e,f,k){var g=a+(b-a)/2,h=t(g,c,e,f,k)-d;return.02>Math.abs(h)?g:0<h?Q(a,g,d,c,e,f,k):Q(g,b,d,c,e,f,k)}function t(a,b,d,c,e){var f=1-a;return b*f*f*f+3*d*f*f*a+3*c*f*a*a+e*a*a*a}function aa(a,b){var d={type:null,Ai:null,lz:null,JF:0,HF:null,Ei:new Int8Array(8),Eb:null,trans:null,xD:[],play:!1,behavior:20,zf:0,start:0,length:0,bE:0,KC:0,Vq:!1,UN:null,speed:1,volume:null,pitch:null,color:null,Bf:null,te:null,je:null,Zq:null,fog_depth:null,fog_start:null,
fog_height:null,eI:null,OK:[],ej:[],NK:[],dj:[],cw:null};if(!a.ia.length)for(var c=0;8>c;c++)a.ia.push(null);a.ia[b]=d;-1==va.indexOf(a)&&va.push(a)}function M(a,b){Y.D(a);ga.H(a);n(a,0,b,!0)}function G(a,d,e,f){f=f||0;if(O.$d(a)){var g=T(a,e);if(g)return aa(a,f),c(a,g,f),M(a,f),!0;if((g=S(a,e))&&"EMITTER"==g.kw){aa(a,f);d=g.name;e=f;for(var g=a.I,h=0;h<g.length;h++)for(var n=g[h].V,l=0;l<n.length;l++){var C=n[l].gb;C&&C.name==d&&b(a.ia[e],C)}M(a,f);return!0}}if(g=ya.Dd("name",e,ta)||ya.Dd("name",
e+"_B4W_BAKED",ta)){aa(a,f);if(k(a,d,g,f))return M(a,f),!0;a.ia[f]=null}v.error('Unsupported object: "'+a.name+'" or animation name: "'+e+'"');return!1}function T(a,b){for(var d=0;d<a.Zc.length;d++){var c=a.Zc[d];if(c.name===b)return c}return null}function S(a,b){for(var d=a.I,c=0;c<d.length;c++)for(var e=d[c].V,f=0;f<e.length;f++){var k=e[f].gb;if(k&&k.name===b)return k}return null}function X(a){a=a.modifiers;for(var b=0;b<a.length;b++){var d=a[b];if("ARMATURE"==d.type)return d.object}return null}
var H=m("__armature"),ma=m("__config"),W=m("__lights"),O=m("__obj_util"),V=m("__particles"),ga=m("__physics"),v=m("__print"),ba=m("__quat"),ea=m("__reformer"),ca=m("__scenes"),na=m("__sfx"),pa=m("__subscene"),L=m("__time"),Y=m("__transform"),xa=m("__tsr"),ya=m("__util"),oa=m("__vec3"),Z=ma.ql,fa=ma.Fi;a.$O=1E-6;a.bF=0;a.az=10;a.bz=20;a.eF=30;a.dF=40;a.cF=50;a.aF=60;a.uP=70;a.tP=80;a.pd=0;a.kF=1;a.lF=2;a.mF=3;a.nF=4;a.oF=5;a.pF=6;a.Bt=7;a.il=-1;a.wE=10;a.xE=20;a.Nx=30;var ha=Array(3),N=new Float32Array(3),
ka=new Float32Array(3),C=new Float32Array(4),ia=new Float32Array(4),qa=new Float32Array(4),ja=xa.create();new Float32Array(16);var va=[],ta=[];a.YI=function(){return ya.trunc((fa.Mr-50)/4)};a.iI=function(a){return a/L.sd()};a.update=function(a){for(var b=0;b<va.length;b++){for(var d=va[b],c=0;8>c;c++)D(d,a,c);d.k.zi&&(I(d,a),E(d,a))}for(b=0;b<va.length;b++)for(d=va[b],c=0;8>c&&d.ia.length;c++)l(d,c)};a.iV=function(){return ta};a.xI=function(a){var b=[];if(h(a))for(var d=0;d<a.Zc.length;d++)b.push(a.Zc[d].name);
for(var c=[],d=0;d<ta.length;d++){var e=ta[d],f=e.s;20==f.type?c.push(e):60==e.s.type&&"MESH"==a.type?c.push(e):10==f.type&&"ARMATURE"==a.type?c.push(e):40==f.type&&"SPEAKER"==a.type?c.push(e):80==f.type&&"WORLD"==a.type&&c.push(e)}for(d=0;d<c.length;d++)b.push(x(c[d].name));if(V.oC(a)&&V.SK(a))for(a=a.I,d=0;d<a.length;d++)for(c=a[d].V,e=0;e<c.length;e++)(f=c[e].gb)&&b.push(f.name);return b};a.YM=x;a.yI=function(a,b){var d=a.ia[b];return d?d.type:0};a.Qt=function(a){for(var d=0,e=a.I,f=0;f<e.length;f++)for(var g=
e[f].V,n=0;n<g.length;n++){var l=g[n].gb;l&&"EMITTER"==l.kw&&!g[n].bg&&(aa(a,d),b(a.ia[d],l),M(a,d),a.ia[d].behavior=l.Sd?10:a.pl,d++)}e=a.Lg.slice();for(f=0;f<e.length;f++)n=e[f],g=n.no,n=n.action,aa(a,d),k(a,g,n,d)?(M(a,d),a.ia[d].behavior=a.pl,d++):a.ia[d]=null;h(a)&&(aa(a,d),c(a,a.Zc[0],d),M(a,d),a.ia[d].behavior=a.pl)};a.pz=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ya.q("Wrong animation behavior")}};a.lV=function(a){var b=
[];a=a.data.materials;for(var d=0;d<a.length;d++){var c=a[d],e=c.node_tree;e&&A(e,b,[c.name])}return b};a.UJ=q;a.play=function(a,b,d){p(a.ia,d,function(a){a.play=!0;a.RA=b?b:null;a.Vq=!1});a.k.zi&&y(a)};a.stop=function(a,b){p(a.ia,b,function(a){a.play=!1;a.RA=null;a.Vq=!1})};a.Wi=function(a,b){var d=a.ia;if(-1==b)for(var c=0;8>c;c++){if(d[c]&&d[c].play)return!0}else if(d=d[b])return d.play;return!1};a.Fo=z;a.gD=function(a,b){b=b||0;p(a.ia,b,function(d){z(a,d.start,b)})};a.JI=function(a,b){var d=a.ia[b];
return d&&d.zf?d.zf:0};a.EB=function(a,b){var d=a.ia[b];return d&&10==d.behavior};a.ts=function(a,b,d){p(a.ia,d,function(a){a.behavior=b})};a.BI=function(a,b){var d=a.ia[b];return d&&d.behavior};a.WF=function(a,b,d,c){p(a.ia,c,function(a){a.bE=b||0;a.KC=d||0})};a.yL=function(a,b){if(-1==b)for(var d=0;8>d;d++)a.ia[d]=null;else a.ia[b]=null;a.k.zi&&K(a,b)};a.K_=n;a.UK=function(a){if("ARMATURE"==a.type||a.St||"WORLD"==a.type)return!0;for(var b=0;b<a.Lg.length;b++){var d=a.Lg[b].action.s.type;if(20==
d||10==d||40==d&&"SPEAKER"==a.type||70==d&&"LAMP"==a.type||60==d&&"MESH"==a.type)return!0}return V.oC(a)&&V.SK(a)||"MESH"==a.type&&a.Zc.length?!0:!1};a.yG=function(a,b){if("ARMATURE"==b.type||X(a)||"WORLD"==b.type)return!0;for(var d=0;d<b.Lg.length;d++){var c=b.Lg[d].action.s.type;if(20==c||10==c||40==c&&"SPEAKER"==b.type||60==c&&"MESH"==b.type)return!0}return V.JR(a)&&V.IR(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.Dc=function(a){return Boolean(a.ia.length)};a.TR=B;a.zU=P;a.JQ=function(a){function b(a,
d){for(var c=0;c<d;c++){var e=a.subarray(8*c+4,8*c+8);ba.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function e(a,b,d,c,f){if(-1<d.search(k)){a=b;d=d.split('"')[1];var g=h}else 8==f?(d="tsr",g=h):g=1<f?new Float32Array(f):0;if(!a[d]){f=a;b=d;if("object"==typeof g&&g.length)for(var n=g.length,l=new Float32Array(c*n),C=0;C<c;C++)for(var v=0;v<n;v++)l[C*n+v]=g[v];
else if("number"==typeof g)for(l=new Float32Array(c),C=0;C<c;C++)l[C]=g;else ya.q("Wrong storage default value");f[b]=l}return a[d]}var k=new RegExp(/pose.bones\[\".+\"\]/g),h=xa.create(),n=a.s={type:0,nC:0,cL:0,rb:null,Cz:null,oG:null,Ei:new Int8Array(8)};n.cL=1/Z.Ul;var l=a.fcurves,C={},v={},u=0,m;for(m in l){var t=l[m],p;for(p in t){var y=t[p],H=y.xf;ea.eS(y,a);y=y.num_channels;u||(u=H.length);for(var y=e(C,v,m,u,y),q=y.length/u,O=c(m,p|0),Y=0;Y<u;Y++)y[Y*q+O]=H[Y]}}if(ya.ir(C)){for(var L in C)"tsr"==
L&&b(C[L],u);n.rb=C}if(ya.ir(v)){for(var z in v)b(v[z],u);n.Cz=v}n.nC=u;n.oG=a.zQ;"tsr"in C&&f(l,n.Ei);("color"in C||"energy"in C)&&r(l,n.Ei);("light_settings.environment_energy"in C||"horizon_color"in C||"zenith_color"in C||"mist_settings.intensity"in C||"mist_settings.depth"in C||"mist_settings.start"in C||"mist_settings.height"in C||"b4w_fog_color"in C)&&g(l,n.Ei);d(a);ta.push(a)};a.kV=function(a,b){return(b-a)*Z.Ul+1};a.kR=function(a,b,d,c,e,f){var k=new Float32Array(2),g=new Float32Array(2),
h=new Float32Array(2),n=new Float32Array(2),l=b[1],C=b[2],v=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var r=0,u=0,m=null;e<=f;e++)if(e<l)for(var p=0;p<Z.Ul;p++)d[r++]=C;else if(e>v)for(p=0;p<Z.Ul;p++)d[r++]=a;else{var y=b[u],H=3;0===y&&(H+=2);0===m&&(H+=2);var q=2===y?0:1;if(b[u+1]==b[u+H+1])m=y,u+=H;else{p=0;e==b[u+1]&&(q&&(c[r]=1),d[r]=b[u+2],r++,p++);if(e==v)for(;p<Z.Ul;p++)d[r++]=a;else for(k[0]=b[u+1],k[1]=b[u+2],0!==y?(g[0]=0,g[1]=0):0===m?(g[0]=b[u+5],g[1]=b[u+6]):(g[0]=b[u+3],
g[1]=b[u+4]),0!==y?(h[0]=0,h[1]=0):(h[0]=b[u+H+3],h[1]=b[u+H+4]),n[0]=b[u+H+1],n[1]=b[u+H+2];p<Z.Ul;p++){var O=e+p/Z.Ul;switch(y){case 0:var Y=k,L=g,z=h,B=n,W=[],fa=[],xa=void 0,I=void 0,P=void 0,xa=void 0;W[0]=Y[0]-L[0];W[1]=Y[1]-L[1];fa[0]=B[0]-z[0];fa[1]=B[1]-z[1];P=B[0]-Y[0];xa=Math.abs(W[0]);I=Math.abs(fa[0]);0!=xa+I&&xa+I>P&&(xa=P/(xa+I),L[0]=Y[0]-xa*W[0],L[1]=Y[1]-xa*W[1],z[0]=B[0]-xa*fa[0],z[1]=B[1]-xa*fa[1]);q&&(c[r]=1);d[r]=t(Q(0,1,O,k[0],g[0],h[0],n[0]),k[1],g[1],h[1],n[1]);r++;break;case 1:q&&
(c[r]=1);Y=k[0];L=k[1];z=(n[1]-L)/(n[0]-Y);d[r]=z*O+(L-z*Y);r++;break;case 2:q&&(c[r]=1);d[r]=b[u+2];r++;break;default:ya.q("Unknown keyframe interpolation mode: "+y)}}e+1==b[u+H+1]&&(m=y,u+=H)}}};a.apply=G;a.fR=function(a,b,d,c){c=c||0;var e=ya.Dd("uuid",d,ta);if(e){aa(a,c);if(k(a,b,e,c)){M(a,c);return}a.ia[c]=null}v.error('Unsupported object: "'+a.name+'" or animation uuid: "'+d+'"')};a.VN=function(a,b){var d=ya.Dd("name",b,ta)||ya.Dd("name",b+"_B4W_BAKED",ta);if(d){if(0==d.s.type)return!1}else if(!(S(a,
b)||O.$d(a)&&T(a,b)))return!1;return!0};a.Yu=function(a,b){for(var d=a.ia,c=0;c<d.length;c++){var e=d[c];if(e&&x(e.Ai)==x(b))return c}return-1};a.jV=function(a,b){var d=a.ia[b];return d&&d.Ai?x(d.Ai):null};a.remove=function(a){a.ia.length=0;a=va.indexOf(a);-1!=a&&va.splice(a,1)};a.dY=function(a){for(var b=ta.length-1;0<=b;b--)ta[b].AQ==a&&ta.splice(b,1)};a.XF=function(a,b){if(!a.ia.length)return G(a,b,0)?0:-1;for(var d=0;d<a.ia.length;d++)if(!a.ia[d])return G(a,b,d)?d:-1};a.lM=function(a,b,d){a.k.Pp=
(b-a.k.Bh)/d;a.k.Op=b};a.nM=function(a,b,d){p(a.ia,d,function(a){a.speed=b})};a.rJ=function(a,b){return a.ia[b].speed};a.YA=function(a,b){return a.ia[b].start};a.XA=function(a,b){return a.ia[b].length};a.ua=function(){va.length=0;ta.length=0};a.EU=function(a){var b=(a[0]||a[1]||a[2]).xf.length,d=C,c=N,e=Boolean(a[0]);e||(a[0]={xf:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={xf:new Float32Array(b),num_channels:8});var k=Boolean(a[2]);k||(a[2]={xf:new Float32Array(b),num_channels:8});
a[3]={xf:new Float32Array(b),num_channels:8};for(var g=0;g<b;g++)c[0]=e?a[0].xf[g]:0,c[1]=f?a[1].xf[g]:0,c[2]=k?a[2].xf[g]:0,ya.Wj(c,d),a[0].xf[g]=d[3],a[1].xf[g]=d[0],a[2].xf[g]=d[1],a[3].xf[g]=d[2]};a.DI=X;a.vZ=function(a,b){for(var d=7,c=0,e=0;e<ta.length;e++){var f=ta[e];if(f.name==b){c=f.s.type;break}}0==c&&(T(a,b)?c=30:(e=S(a,b))&&"EMITTER"==e.kw&&(c=50));for(e=0;8>e;e++)if(f=a.ia[e]){if(f.type==c)return e}else e<d&&(d=e);return d}};b4w.module.__lights=function(a,m){function l(a){x.scale(a.color,a.Bf,a.yq)}m("__print");var c=m("__tsr"),b=m("__util"),x=m("__vec3"),q=new Float32Array(3);new Float32Array(3);a.GW=function(a,h){var m=a.data,p=h.ub={name:"",type:m.type,hL:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),yq:new Float32Array(3),MH:0,lE:!1,Om:0,Fs:0,qq:.1,pq:30,sI:!1,MK:!1,WH:!1,Tm:!0,Vm:!0,Bf:1,distance:25,k4:"INVERSE_SQUARE"};p.name=h.name;p.Tm=m.use_diffuse;p.Vm=m.use_specular;var n=c.N(h.k.n),
n=b.pc(n,b.Oc,q);x.normalize(n,n);p.direction.set(n);p.color[0]=m.color[0];p.color[1]=m.color[1];p.color[2]=m.color[2];p.Bf=p.MH=m.energy;l(p);p.distance=m.distance;p.lE=m.use_sphere;p.qq=m.clip_start;p.pq=m.clip_end;if("POINT"===p.type||"SPOT"===p.type)p.distance=m.distance;"SPOT"===p.type?(p.Fs=m.spot_blend,p.Om=m.spot_size):"POINT"===p.type&&(p.Om=Math.PI/2);p.sI=m.b4w_generate_shadows;p.WH=m.b4w_dynamic_intensity};a.Ow=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];l(a)};a.TY=function(a,
b){a.Fs=b};a.SY=function(a,b){a.distance=b};a.UY=function(a,b){a.Om=b};a.vs=function(a,b){a.Bf=b;l(a)};a.I_=function(a){var h=a.ub;if(h){a=c.N(a.k.n);b.pc(a,b.Oc,h.direction);x.normalize(h.direction,h.direction);if("SUN"==h.type){a=Math.acos(x.dot(h.hL,b.hz));var l=Math.acos(x.dot(h.direction,b.hz));h.MK=Math.floor(a/.025)!=Math.floor(l/.025)?!0:!1}x.copy(h.direction,h.hL)}}};b4w.module.__obj_util=function(a,m){function l(a){a={type:a,Ve:0,n:h.Hl(),Mx:h.Hl(),pivot:new Float32Array(3),Wb:new Float32Array(3),ck:0,dk:0,zv:!1,Av:!1,Oj:null,gh:0,Ok:!1,of:p.create(),use_panning:!1,vb:0,Yk:1,Xk:1,Zk:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Cd:!1,dof_object:null,mb:null,la:null,tb:null,Cc:null,Bc:null,ce:null,Jh:!0,Xh:{qk:1,rk:1,tk:0},Rd:-1,Ed:-1,qc:new Float32Array(4),Wl:0,Ql:0,Yn:!1,Kr:new Float32Array(3),
Lr:0,ff:-1,$g:0,ah:0,En:!1,Ge:!1,fe:!1,qe:!1,ee:!1,Hd:!1,Gd:!1,jh:"",qf:!1,Yf:!1,jd:!1,Qh:!1,Dk:!1,iw:!1,Wc:!1,hw:!1,jw:!1,lm:!1,co:!1,ar:!1,bn:0,rh:0,sh:0,Ng:0,Mg:0,Hg:0,Zi:"",ze:{LB:"",KB:"",uC:""},ul:!1,kq:new Float32Array(3),Eg:!1,aq:!1,cq:"",bq:!1,Ze:0,yx:0,zx:0,bh:0,Vl:!1,Zc:!1,Ke:!1,gi:[],gk:!1,zi:!1,Bh:1,Pp:0,Op:1,ep:new Int8Array([-1,-1]),No:[],Tv:[],Xw:[],me:null,Ee:null,se:null,Ie:null,Fg:null,Ci:null,bs:null,Up:null,Tp:null,tl:null,P:q.Qd(),Ta:q.Qd(),wa:q.Gh(),lb:q.Gh(),ba:q.Jg(),qb:q.Jg(),
zd:q.lu(),jG:q.lu(),Zp:null,Xp:null,Yp:null,hp:!0,Qf:!1,pw:0};p.copy(z.Oc,a.of);return a}function c(a){if(!(a instanceof Object))return a;var b=null,k=null,h=null,n=null,l=null,m=null;a.ya&&(b=a.ya,a.ya=null);a.Ld&&(k=a.Ld,a.Ld=null);a.Gg&&(h=a.Gg,a.Gg=null);a.ib&&(n=a.ib,a.ib=null);a.zb&&(l=a.zb,a.zb=null);a.Le&&(m=a.Le,a.Le=null);var p;p=a.constructor;switch(p){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:p=
new p(a);break;case Array:p=new p(a.length);for(var q=0;q<a.length;q++)p[q]=c(a[q]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:p=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:p=null;break;case Function:p=a;break;default:for(q in p=new p,a)p[q]=c(a[q])}b&&(p.ya=b,a.ya=b);k&&(p.Ld=k,a.Ld=k);h&&(p.Gg=h,a.Gg=h);n&&(p.ib=n,a.ib=n);l&&(p.zb=l,a.zb=l);m&&(p.Le=z.Sj(),a.Le=m);return p}function b(a,b){for(var c=a.I,k=0;k<c.length;k++){var h=c[k];if(h.yb==b)return h}return null}
function x(a){return a.wk?a.parent:a.parent?x(a.parent):null}var q=m("__boundings"),A=m("__config"),h=m("__tsr"),z=m("__util"),p=m("__vec3"),n=m("__vec4"),k=A.B;new Float32Array(4);new Float32Array(4);new Float32Array(4);h.create();h.create();a.Bp=-1;a.Gq=l;a.Vz=function(a){var b=l(a.type);b.Ve=a.Ve;h.copy(a.n,b.n);h.copy(a.Mx,b.Mx);p.copy(a.pivot,b.pivot);p.copy(a.Wb,b.Wb);b.ck=a.ck;b.dk=a.dk;b.zv=a.zv;b.Av=a.Av;a.Oj&&(b.Oj=p.clone(a.Oj));b.gh=a.gh;b.Ok=a.Ok;p.copy(a.of,b.of);b.use_panning=a.use_panning;
b.vb=a.vb;b.Yk=a.Yk;b.Xk=a.Xk;b.Zk=a.Zk;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Cd=a.Cd;b.dof_object=a.dof_object;b.mb=z.R(a.mb);b.la=z.R(a.la);b.tb=z.R(a.tb);b.Cc=z.R(a.Cc);b.Bc=z.R(a.Bc);b.ce=a.ce;b.Jh=a.Jh;b.Xh.qk=a.Xh.qk;b.Xh.rk=a.Xh.rk;b.Xh.tk=a.Xh.tk;b.Rd=a.Rd;b.Ed=a.Ed;b.qc=a.qc;
b.Wl=a.Wl;b.Ql=a.Ql;b.Yn=a.Yn;p.copy(a.Kr,b.Kr);b.Lr=a.Lr;b.ff=a.ff;b.$g=a.$g;b.ah=a.ah;b.En=a.En;b.Ge=a.Ge;b.fe=a.fe;b.qe=a.qe;b.ee=a.ee;b.Hd=a.Hd;b.Gd=a.Gd;b.jh=a.jh;b.qf=a.qf;b.Yf=a.Yf;b.jd=a.jd;b.Qh=a.Qh;b.Dk=a.Dk;b.iw=a.iw;b.Wc=a.Wc;b.hw=a.hw;b.jw=a.jw;b.lm=a.lm;b.co=a.co;b.ar=a.ar;b.bn=a.bn;b.rh=a.rh;b.sh=a.sh;b.Ng=a.Ng;b.Mg=a.Mg;b.Hg=a.Hg;b.Zi=a.Zi;b.ze=a.ze;b.ul=a.ul;p.copy(a.kq,b.kq);b.Eg=a.Eg;b.aq=a.aq;b.cq=a.cq;b.bq=a.bq;b.Ze=a.Ze;b.yx=a.yx;b.zx=a.zx;b.bh=a.bh;b.Vl=a.Vl;b.Zc=a.Zc;b.Ke=
a.Ke;b.gi=z.R(a.gi);b.gk=a.gk;b.zi=a.zi;b.Bh=a.Bh;b.Pp=a.Pp;b.Op=a.Op;b.ep.set(a.ep);b.No=z.R(a.No);b.Tv=z.R(a.Tv);b.Xw=z.R(a.Xw);b.me=z.R(a.me);b.Ee=z.R(a.Ee);b.se=z.R(a.se);b.Ie=z.R(a.Ie);b.Fg=z.R(a.Fg);b.Ci=z.R(a.Ci);b.bs=z.R(a.bs);b.Up=z.R(a.Up);b.Tp=z.R(a.Tp);b.tl=z.R(a.tl);q.vn(a.P,b.P);q.vn(a.Ta,b.Ta);q.cA(a.wa,b.wa);q.cA(a.lb,b.lb);q.aA(a.ba,b.ba);q.aA(a.qb,b.qb);b.Zp=z.R(a.Zp);b.Xp=z.R(a.Xp);b.Yp=z.R(a.Yp);b.hp=a.hp;b.Qf=a.Qf;b.pw=a.pw;return b};a.Fq=function(a,b,c){c||(c=a);return{name:a,
vj:z.UA(),wm:c,type:b,Lj:!1,Ra:!1,Ar:!1,Ps:!1,k:null,oc:null,X:null,ub:null,St:null,anchor:null,Kn:null,Vv:null,I:[],Zc:[],Ue:z.Sj(),$z:z.Sj(),ia:[],ks:[],kg:[],Lt:[],mh:null,Im:[],parent:null,wk:!1,Vr:"",Fx:null,qw:null,Um:!1,cc:"",iu:"AUTO",bf:!1,fg:!1,km:!1,wG:!1,C:null,v:null,$f:null,nf:null,Ln:null,KG:null,AC:[],hh:{Yr:"NO_COLLISION",Rs:!1,TN:!1,Vh:0,ZN:0,YN:0,IH:0,FL:0,YW:!1,ZW:!1,$W:!1,aX:!1,bX:!1,cX:!1,wq:0,uq:0,xq:0,kE:!1,eu:"BOX",Ns:!1},WK:{lx:0,sC:0,Kf:0,PC:0},pl:0,Lg:[],kC:!1,LK:!1,Uv:[]}};
a.bA=function(a){return a instanceof Array?a.slice():a};a.t3=function(a){for(var b=[],k=0;k<a.length;k++){var h=a[k],n={},l;for(l in h)h[l]==h.Ta?n.Ta=c(h.Ta):h[l]==h.qb?n.qb=c(h.qb):n[l]=h[l];b.push(n)}return b};a.hu=c;a.Ra=function(a){return a.Ra};a.sW=function(a){return"MESH"==a.type&&a.Ra};a.Sp=function(a,b){a.I.push({yb:b,yv:!1,V:[],Yh:[],Hi:null,uD:[],pm:0,TK:!1,da:[],BM:[]})};a.Ot=function(a,c,k){b(a,c).V.push(k)};a.N7=function(a,b){for(var c=a.I,k=0;k<c.length;k++)if(c[k].yb==b){c.splice(k,
1);break}};a.ka=b;a.HN=function(a,b){for(var c=0;c<a.length;c++)n.copy(b,a[c].k.qc)};a.bD=function(a,b,c){for(var k=0;k<a.I.length;k++){var h=a.I[k];c&&h.yb!=c||(h.yv=b)}};a.Xu=function(a,b){for(var c=[],h=b?k.DK-1:k.DK,n=0;n<a.length;n++){var l=a[n];l.ub.sI&&c.length<h&&c.push(l)}return c.length?c:a[0]?[a[0]]:[]};a.sX=function(a,b){h.identity(b.n);b.Oj=null;a.k=b};a.PG=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,k=a.data.materials;if(0<=c&&c<k.length&&
("ADD"==k[c].game_settings.alpha_blend||"ALPHA"==k[c].game_settings.alpha_blend||"ALPHA_SORT"==k[c].game_settings.alpha_blend))return!0}return!1};a.qS=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].V,k=0;k<c.length;k++)for(var h=c[k].hb.Ki,n=0;n<h.length;n++){var l=h[n];if("USE_MODEL_TSR_INVERSE"==l[0]&&"1"==l[1])return!0}return!1};a.pI=function(a,b){return a+"*"+b};a.dJ=function(a){return a.wk?null:a.parent};a.Ri=x;a.aB=function(a,b){for(var c=[],k=0;k<b.length;k++){var h=b[k];x(h)==
a&&c.push(h)}return c};a.fB=function(a){return a.k.Ve};a.$d=function(a){return"MESH"===a.type};a.im=function(a){return"ARMATURE"===a.type};a.$n=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.Xg=function(a){return"LAMP"===a.type};a.Xn=function(a){return"EMPTY"===a.type};a.Q6=function(a){return"LINE"===a.type};a.HB=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,m){function l(){n.q("_rand() undefined")}function c(a,b,c,k,h,n){var l=a.wu,d=a.Og,f=a.time;a=a.iL;for(var r=0;r<l.length;r+=4){var g=l[r];if(f>a&&f>=g&&g>a||f<a&&(g>a||f>=g))for(g=0;8>g;g++)d[8*r+g]=k[g],y[g]=k[g];else for(g=0;8>g;g++)y[g]=d[8*r+g];g=K;g[0]=b[3*r];g[1]=b[3*r+1];g[2]=b[3*r+2];p.Hc(g,y,g);h[3*r]=g[0];h[3*r+1]=g[1];h[3*r+2]=g[2];var m=e;m[0]=c[4*r];m[1]=c[4*r+1];m[2]=c[4*r+2];m[3]=c[4*r+3];p.k_(m,y,m);n[4*r]=m[0];n[4*r+1]=m[1];n[4*r+2]=m[2];n[4*r+3]=
m[3];for(g=1;4>g;g++)h[3*(r+g)]=h[3*r],h[3*(r+g)+1]=h[3*r+1],h[3*(r+g)+2]=h[3*r+2],n[4*(r+g)]=m[0],n[4*(r+g)+1]=m[1],n[4*(r+g)+2]=m[2],n[4*(r+g)+3]=m[3]}}function b(a){a?(n.OZ(a),l=function(){return n.aY()}):l=function(){return Math.random()}}var x=m("__config"),q=m("__batch"),A=m("__geometry"),h=m("__textures"),z=m("__time"),p=m("__tsr"),n=m("__util"),k=m("__vec3"),u=x.B,e=new Float32Array(4),y=new Float32Array(8),K=new Float32Array(3),F=[];a.update=function(){for(var a=0;a<F.length;a++)for(var b=
F[a],e=b.I,k=0;k<e.length;k++)for(var h=b,n=e[k].V,l=0;l<n.length;l++){var d=n[l],f=d.gb;f&&f.vx&&!d.bg&&(c(f,f.positions,f.jN,h.k.n,f.EC,f.PD),f.KK=!0)}};a.oC=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].V,e=0;e<c.length;e++)if(c[e].gb)return!0;return!1};a.SK=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].V,e=0;e<c.length;e++){var k=c[e].gb;if(k&&"EMITTER"==k.kw)return!0}return!1};a.JR=function(a){return 0<a.particle_systems.length};a.IR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.XV=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.jW=function(a,b,c){var e=a.gb={name:b.name,kw:b.settings.type,time:0,iL:-1,vx:!1,va:0,Za:0,pN:0,NB:0,sK:0,Sd:0,Vh:0,lC:0,HJ:0,Sl:0,Df:0,iO:0,size:0,PF:0,OF:0,cH:0,bH:new Float32Array(16),KK:!1,positions:null,EC:null,jN:null,PD:null,wu:null,AA:null,Og:null,XK:null,nN:0,oN:0};e.va=b.settings.frame_start;
e.Za=b.settings.frame_end;e.pN=(e.Za-e.va)/z.sd();e.NB=b.settings.lifetime;e.sK=e.NB/z.sd();e.Sd=b.settings.b4w_cyclic?1:0;e.Vh=b.settings.mass;e.lC=b.settings.normal_factor;e.HJ=9.81*b.settings.effector_weights.gravity;e.Sl=b.settings.b4w_fade_in/z.sd();e.Df=b.settings.b4w_fade_out/z.sd();e.iO=b.settings.effector_weights.wind;e.vx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var k,l,m;a.sr?(k=c.halo.size,l=c.halo.hardness,30>l?(l=.5,m=.9):40>l?(l=.1,m=1):50>l?(l=0,m=.8):(l=0,m=.5)):(k=b.settings.particle_size,
m=l=1);e.size=k;e.PF=l;e.OF=m;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(q.jf(a,"NODES",1),q.jf(a,"PARTICLE_BATCH",1),a.ak=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&u.Nt&&(b=b[0].texture,k=[],h.PR(b.color_ramp,h.iF,k),k=new Uint8Array(k.map(function(a){return n.W(255*a,0,255)})),k=h.jH(k,h.iF),q.Hj(a,k,"u_color_ramp_tex",b.name),q.jf(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(k=0;k<b;k+=4)l=c[k/4],a[k]=l.position,a[k+1]=l.color[0],a[k+2]=l.color[1],a[k+3]=l.color[2];e.cH=c.length}e.bH.set(a)};a.aV=function(a,e,h,m){var p=a.gb,u=m.n;m=h.settings.count;var y=h.settings.frame_start/z.sd(),d=h.settings.frame_end/z.sd(),f=h.settings.lifetime/z.sd(),r=h.settings.lifetime_random,g=h.settings.emit_from,
q=h.settings.factor_random;if(h.settings.use_rotations)var t=h.settings.angular_velocity_mode,x=h.settings.angular_velocity_factor;else t="NONE",x=0;var K=h.settings.b4w_randomize_emission,G=h.settings.b4w_cyclic;p.nN=h.settings.billboard_tilt;p.oN=h.settings.billboard_tilt_random;b(h.seed);var F;e=A.bI(e,["a_position","a_tbn_quat"],null);switch(g){case "VERT":var S=e.aa[0].a_position;F=e.aa[0].a_tbn_quat;h=S.length/3;e=[];for(g=0;g<m;g++){var X=Math.round((h-1)*l());e.push(X);e.push(X);e.push(X);
e.push(X)}h=[];for(g=0;g<e.length;g++)h.push(S[3*e[g]]),h.push(S[3*e[g]+1]),h.push(S[3*e[g]+2]);S=new Float32Array(h);h=[];for(g=0;g<e.length;g++)h.push(F[4*e[g]]),h.push(F[4*e[g]+1]),h.push(F[4*e[g]+2]),h.push(F[4*e[g]+3]);F=new Float32Array(h);break;case "FACE":S=[];F=[];g=[];n.wv(0,g);h=A.VA(e,m,!1,g);n.wv(0,g);e=A.VA(e,m,!0,g);for(g=0;g<h.length;g++)S.push(h[g][0],h[g][1],h[g][2]),S.push(h[g][0],h[g][1],h[g][2]),S.push(h[g][0],h[g][1],h[g][2]),S.push(h[g][0],h[g][1],h[g][2]),F.push(e[g][0],e[g][1],
e[g][2],e[g][3]),F.push(e[g][0],e[g][1],e[g][2],e[g][3]),F.push(e[g][0],e[g][1],e[g][2],e[g][3]),F.push(e[g][0],e[g][1],e[g][2],e[g][3]);S=new Float32Array(S);F=new Float32Array(F);break;case "VOLUME":n.q("Particle emission from volume is not supported");break;default:n.q("Wrong emit from option")}F=[S,F];S=F[0];F=F[1];p.positions=new Float32Array(S);p.jN=new Float32Array(F);p.EC=new Float32Array(S.length);p.PD=new Float32Array(F.length);e=[];d=(d-y)/m;for(h=0;h<m;h++)g=K?d*h+10*d*(.5-l()):d*h,G||
(g+=y),e.push(g),e.push(g),e.push(g),e.push(g);y=new Float32Array(e);p.wu=new Float32Array(y);p.AA=new Float32Array(y);if(p.vx){p.Og=new Float32Array(8*y.length);for(K=0;K<8*y.length;K++)for(G=0;8>G;G++)p.Og[8*K+G]=u[G];c(p,S,F,u,S,F)}u=A.Hf("EMITTER_PARTICLES");K=n.Kg();K.a_position=S;K.a_tbn_quat=F;u.aa[0]=K;a.Ih=A.ht;a=[];for(K=0;K<m;K++)a.push(4*K,4*K+2,4*K+1,4*K,4*K+3,4*K+2);a=new Uint16Array(a);u.na=a;u.qa.a_p_bb_vertex=A.nI(m);u.Ja=S.length/3;a=[];r*=f;for(K=0;K<m;K++)G=r*l(),a.push(f-G),a.push(f-
G),a.push(f-G),a.push(f-G);f=u.qa;r=[];for(K=0;K<m;K++)G=Math.random(),r.push(a[4*K],y[4*K],G),r.push(a[4*K+1],y[4*K+1],G),r.push(a[4*K+2],y[4*K+2],G),r.push(a[4*K+3],y[4*K+3],G);r=new Float32Array(r);f.a_p_data=r;f=u.qa;r=[];for(a=0;a<m;a++){y=[l()-.5,l()-.5,l()-.5];k.normalize(y,y);r.push(q*y[0]);r.push(q*y[1]);r.push(q*y[2]);switch(t){case "NONE":r.push(0);break;case "SPIN":case "VELOCITY":r.push(x);break;case "RAND":r.push(2*x*(l()-.5));break;default:n.q("Undefined velocity factor")}y=r.slice(-4);
for(K=0;12>K;K++)r.push(y[K%4])}m=new Float32Array(r);f.a_p_vels=m;p.XK=new Float32Array(u.qa.a_p_data);return u};a.fZ=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var k=a[e].V,h=0;h<k.length;h++){var n=k[h].gb;n&&n.name==b&&!k[h].bg&&(n.iL=n.time,n.time=c)}};a.VX=function(a){for(var b=a.Ja,c=a.aa[0].a_position,e=[],k=[],h=0;h<b;h++)k.push(c[3*h]),e.push(c[3*h+1]),k.push(c[3*h+2]);e=new Float32Array(e);k=new Float32Array(k);a.qa.a_lf_dist=e;a.qa.a_lf_bb_vertex=k;return a};a.K8=function(a,
b,c){a=a.I;for(var e=0;e<a.length;e++)for(var k=a[e].V,h=0;h<k.length;h++){var n=k[h].gb;n&&n.name==b&&(n.size=c)}};a.x8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var k=a[e].V,h=0;h<k.length;h++){var n=k[h].gb;n&&n.name==b&&(n.lC=c)}};a.l8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var k=a[e].V,h=0;h<k.length;h++){var n=k[h],d=n.gb;if(d&&d.name==b){var f=d.wu;if(1==c)var l=f;else if(0==c)for(var l=d.AA,g=0;g<l.length;g+=4)l[g]=1E4,l[g+1]=l[g],l[g+2]=l[g],l[g+3]=l[g];else for(var m=
4/c,l=d.AA,p=0,g=0;g<l.length;g+=4)g>=p?(l[g]=f[g],p+=m):l[g]=1E4,l[g+1]=l[g],l[g+2]=l[g],l[g+3]=l[g];n=n.Ba;if(n.ld.a_p_data){d=d.XK;for(g=0;g<d.length;g+=3)d[g+1]=l[Math.round(g/3)];A.B_(n,d)}}}};a.X_=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var k=a[e].V,h=0;h<k.length;h++){var n=k[h].gb;if(n&&n.vx)for(var d=0;d<8*n.wu.length;d++)n.Og[8*d]=b[0],n.Og[8*d+1]=b[1],n.Og[8*d+2]=b[2],n.Og[8*d+3]=b[3],n.Og[8*d+4]=c[0],n.Og[8*d+5]=c[1],n.Og[8*d+6]=c[2],n.Og[8*d+7]=c[3]}};a.P_=function(a,b,c){for(var e=
[],k=0;k<c;k++)e.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.qa.a_tbn_quat=new Float32Array(e);if(b.Wr){e=[];for(k=0;k<c;k++)e.push(k,k,k,k);a.qa[b.Wr.name]=new Float32Array(e)}};a.O_=function(a){-1==F.indexOf(a)&&F.push(a)};a.fY=function(a){a=F.indexOf(a);-1!=a&&F.splice(a,1)};a.ua=function(){F.length=0}};b4w.module.__geometry=function(a,m){function l(){return{length:0,frames:1,Kc:0,Pm:0,offset:0,Qq:0}}function c(a,b){for(var d=b.a_tbn_quat,c=b.a_position,e=d.length,f=c.length,k=1;k<a.ib.length;k++)for(var g=a.ib[k].Ef,h=a.ib[k].vr,g=g.a_position,n=0;n<f;n++)c[n]+=h*g[n];c=ca;for(k=0;k<e;k+=4){f=d.subarray(k,k+4);c.set(V.jn);for(n=1;n<a.ib.length;n++)g=a.ib[n].Ef,h=a.ib[n].vr,h=W.slerp(V.jn,g.a_tbn_quat,h,na),W.normalize(h,h),W.multiply(h,c,c);W.multiply(c,f,f)}}function b(a){return 65536<a.Ja?H.MI()?
!1:!0:!1}function x(a){return 0<a.na.length?!0:!1}function q(a,b,d){if(!x(a))return a;d||ma.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.na;d=a.Ja;var c=a.qa,e=a.aa,f;for(f in c){var k=c[f],g=R(k,d);c[f]=A(b,k,g)}for(c=0;c<e.length;c++){var h=e[c];for(f in h)k=h[f],g=R(k,d),h[f]=A(b,k,g)}for(c=0;c<a.ib.length;c++){f=a.ib[c].Ef;for(var n in f)k=f[n],g=R(k,d),f[n]=A(b,k,g)}a.Ja=b.length;a.na=new Uint16Array(0);return a}
function A(a,b,d){if(0==b.length)return new Float32Array(0);for(var c=new Float32Array(a.length*d),e=0;e<a.length;e++)for(var f=a[e],k=0;k<d;k++)c[d*e+k]=b[d*f+k];return c}function h(){return{ke:null,rc:g(),dm:0,count:0,ld:{},Sm:0,zn:0,Bn:0,Md:[],eg:null,ib:null,hm:1,Wf:!0}}function z(a,b){var d=a.ld[b];if(d){var c=T(b);return M(a.rc,c).subarray(d.offset,d.offset+d.length)}V.q("extract_array() failed; invalid name: "+b)}function p(b,d){var c;switch(d){case a.en:case a.vp:c=L.STATIC_DRAW;break;case a.ht:c=
L.DYNAMIC_DRAW;break;default:V.q("Wrong draw_mode")}b.Sm=c}function n(a,b,d){function c(a,b){e[a]||(e[a]=0);e[a]+=b}var e={},f;for(f in a[0]){var k=a[0][f],g=T(f);c(g,k.length*a.length)}for(f in b)k=b[f],g=T(f),c(g,k.length);if(d){a=d.dp.length;g=T("a_part_ts");c(g,4*a);g=T("a_part_r");c(g,4*a);b=d.Bm;for(f in b)g=T(f),c(g,b[f].Kc*a);d=d.Hs;for(f in d)g=T(f),c(g,a)}return e}function k(a){a.ke?(a.eg||(a.eg=L.createBuffer()),L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,a.eg),L.bufferData(L.ELEMENT_ARRAY_BUFFER,
a.ke,a.Sm),a.zn=a.ke.byteLength):a.zn=0;for(var b=a.Bn=0;b<a.rc.length;b++){var d=a.rc[b].type,c=t(a.Md,d);-1==c&&(a.Md.push({Wk:null,type:d,XT:V.p_()}),c=a.Md.length-1);d=a.Md[c];d.Wk||(d.Wk=L.createBuffer());L.bindBuffer(L.ARRAY_BUFFER,d.Wk);L.bufferData(L.ARRAY_BUFFER,a.rc[b].ni,a.Sm);a.Bn+=a.rc[b].ni.byteLength}}function u(a,b){a.P=X.yl(a.P,b);a.ba=X.dq(a.ba,b);a.wa=X.eq(a.wa,b);a.zd=X.Dz(a.zd,b)}function e(a){for(var b=a[0],d=a[0],c=r("JOIN_"+a.length+"_SUBMESHES"),e=0,f=0;f<a.length;f++)e+=
a[f].na.length;c.na=new Uint32Array(e);var k=e=0;if(0<a[0].ib.length)for(var g=0;g<a[0].ib.length;g++){for(f=0;f<a.length;f++)e+=a[f].ib[g].Ef.a_position.length,k+=a[f].ib[g].Ef.a_tbn_quat.length;f={a_position:new Float32Array(e),a_tbn_quat:new Float32Array(k)};c.ib.push({vr:a[0].ib[g].vr,Ef:f})}for(f=e=0;f<a.length;f++)e+=a[f].Ja;c.Ja=e;for(var h in d.qa){for(f=e=0;f<a.length;f++)e+=a[f].qa[h].length;c.qa[h]=new Float32Array(e)}for(h in d.aa[0]){for(f=e=0;f<a.length;f++)e+=a[f].aa[0][h].length;for(f=
0;f<d.aa.length;f++)c.aa[f]=c.aa[f]||{},c.aa[f][h]=new Float32Array(e)}f=c.Nf;f.P=X.Bl(b.Nf.P);k=e=0;g=[];for(d=0;d<a.length;d++){var n=a[d],l=n.na,v=n.Ja,m=n.qa;h=n.Nf.wa;X.KA(f.P,n.Nf.P);X.tU(f.wa,h);X.OA(n.Nf.zd,g);for(h=0;h<l.length;h++)c.na[e+h]=l[h]+k;var e=e+l.length,p;for(p in m){var l=m[p],t=k*R(l,v);c.qa[p].set(l,t)}for(h=0;h<n.aa.length;h++){var m=n.aa[h],u=c.aa[h];for(p in m)l=m[p],t=k*R(l,v),u[p].set(l,t)}k+=v}f.ba=X.ju(V.Cf(g),!0);if(0<c.ib.length)for(d=0;d<c.ib.length;d++)for(p=c.ib[d].Ef,
h=e=f=0;h<a.length;h++)k=a[h].ib[d].Ef,p.a_position.set(k.a_position,f),p.a_tbn_quat.set(k.a_tbn_quat,e),f+=k.a_position.length,e+=k.a_tbn_quat.length;a[0].If&&(c.If={dp:b.If.dp,hx:b.If.hx,SM:!0,Hs:b.If.Hs,Bm:b.If.Bm,Bu:b.If.Bu});return c}function y(a,b,d){b=b.Nf;for(var c=X.Qd(),e=X.lu(),f=[],k=0;k<d.length;k++)X.yl(a.Nf.P,d[k],c),X.KA(b.P,c),X.Dz(a.Nf.zd,d[k],e),X.OA(e,f);b.ba=X.ju(V.Cf(f),!0);b.zd=X.OS(b.ba);b.wa=X.Dq(b.ba)}function K(a,b,d,c,e,f){var k=a.submeshes[b],g=k.base_length,h=r("SUBMESH_"+
a.name+"_"+a.materials[b].name);h.Ja=g;var n=!1;if(J(d,"a_texcoord")){var l=null,v=a.materials[b];b=a.submeshes[b];if(v.texture_slots.length)switch(v=v.texture_slots[0],v.texture_coords){case "UV":v=a.uv_textures.indexOf(v.uv_layer);0==v?l=new Float32Array(b.texcoord):1==v&&(l=new Float32Array(b.texcoord2));break;case "ORCO":for(var m=a.b4w_boundings.bb_src,l=new Float32Array(2*b.base_length),v=(m.max_x+m.min_x)/2,p=(m.max_y+m.min_y)/2,t=m.max_x-m.min_x,m=m.max_y-m.min_y,u=0,H=0;H<b.position.length;H+=
3)l[u++]=(b.position[H]-v)/t+.5,l[u++]=(b.position[H+1]-p)/m+.5}null===l&&(l=new Float32Array(2*b.base_length));b=l}else b=new Float32Array(0);if(J(d,"a_orco_tex_coord")){l=a.b4w_boundings.bb_src;v=new Float32Array(3*k.base_length);p=l.max_x-l.min_x;t=l.max_y-l.min_y;m=l.max_z-l.min_z;for(H=u=0;H<k.position.length;H+=3)0==p?v[u++]=.5:v[u++]=V.W(parseFloat(((k.position[H]-l.min_x)/p).toFixed(5)),0,1),0==t?v[u++]=.5:v[u++]=V.W(parseFloat(((k.position[H+1]-l.min_y)/t).toFixed(5)),0,1),0==m?v[u++]=.5:
v[u++]=V.W(parseFloat(((k.position[H+2]-l.min_z)/m).toFixed(5)),0,1);l=v}else l=new Float32Array(0);v=k.group;if(J(d,"a_influence")&&c){p=new Float32Array(4*g);t=v.length/g;m=new Float32Array(t);for(u=0;u<t;u++){m[u]=-1;for(var y in c)if(H=c[y],H.bO===u){m[u]=H.zA;break}}var O=3<t?t:4;c=new Float32Array(O);y=new Uint32Array(O);for(var u=new Float32Array(4),H=new Float32Array(O),O=new Uint32Array(O),L=new Float32Array(4),z=0;z<g;z++)c.set(H),y.set(O),u.set(L),p.set(D(v,t,z,g,m,c,y,u),4*z)}else p=new Float32Array(0);
c=p;e=e?V.R(e):{};e.a_color={$l:!0};e.a_color.src=J(d,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,gg:7}]:[];h.qa.a_texcoord=b;h.qa.a_influence=c;h.qa.a_orco_tex_coord=l;c=h.qa;y=k.vertex_colors;b=k.color;l=a.name;v=[];for(p=0;p<y.length;p++)v.push(y[p].name);for(var W in e)if(p=e[W].src,p.length){for(m=t=0;m<p.length;m++)t+=V.Gm(p[m].gg);c[W]=new Float32Array(t*g);for(m=u=0;m<p.length;m++){var B=p[m].name,H=p[m].gg,O=V.EL(H),I=v.indexOf(B);-1==I&&V.q('vertex color "'+B+'" for mesh "'+
l+'" not found.');L=y[I].mask;z=V.Gm(L);(H&L)!==H&&ma.error("Wrong color extraction from "+B+" to "+W+".");for(var Q=B=0;Q<I;Q++)B+=V.Gm(y[Q].mask);I=B*g;for(B=0;B<g;B++)for(Q=0;3>Q;Q++)O[Q]&&(c[W][B*t+(u+V.Bo(H,Q))]=b[I+B*z+V.Bo(L,Q)]);u+=z}}else c[W]=new Float32Array(0);W=a.uv_textures;e=k.texcoord;c=k.texcoord2;y=h.qa;if(f)for(var w in f){b=W.indexOf(w);if(0==b)var ba=new Float32Array(e);else 1==b&&(ba=new Float32Array(c));y[f[w]]=ba}h.na=new Uint32Array(k.indices);w=k.position.length/g/3;ba=J(d,
"a_tbn_quat")&&k.tbn_quat.length?!0:!1;W=J(d,"a_shade_tangs")&&k.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(n=!0);for(e=0;e<w;e++){f=F(k,g,ba,W,e);if(n)if(c={},c.name=a.b4w_shape_keys[e].name,h.ib.push(c),0!=e){c.Ef=f;c.vr=a.b4w_shape_keys[e].value;continue}else c.Ef=F(k,g,ba,W,e),c.vr=1;h.aa.push(f)}if(1<w&&!n){a=h.aa[0];f={};for(var x in a)f[x]=new Float32Array(a[x]);h.aa.push(f)}J(d,"a_polyindex")&&(q(h,1,!0),h.qa.a_polyindex=P(h));k=k.boundings;d=h.Nf;d.P=X.Qd();d.P.max_x=k.bb.max_x;
d.P.max_y=k.bb.max_y;d.P.max_z=k.bb.max_z;d.P.min_x=k.bb.min_x;d.P.min_y=k.bb.min_y;d.P.min_z=k.bb.min_z;x=k.rbb;a=k.caxis_x;g=k.caxis_y;n=k.caxis_z;f=k.be_ax;d.ba=X.$p(a,g,n,k.be_cen);ga.scale(d.ba.Ga,f[0],d.ba.Ga);ga.scale(d.ba.Ha,f[1],d.ba.Ha);ga.scale(d.ba.Ia,f[2],d.ba.Ia);d.wa=X.Dq(d.ba);ga.copy(x.rbb_c,d.zd.G);ga.copy(a,d.zd.Ga);ga.copy(g,d.zd.Ha);ga.copy(n,d.zd.Ia);k=x.rbb_s;ga.scale(d.zd.Ga,k[0],d.zd.Ga);ga.scale(d.zd.Ha,k[1],d.zd.Ha);ga.scale(d.zd.Ia,k[2],d.zd.Ia);return h}function F(a,b,
d,c,e){var f={},k=new Float32Array(3*b),g=new Float32Array(d?4*b:0),h=e*b*3;k.set(a.position.subarray(h,h+3*b),0);d&&(h=e*b*4,g.set(a.tbn_quat.subarray(h,h+4*b),0));c&&(d=new Float32Array(3*b),d.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=d);f.a_position=k;f.a_tbn_quat=g;return f}function J(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,d,c,e,f,k,g,h){for(var n=!0,l=0;l<d;l++){var v=b[l*e+c];if(-1!==v){var r=f[l];-1!==r&&(k[l]=v,g[l]=r,n=!1)}}if(n)return h;E(k,g,a.ez,!1);for(l=b=0;4>l;l++)b+=
k[l];if(.01>b)return h;for(l=0;4>l;l++)k[l]/=b;if(.01>Math.abs(k[0]-1))h[0]=g[0]+1;else for(l=0;4>l;l++)h[l]=g[l]+k[l];return h}function R(a,b){if(0==b)return 0;var d=a.length,c=d/b;c!=Math.floor(c)&&V.q("Array size mismatch during geometry calculation: array length="+d+", base length="+b);return c}function E(b,d,c,e){for(var f=b.length,k=f,g=!1,h=e?-1:1;1<k||g;){1<k&&(k=Math.floor(k/1.247330950103979));for(var g=!1,n=0;k+n<f;n++)if(c==a.ez?0>h*(b[n]-b[n+k]):b[n]<b[n+k]&&e)g=b[n],b[n]=b[n+k],b[n+
k]=g,g=d[n],d[n]=d[n+k],d[n+k]=g,g=!0}}function I(a,b,d){var c=[],e=[];ga.subtract(b,a,c);ga.subtract(d,a,e);ga.normalize(c,c);ga.normalize(e,e);a=V.W(ga.dot(c,e),-1,1);return Math.acos(a)}function B(a,b,d){if(x(b)){b=b.na;for(var c=b.length/3,e=0;e<c;e++){var f=new Float32Array(9),k=b[3*e];f[0]=a[3*k];f[1]=a[3*k+1];f[2]=a[3*k+2];k=b[3*e+1];f[3]=a[3*k];f[4]=a[3*k+1];f[5]=a[3*k+2];k=b[3*e+2];f[6]=a[3*k];f[7]=a[3*k+1];f[8]=a[3*k+2];d[e]=f}}else for(e=0;e<a.length;e++)f=new Float32Array(9),f[0]=a[9*
e],f[1]=a[9*e+1],f[2]=a[9*e+2],f[3]=a[9*e+3],f[4]=a[9*e+4],f[5]=a[9*e+5],f[6]=a[9*e+6],f[7]=a[9*e+7],f[8]=a[9*e+8],d[e]=f;return d}function P(a){for(var b=new Float32Array(a.Ja),d=0;d<a.Ja;d++)b[d]=d%3/2;return b}function d(a,b,d){var c=ga.dist(a,b);a=ga.dist(a,d);b=ga.dist(b,d);d=(c+a+b)/2;return d*(d-c)*(d-a)*(d-b)}function f(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),d=new Float32Array(8*a),c=0;c<a;c++)d.set(b,8*c);return d}function r(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,na:null,aa:[],qa:b,ib:[],Nf:{P:X.Qd(),ba:X.Jg(),wa:X.Gh(),zd:X.lu()},If:null}}function g(a){var b=[],d;for(d in a)b.push(Q(d,a[d]));return b}function Q(a,b){return{ni:new (G(a))(b),type:a}}function t(a,b){for(var d=0;d<a.length;d++)if(a[d].type==b)return d;return-1}function aa(a,b){var d=t(a,b);return-1==d?null:a[d].Wk}function M(a,b){var d=t(a,b);return-1==d?null:a[d].ni}function G(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function T(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function S(a,
b,d,c){var e=T(b);b=t(a,e);switch(e){case "float":a[b].ni.set(d,c);break;case "short":for(e=0;e<d.length;e++)a[b].ni[c+e]=V.Wq(d[e]);break;case "unsigned_byte":for(e=0;e<d.length;e++)a[b].ni[c+e]=V.m_(d[e])}}var X=m("__boundings"),H=m("__extensions"),ma=m("__print"),W=m("__quat"),O=m("__tsr"),V=m("__util"),ga=m("__vec3");new Float32Array(2);var v=new Float32Array(3),ba=new Float32Array(3),ea=new Float32Array(3),ca=new Float32Array(4),na=new Float32Array(4),pa=new Float32Array(8);a.vp=10;a.ht=20;a.ez=
0;a.b2=1;a.en=a.vp;var L=null;a.rQ="float";a.e2="short";a.f2="unsigned_byte";a.Lf=function(a){L=a};a.$M=function(a,d,e){b(a)&&q(a);var f=a.na,v=a.Ja,r=a.aa,m={},t;for(t in a.qa)t in e&&!e[t].$l||(m[t]=a.qa[t]);e=h();0<a.ib.length&&c(a,r[0]);t=a.If;if(f.length){var u=f.length;if(65536>=v)var f=new Uint16Array(f),C=L.UNSIGNED_SHORT;else f=new Uint32Array(f),C=L.UNSIGNED_INT}else u=v,f=null;for(var H=n(r,m,t),H=g(H),y={},z=0;z<H.length;z++)y[H[z].type]=0;var W={},B;for(B in m){var Q=m[B],I=Q.length;
if(I){var P=T(B),z=W[B]=l();z.length=I;z.Kc=R(Q,v);z.offset=y[P];S(H,B,Q,y[P]);y[P]+=I}}m=r.length;for(B in r[0])if(Q=r[0][B],P=T(B),I=Q.length,Q=R(Q,v),I)for(z=W[B]=l(),z.length=I,z.frames=m,z.Kc=Q,z.offset=y[P],1<m&&(z=W[B+"_next"]=l(),z.length=I,z.frames=m,z.Kc=Q,z.offset=y[P]+I),z=0;z<m;z++)Q=r[z][B],P=T(B),S(H,B,Q,y[P]),y[P]+=I;if(t){r=t.dp;B=t.hx;m=t.Bm;I=t.Hs;r=t.dp;B=t.hx;var m=t.Bm,I=t.Hs,P=t.SM,v={a_part_ts:{data:[],Kc:4},a_part_r:{data:[],Kc:4}},ba;for(ba in m)v[ba]={data:[],Kc:m[ba].Kc};
for(ba in I)v[ba]={data:[],Kc:1};for(Q=0;Q<r.length;Q++){z=r[Q];P&&B&&!t.Bu&&(z=O.multiply(B,r[Q],pa));!P&&t.Bu&&ga.subtract(r[Q],B,r[Q]);v.a_part_ts.data.push(z[0],z[1],z[2],z[3]);v.a_part_r.data.push(z[4],z[5],z[6],z[7]);for(ba in m)for(var z=m[ba].Kc,x=0;x<z;x++)v[ba].data.push(m[ba].data[Q*z+x]);for(ba in I)v[ba].data.push(I[ba][0])}for(ba in v)r=T(ba),S(H,ba,v[ba].data,y[r]),B=l(),B.Kc=v[ba].Kc,B.offset=y[r],B.Qq=1,B.length=v[ba].data.length,W[ba]=B,y[r]+=B.length;e.hm=t.dp.length}e.count=u;
e.ke=f;e.rc=H;e.dm=C;e.ld=W;p(e,d);k(e);e.ib=a.ib;return e};a.UZ=c;a.xW=b;a.wW=x;a.kx=q;a.C_=function(a,b,d){p(a,b);a.count=d.length;a.ke=d;a.dm=d instanceof Uint16Array?L.UNSIGNED_SHORT:L.UNSIGNED_INT};a.B_=function(a,b){var d=a.ld,c=d.a_p_data,e=T("a_p_data");if(c)3!=c.Kc&&V.q('invalid num_comp for "a_p_data"'),S(a.rc,"a_p_data",b,c.offset);else{c=t(a.rc,e);-1==c&&(a.rc.push(Q(e,0)),c=a.rc.length-1);var e=a.rc[c].ni,f=new e.constructor(e.length+b.length);f.set(e);a.rc[c].ni=f;S(a.rc,"a_p_data",
b,e.length);d=d.a_p_data=l();d.Kc=3;d.offset=e.length;d.length=b.length}k(a)};a.e4=z;a.h7=function(a){a.Sm=L.STATIC_DRAW};a.hX=function(a){a.Sm=L.DYNAMIC_DRAW};a.FN=k;a.zS=function(a){a.eg&&L.deleteBuffer(a.eg);for(var b=0;b<a.Md.length;b++)a.Md[b].Wk&&L.deleteBuffer(a.Md[b].Wk);a.Md.length=0};a.LJ=function(a,b){return a.submeshes[b].base_length?!1:!0};a.jx=function(a,b){for(var d=0;d<a.aa.length;d++){var c=a.aa[d].a_position;O.Pk(c,b,c,0);c=a.aa[d].a_tbn_quat;0<c.length&&O.vN(c,b,c,0);(c=a.aa[d].a_shade_tangs)&&
0<c.length&&O.cE(c,b,c,0)}(d=a.qa.au_center_pos)&&d.length&&O.Pk(d,b,d,0);u(a.Nf,b)};a.TZ=function(a,b){var d=a.qa.au_center_pos;if(d&&d.length){var c=new Float32Array(d);O.Pk(c,b,c,0);for(var e=0;e<a.aa.length;e++)for(var f=0;f<c.length;f++)a.aa[e].a_position[f]+=c[f]-d[f];d.set(c)}else V.q('Attribute "au_center_pos" is missing in particle submesh');u(a.Nf,b)};a.HR=u;a.SZ=function(a,b){var d=a.Ja,c;for(c in b){var e=b[c].length;a.qa[c]=new Float32Array(e*d);for(var f=0;f<d;f++)for(var k=0;k<e;k++)a.qa[c][f*
e+k]=b[c][k]}};a.ZM=e;a.gX=function(a,b,d){if(!a.Ja)return r("EMPTY");var c=d.length;65536<a.Ja*c&&!H.MI()&&q(a,c);var e=a.na,f=a.Ja,k=a.qa,g=a.aa,h;for(h in b){var n=b[h].length,l=n*f;k[h]=new Float32Array(l);for(var v=0;v<f;v++)for(l=0;l<n;l++)k[h][v*n+l]=b[h][l]}b=r("CLONE_"+c+"_SUBMESHES");b.Ja=f*c;b.na=new Uint32Array(e.length*c);for(v=0;v<c;v++)for(n=e.length*v,h=f*v,l=0;l<e.length;l++)b.na[n+l]=e[l]+h;for(var m in k)for(e=k[m],l=e.length*c,n=R(e,f),b.qa[m]=new Float32Array(l),v=0;v<c;v++)h=
f*n*v,b.qa[m].set(e,h);for(m in g[0])for(v=0;v<g.length;v++)for(e=g[v][m],l=e.length*c,n=R(e,f),b.aa[v]=b.aa[v]||{},b.aa[v][m]=new Float32Array(l),l=0;l<c;l++)switch(k=d[l],h=f*n*l,m){case "a_position":O.Pk(e,k,b.aa[v][m],h);break;case "a_tbn_quat":O.vN(e,k,b.aa[v][m],h);break;case "a_shade_tangs":O.dE(e,k,b.aa[v][m],h);break;default:V.q("Wrong attribute name: "+m)}y(a,b,d);return b};a.zG=y;a.PA=K;a.yU=function(a){var b=a.Ja,d=a.aa[0].a_position,c=new Float32Array(12*b);a=new Uint32Array(4*a.na.length);
for(var e=new Float32Array(4*b),k=0;k<b;k++){c[12*k]=d[3*k];c[12*k+1]=d[3*k+1];c[12*k+2]=d[3*k+2];c[12*k+3]=d[3*k];c[12*k+4]=d[3*k+1];c[12*k+5]=d[3*k+2];c[12*k+6]=d[3*k];c[12*k+7]=d[3*k+1];c[12*k+8]=d[3*k+2];c[12*k+9]=d[3*k];c[12*k+10]=d[3*k+1];c[12*k+11]=d[3*k+2];a[6*k]=4*k+2;a[6*k+1]=4*k+1;a[6*k+2]=4*k;a[6*k+3]=4*k+2;a[6*k+4]=4*k;a[6*k+5]=4*k+3;var g=Math.random();e[4*k]=g;e[4*k+1]=g;e[4*k+2]=g;e[4*k+3]=g}d=r("HALO");d.aa[0]={};d.Ja=4*b;d.aa[0].a_position=c;d.qa.a_halo_bb_vertex=f(b);d.qa.a_random_vals=
e;d.na=a;return d};a.VV=J;a.bI=function(a,b,d){for(var c=[],f=0;f<a.submeshes.length;f++){var k=K(a,f,b,null,d,null);k.Ja&&c.push(k)}return 0==c.length?r("EMPTY"):1==c.length?c[0]:e(c)};a.A_=function(a,b,d,c){var e=a.ke,f=z(a,"a_position"),k=b.qX,g=b.rX;b=b.dU;for(var h=e,n=h.length/3,l=0;l<n;l++){var v=h[3*l],r=h[3*l+1],m=h[3*l+2],p=f[3*v+1],t=f[3*v+2],u=f[3*r+1],H=f[3*r+2],y=f[3*m+1],q=f[3*m+2];k[3*l]=(f[3*v]+f[3*r]+f[3*m])/3;k[3*l+1]=(p+u+y)/3;k[3*l+2]=(t+H+q)/3}O.Pk(k,d,g);d=g.length/3;for(f=
0;f<d;f++)k=g[3*f]-c[0],h=g[3*f+1]-c[1],n=g[3*f+2]-c[2],b[f]=k*k+h*h+n*n;c=e;e=b.length;if(!(2>e))for(g=e,f=!1;1<g||f;)for(1<g&&(g=Math.floor(g/1.247330950103979)),f=!1,d=0;g+d<e;d++)0>b[d]-b[d+g]&&(f=b[d],b[d]=b[d+g],b[d+g]=f,f=c,k=d,h=d+g,n=f[3*k],l=f[3*k+1],v=f[3*k+2],f[3*k]=f[3*h],f[3*k+1]=f[3*h+1],f[3*k+2]=f[3*h+2],f[3*h]=n,f[3*h+1]=l,f[3*h+2]=v,f=!0);e=c;L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,a.eg);L.bufferData(L.ELEMENT_ARRAY_BUFFER,e,L.DYNAMIC_DRAW)};a.CZ=E;a.SR=function(a,b,d){for(var c=b.length/
3,e=a.length/3,f=[],k=Array(3),g=Array(3),h=Array(3),n=0;n<e;n++){for(var l=a[3*n],v=a[3*n+1],r=a[3*n+2],m=0;3>m;m++)k[m]=b[3*l+m],g[m]=b[3*v+m],h[m]=b[3*r+m];if(d)var m=I(k,g,h),p=I(g,h,k),t=Math.PI-m-p;else t=p=m=1;var u=f,H;H=k;var y=h,q=[],O=[],L=[];ga.subtract(g,H,q);ga.subtract(y,H,O);ga.cross(q,O,L);ga.normalize(L,L);H=L;for(y=0;3>y;y++)q=3*v+y,O=3*r+y,u[3*l+y]=m*H[y],u[q]=p*H[y],u[O]=t*H[y]}if(d)for(var z in d)for(n=d[z],a=0;3>a;a++){b=3*n[0]+a;for(e=1;e<n.length;e++)k=3*n[e]+a,f[b]+=f[k];
for(e=1;e<n.length;e++)k=3*n[e]+a,f[k]=f[b]}for(n=0;n<c;n++){d=n;z=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*d+b,a[b]=z[e];ga.normalize(a,a);for(b=0;3>b;b++)e=3*d+b,z[e]=a[b]}return f};a.VR=function(a,b,d){for(var c={},e=b.length/3,f=0;f<e;f++){var k=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);c[k]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],k=String(d[3*b])+String(d[3*b+1])+String(d[3*b+2]),k in c&&c[k].push(b);return c};a.VA=function(a,b,c,e){var f;f=null;f=[];f=B(a.aa[0].a_position,a,f);if(c){var k;
k=null;k=[];for(var g=a.aa[0].a_tbn_quat,h=g.length/4,n=new Float32Array(3*h),l=0;l<h;l++){var m=ca;m[0]=g[4*l];m[1]=g[4*l+1];m[2]=g[4*l+2];m[3]=g[4*l+3];m=ga.transformQuat(V.zj,m,v);n[3*l]=m[0];n[3*l+1]=m[1];n[3*l+2]=m[2]}k=B(n,a,k)}h=f.length;n=new Float32Array(h);for(a=0;a<h;a++)l=f[a],v.set(l.subarray(0,3)),ba.set(l.subarray(3,6)),ea.set(l.subarray(6)),n[a]=Math.sqrt(d(v,ba,ea));g=new Float32Array(h);g[0]=n[0];for(a=1;a<h;a++)g[a]=g[a-1]+n[a];h=g[n.length-1];n=[];for(a=0;a<b;a++){var l=h*V.qg(e),
l=V.Xt(g,l,0,g.length-1),r=l=c?k[l]:f[l],p=e;(l=v)||(l=new Float32Array(3));var m=r[0],t=r[1],u=r[2],H=r[3],y=r[4],q=r[5],O=r[6],L=r[7],z=r[8],r=V.qg(p),p=V.qg(p);1<r+p&&(r=1-r,p=1-p);var Q=1-r-p,t=Q*t+r*y+p*L,u=Q*u+r*q+p*z;l[0]=Q*m+r*H+p*O;l[1]=t;l[2]=u;c?(n[a]=new Float32Array(4),ga.normalize(l,l),l=W.rotationTo(V.zj,l,ca),n[a][0]=l[0],n[a][1]=l[1],n[a][2]=l[2],n[a][3]=l[3]):(n[a]=new Float32Array(3),n[a][0]=l[0],n[a][1]=l[1],n[a][2]=l[2])}return n};a.Gu=P;a.F9=d;a.nI=f;a.JL=function(a,b,d){a=a.aa[0].a_position;
for(var c=0;c<a.length;c+=3)a[c]=(a[c]-d[0])*b[0]+d[0],a[c+1]=(a[c+1]-d[1])*b[1]+d[1],a[c+2]=(a[c+2]-d[2])*b[2]+d[2]};a.jR=function(a,b,d){var c=a.I[0].V;a=a.k.gi;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=d);for(e=0;e<c.length;e++)if(!c[e].bg&&c[e].Ke&&!c[e].Ji){b=c[e].Ba;var f=T("a_position");d=aa(b.Md,f);f=M(b.rc,f);L.bindBuffer(L.ARRAY_BUFFER,d);var k=b.ld.a_position;d=c[e];var g=a;if(k){for(var h=k.offset,k=k.length+h,n=d.Ba.ib[0].Ef.a_position,l=h;l<k;l++)f[l]=n[l-h];for(l=1;l<d.Ba.ib.length;l++){var n=
d.Ba.ib[l].Ef.a_position,v=g[l].value;if(v)for(var r=h;r<k;r++)f[r]+=v*n[r-h]}L.bufferSubData(L.ARRAY_BUFFER,V.Aj*h,f.subarray(h))}f=T("a_tbn_quat");d=aa(b.Md,f);f=M(b.rc,f);L.bindBuffer(L.ARRAY_BUFFER,d);h=b.ld.a_tbn_quat;b=c[e];d=f;f=a;if(h){g=h.offset;h=h.length+g;k=b.Ba.ib[0].Ef.a_tbn_quat;l=ca;for(n=g;n<h;n+=4){l[0]=0;l[1]=0;l[2]=0;for(v=l[3]=1;v<b.Ba.ib.length;v++){var r=b.Ba.ib[v].Ef.a_tbn_quat,m=f[v].value;if(m){var p=na;p[0]=r[n-g];p[1]=r[n+1-g];p[2]=r[n+2-g];p[3]=r[n+3-g];r=W.slerp(V.jn,
p,m,na);W.multiply(r,l,l)}}v=na;v[0]=k[n-g];v[1]=k[n-g+1];v[2]=k[n-g+2];v[3]=k[n-g+3];r=0<v[3];W.multiply(l,v,v);(0<v[3]&&!r||0>v[3]&&r)&&W.scale(v,-1,v);d[n]=V.Wq(v[0]);d[n+1]=V.Wq(v[1]);d[n+2]=V.Wq(v[2]);d[n+3]=V.Wq(v[3])}L.bufferSubData(L.ARRAY_BUFFER,V.Aj*g,d.subarray(g))}}};a.sS=function(a){return a.k.Ke};a.J5=function(a){var b=[];if(a.k)for(var d=1;d<a.k.gi.length;d++)b.push(a.k.gi[d].name);return b};a.I5=function(a,b){if(a.k)for(var d=1;d<a.k.gi.length;d++)if(b==a.k.gi[d].name)return a.k.gi[d].value;
return 0};a.YV=function(a,b){var d=a.k.gi;if(d)for(var c=1;c<d.length;c++)if(d[c].name==b)return!0;return!1};a.j6=function(a){return a&&a.k&&a.k.Yf?!0:!1};a.N3=function(b,d,c){var e=b.Ba;if(e){for(var f=c?d.length/3/2:d.length/3-1,h=new Float32Array(12*f),n=new Float32Array(12*f),l=new Uint16Array(6*f),v=0;v<f;v++){if(c)var r=6*v,m=6*v+3;else r=3*v,m=3*(v+1);var p=d[r],t=d[r+1],r=d[r+2],u=d[m],H=d[m+1],m=d[m+2],y=u-p,q=H-t,O=m-r;h[12*v]=p;h[12*v+1]=t;h[12*v+2]=r;n[12*v]=y;n[12*v+1]=q;n[12*v+2]=O;
h[12*v+3]=u;h[12*v+4]=H;h[12*v+5]=m;n[12*v+3]=-y;n[12*v+4]=-q;n[12*v+5]=-O;h[12*v+6]=p;h[12*v+7]=t;h[12*v+8]=r;n[12*v+6]=-y;n[12*v+7]=-q;n[12*v+8]=-O;h[12*v+9]=u;h[12*v+10]=H;h[12*v+11]=m;n[12*v+9]=y;n[12*v+10]=q;n[12*v+11]=O;l[6*v]=4*v;l[6*v+1]=4*v+1;l[6*v+2]=4*v+2;l[6*v+3]=4*v;l[6*v+4]=4*v+3;l[6*v+5]=4*v+1}c=0;for(var L in e.ld)d=e.ld[L],c+=h.length/3*d.Kc;d={};d["float"]=c;c=e.rc=g(d);a.C_(e,b.Ih,l);b=0;for(L in e.ld)switch(d=e.ld[L],L){case "a_position":S(c,L,h,b);d.offset=b;d.length=h.length;
b+=d.length;break;case "a_direction":S(c,L,n,b);d.offset=b;d.length=n.length;b+=d.length;break;default:d.offset=b,d.length=h.length/3*d.Kc,l=new Float32Array(d.length),S(c,L,l,b),b+=d.length}k(e)}};a.FS=function(a){var b=h();if(a.ke)switch(a.dm){case L.UNSIGNED_SHORT:b.ke=new Uint16Array(a.ke);break;case L.UNSIGNED_INT:b.ke=new Uint32Array(a.ke)}else b.ke=null;for(var d=a.rc,c=[],e=0;e<d.length;e++){var f=d[e].ni,k=d[e].type;c.push({ni:new f.constructor(f),type:k})}b.rc=c;b.dm=a.dm;b.count=a.count;
b.ld=V.R(a.ld);b.Sm=a.Sm;b.zn=a.zn;b.Bn=a.Bn;b.eg=null;b.vv=V.R(a.vv);b.ib=V.R(a.ib);b.hm=a.hm;b.Wf=a.Wf;return b};a.Hf=r;a.reset=function(){L=null};a.I6=g;a.AY=t;a.T5=aa;a.$u=M;a.I4=G;a.pr=T;a.wJ=function(a){switch(T(a)){case "float":return V.Aj;case "short":return V.Hp;case "unsigned_byte":return V.Tx;default:return V.Aj}};a.EV=function(a){switch(T(a)){case "float":return L.FLOAT;case "short":return L.SHORT;case "unsigned_byte":return L.UNSIGNED_BYTE;default:return L.FLOAT}};a.WN=S};b4w.module.__textures=function(a,m){function l(){return{type:0,source:"",Bs:"",width:0,height:0,Bq:1,anisotropic_filtering:"",mj:1024,Rl:!1,Vf:null,nb:0,sb:null,Me:null,mm:!1,Ys:-1,Sa:null,Bx:"",jk:0,Sg:0,va:0,Ub:0,Yj:0,ig:!1,lh:1,wd:null,qs:0,ps:0,lj:-1,ss:!1,Fk:-1,Ws:!1,jE:!1,uj:!1,Vk:!1,repeat:!0,ur:"",Tn:"",Un:"",uB:"",tB:"",tv:!1,em:"",Fz:"",nk:0}}function c(a,b,d){a.Un=b.uuid;a.Tn=b.filepath;a.uB=b.source;a.tB=b.name;a.ur=ga.hj(d+b.filepath);if(a.tv=b.zh)a.em=b.Mp;Z.push(a)}function b(a,b,d){var c=
-1<b.indexOf(".dds"),e=-1<b.indexOf(".pvr");a.tv=c||e;a.em=c?"dds":e?"pvr":"";a.Tn=b;a.ur=d}function x(b,d){var c=l();c.type=b;c.source="NONE";if(b==a.Ht||b==a.Ft||b==a.It||b==a.Gt)c.Me=N.createRenderbuffer();else{var e=N.TEXTURE_2D,f=N.createTexture();N.bindTexture(e,f);N.texParameteri(e,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(e,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);var k=K(c),g=F(c),h=J(c),n=
b==a.ll?null:new Uint8Array([204,204,204,255]);N.texImage2D(e,0,g,1,1,0,k,h,n);pa.zq&&d&&N.texParameterf(e,N.TEXTURE_COMPARE_MODE,N.COMPARE_REF_TO_TEXTURE);N.bindTexture(e,null);c.nb=e;c.sb=f}return c}function q(a){"CANVAS"!=a.source&&ga.q("Wrong texture");var b=a.nb;N.bindTexture(b,a.sb);var d=K(a),c=F(a),e=J(a),f=a.Vf.canvas;N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);N.texImage2D(b,0,c,d,e,f);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);a.Rl&&N.generateMipmap(b);N.bindTexture(b,null);a.width=f.width;a.height=
f.height}function A(a){var b=a.nb;N.bindTexture(b,a.sb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Sa.length?a.ig?p(a,a.Sa,a.width*a.lh,a.height*a.lh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.Sa):N.texImage2D(b,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,a.Sa);N.bindTexture(b,null)}function h(a){var b=a.nb;N.bindTexture(b,a.sb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.ig?p(a,a.wd[a.lj],a.width*a.lh,a.height*a.lh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.wd[a.lj]);N.bindTexture(b,
null)}function z(){xa||(xa=document.createElement("canvas"));return xa}function p(a,b,d,c,e){e||(k(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b));N.bindTexture(N.TEXTURE_2D,null);v.hU(a,d,c,oa,ya)}function n(a,b,d,c){for(var e=0;6>e;e++){var f=c[e],k=z();k.width=d;k.height=d;var g=k.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(g.translate(0,d),g.scale(1,-1)):(g.translate(d,0),g.scale(-1,1));g.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,d,d);N.texImage2D(N["TEXTURE_CUBE_MAP_"+
f[0]],0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,k)}}function k(a){oa||(oa=N.createFramebuffer());N.bindTexture(a,null);ya||(ya=N.createTexture());N.bindTexture(a,ya);N.texParameteri(a,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(a,N.TEXTURE_MIN_FILTER,N.LINEAR)}function u(a,b,d){var c=a.source,f=a.sb,g=a.nb,h=a.em,l=a.Tn,r=1,m=1;N.bindTexture(g,f);a.repeat?(N.texParameteri(g,N.TEXTURE_WRAP_S,N.REPEAT),
N.texParameteri(g,N.TEXTURE_WRAP_T,N.REPEAT)):(N.texParameteri(g,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(g,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE));if(4==b.length){var t=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==c)if(t)N.texImage2D(g,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(h){m=H.EJ(b,h);t=ga.mq(m.width)||ga.mq(m.height);if(m.width>L.Ec||m.height>L.Ec){O.error('Image "'+l+'" has unsupported size: '+m.width+"x"+m.height+". Max available: "+
L.Ec+"x"+L.Ec+".");return}r=m.width;m=m.height;if(t||"pvr"==h)a.ig=!0,k(g),r=y(r*a.lh),m=y(m*a.lh);"dds"==h?H.Z_(N,W.lJ(),b,!0):"pvr"==h&&H.$_(N,W.hJ(),b);a.ig&&(p(a,null,r,m,!0),N.bindTexture(g,f),N.generateMipmap(g));a.width=r;a.height=m;a.Bq=H.nV(b,h)}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.mm?pa.rs?(r=b[0].width,m=b[0].height):(r=b.videoWidth,m=b.videoHeight):(r=b.width,m=b.height);a.width=r;a.height=m;if(r>L.Ec||r>L.Ec)O.warn('Image "'+l+'" has unsupported size: '+r+"x"+m+". Max available: "+
L.Ec+"x"+L.Ec+". Reduced image size will be used."),a.lh=Math.min(L.Ec/r,L.Ec/m),a.ig=!0;a.mm&&(d in ha||(ha[d]={}),ha[d][a.Bx]=a,pa.rs?(a.wd=b,a.qs=b.length,a.Sg=a.ps*a.jk/b.length,b=b[0]):(a.Sa=b,a.Sa.loop=a.uj,a.Sg=b.duration?a.jk/b.duration:V.sd(),Y.SH||(b.playbackRate=V.sd()/a.Sg,Y.UG&&2<b.playbackRate&&(b.playbackRate=2)),e(a)));r=y(a.width*a.lh);m=y(a.height*a.lh);a.ig?(l=z(),f=l.getContext("2d"),l.width=r,l.height=m,f.drawImage(b,0,0,a.width,a.height,0,0,r,m),N.texImage2D(g,0,N.RGBA,N.RGBA,
N.UNSIGNED_BYTE,l)):pa.gc||!ga.mq(a.width)&&!ga.mq(a.height)?N.texImage2D(g,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b):(p(a,b,r,m,!1),a.ig=!0);f=a.sb;a.mm||(N.bindTexture(g,f),N.generateMipmap(g),N.bindTexture(g,null));a.width=r;a.height=m}else if("ENVIRONMENT_MAP"==c)if(r=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],t){for(l=0;6>l;l++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+r[l][0]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){O.error('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}m=b.width/3;m>L.$i?(O.warn('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*L.$i+"x"+2*L.$i+". Reduced image size will be used."),l=y(L.$i/m*m),a.ig=!0):(l=y(m),!pa.gc&&(3*l>L.Ec||2*l>L.Ec)&&(a.ig=!0));if(a.ig||pa.XC)n(b,m,l,r);else{h=
b;f=l;k(N.TEXTURE_2D);N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,h);N.bindTexture(N.TEXTURE_2D,null);for(h=0;6>h;h++)N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,N.RGBA,f,f,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(a.nb,null);N.bindFramebuffer(N.FRAMEBUFFER,oa);for(h=0;6>h;h++)v.gU(a,N.TEXTURE_CUBE_MAP_POSITIVE_X+h,f,m,ya,h);N.bindFramebuffer(N.FRAMEBUFFER,null);N.bindTexture(a.nb,a.sb);N.texParameteri(a.nb,N.TEXTURE_MIN_FILTER,ka[pa.bp]);N.texParameteri(a.nb,N.TEXTURE_MAG_FILTER,
N.LINEAR)}ma.oS()&&(O.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),n(b,m,S.$E,r));a.width=3*l;a.height=2*l;N.generateMipmap(g)}else"NODE_TEX"==c&&(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),N.texImage2D(g,0,N.RGBA,b.width,b.height,0,N.RGBA,N.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);N.bindTexture(g,null)}function e(a){a.Sa.w7=function(){A(a)}}function y(a){return ga.mq(a)?ga.W(Math.pow(2,parseInt(a).toString(2).length),2,L.Ec):a}function K(b){var d;
switch(b.type){case a.wh:d=N.RGBA;break;case a.Jt:d=N.RGB;break;case a.Kp:d=N.RGBA;break;case a.Lp:d=N.RGB;break;case a.ll:d=N.DEPTH_COMPONENT;break;default:ga.q("Wrong texture type")}return d}function F(b){var d;switch(b.type){case a.wh:d=pa.gc?N.RGBA8:N.RGBA;break;case a.Jt:d=pa.gc?N.RGB8:N.RGB;break;case a.Kp:d=pa.gc?N.RGBA8:N.RGBA;break;case a.Lp:d=pa.gc?N.RGB8:N.RGB;break;case a.ll:d=pa.gc?pa.oz?N.DEPTH_COMPONENT16:N.DEPTH_COMPONENT24:N.DEPTH_COMPONENT;break;default:ga.q("Wrong texture type")}return d}
function J(b){var d;switch(b.type){case a.wh:d=N.UNSIGNED_BYTE;break;case a.Jt:d=N.UNSIGNED_BYTE;break;case a.Kp:d=N.FLOAT;break;case a.Lp:d=N.FLOAT;break;case a.ll:d=pa.oz?N.UNSIGNED_SHORT:N.UNSIGNED_INT;break;default:ga.q("Wrong texture type")}return d}function D(a){return a&&a.Me?!0:!1}function R(a){a.Sa?a.Sa.play():a.wd&&(a.ss=!0);a.Ws=!1}function E(a){a.Sa?a.Sa.pause():a.wd&&(a.ss=!1);a.Ws=!0}function I(a){a.Sa?a.Sa.currentTime=a.Ub/a.Sg:a.wd&&(a.lj=P(a,a.Ub),h(a))}function B(a){return a.Sa?
!a.Sa.paused:a.wd?a.ss:!1}function P(a,b){return Math.round(b*a.qs/a.jk)}function d(a,b){if(ba.Ra(a))return f(a,b);for(var d=a.Uv,c=0;c<d.length;c++){var e=f(d[c],b);if(e)return e}return null}function f(a,b){var d=a.I;if(d.length)for(var d=d[0].V,c=0;c<d.length;c++){var e=d[c];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.ya.length;f++)if(e.Gg[f]==b)return e.ya[f]}return null}function r(a,b,d){a=a.I;if(a.length){a=a[0].V;for(var c=0;c<a.length;c++){var e=a[c];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++)e.Gg[f]==
b&&(M(e.ya[f]),e.ya[f]=d,G(d))}}}function g(a,b){var d=a.I;if(d.length)for(var d=d[0].V,c=0;c<d.length;c++){var e=d[c];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++){var k=e.ya[f],g=e.Gg[f];-1==b.indexOf(g)&&"NODE_TEX"!=k.source&&b.push(g)}}}function Q(a,b,d){var c=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),k=t(c,f,!0),g=aa(c,f,!0);if(k&&g)if("CONSTANT"==a)d.push.apply(d,k.color);else{var h=d,n=k,l=g;n==l?h.push.apply(h,n.color):(h.push(ea.Lv(l.color[0],l.position,n.color[0],
n.position,f)),h.push(ea.Lv(l.color[1],l.position,n.color[1],n.position,f)),h.push(ea.Lv(l.color[2],l.position,n.color[2],n.position,f)),h.push(ea.Lv(l.color[3],l.position,n.color[3],n.position,f)))}g&&!k&&d.push.apply(d,g.color);k&&!g&&d.push.apply(d,k.color)}}function t(a,b,d){for(var c=null,e=0;e<a.length;e++){var f=d?b-a[e].position:b-a[e][1][0];0<=f&&(c?f<=(d?b-c.position:b-a[e][1][0])&&(c=a[e]):c=a[e])}return c}function aa(a,b,d){for(var c=null,e=0;e<a.length;e++){var f=d?a[e].position-b:a[e][1][0]-
b;0<=f&&(c?f<=(d?c.position-b:c[1][0]-b)&&(c=a[e]):c=a[e])}return c}function M(a){0<a.nk&&--a.nk;0>=a.nk&&(a.sb&&N.deleteTexture(a.sb),a=Z.indexOf(a),-1!=a&&Z.splice(a,1))}function G(a){a.nk+=1}function T(a,b){for(var d=0;d<Z.length;d++){var c=Z[d];if(c.ur==a&&c.type==b.type&&c.repeat==b.repeat&&c.anisotropic_filtering==b.anisotropic_filtering&&c.Vk==b.Vk)return c}return null}var S=m("__compat"),X=m("__config"),H=m("__texcomp"),ma=m("__debug"),W=m("__extensions"),O=m("__print"),V=m("__time"),ga=m("__util"),
v=m("__renderer"),ba=m("__obj_util"),ea=m("__curve"),ca=m("__vec3"),na=m("__scenes"),pa=X.B,L=X.Fi,Y=X.X,xa=null,ya=null,oa=null;a.ve=0;a.K=0;a.qQ=0;a.oQ=0;a.pQ=0;a.nQ=0;a.wh=10;a.Jt=20;a.Kp=30;a.Lp=40;a.ll=50;a.Ht=60;a.Ft=70;a.It=80;a.Gt=90;a.FE=128;a.qO=128;a.iF=128;var Z=[],fa={},ha={},N=null,ka;a.Lf=function(b){ka=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.ve=b.NEAREST;a.K=b.LINEAR;a.qQ=b.NEAREST_MIPMAP_NEAREST;a.oQ=b.LINEAR_MIPMAP_NEAREST;
a.pQ=b.NEAREST_MIPMAP_LINEAR;a.nQ=b.LINEAR_MIPMAP_LINEAR;N=b};a.E4=function(a,b){return b in fa&&a in fa[b]?fa[b][a].Vf:null};a.M9=function(a,b){return b in fa&&a in fa[b]?(q(fa[b][a]),!0):!1};a.RF=c;a.Jl=x;a.kH=function(b){var d=N.createTexture(),c=N.TEXTURE_CUBE_MAP;N.bindTexture(c,d);N.texParameteri(c,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(c,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(c,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(c,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
f=0;6>f;f++)N.texImage2D(N[e[f]],0,N.RGBA,b,b,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(c,null);c=l();c.type=a.wh;c.source="NONE";c.width=3*b;c.height=2*b;c.Bq=1;c.sb=d;c.nb=N.TEXTURE_CUBE_MAP;return c};a.fD=function(a,b,d){if(!D(a)){var c=a.nb;N.bindTexture(c,a.sb);b&&N.texParameteri(c,N.TEXTURE_MIN_FILTER,b);d&&N.texParameteri(c,N.TEXTURE_MAG_FILTER,d);N.bindTexture(c,null)}};a.T4=function(b){if(D(b))return{min:a.ve,eX:a.ve};var d=b.nb;N.bindTexture(d,b.sb);b=N.getTexParameter(d,N.TEXTURE_MIN_FILTER);
var c=N.getTexParameter(d,N.TEXTURE_MAG_FILTER);N.bindTexture(d,null);return{min:b,eX:c}};a.resize=function(b,d,c){d=Math.max(d,pa.Tq?2:1);c=Math.max(c,pa.Tq?2:1);if(b.width!=d||b.height!=c){switch(b.type){case a.Ht:N.bindRenderbuffer(N.RENDERBUFFER,b.Me);N.renderbufferStorage(N.RENDERBUFFER,N.RGB565,d,c);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.Ft:N.bindRenderbuffer(N.RENDERBUFFER,b.Me);N.renderbufferStorage(N.RENDERBUFFER,N.DEPTH_COMPONENT16,d,c);N.bindRenderbuffer(N.RENDERBUFFER,null);
break;case a.It:N.bindRenderbuffer(N.RENDERBUFFER,b.Me);N.renderbufferStorageMultisample(N.RENDERBUFFER,pa.Fc,N.RGBA8,d,c);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.Gt:N.bindRenderbuffer(N.RENDERBUFFER,b.Me);N.renderbufferStorageMultisample(N.RENDERBUFFER,pa.Fc,N.DEPTH_COMPONENT24,d,c);N.bindRenderbuffer(N.RENDERBUFFER,null);break;default:var e=b.nb;N.bindTexture(e,b.sb);var f=K(b),k=F(b),g=J(b);N.texImage2D(e,0,k,d,c,0,f,g,null);N.bindTexture(e,null)}d>L.Ec||c>L.Ec?ga.q('Slink texture "'+
b.type+'" has unsupported size: '+d+"x"+c+". Max available: "+L.Ec+"x"+L.Ec+"."):(b.width=d,b.height=c)}};a.MT=function(b,d,e,f,k){var g=b.type,h=b.image,n=l();n.Fz=b.uuid;n.type=a.wh;n.width=1;n.height=1;var v=b.b4w_anisotropic_filtering;"DEFAULT"===v&&(v=d);"OFF"!==v&&pa.anisotropic_filtering&&W.zI()&&(v=parseFloat(v.split("x")[0]),n.anisotropic_filtering=v);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)n.repeat=!1;if(h&&("IMAGE"==g&&"MOVIE"==h.source&&(n.mm=!0,n.Bx=b.name,n.va=b.frame_start,n.Ub=
b.frame_offset,n.Yj=b.frame_duration,n.jE=b.use_auto_refresh,n.uj=b.use_cyclic,n.jk=b.movie_length,n.Vk=b.b4w_nla_video,0!=n.Ub&&O.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),d=ga.hj(k+h.filepath),d=T(d,n))){b.s=d;return}d=new Uint8Array([204,204,204,255]);switch(g){case "IMAGE":var v=N.createTexture(),r=N.TEXTURE_2D;N.bindTexture(r,v);N.texImage2D(r,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);break;case "NONE":v=N.createTexture();
r=N.TEXTURE_2D;N.bindTexture(r,v);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=ga.Dd("name",b.b4w_source_id,e)))n.mj=b.b4w_source_size,e.Tf=e.Tf||[],e.Tf.push(n),G(n),N.texImage2D(r,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);else return;break;case "ENVIRONMENT_MAP":v=N.createTexture();r=N.TEXTURE_CUBE_MAP;N.bindTexture(r,v);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var m=0;6>m;m++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+
e[m]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);break;case "BLEND":return;default:O.error('texture "'+b.name+'" has unsupported type "'+g+'"');return}n.sb=v;n.nb=r;n.anisotropic_filtering&&N.texParameterf(n.nb,W.zI().TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic_filtering);"NONE"==g&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==g&&"MOVIE"==h.source?N.texParameteri(r,N.TEXTURE_MIN_FILTER,N.LINEAR):N.texParameteri(r,N.TEXTURE_MIN_FILTER,ka[pa.bp]);N.texParameteri(r,N.TEXTURE_MAG_FILTER,
N.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==g?(g=b.b4w_source_id,e=b.b4w_source_size,n.Rl=b.b4w_enable_canvas_mipmapping,n.Bs=g,n.source="CANVAS",d=document.createElement("canvas"),d.width=e,d.height=e,n.Vf=d.getContext("2d"),f in fa||(fa[f]={}),fa[f][g]=n,q(n)):"SCENE"==b.b4w_source_type&&"NONE"==g?(n.Bs=b.b4w_source_id,n.source="SCENE"):(n.source=g,N.generateMipmap(r),N.bindTexture(r,null));h&&c(n,h,k);b.s=n};a.KN=A;a.JN=h;a.Ls=u;a.UR=y;a.bo=function(a){return a&&(a.sb||a.Me)?!0:!1};a.Zn=D;a.M6=
function(b){return b.type==a.Kp||b.type==a.Lp?!0:!1};a.PV=function(b){var d=0;switch(b.type){case a.wh:case a.Jt:d=4;break;case a.Kp:case a.Lp:d=16;break;case a.ll:d=3;break;case a.Ht:case a.Ft:d=2;break;case a.It:d=4*pa.Fc;break;case a.Gt:d=3*pa.Fc}return d};a.ua=function(){if(!pa.rs)for(var a in ha)for(var b in ha[a])ha[a][b].Sa.pause(),ha[a][b].Sa.src="",ha[a][b].Sa.load();Z.length=0;fa={};ha={}};a.pause=function(){for(var a in ha)for(var b in ha[a]){var d=ha[a][b];B(d)&&E(d)}};a.reset=function(){for(var a in ha)for(var b in ha[a])I(ha[a][b])};
a.play=function(a){for(var b in ha)for(var d in ha[b]){var c=ha[b][d];a&&!c.Ws||R(c)}};a.b6=function(a,b){return b in ha&&a in ha[b]?ha[b][a]:null};a.U9=function(a){return a.Vk};a.fL=R;a.xC=E;a.DL=I;a.NY=function(a,b){if(void 0 in ha&&a in ha[void 0]){var d=ha[void 0][a];d.Sa?d.Sa.currentTime=b/d.Sg:d.wd&&(d.lj=b,h(d))}};a.fO=B;a.gO=function(a){return a.Sa||a.wd?a.Sa?2<=a.Sa.readyState:!0:0};a.cO=function(a){return a.Sa||a.wd?a.Sa?Math.round(a.Sa.currentTime*a.Sg):a.lj:0};a.eO=function(a){return a.Sa||
a.wd?a.Sa?a.Ub:P(a,a.Ub):0};a.n0=function(a){if(!a.Sa&&!a.wd)return 0;var b=Math.min(a.Yj,a.jk-a.Ub);return a.Sa?a.Ub+b:P(a,a.Ub+b)};a.Gw=function(a,b){return Math.round(b*a.ps*(V.sd()/a.Sg))};a.dO=function(a){return Math.min(a.Yj,a.jk-a.Ub)};a.m0=P;a.F4=function(a,b){var c=d(a,b);return c&&"CANVAS"==c.source?c.Vf:null};a.N9=function(a,b){var c=d(a,b);return c&&"CANVAS"==c.source?(q(c),!0):!1};a.N5=d;a.O5=function(a){var b=[];if(ba.Ra(a))g(a,b);else{a=a.Uv;for(var d=0;d<a.length;d++)g(a[d],b)}return b};
a.sZ=function(a){for(var b={},d=0;d<a.length;d++){for(var c=a[d].ya,e=a[d].Ld,f=[],k=[],g=0;g<c.length;g++){var h=c[g],n=e[g];if("CANVAS"==h.source)if(n in b)h=b[n];else{var v=c[g],h=l();h.source="CANVAS";h.width=v.width;h.height=v.height;h.Rl=v.Rl;h.type=v.type;v=document.createElement("canvas");v.width=h.width;v.height=h.height;h.Vf=v.getContext("2d");h.nb=N.TEXTURE_2D;h.sb=N.createTexture();N.bindTexture(N.TEXTURE_2D,h.sb);h.Rl?N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,ka[pa.bp]):N.texParameteri(N.TEXTURE_2D,
N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR);N.bindTexture(N.TEXTURE_2D,null);v=h;v.Vf.drawImage(c[g].Vf.canvas,0,0);q(v);b[n]=h}f.push(h);k.push(n)}a[d].ya=f}};a.wU=function(a,b){for(var d=[],c=0;c<a.length;c++)Q(a[c].data.value.color_ramp,b,d);return new Uint8Array(d.map(function(a){return ga.W(255*a,0,255)}))};a.PR=Q;a.AU=function(a,b){for(var d=new Float32Array(3),c=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var k=a[f].data.value,g=[],h=k.curve_mapping.curves_data,
n=k.curve_mapping.curve_extend,l=k.curve_mapping.curves_handle_types,k=0;k<h.length;k++){for(var v=n[k],r=h[k],m=[],p=l[k],u=0;u<r.length;u++)m.push([new Float32Array(3),new Float32Array(r[u].concat(0)),new Float32Array(3)]);ea.Kz(m[0],null,m[1],p[0],p[0]);for(u=1;u<m.length-1;u++)ea.Kz(m[u],m[u-1],m[u+1],p[u],p[u]);ea.Kz(m[m.length-1],m[m.length-2],null,p[m.length-1],p[m.length-1]);if(2<m.length){if("AUTO"==p[0]){ca.subtract(m[0][2],m[0][1],d);u=ca.length(d);ca.copy(m[1][0],c);c[0]<m[0][1][0]&&(c[0]=
m[0][1][0]);ca.subtract(c,m[0][1],c);var H=ca.length(c);1E-8<H&&(ca.scale(c,u/H,c),ca.add(m[0][1],c,m[0][2]),ca.subtract(m[0][1],c,m[0][0]))}r=m.length-1;"AUTO"==p[0]&&(ca.subtract(m[r][0],m[r][1],d),u=ca.length(d),ca.copy(m[r-1][2],c),c[0]>m[r][1][0]&&(c[0]=m[r][1][0]),ca.subtract(c,m[r][1],c),H=ca.length(c),1E-8<H&&(ca.scale(c,u/H,c),ca.add(m[r][1],c,m[r][0]),ca.subtract(m[r][1],c,m[r][2])))}for(r=0;r<m.length-1;r++)ea.JS(m[r][1],m[r][2],m[r+1][0],m[r+1][1]);r=[];3>=h.length?(u=Math.round(-b/2),
p=Math.round(b/2)):(u=0,p=b);for(;u<p;u++){var H=u/(p-1),y=t(m,H,!1),q=aa(m,H,!1);y&&q?r.push(ea.nG(H,y[1],y[2],q[0],q[1],.001)):q&&!y?"EXTRAPOLATED"==v?(H=q[1][0]==q[2][0]?q[1][1]:ea.tK(H,q[1],q[2]),r.push(H)):r.push(q[1][1]):y&&!q&&("EXTRAPOLATED"==v?(H=y[0][0]==y[1][0]?y[1][1]:ea.tK(H,y[0],y[1]),r.push(H)):r.push(y[1][1]))}g.push(r)}e.push(g)}d=[];for(u=0;u<e.length;u++)for(g=e[u],k=0;k<g[0].length;k++)3>=g.length?(c=ga.W(127.5*(g[0][k]+1),0,255),f=ga.W(127.5*(g[1][k]+1),0,255),h=ga.W(127.5*(g[2][k]+
1),0,255),r=255):(c=ga.W(255*g[0][k],0,255),f=ga.W(255*g[1][k],0,255),h=ga.W(255*g[2][k],0,255),r=ga.W(255*g[3][k],0,255)),d.push(c,f,h,r);return new Uint8Array(d)};a.jH=function(b,d){var c=x(a.wh,!1);c.source="NODE_TEX";c.repeat=!1;u(c,{width:d,height:b.length/(4*d),data:b});return c};a.Q2=function(a,d,c,e,f){var k=ga.hj(f);if("WORLD"!=a.type){var g=T(k,d);if(!g){g=l();g.type=d.type;g.source=d.source;g.Bs=d.Bs;g.width=d.width;g.height=d.height;g.Bq=d.Bq;g.mj=d.mj;g.Rl=d.Rl;g.Vf=d.Vf;g.nb=d.nb;g.sb=
d.sb;g.Me=d.Me;g.mm=d.mm;g.Ys=d.Ys;g.Sa=d.Sa;g.Bx=d.Bx;g.jk=d.jk;g.Sg=d.Sg;g.va=d.va;g.Ub=d.Ub;g.Yj=d.Yj;g.ig=d.ig;g.lh=d.lh;g.wd=d.wd;g.qs=d.qs;g.ps=d.ps;g.lj=d.lj;g.ss=d.ss;g.Fk=d.Fk;g.Ws=d.Ws;g.jE=d.jE;g.uj=d.uj;g.Vk=d.Vk;g.repeat=d.repeat;g.Tn=d.Tn;g.ur=d.ur;g.Un=d.Un;g.uB=d.uB;g.tB=d.tB;g.tv=d.tv;g.em=d.em;var h=g;N.bindTexture(d.nb,d.sb);var n=N.getTexParameter(d.nb,N.TEXTURE_MAG_FILTER),v=N.getTexParameter(d.nb,N.TEXTURE_MIN_FILTER),m=N.getTexParameter(d.nb,N.TEXTURE_WRAP_S);d=N.getTexParameter(d.nb,
N.TEXTURE_WRAP_T);h.sb=N.createTexture();N.bindTexture(h.nb,h.sb);N.texParameteri(h.nb,N.TEXTURE_MAG_FILTER,n);N.texParameteri(h.nb,N.TEXTURE_MIN_FILTER,v);N.texParameteri(h.nb,N.TEXTURE_WRAP_S,m);N.texParameteri(h.nb,N.TEXTURE_WRAP_T,d);N.bindTexture(h.nb,null);b(g,f,k);Z.push(g);u(g,e,0)}e=g;if(ba.Ra(a))r(a,c,e);else for(a=a.Uv,f=0;f<a.length;f++)r(a[f],c,e)}else g=d,b(g,f),u(g,e,0),na.V_(a)};a.OC=M;a.uv=G;a.he=function(a){return a.texture.s};a.rY=function(){N=null};a.XI=function(){return Z}};b4w.module.__texcomp=function(a,m){function l(a,b,c,e){var l=new Int32Array(c,0,31),m,F,A,D,R,E;if(542327876!=l[0])return q.error("Invalid magic number in DDS header"),0;if(!l[20]&4)return q.error("Unsupported format, must contain a FourCC code"),0;m=l[21];switch(m){case h:F=8;A=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case z:F=16;A=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case p:F=16;A=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return q.error("Unsupported FourCC code:",x(m)),null}E=
1;l[2]&131072&&!1!==e&&(E=Math.max(1,l[7]));D=l[4];R=l[3];l=l[1]+4;if(b)for(m=0;m<E;++m)e=Math.max(4,D)/4*Math.max(4,R)/4*F,b=new Uint8Array(c,l,e),a.compressedTexImage2D(a.TEXTURE_2D,m,A,D,R,0,b),l+=e,D=Math.max(.5*D,1),R=Math.max(.5*R,1);else if(m==h){Math.max(4,D);Math.max(4,R);c=b=new Uint16Array(c);F=l/2;A=D;var I=R,l=new Uint16Array(4);b=new Uint16Array(A*I);for(var B=0,P=0,d=P=B=m=0,f=0,r=0,g=0,Q=A/4,I=I/4,t=0;t<I;t++)for(var aa=0;aa<Q;aa++)m=F+4*(t*Q+aa),l[0]=c[m],l[1]=c[m+1],B=l[0]&31,P=
l[0]&2016,d=l[0]&63488,f=l[1]&31,r=l[1]&2016,g=l[1]&63488,l[2]=5*B+3*f>>3|5*P+3*r>>3&2016|5*d+3*g>>3&63488,l[3]=5*f+3*B>>3|5*r+3*P>>3&2016|5*g+3*d>>3&63488,B=c[m+2],P=4*t*A+4*aa,b[P]=l[B&3],b[P+1]=l[B>>2&3],b[P+2]=l[B>>4&3],b[P+3]=l[B>>6&3],P+=A,b[P]=l[B>>8&3],b[P+1]=l[B>>10&3],b[P+2]=l[B>>12&3],b[P+3]=l[B>>14],B=c[m+3],P+=A,b[P]=l[B&3],b[P+1]=l[B>>2&3],b[P+2]=l[B>>4&3],b[P+3]=l[B>>6&3],P+=A,b[P]=l[B>>8&3],b[P+1]=l[B>>10&3],b[P+2]=l[B>>12&3],b[P+3]=l[B>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,R,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);e&&a.generateMipmap(a.TEXTURE_2D)}else return q.error("No manual decoder for",x(m),"and no native support"),0;return E}function c(a,b,c,e,h){var m=new XMLHttpRequest;m.open("GET",c,!0);m.responseType="arraybuffer";m.onload=function(){if(200==m.status){a.bindTexture(a.TEXTURE_2D,e);var c=l(a,b,m.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}h&&h(e)};m.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function x(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var q=m("__print"),A=m("__util"),h=b("DXT1"),z=b("DXT3"),p=b("DXT5");a.Z_=l;a.$_=function(a,b,c){var e=new Uint32Array(c,0,13);if(55727696==e[0]){var h=e[7],l=e[6],m=e[11],p=52+e[12];switch(e[2]){case 0:var q=2,z=1;break;case 1:q=2;z=3;break;case 2:q=4;z=0;break;case 3:q=4;z=2;break;default:A.q("Unsupported PVR V3 format.")}}else if(559044176==
e[11]){h=e[2];l=e[1];m=e[3];p=e[0];m++;var x=e[4]&255,e=0<e[10];25==x?(q=4,z=e?2:0):24==x?(q=2,z=e?3:1):A.q("Unsupported PVR V2 format.")}else A.q("Unsupported PVR version.");x=2==q?8:4;e=4;switch(z){case 0:var I=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:I=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:I=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:I=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=x*e*q/8;for(q=0;q<m;q++){var z=Math.max(h>>q,1),B=Math.max(l>>q,1),P=z/x,d=B/e;2>P&&(P=2);2>d&&(d=2);P=
P*d*b;d=new Uint8Array(c,p,P);a.compressedTexImage2D(a.TEXTURE_2D,q,I,z,B,0,d);p+=P}};a.EJ=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var e=c[7],c=c[6];else e=c[2],c=c[1];return{width:e,height:c}}};a.nV=function(a,b){var c=1;if("dds"==b){var e=new Int32Array(a,0,31),l=e[21];switch(l){case h:c=6;break;case z:case p:c=4;break;default:q.error("Unsupported FourCC code:",x(l))}}else if("pvr"==b)if(e=
new Uint32Array(a,0,13),55727696==e[0])switch(e[2]){case 0:c=12;break;case 1:c=16;break;case 2:c=6;break;case 3:c=8}else l=e[4]&255,e=0<e[10],25==l?c=e?8:6:24==l&&(c=e?16:12);return c};a.c7=function(a,b,h,e){var l=a.createTexture();c(a,b,h,l,e);return l}};b4w.module.__time=function(a,m){function l(){return-1!==c.ql.Lu?c.ql.Lu:p}var c=m("__config");m("__print");var b=0,x=0,q=[],A=0,h=0,z=[],p=-1;a.qM=function(a){b=a;x=performance.now();for(a=0;a<q.length;a++){var c=q[a];b>c.LA&&(q.splice(a,1),a--,c.callback())}for(a=0;a<z.length;a++){var c=z[a],h=1-(c.LA-b)/c.duration,h=Math.min(h,1);c.callback(c.from+h*(c.to-c.from));1==h&&(z.splice(a,1),a--)}};a.cm=function(){return b};a.Sw=function(a,c){var h;A++;h=A;q.push({id:h,callback:a,LA:b+(performance.now()-
x+c)/1E3});return h};a.un=function(a){for(var b=0;b<q.length;b++)if(q[b].id==a){q.splice(b,1);break}};a.tn=function(a){for(var b=z.length;b--;)if(z[b].id==a){z.splice(b,1);break}};a.Fj=function(a,c,l,e){l/=1E3;var m;h++;m=h;z.push({id:m,callback:e,from:a,to:c,LA:b+l,duration:l});e(a);return m};a.reset=function(){x=b=0;q.length=0;h=A=z.length=0};a.sd=l;a.OY=function(a){p=a};a.kr=function(a){return a*l()}};b4w.module.__curve=function(a,m){function l(a,b,c,k,h){var e=k.length;h||(h=new Float32Array(e));for(var l=e+a,m=new Float32Array(l),q=1;q<=l-1;q++)m[q-1]=b>=c[q-1]&&b<c[q+1-1]?1:0;for(var x=2;x<=a;x++)for(q=1;q<=l-x;q++)m[q-1]=(0!=m[q-1]?(b-c[q-1])*m[q-1]/(c[q+x-1-1]-c[q-1]):0)+(0!=m[q+1-1]?(c[q+x-1]-b)*m[q+1-1]/(c[q+x-1]-c[q+1-1]):0);b==c[l-1]&&(m[e-1]=1);a=0;for(q=1;q<=e;q++)a+=m[q-1]*k[q-1];for(q=1;q<=e;q++)h[q-1]=0!=a?m[q-1]*k[q-1]/a:0;return h}function c(a){a=a.Jv;return a[a.length-1]}function b(a){a=
a.FH;return a[a.length-1]}function x(a,b,c,k,h,e,l,m){var F=a+(b-a)/2,A=q(F,k,h,e,l)-c;m=m?m:.01;return Math.abs(A)<m?F:0<A?x(a,F,c,k,h,e,l,m):x(F,b,c,k,h,e,l,m)}function q(a,b,c,k,h){var e=1-a;return b*e*e*e+3*c*e*e*a+3*k*e*a*a+h*a*a*a}m("__print");var A=m("__util"),h=m("__vec3");a.mT=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var k=a.order_u;b.pk=k;a=a.points;var h=a.length/5,e=[],m=h+k,h=h+2;e[0]=0;for(var q=2;q<=m;q++)e[q-1]=q>k&&q<h?e[q-
2]+1:e[q-2];b.Jv=e;"2D"==c.dimensions?b.ek=!1:"3D"==c.dimensions?b.ek=!0:A.q("Wrong curve dimensions");k=[];e=[];for(c=0;c<a.length;c+=5)k.push(a[c]),k.push(a[c+1]),k.push(a[c+2]),b.ek&&k.push(a[c+3]),e.push(a[c+4]);b.eA=k;b.uE=e;a=[];for(var c=b.eA,k=b.ek?4:3,e=b.uE,m=b.Jv,h=b.pk,q=c.length/k,x=q+h,J=0,D=m[x-1]/999,R=0;1E3>R;R++){5E-6>m[x-1]-J&&(J=m[x-1]);for(var E=l(h,J,m,e),I=0;I<k;I++)for(var B=a[k*R+I]=0;B<q;B++)a[k*R+I]+=E[B]*c[k*B+I];J+=D}k=b.ek?4:3;e=new Float32Array(1E3);e[0]=0;for(c=1;1E3>
c;c+=1)m=a[(c-1)*k],h=a[(c-1)*k+1],q=a[(c-1)*k+2],x=a[c*k],J=a[c*k+1],D=a[c*k+2],e[c]=e[c-1]+Math.sqrt((x-m)*(x-m)+(J-h)*(J-h)+(D-q)*(D-q));b.FH=e;return b};a.NZ=function(a,b,h){h||(h=[]);var k=b,m=Math.max(k,0);b=m=Math.min(k,c(a));var k=a.eA,m=a.ek?4:3,e=a.uE,q=a.Jv,x=a.pk;a=k.length/m;var F=a+x;5E-6>q[F-1]-b&&(b=q[F-1]);F=new Float32Array(a);l(x,b,q,e,F);for(b=0;b<m;b++)for(e=h[b]=0;e<a;e++)h[b]+=F[e]*k[m*e+b]};a.KZ=function(a,b,c){c||(c=[]);var k=a.eA,h=a.ek?4:3,e=a.uE,l=a.Jv,m=a.pk;a=k.length/
h;var q=a+m;5E-6>l[q-1]-b&&(b=l[q-1]);var q=new Float32Array(a),x=b;b=q;var D=e.length;b||(b=new Float32Array(D));var A=new Float32Array(D),E=new Float32Array(D),I=A,B=E;I||(I=new Float32Array(D));B||(B=new Float32Array(D));for(var P=D+m,d=new Float32Array(P),f=new Float32Array(P),r=1;r<=P-1;r++)d[r-1]=x>=l[r-1]&&x<l[r+1-1]?1:0;x==l[P-1]&&(d[D-1]=1);for(var g=2;g<=m;g++)for(r=1;r<=P-g;r++){var Q=0!=d[r-1]?d[r-1]/(l[r+g-1-1]-l[r-1]):0,t=0!=d[r+1-1]?-d[r+1-1]/(l[r+g-1]-l[r+1-1]):0,aa=0!=f[r-1]?(x-l[r-
1])*f[r-1]/(l[r+g-1-1]-l[r-1]):0,M=0!=f[r+1-1]?(l[r+g-1]-x)*f[r+1-1]/(l[r+g-1]-l[r+1-1]):0;d[r-1]=(0!=d[r-1]?(x-l[r-1])*d[r-1]/(l[r+g-1-1]-l[r-1]):0)+(0!=d[r+1-1]?(l[r+g-1]-x)*d[r+1-1]/(l[r+g-1]-l[r+1-1]):0);f[r-1]=Q+t+aa+M}for(r=1;r<=D;r++)I[r-1]=d[r-1],B[r-1]=f[r-1];l=0;for(m=1;m<=D;m++)l+=A[m-1]*e[m-1];x=0;for(m=1;m<=D;m++)x+=E[m-1]*e[m-1];for(m=1;m<=D;m++)b[m-1]=0!=l?E[m-1]*e[m-1]/l+A[m-1]*e[m-1]*x/(l*l):0;for(e=0;e<h;e++)for(l=c[e]=0;l<a;l++)c[e]+=q[l]*k[h*l+e]};a.f9=c;a.MZ=b;a.LZ=function(a,
h){if(0>=h)return 0;var n=c(a);if(h>=b(a))return n;var k=a.FH,l=A.Xt(k,h,0,k.length-1);return n*(l+(h-k[l])/(k[l+1]-k[l]))/1E3};a.Lv=function(a,b,c,k,h){return c+(h-k)*(a-c)/(b-k)};a.tK=function(a,b,c){var k=b[0];b=b[1];c=(c[1]-b)/(c[0]-k);return c*a+(b-c*k)};a.nG=function(a,b,c,k,h,e){return q(x(0,1,a,b[0],c[0],k[0],h[0],e),b[1],c[1],k[1],h[1])};a.Kz=function(a,b,c,k,l){var e=new Float32Array(3),m=new Float32Array(3),q=new Float32Array(3),x=new Float32Array(3),A=new Float32Array(3),D=new Float32Array(3);
h.copy(a[1],m);null==b?(h.copy(c[1],q),e[0]=2*m[0]-q[0],e[1]=2*m[1]-q[1]):h.copy(b[1],e);null==c?(h.copy(b[1],e),q[0]=2*m[0]-e[0],q[1]=2*m[1]-e[1]):h.copy(c[1],q);h.subtract(m,e,x);h.subtract(q,m,A);b=h.length(x);c=h.length(A);0==b&&(b=1);0==c&&(c=1);if("AUTO"==k||"AUTO"==l)D[0]=A[0]/c+x[0]/b,D[1]=A[1]/c+x[1]/b,e=2.5614*h.length(D),0!=e&&("AUTO"==k&&h.scaleAndAdd(m,D,-(b/e),a[0]),"AUTO"==l&&h.scaleAndAdd(m,D,c/e,a[2]));"VECTOR"==k&&h.scaleAndAdd(m,x,-1/3,a[0]);"VECTOR"==l&&h.scaleAndAdd(m,A,1/3,a[2])};
a.JS=function(a,b,c,k){var h=[],e=[],l,m,q;h[0]=a[0]-b[0];h[1]=a[1]-b[1];e[0]=k[0]-c[0];e[1]=k[1]-c[1];q=k[0]-a[0];l=Math.abs(h[0]);m=Math.abs(e[0]);0!=l+m&&l+m>q&&(l=q/(l+m),b[0]=a[0]-l*h[0],b[1]=a[1]-l*h[1],c[0]=k[0]-l*e[0],c[1]=k[1]-l*e[1])}};b4w.module.__scenes=function(a,m){function l(a){for(var b=0;b<a.length;b++){var d=a[b];if(!d.Tf||!d.Tf.length)return d}return null}function c(){wb||Ia.q("No active scene available");return wb}function b(a,b,d){if(!za.xu||!x(a,b,d))return null;d=a.b4w_shadow_settings;var c={};d.csm_resolution>hb.Ec?(c.csm_resolution=hb.Ec,Fa.error("Shadow map texture has unsupported size. Changed to "+hb.Ec+".")):c.csm_resolution=d.csm_resolution;za.GR=d.blur_samples;c.xZ=d.soft_shadows;a=Aa.Xu(b,za.ssao&&a.b4w_enable_ssao);
c.self_shadow_polygon_offset=d.self_shadow_polygon_offset;c.self_shadow_normal_offset=d.self_shadow_normal_offset;c.enable_csm=d.b4w_enable_csm&&1==a.length;c.Zg=[];c.QM=[];c.qq=[];c.pq=[];for(b=0;b<a.length;b++)c.Zg.push(a[b].ub.type),c.QM.push(a[b].ub.Om),c.qq.push(a[b].ub.qq),c.pq.push(a[b].ub.pq),"SPOT"!=c.Zg[b]&&"POINT"!=c.Zg[b]||!c.enable_csm||(Fa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),c.enable_csm=!1);c.enable_csm?(c.csm_num=d.csm_num,c.csm_first_cascade_border=
d.csm_first_cascade_border,c.first_cascade_blur_radius=d.first_cascade_blur_radius,c.csm_last_cascade_border=d.csm_last_cascade_border,c.last_cascade_blur_radius=d.last_cascade_blur_radius,c.fade_last_cascade=d.fade_last_cascade,c.blend_between_cascades=d.blend_between_cascades):(c.csm_num=1,c.csm_first_cascade_border=d.csm_first_cascade_border,c.first_cascade_blur_radius=d.first_cascade_blur_radius,c.csm_last_cascade_border=d.csm_last_cascade_border,c.last_cascade_blur_radius=d.last_cascade_blur_radius,
c.fade_last_cascade=!1,c.blend_between_cascades=!1);return c}function x(a,b,d){if(0!=b.length&&za.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var c=!1,e=!1;a=za.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<d.length;b++){var f=d[b];f.b4w_shadow_cast&&(c=!0);f.b4w_shadow_receive&&(e=!0);if((a||c)&&e)return!0}return!1}function q(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].ub.type)return!0;return!1}function A(a){if(!za.Hk)return!1;a=na(a);
for(var b=0;b<a.length;b++){var d=a[b];if(d.b4w_water&&d.b4w_water_shore_smoothing)return!0}return!1}function h(a){for(var b=0;b<a.length;b++)for(var d=a[b].particle_systems,c=0;c<d.length;c++)if(Aa.PG(a[b],d[c].settings))return!0;return!1}function z(a){for(var b=na(a),d=[],c=0;c<b.length;c++){var e=b[c];if(e.b4w_water){for(var f={},k=0;k<a.length;k++)for(var g=a[k],h=g.data.materials,n=0;n<h.length;n++)h[n]==e&&(f.bl=g.location[2]);f.Ae=e.b4w_water_fog_color.slice(0);f.Ae.push(e.b4w_water_fog_density);
e.b4w_water_dynamic?(f.Sq=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,
f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Sq=!1,f.waves_height=0,f.waves_length=0);f.Ig=e.b4w_water_enable_caust;f.bS=e.b4w_water_caust_scale;f.aS=e.b4w_water_caust_brightness;f.cS=new Float32Array([.3,.7]);f.Ik=null;e=e.texture_slots;for(k=0;k<e.length;k++)g=e[k].texture,!0===g.b4w_shore_dist_map&&"FILE"==g.image.source&&(f.Ik=g.image,f.wD=g.image.size[0],f.WB=g.b4w_max_shore_dist,g=g.b4w_shore_boundings,f.Lo=[(g[0]+g[1])/2,(g[2]+g[3])/2],f.Mo=[g[0]-g[1],
g[2]-g[3]]);d.push(f)}}if(0<d.length){f=d[0];if(!f.Sq)for(c=0;c<d.length;c++)d[c].Sq&&(f=d[c]);return f}return null}function p(a){function b(a){if(a){a=a.nodes;for(var c=0;c<a.length;c++){var e=a[c];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(d.refractions=!0)}}}var d={refractions:!1};a=na(a);for(var c=0;c<a.length;c++){var e=a[c];e.b4w_refractive&&(d.refractions=!0);e.node_tree&&b(e.node_tree)}return d}function n(a,b,d){if(za.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var c=0,e=!1,f=0;f<b.length;f++){var k=b[f];k.k.Gd&&"CUBE"==k.k.jh&&c++;if(k.ks.length){for(var g=null,h=0;h<a.length;h++)if(a[h]==k){g=h;break}null==g&&a.push(k)}}for(f=0;f<d.length;f++){a:if(b=d[f],b.b4w_reflexible){b=b.data.materials;for(k=0;k<b.length;k++)if(g=b[k].game_settings.alpha_blend,"OPAQUE"!=g&&"CLIP"!=g){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{wL:a,QK:c,Hi:[],tA:[],Yh:[],rw:[],JJ:e}}function k(a,b){var d=a.b4w_sky_settings,c={};c.zL=d.render_sky||d.procedural_skydome;
c.procedural_skydome=d.procedural_skydome;c.use_as_environment_lighting=d.use_as_environment_lighting;c.Oo=d.color;c.rayleigh_brightness=d.rayleigh_brightness;c.mie_brightness=d.mie_brightness;c.spot_brightness=d.spot_brightness;c.scatter_strength=d.scatter_strength;c.rayleigh_strength=d.rayleigh_strength;c.mie_strength=d.mie_strength;c.rayleigh_collection_power=d.rayleigh_collection_power;c.mie_collection_power=d.mie_collection_power;c.mie_distribution=d.mie_distribution;c.ee=d.reflexible;c.Hd=d.reflexible_only;
!b&&d.procedural_skydome&&Fa.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return c}function u(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.ZV=a.hemisphere;b.FR=a.blur_depth;b.vG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.yY=a.samples;return b}function e(a){if(!(za.bloom&&a.b4w_enable_bloom&&a.s.qj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function y(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function K(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function F(a){var b={};a=a.b4w_god_rays_settings;b.zB=a.intensity;b.io=a.max_ray_length;b.Xo=a.steps_per_pass;return b}function J(a){var b={};b.ij=a.b4w_outline_color;b.Tr=a.b4w_outline_factor;return b}
function D(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function R(a,b){var d=a.light_settings,c={};c.Pg=d.environment_energy;c.Qs=d.use_environment_light;c.JA=d.environment_color;c.je=a.horizon_color.slice(0);c.te=a.zenith_color.slice(0);c.Ts=a.use_sky_paper;c.Ss=a.use_sky_blend;c.Us=a.use_sky_real;c.dx=null;
c.Po=null;c.Fu=null;d=!0;if(c.Qs&&"SKY_TEXTURE"==c.JA&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?c.Fu=e:d=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){d=!0;e=a.texture_slots[f];c.dx=e;f=Math.min(hb.$i,La.UR(e.texture.image.size[0]/3));c.Po={c_:f,sG:e.blend_factor,
OJ:e.horizon_factor,mO:e.zenith_up_factor,lO:e.zenith_down_factor,color:e.color,Da:e.default_value,invert:e.invert,SN:e.use_rgb_to_intensity,tG:e.blend_type,NN:e.use_map_blend,ON:e.use_map_horizon,QN:e.use_map_zenith_up,PN:e.use_map_zenith_down};break}c.Qs=c.Qs?d:!1;return c}function E(a){var b=a.fog_settings,d={};d.e0=b.use_fog;d.zB=b.intensity;d.depth=b.depth;d.start=b.start;d.height=b.height;d.DU=b.falloff;d.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=d.color;d.Ae=new Float32Array([a[0],
a[1],a[2],1/d.depth]);d.ag=new Float32Array([d.zB,d.depth,d.start,d.height]);return d}function I(a,b){if(!za.jd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var d=!1,c=!1,e=0;e<b.length;e++){for(var f=b[e],k=f.data.materials,g=0;g<k.length;g++)k[g].b4w_terrain&&(d=!0);f=f.particle_systems;for(g=0;g<f.length;g++)k=f[g].settings,"HAIR"==k.type&&k.b4w_dynamic_grass&&(c=!0);if(d&&c)return!0}return!1}function B(a,b){if(Va.outlining_overview_mode)return!0;if(za.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var d=0;d<b.length;d++)if(b[d].pb.k.Dk)return!0;return!1}else return!1}function P(a,b){if(Va.outlining_overview_mode)return!0;if(za.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<b.length;d++)if(b[d].pb.k.Wc)return!0;return!1}else return!1}function d(a,b){if(za.Ui)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var d=0;d<b.length;d++)for(var c=b[d].data.materials,
e=0;e<c.length;e++)if(Ga.OG(c[e]))return!0;return!1}else return!1}function f(a,b){if(za.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function r(a){for(var b=0;b<a.length;b++)for(var d=a[b].data.materials,c=0;c<d.length;c++){var e=d[c],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function g(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var d=0;d<b.length;d++){var c=b[d].pb;if(c.anchor&&c.anchor.Dn)return!0}return!1}}function Q(a,b,d){var c=la.eh(a,b);la.li(a,c,function(a,b,c){if(c.Ic){switch(c.from){case "COLOR":case "CUBEMAP":var e=b.p.vc;break;case "DEPTH":e=b.p.We;break;case "SCREEN":e=null;break;case U.nd:return;default:Ia.q("Wrong slink")}switch(c.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ia.q("Connection of SCREEN is forbidden"),e.Me&&Ia.q("Batch texture can't use renderbuffer"),ra.SG(d.zb,c.to)&&ja.Hj(d,e,c.to)}}});for(a=0;a<b.Ya.length;a++){var c=b.Ya[a],e=b.ki[a];switch(c.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Me&&Ia.q("Batch texture can't use renderbuffer"),ra.SG(d.zb,c.to)&&ja.Hj(d,e,c.to)}}}function t(a){if(a&&a.s&&a.s.Wa){var b=da.ic(a.s.Wa,U.Bg);b&&ca(a,b)}}function aa(a,
b,d,c,e,f){for(var k=b.k,g=Aa.ka(b,e).V,h=0;h<g.length;h++){var n=g[h];if(!(n.qe||n.Hd||"MAIN"!=n.type&&"NODES_GLOW"!=n.type&&"PARTICLES"!=n.type&&"LINE"!=n.type)&&("OPAQUE"==n.Fb&&"OPAQUE"==c||"BLEND"==n.Fb&&"BLEND"==c||"XRAY"==n.Fb&&"XRAY"==c||"NODES_GLOW"==n.type&&"GLOW"==c)){if(!f&&(M(n,a,b,d,c,e),!ja.Yc(n)))if("DEBUG"===Ta.type())ja.Rt(n,"error.glslv","error.glslf"),ja.Yc(n);else continue;var l=U.Rh(n,k);U.Tc(a,l);Q(d,a,n);G(n)}}}function M(a,b,d,c,e,f){var k=d.k,g=f.s,h=Aa.ka(d,f),n="NO_SHADOWS";
d=L(f,[U.dd]);if(d.length&&a.fe){switch(e){case "OPAQUE":n="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":n="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":n="NO_SHADOWS";break;case "SHADOW":n="SHADOW_MASK_GENERATION";break;default:Ia.q("Wrong subscene type")}for(var l=0;l<d.length;l++)ja.bG(a,f.s.xd)}l="NO_SOFT_SHADOWS";if(g.xd&&g.xd.xZ)switch(za.GR){case "16x":l="POISSON_X_16";break;case "8x":l="POISSON_X_8";break;case "4x":l="POISSON_X_4"}d=a.hb;ra.ha(d,"SHADOW_USAGE",
n);ra.ha(d,"POISSON_DISK_NUM",l);a.jd&&(l=da.ic(c,U.ui))&&T(a,l,k);l=b.p;l.type==ta.we||l.type==ta.xh||l.type==ta.xi?ra.ha(d,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ra.ha(d,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.ak){e=b.ew;ra.ha(d,"NUM_LIGHTS",e);ra.ha(d,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);ra.ha(d,"REFLECTION_PASS","REFL_PASS_NONE");ra.ha(d,"SSAO_ONLY",0);if(e=g.Nc)ra.ha(d,"WATER_EFFECTS",1),ra.ha(d,"WAVES_HEIGHT",ra.M(e.waves_height)),ra.ha(d,"WAVES_LENGTH",ra.M(e.waves_length)),
ra.ha(d,"WATER_LEVEL",ra.M(e.bl));if(b.Ig&&a.Ig){ra.ha(d,"CAUSTICS",1);if(l=g.xd){k=l.Zg;for(l=n=0;l<k.length;l++)"SUN"==k[l]&&(n=l);ra.ha(d,"SUN_NUM",n)}ra.ha(d,"CAUST_SCALE",ra.M(b.EG));ra.ha(d,"CAUST_SPEED",ra.M(b.FG,2));ra.ha(d,"CAUST_BRIGHT",ra.M(b.DG))}b=h.Hi;h=h.Yh;if(-1!==a.Ld.indexOf("u_mirrormap"))ra.ha(d,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Gd&&b)b=b.p.vc,ja.Hj(a,b,"u_cube_reflection"),ra.ha(d,"REFLECTION_TYPE","REFL_CUBE");else if(a.Gd&&h)for(l=0;l<h.length;l++)b=h[l].p.vc,ja.Hj(a,
b,"u_plane_reflection"),ra.ha(d,"REFLECTION_TYPE","REFL_PLANE");else ra.ha(d,"REFLECTION_TYPE","REFL_NONE");(h=da.ic(c,U.Bg))?a.zu?(b=h.p.vc,ja.Hj(a,b,"u_sky")):h.procedural_skydome&&(a.ye=h.ye,ra.ha(d,"PROCEDURAL_FOG",1)):ra.ha(d,"PROCEDURAL_FOG",0);b=g.pp;b.Qs&&(ra.ha(d,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.JA?(b.Fu?(h=b.Fu.texture,b=La.he(b.Fu),ja.Hj(a,b,"u_sky_texture",h.name)):h&&(b=h.p.vc,ja.Hj(a,b,"u_sky_texture")),ra.ha(d,"SKY_TEXTURE",1)):"SKY_COLOR"==b.JA&&ra.ha(d,"SKY_COLOR",1));
b=g.kO;b.e0&&(ra.ha(d,"USE_FOG",1),ra.ha(d,"FOG_TYPE",b.DU));a.zk&&a.Lb?(za.xu&&ra.ha(d,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type?(ra.ha(d,"REFRACTIVE",1),g.refractions?ra.ha(d,"USE_REFRACTION",1):ra.ha(d,"USE_REFRACTION",0)):g.refractions?ra.ha(d,"REFRACTIVE",1):ra.ha(d,"REFRACTIVE",0),(g.AK.refractions||g.refractions)&&ra.ha(d,"HAS_REFRACT_TEXTURE",1)):(ra.ha(d,"REFRACTIVE",0),ra.ha(d,"USE_REFRACTION",0),ra.ha(d,"USE_REFRACTION_CORRECTION",0));a.xj&&(za.Hk&&a.Zs&&
da.ic(c,U.GE)?ra.ha(d,"SHORE_SMOOTHING",1):ra.ha(d,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ra.ha(d,"DYNAMIC",1):ra.ha(d,"DYNAMIC",0));"PARTICLES"==a.type&&(ra.ha(d,"SIZE_RAMP_LENGTH",a.gb.c9),ra.ha(d,"COLOR_RAMP_LENGTH",a.gb.cH));if(!a.bg)for(a=a.ya,c=0;c<a.length;c++)if(b=a[c],"SCENE"==b.source)for(g=0;g<Sa.length;g++)for(d=Sa[g],h=Sa[g].Tf,e=0;e<h.length;e++)h[e]==b&&la.r(Mb,d,f,null)}}function G(a){8<a.ya.length&&Fa.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.ud.join(", ")+'"')}function T(a,b,d){a.ie=b.ie;var c=b.ie[0],e=b.ie[1],f=b.ie[2];d=d.P;d=Math.max(d.max_x-d.min_x,d.max_y-d.min_y);f=0==f?d:Math.max(f,d);b.ie[2]=f;b=b.p;ta.Lw(b,f/2,-e,-c,f/2);ta.Gk(b);c=a.qr||0;c=0==c?d:Math.max(c,d);a.qr=c}function S(a,b,d,c,e,f){for(var k=b.k,g=Aa.ka(b,e).V,h=0;h<g.length;h++){var n=g[h];if(("MAIN"==n.type||"PARTICLES"==n.type||"LINE"==n.type)&&"REFLECT"==n.Fb&&n.Lb==c){if(a.type==U.Nd||a.type==U.vf){var l;a:{var v=e.s.ai.Yh;for(l=0;l<v.length;l++)for(var m=
0;m<v[l].length;m++)if(v[l][m]==a)break a;v=e.s.ai.rw;for(l=0;l<v.length;l++)for(m=0;m<v[l].length;m++)if(v[l][m]==a)break a;l=null}if(l==k.Ed)continue}else if(l=qa(e,a),l==k.Rd)continue;if(!f&&(M(n,a,b,d,"REFLECT",e),l=n.hb,ra.ha(l,"WATER_EFFECTS",0),a.type==U.Nd||a.type==U.vf?ra.ha(l,"REFLECTION_PASS","REFL_PASS_PLANE"):ra.ha(l,"REFLECTION_PASS","REFL_PASS_CUBE"),ra.ha(l,"TEXTURE_NORM",0),!ja.Yc(n)))if("DEBUG"===Ta.type())ja.Rt(n,"error.glslv","error.glslf"),ja.Yc(n);else continue;n=U.Rh(n,k);U.Tc(a,
n)}}}function X(a){ea(a);var b=Y(a,U.Pb),d=!0,c=a.s.xd;la.pa(a.s.Wa,function(e,f){f.type===U.dd&&(ma(f,a,b.p,c,d),d=!1)})}function H(a){la.pa(a.s.Wa,function(a,b){b.type===U.gn&&(b.IA=1)})}function ma(a,b,d,c,e){if(0!=a.Qa.length){var f=a.p,k=sa.jc(d.n,mb);sa.pe(k,f.n);sa.copy(d.pf,f.ys);if("SUN"===c.Zg[a.nh]||"HEMI"===c.Zg[a.nh]){k=tc;va.y0(k);for(var g=0;g<a.Qa.length;g++)for(var h=a.Qa[g].sa,n=0;n<h.length;n++){var l=h[n].gf;0==g&&0==n?va.vn(l.Ta,k):va.KA(k,l.Ta)}k=va.aI(k,Fc);Ia.wo(k,f.Ob,k);
if(c.enable_csm){b=Ra.copy(d.Hh[a.sA],mb);c=Pa.invert(d.Ob,fc);Ia.wo(b,c,b);Ia.wo(b,f.Ob,b);a=d.Hq[a.sA];if(e)for(gc=0,Xc=-Infinity,e=2;e<k.length;e+=3)gc=Math.min(gc,k[e]),Xc=Math.max(Xc,k[e]);e=tc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=Xc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=gc}else{d=e=tc;c=$c;c.set(k);k=Zb/9;g=Pa.identity(fc);Pa.rotate(g,k,Ia.ad,g);n=h=-1;for(l=0;10>l;l++){var v=va.iG(c,Pc),m=(v.max_x-v.min_x)*(v.max_y-v.min_y);if(-1==h||m<h)h=m,n=l,va.vn(v,d);Ia.wo(c,g,c)}d=n*k;0<d&&(k=Pa.identity(fc),
Pa.rotate(k,d,Ia.ad,k),Pa.multiply(k,f.Ob,f.Ob),sa.Tg(f.Ob,f.pf));d=e.max_x-e.min_x;k=e.max_y-e.min_y;d&&k&&(c=Math.abs(d-k)/2,2<d/k?(e.max_y+=c,e.min_y-=c):2<k/d&&(e.max_x+=c,e.min_x-=c));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;W(a,b.s.Wa)}ta.PY(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);ta.Gk(f);Ia.In(f.md,f.Lh)}else"SPOT"!==c.Zg[a.nh]&&"POINT"!==c.Zg[a.nh]||ta.Gk(f,f.Ab)}}function W(a,b){for(var d=a.p,c=da.KV(b,a),e=0;e<c.length;e++){var f=
c[e];if(f.type==U.Pb||f.type==U.wf||f.type==U.Qc||f.type==U.Sf)if(za.Pv)f.mE.set(d.pf,9*a.nh);else{var k=sa.F(d.pf),g=sa.td(d.pf),h=sa.N(d.pf);vb.set(k[0],k[1],k[2],g,ib);f.xx.set(ib,4*a.nh);f.wx.set(h,4*a.nh)}}}function O(a,b,d,c,e){for(var f=b.k,k=Aa.ka(b,c).V,g=0;g<k.length;g++){var h=k[g];if("COLOR_ID"==h.type&&(a.type==U.sf&&"COLOR_ID"==h.Fb||a.type==U.si&&"COLOR_ID_XRAY"==h.Fb)){if(!e&&(M(h,a,b,d,"COLOR_ID",c),ja.jf(h,"USE_OUTLINE",0),!ja.Yc(h)))continue;h=U.Rh(h,f);U.Tc(a,h)}}}function V(a,
b,d,c,e){if(!c&&(e.jd&&(c=da.ic(d,U.ui))&&T(e,c,b),!ja.Yc(e)))if("DEBUG"===Ta.type())ja.Rt(e,"error.glslv","error.glslf"),ja.Yc(e);else return;b=U.Rh(e,b);U.Tc(a,b);Q(d,a,e);G(e)}function ga(a,b){v(a,b);for(var d=0;d<a.Ue.length;d++)a.Ue[d].parent==a&&ga(a.Ue[d],b)}function v(a,b){a.k.Qh=b;if(Aa.Xg(a))for(var d=0;d<a.I.length;d++)for(var c=a.I[d],e=L(c.yb,ob),f=0;f<e.length;f++){var k=e[f],g=a.k,h=a.ub,n=c.pm,l=h.Tm&&!g.Qh?1:0;k.Jr[4*n+3]=l;l=h.Vm&&!g.Qh?1:0;k.Ir[4*n+3]=l;k.Aa=!0}}function ba(a,b){for(var d=
L(b,ob),c=a.ub,e=a.k,f=Aa.ka(a,b),k=sa.F(e.n),e=sa.N(e.n),g=0;g<d.length;g++){var h=d[g],n=h,l=a.k,v=a.ub,m=f.pm,r=sa.F(a.k.n),t=v.yq;n.OB.set(v.direction,3*m);ib[0]=r[0];ib[1]=r[1];ib[2]=r[2];ib[3]=v.Tm&&!l.Qh?1:0;n.Jr.set(ib,4*m);ib[0]=t[0];ib[1]=t[1];ib[2]=t[2];ib[3]=v.Vm&&!l.Qh?1:0;n.Ir.set(ib,4*m);n.Aa=!0;switch(c.type){case "SUN":h.cN.set(e);h.bN=c.yq;h.type===U.Bg?(h.$v=c.MK,Ra.copy(c.direction,h.HD),ca(b,h)):Ra.copy(c.direction,h.HD);break;case "HEMI":case "POINT":case "SPOT":break;default:Fa.error("Unknown light type: "+
c.type+'".')}h=h.Qa;for(n=0;n<h.length;n++)for(l=h[n].sa,v=0;v<l.length;v++)m=l[v].za,m.om&&ja.RY(m,a)}d=Y(b,U.Pb).p;f=f.uD;c=b.s.xd;for(g=0;g<f.length;g++)h=f[g],ta.qD(h.p,k,e),ma(h,b,d,c,!0),W(h,b.s.Wa)}function ea(a){var b=Qa.Vb(a,"LAMP",Qa.nc),b=Aa.Xu(b,za.ssao&&a.b4w_enable_ssao);if(b.length)for(var d=0;d<b.length;d++)for(var c=b[d],e=c.k,f=sa.jc(e.n,mb),e=sa.Yd(e.n,Ib),k=0;k<c.I.length;k++){var g=c.I[k],h=g.uD;if(g.yb==a)for(g=0;g<h.length;g++)ta.qD(h[g].p,f,e)}}function ca(a,b){Za.uw(b);Na.Gn(b);
if(b.$v)for(var d=L(a,$a),c=0;c<d.length;c++)for(var e=d[c].Qa,f=0;f<e.length;f++)for(var k=e[f].sa,g=0;g<k.length;g++){var h=k[g];h.dc&&(h=h.za,ja.fS(h)&&Na.w_(h))}}function na(a){for(var b=[],d=0;d<a.length;d++)for(var c=a[d].data,e=0;e<c.materials.length;e++){var f=c.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function pa(a,b,d){for(var c=a.s,e=Aa.ka(a.Cj,a).da,f=0;f<e.length;f++){var k=e[f];ta.Gk(k,b/d);c.xd&&ta.gE(k,c.xd)}c.xd&&(c.aw=!0,Y(a,U.wf).Aa=!0,Y(a,U.Qc).Aa=!0);var g=c.Wa;da.l_(g,
function(c,e,f){if(c.Ks){var k=c.Jm*b,h=c.Km*d;if(e)for(e=0;e<f.Ya.length;e++)f.Ya[e]==c&&La.resize(c.jb,k,h);else switch(La.bo(c.jb)&&La.resize(c.jb,k,h),c=f.p,c.width=k,c.height=h,f.type){case U.wp:xa(a,{dof_power:f.p.dof_power});break;case U.yp:oa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case U.qp:ya(a,{bloom_blur:f.rn});break;case U.gn:f=da.Db(g,f,U.hc);k=da.Db(g,f,U.hc);h=da.Db(g,k,U.hc);c=da.Db(g,h,U.hc);da.Jd(f,1/b,1/d);da.Jd(k,
1/b,1/d);da.Jd(h,1/b,1/d);da.Jd(c,1/b,1/d);break;default:da.Jd(f,1/b,1/d)}}})}function L(a,b){for(var d=[],c=0;c<b.length;c++){var e=b[c];la.pa(a.s.Wa,function(a,b){b.type==e&&d.push(b)})}return d}function Y(a,b){return da.ic(a.s.Wa,b)}function xa(a,b){var d=Y(a,U.wp);if(!d)return Fa.error("DOF is not enabled on the scene. Check camera settings"),0;var c=d.p.dof_bokeh,e=c?L(a,[U.Ux]):[],f=a.s.Wa;if("boolean"==typeof b.dof_on&&(d.p.dof_on=b.dof_on,c))for(var k=0;k<e.length;k++)e[k].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(d.p.dof_distance=b.dof_distance,c))for(k=0;k<e.length;k++)e[k].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(d.p.dof_front_start=b.dof_front_start,c))for(k=0;k<e.length;k++)e[k].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(d.p.dof_front_end=b.dof_front_end,c))for(k=0;k<e.length;k++)e[k].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(d.p.dof_rear_start=b.dof_rear_start,c))for(k=0;k<e.length;k++)e[k].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(d.p.dof_rear_end=b.dof_rear_end,c))for(k=0;k<e.length;k++)e[k].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(d.p.dof_bokeh_intensity=b.dof_bokeh_intensity,c&&(e=da.eB(f,d,U.hc),e[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,e[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,e[0]=da.Db(f,e[0],U.hc),e[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(c){c=b.dof_power;d.p.dof_power=c;var c=
c/2,k=d.p.width,g=d.p.height,h=[1/k,0],n=[1/k*.5,1/g*.866],l=[-1/k*.5,1/g*.866],e=da.eB(f,d,U.hc);da.Mc(e[0],c);da.Jd(e[0],l[0],l[1]);da.Mc(e[1],c);da.Jd(e[1],n[0],n[1]);e[0]=da.Db(f,e[0],U.hc);da.Mc(e[0],c);da.Jd(e[0],h[0],h[1]);d.p.Cd&&(e[0]=da.Db(f,e[0],U.Ux),e[0]=da.Db(f,e[0],U.hc),da.Jd(e[0],1/k,1/g),e[0]=da.Db(f,e[0],U.hc),da.Jd(e[0],1/k,1/g))}else d.p.dof_power=b.dof_power,e=da.Db(f,d,U.hc),f=da.Db(f,e,U.hc),da.Mc(e,d.p.dof_power),da.Jd(e,1/d.p.width,1/d.p.height),da.Mc(f,d.p.dof_power),da.Jd(f,
1/d.p.width,1/d.p.height)}function ya(a,b){var d=Y(a,U.wt),c=Y(a,U.qp);if(!d||!c)return Fa.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(d.Zt=b.key,d.Aa=!0);"number"==typeof b.edge_lum&&(d.Yt=b.edge_lum,d.Aa=!0);if("number"==typeof b.blur){var e=a.s.Wa,d=da.Db(e,c,U.rp),e=da.Db(e,d,U.rp);c.rn=b.blur;da.Mc(d,b.blur);da.Jd(d,1/c.p.width,1/c.p.height);da.Mc(e,b.blur);da.Jd(e,1/c.p.width,1/c.p.height)}}function oa(a,b){var d=Y(a,U.yp);if(!d)return Fa.error("Glow is not enabled on the scene"),
null;for(var c=a.s.Wa,e=da.GV(c,d),f=0;f<e.length;++f){var k=e[f];if(k.type==U.hc&&"GLOW_MASK_LARGE"==k.Fb)var g=k;if(k.type==U.hc&&"GLOW_MASK_SMALL"==k.Fb)var h=k}e=da.Db(c,g,U.hc);c=da.Db(c,h,U.hc);"number"==typeof b.small_glow_mask_coeff&&(d.small_glow_mask_coeff=b.small_glow_mask_coeff,d.Aa=!0);"number"==typeof b.large_glow_mask_coeff&&(d.large_glow_mask_coeff=b.large_glow_mask_coeff,d.Aa=!0);"number"==typeof b.small_glow_mask_width&&(d.small_glow_mask_width=b.small_glow_mask_width,da.Mc(h,b.small_glow_mask_width),
da.Jd(h,1/d.p.width,1/d.p.height),h.Aa=!0,da.Mc(c,b.small_glow_mask_width),da.Jd(c,1/d.p.width,1/d.p.height),c.Aa=!0);"number"==typeof b.large_glow_mask_width&&(d.large_glow_mask_width=b.large_glow_mask_width,da.Mc(g,b.large_glow_mask_width),da.Jd(g,1/d.p.width,1/d.p.height),g.Aa=!0,da.Mc(e,b.large_glow_mask_width),da.Jd(e,1/d.p.width,1/d.p.height),e.Aa=!0)}function Z(a,b,d){var c=a.s,e=c.Nc;if(!e.Sq)return e.bl;var f=e.waves_height,k=e.waves_length,g=e.bl,h=Ra.length(c.yj)||1;a=Y(a,U.Pb).time;a*=
h;var n=Nb;n[0]=20/k*(b-.25*a);n[1]=20/k*(d-.25*a);h=Ia.GG(n);n[0]=17/k*(d+.1*a);n[1]=17/k*(b+.1*a);var n=Ia.GG(n),h=h+n-1,l=e.dst_noise_scale0,n=e.dst_noise_scale1,v=e.dst_noise_freq0,m=e.dst_noise_freq1,r=Nb;r[0]=l*(b+v*a);r[1]=l*(d+v*a);l=Ia.zD(r);r[0]=n*(d-m*a);r[1]=n*(b-m*a);n=Ia.zD(r);n*=f*l;if(e.Ik)if(m=(b-e.Lo[0])/e.Mo[0],r=(e.Lo[1]+d)/e.Mo[1],m+=.5,r+=.5,1<m||0>m||1<r||0>r)e=n;else{var c=Ia.AI(c.vD,e.wD,m,r),r=e.dir_freq,t=e.dir_noise_scale,p=e.dir_noise_freq,l=e.dir_min_noise_fac,m=e.dst_min_fac,
v=k/e.WB/Math.PI;d=[t/k*(b+p*a),t/k*(d+p*a)];b=Math.sqrt(c);e=f*Math.max(c,e.dir_min_shore_fac)*Math.sin(b/v+r*a)*Math.max(Ia.zD(d),l);f=Math.max(b,m);e=e*(1-f)+n*f;h*=c}else e=n;return g+(e+.05*h)}function fa(a,b){a.zr&&a.type==U.hc&&b.dc!=a.dc&&(a.dc=b.dc);b.dc||a.type!=U.gn||(a.IA=0)}function ha(a,b,d,c){var e=la.Va(a,b);ta.Iw(e.p,d,c);e.vz=!0;la.Qk(a,b,function(b,e,f){f.Ic&&f.from==d&&da.tS(f)&&N(a,b,f.to,c)});la.li(a,b,function(b,e,f){f.Ic&&f.from==d&&f.from==f.to&&ha(a,b,d,c)})}function N(a,
b,d,c){a=la.Va(a,b).Qa;for(b=0;b<a.length;b++)for(var e=a[b].sa,f=0;f<e.length;f++)ja.nY(e[f].za,c,d)}function ka(a){var b=Y(a,U.ui);if(b){var d=b.p,c=a.Cj.k;a=sa.jc(c.n,mb);var e=pd;e[0]=0;e[1]=0;e[2]=-b.ie[2]/2;b=sa.Yd(c.n,Ib);Ra.transformQuat(e,b,e);e[0]+=a[0];e[1]+=a[1];e[2]=0;Ec.identity(b);ta.qD(d,e,b)}}function C(a,b){la.pa(a,function(d,c){if(c.type==U.vh){c.Ya[0]&&c.ki[0]||Ia.q("Wrong MOTION_BLUR subscene");var e=c.Ya[0],f=c.ki[0];c.ki[0]=c.p.vc;la.Qk(a,d,function(b,d,c){c.Ic&&N(a,b,c.to,
f)});ha(a,d,e.from,f);N(a,d,e.to,c.ki[0]);c.FK=Math.exp(-b/c.mb_factor)}})}function ia(a){return a.s.yj}function qa(a,b){if(!a.s.ai)return null;for(var d=a.s.ai.Hi,c=0;c<d.length;c++)if(d[c]==b)return c;d=a.s.ai.tA;for(c=0;c<d.length;c++)if(d[c]==b)return c;return null}var ja=m("__batch"),va=m("__boundings"),ta=m("__camera"),Ea=m("__config"),Ca=m("__container"),Ba=m("__debug"),la=m("__graph"),ua=m("__hud"),wa=m("__input"),Pa=m("__mat4"),Ga=m("__nodemat"),Qa=m("__objects"),Aa=m("__obj_util"),w=m("__physics"),
Za=m("__prerender"),ub=m("__primitives"),Fa=m("__print"),Ec=m("__quat"),Na=m("__renderer"),da=m("__scenegraph"),Da=m("__sfx"),ra=m("__shaders"),U=m("__subscene"),La=m("__textures"),sa=m("__tsr"),Ia=m("__util"),Ra=m("__vec3"),vb=m("__vec4"),Ta=m("__version"),za=Ea.B,hb=Ea.Fi,Va=Ea.Wc,Ja=Ea.Do,eb=[U.ui,U.dd,U.Pb,U.Qc,U.Sf,U.ge,U.Nd,U.nd,U.vf,U.Pe,U.sf,U.si,U.wf,U.Ag,U.uf];a.a2=eb;var ob=[U.Pb,U.Qc,U.Sf,U.ge,U.Nd,U.nd,U.Bj,U.rt,U.Bg,U.vf,U.Pe,U.wt,U.wf,U.dd,U.sf,U.si,U.Ag],$a=[U.Pb,U.Et,U.Qc,U.Sf,U.ge,
U.Nd,U.nd,U.vf,U.Pe],sb=[U.dd,U.Pb,U.Qc,U.Sf,U.ge,U.Nd,U.nd,U.vf,U.Pe,U.sf,U.si,U.wf,U.Bj,U.Ag,U.uf],fb=[U.Pb,U.Qc,U.Sf,U.ge,U.Nd,U.nd,U.vf,U.Pe],lb=null,wb=null,Sa=[],Mb=null,Zb=Math.PI/2,Nb=new Float32Array(2),mb=new Float32Array(3),pd=new Float32Array(3),Ib=new Float32Array(4),ib=new Float32Array(4),fc=new Float32Array(16),Fc=new Float32Array(24),$c=new Float32Array(24),tc=va.Qd(),Pc=va.Qd(),gc=0,Xc=-Infinity;a.y3=function(){return{}};a.Hw=function(a){wb=a;Da.DY(a)};a.XX=function(a,b){var d=a.s,
c=da.iT(d.Wa);if(a==b){pa(a,Ca.zJ(),Ca.yJ());for(var e=0;e<c.length;e++)a.s.Em.push(c[e])}else for(e=a.Tf[0],pa(a,e.mj,e.mj),e=0;e<c.length;e++)b.s.Em.push(c[e]);c=L(a,sb);for(e=0;e<c.length;e++)c[e].yj.set(d.yj);for(e=0;e<d.Em.length;e++)d.Em[e].type==U.dd&&Na.Gn(d.Em[e])};a.Nh=function(){lb||(lb=l(Sa));return lb};a.Iu=l;a.A=c;a.Ca=function(){return wb?!0:!1};a.Mh=function(a){return a.Cj};a.gr=function(){return Sa};a.gB=function(){if(1==Sa.length)return Sa;for(var a=0;a<Sa.length;a++){var b=Sa[a].s.Wa;
la.pa(b,function(b,d){for(var c=d.Qa,e=0;e<c.length;e++)for(var f=c[e].sa,k=0;k<f.length;k++){for(var g=f[k],h=g.za.ya,n=null,l=0;l<h.length;l++)if("SCENE"==h[l].source&&h[l].Bs==Sa[a].name&&d.type!=U.Wx){Fa.error('Texture-scene loop detected. A scene is rendered to texture "'+h[l].name+'" yet this texture belongs to the same scene.');la.eh(Mb,Sa[a]);n=g.za;break}n&&(n.ya=[],n.Ld=[],ja.v_(n,null),ja.Yc(n),U.Tc(d,g))}})}for(var d=[],a=0;a<Sa.length;a++)if(b=Sa[a],!b.Tf.length){b=la.eh(Mb,b);la.qU(Mb,
b);b=la.ix(Mb,b,la.ft);b=la.UD(b);la.pa(b,function(a,b){d.push(b)});break}return d};a.QQ=function(a,c,l,v,m){a.Tf=a.Tf||[];a.ra=null;var t=a.s,H=Aa.ka(a.Cj,a),C=a.Cj.k;t.mp=[];var O=a.world;t.HW=l.length;t.qj=q(l);t.$w=k(O,t.qj);t.pp=R(O,t.$w);t.kO=E(O);if(O=!a.Tf.length)a:{if("HMD"==za.stereo){if(H.da[0].type!=ta.Od){Fa.warn("Head-mounted display stereo is disabled for the non-perspective camera");za.stereo="NONE";O=!1;break a}if(!wa.Nz(wa.Oe)){Fa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
za.stereo="NONE";O=!1;break a}}O="HMD"==za.stereo}t.pv=O;if(O=!a.Tf.length)H.da[0].type!=ta.Od&&"ANAGLYPH"==za.stereo?(Fa.warn("Anaglyph stereo is disabled for the non-perspective camera"),za.stereo="NONE",O=!1):O="ANAGLYPH"==za.stereo;t.anaglyph_use=O;t.HQ=!t.pv&&!t.anaglyph_use&&g(a,m);t.ai=n(a,c,v);t.ER=e(a);t.pX=y(a);t.dS=K(a);t.SV=F(a);t.EX=J(a);t.$j=D(a);t.dof=za.dof&&(0<C.dof_distance||C.dof_object);t.motion_blur=za.motion_blur&&a.b4w_enable_motion_blur;t.compositing=za.compositing&&a.b4w_enable_color_correction;
t.antialiasing=za.antialiasing&&1==za.Fc&&"NONE"!=a.b4w_antialiasing_quality;t.ssao=za.ssao&&a.b4w_enable_ssao;t.god_rays=za.god_rays&&a.b4w_enable_god_rays&&t.qj;t.$T=za.xu;t.cv=a.b4w_glow_settings.render_glow_over_blend;t.PZ=u(a);m=p(v);t.AK=m;t.refractions=f(a,m);t.xd=b(a,l,v);t.Nc=z(v);t.th=r(v);t.wZ=h(v);t.Hk=A(v);t.jd=I(a,v);t.HS=B(a,v);t.outline=P(a,v);t.Ui=d(a,v);switch(a.b4w_reflection_quality){case "LOW":t.Ii=Ja.EH;t.ih=Ja.dL;break;case "MEDIUM":t.Ii=Ja.TT;t.ih=Ja.QX;break;case "HIGH":t.Ii=
Ja.ST;t.ih=Ja.PX;break;default:t.Ii=Ja.EH,t.ih=Ja.dL}Ca.vW()?(Fa.log("%cENABLE HIDPI MODE","color: #00a"),t.FF="AA_QUALITY_LOW",t.Ao=1,za.Fc=1):1<za.Fc?(Fa.log("%cENABLE MSAA RENDERING: "+za.Fc+"x","color: #00a"),t.Ao=1):(t.FF="AA_QUALITY_"+a.b4w_antialiasing_quality,t.Ao="MEDIUM"===a.b4w_antialiasing_quality&&za.quality===Ea.hn||"HIGH"===a.b4w_antialiasing_quality&&za.quality===Ea.hl?1.33:"HIGH"===a.b4w_antialiasing_quality&&za.quality===Ea.hn||"NONE"===a.b4w_antialiasing_quality&&za.quality===Ea.hn?
2:1);l=a.Tf.sort(function(a,b){return b.mj-a.mj});t.Wa=da.hT(t,H,C,l);t.Em=[];t.aw=!1;t.iC=!1;t.jC=!1;t.yj=new Float32Array(3);Sa.push(a);Mb||(Mb=la.create());la.J(Mb,a);for(t=0;t<c.length;t++)Aa.bD(c[t],!0,a);a=Ca.af();Ca.resize(a.clientWidth,a.clientHeight,!0)};a.RQ=function(a,b,d){for(var c=0;c<b.length;c++){var e=b[c].s;e&&e.mm&&(e.Ys=d,a.s.mp.push(b[c]))}};a.dB=function(a){return a.s.Wa};a.qI=function(a,b){la.pa(b,function(d,c){var e=null;switch(c.type){case U.hc:e=ja.lA(c.tw);break;case U.Et:e=
ja.nT(c);break;case U.fz:e=ja.oT(c);break;case U.GE:e=ja.US();break;case U.Bj:da.Db(b,c,U.kn)||da.Db(b,c,U.uf)||da.Db(b,c,U.Qc)||da.Db(b,c,U.Bj);e=ja.YS(c.YK,c.xj,c.Xo);break;case U.rt:da.Db(b,c,U.kn)||da.Db(b,c,U.uf)||da.Db(b,c,U.Qc);da.Db(b,c,U.Bj);e=ja.ZS();break;case U.vh:e=ja.cT();break;case U.Ux:e=ja.RS(c.$G);break;case U.wp:var e=ja.VS(c),f=c.p.dof_power;if(c.p.dof_bokeh){var f=f/2,k=da.eB(b,c,U.hc);da.Mc(k[0],f);da.Mc(k[1],f);k[0]=da.Db(b,k[0],U.hc);da.Mc(k[0],f)}else{var k=da.Db(b,c,U.hc),
g=da.Db(b,k,U.hc);da.Mc(k,f);da.Mc(g,f)}break;case U.gn:var e=ja.dT(),f=da.Db(b,c,U.hc),k=da.Db(b,f,U.hc),g=da.Db(b,k,U.hc),h=da.Db(b,g,U.hc);da.Mc(k,c.Az);da.Mc(f,c.Az);da.Mc(h,c.NA*c.Tr);da.Mc(g,c.NA*c.Tr);break;case U.yp:e=ja.XS();break;case U.Vx:e=ja.SS();break;case U.yE:e=ja.MS(c);break;case U.dz:case U.Ct:case U.Ip:case U.Dt:e=ja.lT(c.type);break;case U.wi:e=ja.pT(c.Fb);break;case U.Bg:e=ja.TS(a,c);break;case U.LUMINANCE:e=ja.$S();break;case U.oO:e=ja.NS();break;case U.wt:e=ja.aT();break;case U.rp:e=
ja.PS();break;case U.qp:e=da.Db(b,c,U.rp);f=da.Db(b,e,U.rp);da.Mc(e,c.rn);da.Mc(f,c.rn);e=ja.QS();break;case U.sQ:e=ja.NT();break;case U.cn:e=ja.LS();break;case U.Ep:e=ja.eT()}e&&(f=U.Rh(e,Aa.Gq("NONE")),U.Tc(c,f),Q(b,c,e),G(e))})};a.on=function(a,b,d){switch(b.type){case "MESH":case "LINE":case "WORLD":var c=a.s.Wa,e=b.k;!da.ic(c,U.dd)&&e.fe&&(e.fe=!1);e=L(a,eb);d&&b.Um&&w.on(b,a);for(var f=0;f<e.length;f++){var k=e[f],g=b,h=c,n=a,l=d;switch(k.type){case U.Pb:aa(k,g,h,"OPAQUE",n,l);break;case U.Qc:aa(k,
g,h,"BLEND",n,l);break;case U.Sf:aa(k,g,h,"XRAY",n,l);break;case U.ge:aa(k,g,h,"GLOW",n,l);break;case U.Nd:case U.nd:S(k,g,h,!1,n,l);break;case U.vf:case U.Pe:S(k,g,h,!0,n,l);break;case U.wf:for(var v=Aa.ka(g,n).V,m=0;m<v.length;m++){var r=v[m];if("SHADOW"==r.type&&"RECEIVE"==r.Fb&&r.fe){if(!l&&(M(r,k,g,h,"SHADOW",n),!ja.Yc(r)))continue;var t=U.Rh(r,g.k);U.Tc(k,t);Q(h,k,r);G(r)}}break;case U.dd:v=!1;m=g.k;g=Aa.ka(g,n).V;r=da.ic(h,U.ui);for(t=0;t<g.length;t++){var p=g[t];if("SHADOW"==p.type&&"CAST"==
p.Fb){v=!0;if(!l){var H=k.ew;ja.jf(p,"NUM_LIGHTS",H);ja.jf(p,"NUM_LFACTORS",0==H%2?H/2:Math.floor(H/2)+1);ra.ha(p.hb,"SHADOW_USAGE","SHADOW_CASTING");p.jd&&r&&T(p,r,m);ja.jf(p,"SHADOW_TEX_RES",ra.M(n.s.xd.csm_resolution));if(!ja.Yc(p))continue}p=U.Rh(p,m);U.Tc(k,p)}}v&&(g=n.s.xd,l=da.ic(h,U.Pb),ma(k,n,l.p,g,!0));break;case U.sf:O(k,g,h,n,l);break;case U.si:O(k,g,h,n,l);break;case U.Ag:v=g.k;m=Aa.ka(g,n).V;for(r=0;r<m.length;r++)if(t=m[r],"COLOR_ID"==t.type&&"OUTLINE"==t.Fb){if(!l&&(M(t,k,g,h,"COLOR_ID",
n),ja.jf(t,"USE_OUTLINE",1),!ja.Yc(t)))continue;t=U.Rh(t,v);U.Tc(k,t)}break;case U.ui:h=g.k;g=Aa.ka(g,n).V;for(n=0;n<g.length;n++)if(v=g[n],"GRASS_MAP"==v.type){if(!l&&!ja.Yc(v))if("DEBUG"===Ta.type())ja.Rt(v,"error.glslv","error.glslf"),ja.Yc(v);else continue;v=U.Rh(v,h);U.Tc(k,v);v=k.p;p=h.Ta;m=k.ie[0];r=k.ie[1];t=k.ie[2];0==m&&0==r?(m=p.min_z,r=p.max_z):(m=Math.min(m,p.min_z),r=Math.max(r,p.max_z));p=1E-4*(r-m);m-=p;r+=p;k.ie[0]=m;k.ie[1]=r;ta.Lw(v,t/2,-r,-m,t/2);ta.Gk(v)}break;case U.uf:for(v=
g.k,g=Aa.ka(g,n).V,n=0;n<g.length;n++)m=g[n],"DEBUG_VIEW"==m.type&&V(k,v,h,l,m)}}break;case "LAMP":ba(b,a),Qa.BZ(a)}Aa.bD(b,!0,a)};a.iE=t;a.cD=function(a){a.s.aw=!0};a.T_=function(a,b){la.pa(b,function(b,d){if(d.type===U.dd){var c=sa.jc(a.n,mb);sa.pe(c,d.p.n);sa.copy(a.pf,d.p.ys)}})};a.P9=W;a.oV=function(a,b){for(var d=a.s.xd,c=new Float32Array(d.csm_num),e=0;e<d.csm_num;e++)c[e]=ta.QT(d,b,e);return c};a.n2=V;a.IG=ga;a.lq=v;a.FB=function(a){return a.k.Qh};a.gY=function(a){for(var b=0;b<a.I.length;b++)for(var d=
L(a.I[b].yb,eb),b=0;b<d.length;b++)for(var c=d[b].Qa,e=0;e<c.length;e++)for(var f=c[e].sa,k=f.length-1;0<=k;k--){var g=f[k];g.gf==a.k&&(g.za&&ja.WG(g.za),f.splice(k,1))}};a.H_=function(a,b){for(var d=a.ub,c=Aa.ka(a,b).pm,e=L(b,ob),f=0;f<e.length;f++){var k=e[f];k.Ir.set(d.yq,4*c);k.Aa=!0}};a.gp=ba;a.V_=function(a){a=a.I;for(var b=0;b<a.length;b++)t(a[b].yb)};a.ua=function(){for(var a=0;a<Sa.length;a++){var b=Sa[a];la.pa(b.s.Wa,function(a,b){if(b.type!=U.ln){var d=b.p;Na.hY(d.$e,d.vc,d.We,d.width,
d.height);for(var d=b.Qa,c=0;c<d.length;c++)for(var e=d[c].sa,f=0;f<e.length;f++){var k=e[f].za;k&&ja.WG(k)}}});b.s.Wa=[];b.s.Em=[]}wb=lb=null;Sa.length=0;Mb=null};a.yK=function(a,b,d){a=ta.xU(a,a.near,a.far,null,!0);var c=ub.bV(a);a=Aa.Gq("DYNAMIC");a.Ta=a.P={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.lb=a.wa=va.AR();var e=a.lb.Xa;a.qb=a.ba=va.$p([e,0,0],[0,e,0],[0,0,e],a.lb.G);a.hp=!1;d=ja.kT(c,d);d=U.Rh(d,a);U.Tc(b,d)};a.F5=function(a){return[a.frame_start,a.frame_end]};
a.uM=function(a,b,d){Ca.pZ(a,b,d);wb&&pa(wb,a,b)};a.V8=pa;a.FD=L;a.La=Y;a.NI=function(a){a=Y(a,U.Pb);var b=a.je,d=a.te,c=[],e=[];c[0]=b[0];c[1]=b[1];c[2]=b[2];e[0]=d[0];e[1]=d[1];e[2]=d[2];return[a.Pg,c,e]};a.Kw=function(a,b,d,c){a=L(a,ob);for(var e=0;e<a.length;e++){var f=a[e];f.je.set(d);f.te.set(c);f.Pg=b;f.Aa=!0}};a.qJ=function(a){if(a=Y(a,U.Bg)){var b={};b.color=Array(3);Ra.copy(a.Oo,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.mM=function(a,b){var d=Y(a,U.Bg);d&&("number"==typeof b.procedural_skydome&&(d.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(d.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&d.Oo.set(b.color),"number"==typeof b.rayleigh_brightness&&(d.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(d.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(d.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(d.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(d.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(d.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(d.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(d.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(d.mie_distribution=b.mie_distribution),d.Aa=!0,d.$v=!0,ca(a,d))};a.xV=function(a){return L(a,$a)[0].ag[0]};a.vV=function(a){return L(a,$a)[0].ag[1]};a.yV=function(a){return L(a,$a)[0].ag[2]};
a.wV=function(a){return L(a,$a)[0].ag[3]};a.aM=function(a,b){for(var d=L(a,$a),c=0;c<d.length;c++){var e=d[c];e.ag[0]=b;e.Aa=!0}};a.ZL=function(a,b){for(var d=L(a,$a),c=0;c<d.length;c++){var e=d[c];e.ag[1]=b;e.Aa=!0}};a.bM=function(a,b){for(var d=L(a,$a),c=0;c<d.length;c++){var e=d[c];e.ag[2]=b;e.Aa=!0}};a.$L=function(a,b){for(var d=L(a,$a),c=0;c<d.length;c++){var e=d[c];e.ag[3]=b;e.Aa=!0}};a.TI=function(a,b){var d=b||[],c=L(a,$a)[0].Ae;d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];return d};a.hD=function(a,
b){for(var d=L(a,$a),c=0;c<d.length;c++){var e=d[c];e.Ae.set(b);e.Aa=!0}};a.sJ=function(a){var b=Y(a,U.Et);a=Y(a,U.fz);if(!b)return null;var d=b.Qa[0].sa[0].za,c={};c.ssao_quality=ja.ZA(d,"SSAO_QUALITY")[1];c.ssao_hemisphere=b.ssao_hemisphere;c.ssao_blur_depth=a.ssao_blur_depth;c.vG=a.ssao_blur_discard_value;c.radius_increase=b.To;c.influence=b.So;c.dist_factor=b.Ro;c.ssao_only=b.ssao_only;c.ssao_white=ja.ZA(d,"SSAO_WHITE")[1];return c};a.oM=function(a,b){var d=Y(a,U.Et),c=Y(a,U.fz);if(!d)return Fa.error("SSAO is not enabled on the scene"),
0;var e=d.Qa[0].sa[0],f=e.za;"string"==typeof b.ssao_quality&&(ja.jf(f,"SSAO_QUALITY",b.ssao_quality),ja.Yc(f),U.Tc(d,e));"number"==typeof b.ssao_hemisphere&&(ja.jf(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),ja.Yc(f),U.Tc(d,e));"number"==typeof b.ssao_blur_depth&&(ja.jf(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ja.Yc(f),U.Tc(d,e));"number"==typeof b.ssao_white&&(ja.jf(f,"SSAO_WHITE",b.ssao_white),ja.Yc(f),U.Tc(d,e));"number"==typeof b.ssao_blur_discard_value&&(c.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.To&&(d.To=b.To);"number"==typeof b.So&&(d.So=b.So);"number"==typeof b.Ro&&(d.Ro=b.Ro);if("number"==typeof b.ssao_only){d=Y(a,U.Pb);d.ssao_only=b.ssao_only;for(var e=d.Qa,k=0;k<e.length;k++)for(var g=e[k].sa,h=0;h<g.length;h++)f=g[h].za,ja.jf(f,"SSAO_ONLY",b.ssao_only),ja.Yc(f),U.Tc(d,g[h])}d.Aa=!0;c.Aa=!0};a.KI=function(a){a=Y(a,U.wp);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.XL=xa;a.WI=function(a){var b=L(a,[U.Bj]);a=Y(a,U.rt);if(!b||!a)return null;var d={};d.god_rays_max_ray_length=b[0].io;d.god_rays_intensity=a.god_rays_intensity;d.god_rays_steps=ja.ZA(b[0].Qa[0].sa[0].za,"STEPS_PER_PASS")[1];return d};a.dM=function(a,b){var d=L(a,[U.Bj]),c=Y(a,U.rt);if(!d||!c)return Fa.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(c.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<d.length;f++)d[f].io=e,d[f].zw=e/d[f].Xo/(f+1),d[f].Aa=!0;if("number"==typeof b.god_rays_steps)for(var k=ra.M(b.god_rays_steps,1),e=d[0].io,f=0;f<d.length;f++){d[f].Xo=k;d[f].zw=e/k/(f+1);d[f].Aa=!0;var g=d[f].Qa[0].sa[0],h=g.za;ja.jf(h,"STEPS_PER_PASS",k);ja.Yc(h);U.Tc(d[f],g)}c.Aa=!0};a.CI=function(a){var b=Y(a,U.wt);a=Y(a,U.qp);
if(!b||!a)return null;var d={};d.key=b.Zt;d.edge_lum=b.Yt;d.blur=a.rn;return d};a.NL=ya;a.VI=function(a){a=Y(a,U.yp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.cM=oa;a.FJ=function(a){var b=ia(a);a=Ra.length(b);if(0==a)return null;var b=Ia.ne(Math.atan2(b[0],-b[1])),d={};d.wind_dir=b;d.wind_strength=a;return d};a.zY=
function(a){a.s.iC=!0};a.CJ=Z;a.BJ=function(a,b){var d=a.s.Nc,c=Y(a,U.Pb);c&&d&&(b.waves_height=d.waves_height,b.waves_length=d.waves_length,c.pi&&(b.water_fog_density=c.pi[3],d=b.water_fog_color=[],d[0]=c.pi[0],d[1]=c.pi[1],d[2]=c.pi[2]))};a.sM=function(a,b){var d=a.s.Nc;if(!d)return Fa.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(d.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(d.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(d.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(d.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(d.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(d.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(d.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(d.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(d.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(d.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(d.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(d.Sq=b.water_dynamic);for(var c=L(a,fb),e=0;e<c.length;e++){var f=c[e];"number"==typeof b.water_fog_density&&d.Ae&&(f.pi[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&d.Ae&&f.pi.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.rE=b.waves_height);"number"==typeof b.waves_length&&(f.sE=b.waves_length);f.Aa=!0}};a.pJ=
function(a,b,d){var c=a.s.Nc;if(!c.Ik)return 100;var e=c.WB;a=c.bl;var f=(b[0]-c.Lo[0])/c.Mo[0],k=(c.Lo[1]+b[1])/c.Mo[1],f=f+.5,k=k+.5;if(1<f||0>f||1<k||0>k)b=1;else return c=e*Ia.AI(wb.s.vD,c.wD,f,k),b=(a-b[2])*d,b=Math.sqrt(c*c+b*b)};a.update=function(a,b){for(var d=c().Cj.k,e=0;e<Sa.length;e++){var f=Sa[e],k=f.s.Wa,g=f.s;if(g.Nc)var h=sa.F(d.n),n=h[2]-Z(f,h[0],h[1]);for(h=0;h<g.mp.length;h++){var l=g.mp[h].s,v=l.Sa,m=l.wd;if(!(f.b4w_use_nla&&l.Vk||!v&&!m)&&La.fO(l)){var r=La.cO(l),t=La.eO(l);v&&
za.is_mobile_device&&(t-=5);var p=La.n0(l);r>=p&&l.uj||r<t?(La.DL(l),m&&(l.Fk=La.Gw(l,a))):r>=p&&!l.uj?La.xC(l):La.gO(l)&&(v?La.KN(l):(v=La.Gw(l,a),v!=l.Fk&&(La.JN(l),l.lj++),l.Fk=v))}}la.pa(k,function(b,d){-1<sb.indexOf(d.type)&&(d.time=a);g.Nc&&(d.Mz=n)})}for(e=0;e<Sa.length;e++)if(f=Sa[e],g=f.s,k=g.Wa,d=g.Em,d.length)for(g.aw&&(X(f),g.aw=!1),g.iC&&(ka(f),g.iC=!1),g.jC&&(H(f),g.jC=!1),g.motion_blur&&C(k,b),f=da.ic(k,U.Ag),h=0;h<d.length;h++)k=d[h],Za.uw(k),f&&fa(k,f),Na.Gn(k);za.show_hud_debug_info&&
ua.tZ(Sa,b)};a.pY=function(a){a.s.jC=!0};a.WA=function(a){var b=[];la.pa(a.s.Wa,function(a,d){b.push(d)});return b};a.EI=function(){var a=Y(wb,U.Qc),b=wb;return a||b.s.Nc?a.Mz:null};a.IN=function(a){la.pa(a.s.Wa,function(a,b){b.Aa=!0})};a.HY=function(a,b){a.debug_view_mode=b;a.dc=b!=Ba.jt;a.Lb=b==Ba.kt;a.Aa=!0;for(var d=c(),e=0;e<fb.length;e++){var f=Y(d,fb[e]);f&&(f.GA=b==Ba.xp)}};a.GY=function(a,b){a.debug_colors_seed=b;a.Aa=!0};a.cZ=function(a,b){a.KH=b;a.Aa=!0};a.lZ=function(a,b){for(var d=a.Qa,
c=0;c<d.length;c++)for(var e=d[c].sa,f=0;f<e.length;f++){var k=e[f].za;Ra.copy(b,k.wireframe_edge_color);k.Aa=!0}};a.EN=function(a,b){var d=b.Kn,c=a.s.yj;if(d&&"WIND"==d.type&&c){var e=sa.N(b.k.n);Ra.transformQuat(Ia.Oc,e,c);Ra.normalize(c,c);Ra.scale(c,d.XM,c);d=L(a,sb);for(e=0;e<d.length;e++)d[e].yj.set(c);return!0}return!1};a.KX=function(a,b,d){var c=Y(a,U.sf);if(c){var e=Ca.Qi();ta.FY(c.p,b,d,e.clientWidth,e.clientHeight);Za.uw(c);c.dc&&Na.Gn(c);if(a=Y(a,U.si))Pa.copy(c.p.xb,a.p.xb),Pa.copy(c.p.md,
a.p.md),Ia.In(a.p.md,a.p.Lh),Za.uw(a),a.dc&&Na.Gn(a);if(c.dc||a&&a.dc)return Na.NC(a?a.p.$e:c.p.$e,0,0)}else Fa.error("Object Selection is not available on the scene");return null};a.iM=function(a){var b=c();if(b=Y(b,U.gn))b.ij.set(a),b.Aa=!0};a.f6=ia;a.Tu=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.DN=function(a,b){var d=mb;Ra.negate(b,d);for(var c=0;6>c;c++){var e=a.Kl[c],f=a.Iq[c],k=a.p;Pa.translate(Ia.AO[c],
d,e);Pa.multiply(k.xb,e,k.md);Ia.In(k.md,f)}};a.GN=function(a,b,d){Ia.h_(b,d,Ia.Oc,a.p.qc)};a.qR=function(a,b,d){var c=a.s.xd,e=a.s.ai;d=Aa.Xu(d,za.ssao&&a.b4w_enable_ssao);if(e)for(var f=0;f<b.length;f++){var k=b[f],g=Aa.ka(k,a);if(-1!=k.k.Ed){var h=e.Yh,n=e.rw,k=k.k.Ed;n.length?g.Yh=n[k]:h.length&&(g.Yh=h[k])}else-1!=k.k.Rd&&(h=e.Hi,n=e.tA,k=k.k.Rd,n.length?g.Hi=n[k]:h.length&&(g.Hi=h[k]))}for(f=0;f<d.length;f++)if(g=Aa.ka(d[f],a),c)for(b=L(a,[U.dd]),e=0;e<b.length;e++)f==b[e].nh&&g.uD.push(b[e])};
a.zK=function(a,b){return a.timeline_markers[b]};a.Mw=function(a){var b=c();if(b=Y(b,U.wi))a.distortion_coefs&&(b.Ol[0]=a.distortion_coefs[0],b.Ol[1]=a.distortion_coefs[1],b.Aa=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Aa=!0),a.base_line_factor&&(b.Ol[2]=
a.base_line_factor,b.Aa=!0),a.inter_lens_factor&&(b.Ol[3]=a.inter_lens_factor,b.Aa=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Aa=!0)};a.HK=function(b,d){for(var c=Sa,e=0;e<c.length;e++)da.vX(a.dB(c[e]),b,d)};a.q_=function(a){for(var b=Qa.Vb(a,"LAMP",Qa.nc),d=L(a,eb),c=0;c<d.length;c++)for(var e=d[c],f=e.Qa,k=0;k<f.length;k++)for(var g=f[k].sa,h=0;h<g.length;h++){var n=g[h],l=n.za;"MAIN"==l.type&&(ja.u_(l,b,a),ja.Yc(l),U.Tc(e,n))}};a.E7=function(a){for(var b=0;b<Sa.length;b++)la.pa(Sa[b].s.Wa,
function(b,d){for(var c=d.Qa,e=0;e<c.length;e++)for(var f=c[e].sa,k=0;k<f.length;k++){var g=f[k];g.za==a&&U.Tc(d,g)}})}};b4w.module.__hud=function(a,m){function l(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var c=0,k=0,n=0;h.pa(a.s.Wa,function(a,h){if(h.type!=z.ln){for(var l=Math.round(h.p.width)+"x"+Math.round(h.p.height),m=0,p=0;p<h.Qa.length;p++)m+=h.Qa[p].sa.length;p=h.Kq;if(h.type==z.nd||h.type==z.Pe)m*=6;var u=h.dc,q=u?h.Af:0;h.Vd||(h.Af=0);var x=
u?" (\u2713)":" (\u2715)",d=z.GD(h);b(x,d,h.ew,l,p,"of",m,"  ",q.toFixed(3));h.Kq=0;u&&(c+=m,k+=p,n+=q)}});return[c,k,n]}b("No INFO")}function b(){for(var a=80+20*k[0],b=arguments[0],c=1;c<arguments.length;c++){for(var h="",l=0;l<p[c]-String(arguments[c]).length;l++)h+=" ";b+=h+arguments[c]}k[0]++;n.fillText(b,30,a)}function x(a,b,c){b*=a.tc;c.x=a.x+b;c.y=a.y;c.tc=a.tc-2*b;c.Ib=a.Ib}function q(a){return a.x+a.tc/2}function A(a){var b=n,c={x:0,y:0,tc:0,Ib:0},k=b.canvas.width,b=b.canvas.height;c.x=
0;c.y=0;c.tc=k;c.Ib=b;x(c,.01,c);k=.02*c.Ib;c.x=c.x;c.y+=k;c.tc=c.tc;c.Ib-=2*k;k=c.tc/8;c.x+=k*a;c.y=c.y;c.tc=k;c.Ib=c.Ib;x(c,.02,c);return c}var h=m("__graph");m("__print");var z=m("__subscene"),p=[5,30,4,10,5,3,5],n=null,k=[0,0];a.Vg=function(a){a=a.getContext("2d");l(a);return n=a};a.Ks=function(){n&&l(n)};a.reset=function(){var a=n;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),k[0]=0,k[1]=0)};a.tZ=function(a,e){var h=
n;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));k[0]++;for(var l=h=0,m=0,p=0;p<a.length;p++){var q=c(a[p]),h=h+q[0],l=l+q[1],m=m+q[2];k[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",l,"of",h,"  ",m.toFixed(3))}};a.print=function(){var a=n;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.D7=function(a,b,c,k,h,l,m){var p=n;if(p){b=A(b);var z=b.Ib/5;b.x=b.x;b.y+=4*z;b.tc=
b.tc;b.Ib=z;p.textAlign="center";p.fillStyle="#00FF00";n.fillText(a,q(b),b.y-10);p.strokeStyle="#00FF00";p.lineWidth=.5;p.beginPath();p.moveTo(b.x,b.y);p.lineTo(b.x+b.tc,b.y);p.lineTo(b.x+b.tc,b.y+b.Ib);p.lineTo(b.x,b.y+b.Ib);p.closePath();p.stroke();if(!l&&!m)for(l=1E6,m=-1E6,a=0;a<c.length;a++)l=Math.min(l,c[a]),m=Math.max(m,c[a]);p.textAlign="right";n.fillText(String(l),b.x-10,b.y+b.Ib);n.fillText(String(m),b.x-10,b.y);p.textAlign="center";n.fillText(String(k),b.x,b.y+b.Ib+15);n.fillText(String(h),
b.x+b.tc,b.y+b.Ib+15);p.strokeStyle="#FF0000";p.lineWidth=1.5;p.beginPath();k=b.tc/(c.length-1);m=b.Ib/(m-l);for(a=0;a<c.length;a++)h=b.x+k*a,z=b.y+b.Ib-(c[a]-l)*m,0==a?p.moveTo(h,z):p.lineTo(h,z);p.stroke()}};a.O3=function(a,b,c,k,h,l,m){var p=n;if(p)for(p.textAlign="center",p.fillStyle="#00FF00",p.font="bold 12px Courier",c=A(c),n.fillText(b?"["+a+"]":a,q(c),c.y),0<=l&&n.fillText(l?"[M]":"[ ]",q(c)-15,c.y+30),0<=m&&n.fillText(m?"[S]":"[ ]",q(c)+15,c.y+30),a={x:0,y:0,tc:0,Ib:0},b=0;b<k.length;b++){l=
k[b];var z="VOLUME"==l[0];if(z){m=c.y+350;var I=c.tc,B=a;B.x=c.x;B.y=m;B.tc=I;B.Ib=250}else{m=c.y+50+50*b;var I=c.tc,B=c.Ib,x=a;x.x=c.x;x.y=m;x.tc=I;x.Ib=B}m=p;var I=a,x=b==h,d=l[0],B=l[1],f=l[2],r=l[3],g=(r-f)/l[4],g=1>g?Math.floor(1/g-1E-5).toFixed(0).length:0;l=l[5]?Math.log(B/f)/Math.log(r/f):(B-f)/(r-f);m.textAlign="center";x?m.fillText("["+d+"]",q(I),I.y):m.fillText(d,q(I),I.y);m.strokeStyle="#00FF00";m.lineWidth=z?3:1;z?(m.textAlign="right",m.fillText(r.toFixed(g),q(I)-10,I.y+15),m.textAlign=
"right",m.fillText(f.toFixed(g),q(I)-10,I.y+I.Ib-15)):(m.textAlign="right",m.fillText(f.toFixed(g),I.x+28,I.y+15),m.textAlign="left",m.fillText(r.toFixed(g),I.x+I.tc-28,I.y+15));m.beginPath();if(z){var Q=I.y+15+(I.Ib-30)*(1-l);m.moveTo(q(I),I.y+15);m.lineTo(q(I),I.y+I.Ib-15);m.moveTo(q(I)-5,I.y+15);m.lineTo(q(I)+5,I.y+15);m.moveTo(q(I)-5,I.y+I.Ib-15);m.lineTo(q(I)+5,I.y+I.Ib-15);m.moveTo(q(I)-5,Q);m.lineTo(q(I)+5,Q)}else{var t=I.x+30+(I.tc-60)*l;m.moveTo(I.x+30,I.y+15);m.lineTo(I.x+I.tc-30,I.y+15);
m.moveTo(I.x+30,I.y+15-5);m.lineTo(I.x+30,I.y+15+5);m.moveTo(I.x+I.tc-30,I.y+15-5);m.lineTo(I.x+I.tc-30,I.y+15+5);m.moveTo(t,I.y+15-5);m.lineTo(t,I.y+15+5)}m.stroke();"EQ_Q"==d?(l=Math.log(1+1/(2*B*B)+Math.sqrt((2+1/(B*B))*(2+1/(B*B))/4-1))/Math.log(2),z?(m.textAlign="left",m.fillText(B.toFixed(g),q(I)+10,Q),m.textAlign="left",m.fillText("("+l.toFixed(g+1)+")",q(I)+10,Q+10)):(m.textAlign="right",m.fillText(B.toFixed(g),t,I.y+30),m.textAlign="left",m.fillText("("+l.toFixed(g+1)+")",t,I.y+30))):z?(m.textAlign=
"left",m.fillText(B.toFixed(g),q(I)+10,Q)):(m.textAlign="center",m.fillText(B.toFixed(g),t,I.y+30))}}};b4w.module.__subscene=function(a,m){function l(a,b){a.ew=b;a.OB=new Float32Array(3*b);a.Jr=new Float32Array(4*b);a.Ir=new Float32Array(4*b)}function c(a){a={type:a,Fb:"",Lb:!1,YK:!1,vz:!1,$v:!1,Kq:0,Af:0,Ll:[],debug_view_mode:0,debug_colors_seed:0,KH:1,GA:!1,time:0,p:null,Kl:null,Iq:[],Qa:[],Ya:[],ki:[],yj:new Float32Array(3),ie:new Float32Array(3),Ae:new Float32Array(4),ag:new Float32Array(4),ye:new Float32Array(16),bx:0,Pg:0,ew:0,OB:null,Jr:null,Ir:null,X6:null,je:new Float32Array(3),te:new Float32Array(3),
cx:new Float32Array(4),bN:new Float32Array(3),HD:new Float32Array([0,0,1]),cN:new Float32Array(4),ax:new Float32Array(3),Tr:0,IA:0,zr:!1,ij:new Float32Array(3),xj:!1,Mz:0,pi:null,rE:0,sE:0,bl:0,Nc:null,Ig:!1,EG:0,FG:new Float32Array(2),DG:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Oo:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,To:0,So:0,Ro:0,RM:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,io:0,zw:0,Xo:0,sA:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,xx:null,wx:null,mE:null,zm:null,yc:!1,lI:"",Zt:0,rn:0,Yt:0,Az:0,NA:0,mb_decay_threshold:0,mb_factor:0,FK:0,tw:"",$G:"",BW:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,RD:new Float32Array(2),Gb:new Float32Array(2),
Ol:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,nh:0,hC:!0,GM:!1,LM:!1,HM:!1,IM:!1,KM:!1,JM:!1,FM:"",Ss:!1,Ts:!1,Us:!1,dc:!0,Vd:!0,wb:!0,Bb:!0,Td:!0,Aa:!0,ug:1};a.Gb[0]=1;a.Gb[1]=1;a.Ol[2]=.5;a.Ol[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function x(a,c){return-b(a.Cg,c.Cg)||b(a.mg,c.mg)||b(a.zb.tD,c.zb.tD)}var q=m("__camera"),A=m("__config"),h=m("__util"),z=m("__boundings"),p=A.Wc;a.Pb=0;a.Qc=1;a.Sf=2;a.Nd=3;a.nd=4;a.vf=5;a.Pe=6;a.ge=7;a.dd=
8;a.wf=9;a.ui=10;a.hc=11;a.rp=12;a.yp=13;a.kn=14;a.sf=15;a.si=16;a.uf=17;a.cn=18;a.GE=19;a.Et=20;a.fz=21;a.yE=22;a.Ip=23;a.Ct=24;a.dz=25;a.Dt=26;a.Vx=27;a.vh=28;a.Ux=29;a.wp=30;a.Ag=31;a.gn=32;a.Bj=33;a.rt=34;a.Bg=35;a.Wx=36;a.wi=37;a.LUMINANCE=38;a.oO=39;a.wt=40;a.qp=41;a.sQ=42;a.ln=43;a.Ep=44;a.GT=function(a,b,m,e){var p=c(8);p.sA=a;p.self_shadow_polygon_offset=m.self_shadow_polygon_offset;p.nh=b;switch(m.Zg[b]){case "SPOT":case "POINT":p.p=q.hd(q.Od);a=h.ne(m.QM[b]);q.Lw(p.p,a,m.qq[b],m.pq[b]);
break;default:p.p=q.hd(q.xi)}l(p,e);return p};a.GS=function(a){var b=a.p;a.p=null;var c=h.R(a);a.p=b;c.p=q.Jc(b,!0);return c};a.zT=function(){var a=c(10);a.p=q.hd(q.xh);return a};a.Ad=function(a){var b=c(11);b.wb=!1;b.Bb=!1;b.Td=!1;b.yc=!0;b.p=q.hd(q.qd);b.tw=a;switch(a){case "NONE":b.Gb[0]=1;b.Gb[1]=1;break;case "GRAYSCALE":b.Gb[0]=1;b.Gb[1]=1;break;case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=0;b.Gb[1]=1;break;case "X_GLOW_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_GLOW_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;case "X_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "Y_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "X_ALPHA_BLUR":b.Gb[0]=1;b.Gb[1]=0;b.ug=3;break;case "Y_ALPHA_BLUR":b.Gb[0]=0;b.Gb[1]=1;b.ug=3;break;case "X_EXTEND":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_EXTEND":b.Gb[0]=0;b.Gb[1]=1;break;default:h.q("Wrong postprocessing effect: "+a)}return b};a.vH=function(a){var b=c(12);b.wb=!1;b.Bb=!1;b.Td=!1;b.p=q.hd(q.qd);b.tw=a;b.yc=!0;switch(a){case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;default:h.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.xT=function(a,b){var h=c(13);h.wb=!1;h.Bb=!1;h.Td=!1;h.small_glow_mask_coeff=b.$j.small_glow_mask_coeff;h.large_glow_mask_coeff=b.$j.large_glow_mask_coeff;h.small_glow_mask_width=b.$j.small_glow_mask_width;h.large_glow_mask_width=b.$j.large_glow_mask_width;h.p=a;h.yc=!0;return h};a.Il=function(a,b,m,e,p,q,z,x,D){var A=c(a);0==a?(A.wb=!0,A.Bb=m,A.Lb=!1):1==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):2==a?(A.wb=!1,A.Bb=!0,A.Lb=
!0):3==a||4==a?(A.wb=!0,A.Bb=!0,A.Lb=!1):5==a||6==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):7==a?(A.wb=!0,A.Bb=!1,A.Lb=!0):h.q("wrong main subscene type");A.Lb&&x&&(A.self_shadow_normal_offset=x.self_shadow_normal_offset);A.p=b;if(a=z.Po)A.cx.set([a.sG,a.OJ,a.mO,a.lO]),A.ax.set(a.color),A.bx=a.Da;A.je.set(z.je);A.te.set(z.te);A.Pg=z.Pg;A.Ae=q.Ae;A.ag=q.ag;e&&(A.Nc=e,e.Ae&&(A.pi=new Float32Array(e.Ae)),A.rE=e.waves_height,A.sE=e.waves_length,A.bl=e.bl,e.Ig&&D&&(A.Ig=!0,A.EG=e.bS,A.DG=e.aS,A.FG.set(e.cS)));l(A,p);
return A};a.nu=function(){var a=c(14);a.yc=!0;a.p=q.hd(q.qd);return a};a.wH=function(a,b,h){var e=c(15);b&&(e.type=16,e.wb=!1,e.Bb=!0);e.Vd=!1;e.p=a;l(e,h);return e};a.vT=function(a){var b=c(17);b.dc=!1;b.wb=!1;b.Bb=!1;b.p=a;return b};a.rT=function(a){var b=c(18);b.wb=!0;b.Bb=!1;b.p=a;return b};a.HT=function(a,b){var h=c(9);h.p=a;l(h,b);return h};a.wT=function(a){var b=c(19);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.JT=function(a,b,h){var e=c(20);e.wb=!1;e.Bb=!1;e.Td=!1;e.p=a;e.Ae=b.Ae;e.pi=new Float32Array(b.Ae);
e.To=h.radius_increase;e.ssao_hemisphere=h.ZV;e.So=h.influence;e.Ro=h.dist_factor;e.RM=h.yY;e.yc=!0;return e};a.KT=function(a,b){var h=c(21);h.wb=!1;h.Bb=!1;h.Td=!1;h.p=a;h.ssao_blur_depth=b.FR;h.ssao_blur_discard_value=b.vG;h.yc=!0;return h};a.qT=function(a){var b=c(22);b.wb=!1;b.Bb=!1;b.Td=!1;b.ug=1/a.Ao;b.lI=a.FF;b.p=q.hd(q.qd);b.yc=!0;return b};a.pA=function(a,b){var h=c(a);h.wb=23==a||24==a?!0:!1;h.Bb=!1;h.Td=!1;h.ug=1/b.Ao;h.p=q.hd(q.qd);23==a&&(h.DW=new Float32Array(4));h.yc=!0;return h};a.uT=
function(a,b,h,e){var l=c(27);l.wb=!1;l.Bb=!1;l.Td=!1;l.p=q.hd(q.qd);l.brightness=a;l.contrast=b;l.exposure=h;l.saturation=e;l.yc=!0;return l};a.CT=function(a,b){var h=c(28);h.wb=!1;h.Bb=!1;h.Td=!1;h.p=q.hd(q.qd);h.vz=!0;h.mb_decay_threshold=a;h.mb_factor=b;h.yc=!0;return h};a.mA=function(a,b){var h=c(29);h.wb=!1;h.Bb=!1;h.Td=!1;h.p=a;h.ug=h.p.dof_power;h.$G=b;h.yc=!0;return h};a.xH=function(a){var b=c(30);b.wb=!1;b.Bb=!1;b.Td=!1;b.p=a;b.ug=b.p.dof_power;b.yc=!0;return b};a.ET=function(a,b){var h=
c(31);h.Td=!1;h.p=a;l(h,b);return h};a.DT=function(a){var b=c(32);p.outlining_overview_mode?b.ij.set(p.ij):b.ij.set(a.ij);b.Tr=a.Tr;b.NA=5;b.Az=3;b.Td=!1;b.p=q.hd(q.qd);b.yc=!0;return b};a.oA=function(a,b,h,e,m,p,q){var z=c(33);z.wb=!1;z.Bb=!1;z.Td=!1;z.je=new Float32Array([1,1,1]);z.te=new Float32Array([1,1,1]);z.Pg=1;z.YK=e;z.xj=b;z.zw=m;z.io=h;z.Xo=q;z.p=a;l(z,p);return z};a.yT=function(a,b){var h=c(34);h.wb=!1;h.Bb=!1;h.Td=!1;h.p=q.hd(q.qd);h.god_rays_intensity=a;l(h,b);h.yc=!0;return h};a.IT=
function(a,b,m,e){var p=c(35);p.Vd=!1;p.wb=!1;p.Bb=!1;p.Td=!1;var z=q.hd(q.qd);z.width=e;z.height=e;p.p=z;p.Kl=h.$U();l(p,b);p.je=new Float32Array([1,1,1]);p.te=new Float32Array([1,1,1]);p.Pg=1;p.Oo.set(m.Oo);p.procedural_skydome=m.procedural_skydome;p.use_as_environment_lighting=m.use_as_environment_lighting;p.rayleigh_brightness=m.rayleigh_brightness;p.mie_brightness=m.mie_brightness;p.spot_brightness=m.spot_brightness;p.scatter_strength=m.scatter_strength;p.rayleigh_strength=m.rayleigh_strength;
p.mie_strength=m.mie_strength;p.rayleigh_collection_power=m.rayleigh_collection_power;p.mie_collection_power=m.mie_collection_power;p.mie_distribution=m.mie_distribution;if(a){p.je.set(a.je);p.te.set(a.te);p.Pg=a.Pg;if(b=a.Po)p.cx.set([b.sG,b.OJ,b.mO,b.lO]),p.ax.set(b.color),p.bx=b.Da,p.GM=b.invert,p.LM=b.SN,p.HM=b.NN,p.IM=b.ON,p.KM=b.QN,p.JM=b.PN,p.FM=b.tG;p.Ss=a.Ss;p.Ts=a.Ts;p.Us=a.Us}return p};a.nA=function(){var a=c(36);a.wb=!1;a.Bb=!1;a.p=q.hd(q.qd);a.yc=!0;return a};a.LT=function(a){var b=c(37);
b.wb=!1;b.Bb=!1;b.Fb=a?"HMD":"ANAGLYPH";b.p=q.hd(q.qd);b.yc=!0;return b};a.AT=function(){var a=c(38);a.wb=!1;a.Bb=!1;a.p=q.hd(q.qd);a.yc=!0;return a};a.sT=function(){var a=c(39);a.wb=!1;a.Bb=!1;a.p=q.hd(q.qd);a.yc=!0;return a};a.BT=function(a,b,h,e){var m=c(40);m.wb=!1;m.Bb=!1;m.Zt=a;m.Yt=b;m.p=e;l(m,h);m.yc=!0;return m};a.tT=function(a){var b=c(41);b.wb=!1;b.Bb=!1;b.p=q.hd(q.qd);b.rn=a;b.yc=!0;return b};a.B3=function(a){var b=c(42);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.yH=function(){var a=c(43);
a.Vd=!1;return a};a.FT=function(){var a=c(44);a.yc=!0;return a};a.GD=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.tw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Tc=function(a,b){for(var c=b.za,e=c.zb,h=0;h<a.Qa.length;h++){var l=a.Qa[h].sa,m=l.indexOf(b);
-1!=m&&(l.splice(m,1),l.length||a.Qa.splice(h,1))}h=a.Lb?c.mg:0;a:{l=a.Qa;for(m=0;m<l.length;m++){var p=l[m];if(p.zb==e&&h==p.mg){l=p;break a}}l=null}l?l.sa.push(b):(a.Qa.push({zb:e,sa:[b],Cg:c.Cg,mg:h,dc:!0}),a.hC=!0)};a.Rh=function(a,b){var c={dc:!0,HA:[!0,!0,!0,!0,!0,!0],gf:b,za:a,vv:null};if(a.rf&&a.Ba.ke){var e=a.Ba.ke;c.vv={qX:new Float32Array(e.length),rX:new Float32Array(e.length),dU:new Float32Array(e.length/3),nO:new Float32Array(3),zR:z.RR(a.P)}}return c};a.AZ=function(a){a.Qa.sort(x);
a.hC=!1}};b4w.module.__input=function(a,m){function l(a){var b=T.Cn();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!l(a))return null;var d={type:a,kh:!1,ng:[],fh:[],aj:[],be:[],bj:[],cj:[],Er:[],kK:[],Xi:[],tj:[],sj:[],rj:[],element:b,Zh:!0,Yb:[],Zv:new Float32Array(2),uX:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),op:null,qi:null,Rf:null,orientation:ma.create(),position:O.create(),
Li:new Float32Array(4),Mi:new Float32Array(4),Vi:0,Ij:0,Ck:0,an:0,bk:0,Jj:0,Xl:[],Zj:[0,0,0,0,0,0,0,0,0,0,0,0],mI:[0,0,0,0,0,0,0,0,0,0,0,0],Nu:[]};d.Li[0]=d.Li[1]=d.Li[2]=d.Li[3]=45;d.Mi[0]=d.Mi[1]=d.Mi[2]=d.Mi[3]=45;30==a||40==a||50==a?(d.kh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(d.Zh=!1)):10==a?d.kh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ga.is_mobile_device?q(d,v.webvr):(x(d),d.kh=!0));return d}function b(b,d){10==b||20==b?d=window:d||
(d=40==b?document:S.af());for(var e=0;e<oa.length;e++)if(oa[e].type==b&&oa[e].element==d)return oa[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.Nu.push(a.qy,a.ry,a.Cy,a.Jy,a.Ky,a.Ly,a.pt,a.qt,a.My,a.Ny,a.sy,a.ty,a.uy,a.vy,a.wy,a.xy,a.yy,a.zy,a.Ay,a.By,a.Dy,a.Ey,a.Fy,a.Gy,a.Hy,a.Iy,a.lt,a.mt,a.nt,a.ot,a.ky,a.ly,a.my,a.ny,a.oy,a.py,a.iy,a.jy);e&&oa.push(e);return e}function x(a){var b=v.nonwebvr;a.an=b.an;a.bk=b.bk;a.Jj=b.Jj;q(a,b);a.Vi=b.Vi;a.Ij=b.Ij;a.Ck=b.Ck;h(a)}function q(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function A(a,b){var d=b*b;return b*(1+a[0]*d+a[1]*d*d)}function h(a){var b=a.Ij-a.Jj,d=a.bk-b,c=a.Vi/2,e=(a.an-a.Vi)/2,b=W.ne(Math.atan(b/a.Ck)),d=W.ne(Math.atan(d/a.Ck)),c=W.ne(Math.atan(c/
a.Ck)),e=W.ne(Math.atan(e/a.Ck));d&&(a.Li[0]=a.Mi[0]=Math.min(d,60));c&&(a.Li[1]=a.Mi[3]=Math.min(c,60));b&&(a.Li[2]=a.Mi[2]=Math.min(b,60));e&&(a.Li[3]=a.Mi[1]=Math.min(e,60))}function z(a,b){var d=b.filter(function(a){return a instanceof HMDVRDevice}),c=null;d.length&&(c=d[0]);d=null;c&&(d=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==c.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.op=c;a.qi=d}function p(a,b,d){switch(a.type){case 20:var c=
a.Rf||a.op;c?(b=c.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,c=A(a,Math.tan(W.Cb(b.downDegrees))),W.ne(Math.atan(c)),c=A(a,Math.tan(W.Cb(b.upDegrees))),W.ne(Math.atan(c)),c=A(a,Math.tan(W.Cb(b.leftDegrees))),W.ne(Math.atan(c)),a=A(a,Math.tan(W.Cb(b.rightDegrees))),W.ne(Math.atan(a)),d[0]=b.upDegrees,d[1]=b.rightDegrees,d[2]=b.downDegrees,d[3]=b.leftDegrees):(b="left"==b?a.Li:a.Mi,V.copy(b,d));break;default:H.error("fov is undefined for device: ",a.type)}return d}
function n(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ga.is_mobile_device?1:0:2;case 23:var d=a.Rf||a.op;if(d){var c=d.getEyeParameters("left"),d=d.getEyeParameters("right");return a.Rf?d.offset[0]-c.offset[0]:d.eyeTranslation.x-c.eyeTranslation.x}return a.Vi}}function k(a,b){if(a.Rf){var d=a.Rf,c=d.capabilities,d=d.getPose();c.hasOrientation&&d.orientation&&(a.orientation[0]=d.orientation[0],a.orientation[1]=d.orientation[1],a.orientation[2]=d.orientation[2],a.orientation[3]=
d.orientation[3]);c.hasPosition&&d.position&&(a.position[0]=d.position[0],a.position[1]=-d.position[2],a.position[2]=d.position[1])}else 1<b-na&&(na=b,navigator.getVRDisplays?a.Rf||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Rf=b[0],a.kh=!0)},function(){H.O("WebVR displays are not found.");a.kh=!1}):navigator.getVRDevices?a.op||pa||navigator.getVRDevices().then(function(b){z(a,b);b.length&&(a.kh=!0);pa=!0},function(){H.O("WebVR devices are not found.");a.kh=!1;pa=!0}):ga.is_mobile_device||
H.O("HMD isn't supported."))}function u(a,b){if(a){for(var d=0;d<a.buttons.length;d++)b.Xl[d]=a.buttons[d].value;if(a.axes)for(d=0;d<a.axes.length;d++)b.Zj[d]=a.axes[d]}}function e(a){for(var b=0;b<a.Xl;b++)a.Xl[b]=0;for(b=0;b<a.Zj.length;b++)a.mI[b]=a.Zj[b],a.Zj[b]=0}function y(a,b){var d=a.indexOf(b);0<=d&&(a[d]=null)}function K(a){return null===a}function F(a,b,c,e){switch(b){case 120:c&&y(a.ng,c);if(e||a.fh.every(K)&&a.ng.every(K))a.ng.length=0,a.fh.length=0,b=a.Yb.indexOf(131),0<=b&&(a.Yb.splice(b,
1),a.element.removeEventListener("deviceorientation",D,!1));break;case 130:c&&y(a.fh,c);if(e||a.fh.every(K)&&a.ng.every(K))a.ng.length=0,a.fh.length=0,b=a.Yb.indexOf(131),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:c&&y(a.aj,c);if(e||a.aj.every(K))a.aj.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("mousedown",B,!1));break;case 30:c&&y(a.be,c);if(e||a.be.every(K))a.be.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,
1),a.element.removeEventListener("mousemove",E,!1));break;case 31:c&&y(a.be,c);if(e||a.be.every(K))a.be.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("mousemove",I,!1));break;case 50:c&&y(a.bj,c);if(e||a.bj.every(K)){a.bj.length=0;b=a.Yb.indexOf(b);0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("mouseout",P,!1),a.element.removeEventListener("mouseup",d,!1));break}break;case 60:c&&y(a.cj,c);if(e||a.cj.every(K))a.cj.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,
1),a.element.removeEventListener("wheel",f,!1));break;case 80:c&&y(a.Er,c);if(e||a.Er.every(K))a.Er.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("keydown",r,!1));break;case 70:c&&y(a.Xi,c);if(e||a.Xi.every(K))a.Xi.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("keyup",g,!1));break;case 90:c&&y(a.tj,c);if(e||a.tj.every(K))a.tj.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("touchstart",Q,!1));break;
case 100:c&&y(a.sj,c);if(e||a.sj.every(K))a.sj.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("touchmove",t,!1));break;case 110:if(c&&y(a.rj,c),e||a.rj.every(K))a.rj.length=0,b=a.Yb.indexOf(b),0<=b&&(a.Yb.splice(b,1),a.element.removeEventListener("touchend",aa,!1))}}function J(a,b){W.pC(a,W.iz,b);var d="orientation"in window?W.Cb(window.orientation):"orientation"in window.screen?W.Cb(window.screen.orientation.angle):0,d=ma.setAxisAngle(W.ad,d,ea);ma.multiply(b,d,
b);return b}function D(a){var d=ca;null===a.alpha||null===a.beta||null===a.gamma?d[0]=d[1]=d[2]=0:(d[0]=W.Cb(a.alpha),d[1]=W.Cb(a.beta),d[2]=W.Cb(a.gamma));a=b(10,a.currentTarget);for(var c=0;c<a.fh.length;c++){var e=a.fh[c];e&&(O.copy(d,Y),e(Y))}if(a.ng.length)for(d=J(d,ba),c=0;c<a.ng.length;c++)if(e=a.ng[c])ma.copy(d,xa),e(xa);for(c=0;c<a.ng.length;c++)a.ng[c]||a.ng.splice(c,1);for(c=0;c<a.fh.length;c++)a.fh[c]||a.fh.splice(c,1)}function R(a,b){switch(a.type){case 30:a.Zv[0]=b.clientX,a.Zv[1]=b.clientY,
a.uX=b.which}}function E(a){if(!ya||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var d=b(30,a.currentTarget);R(d,a);for(var c=0;c<d.be.length;c++){var e=d.be[c];e&&(L[0]=a.clientX,L[1]=a.clientY,e(L))}d.Zh&&a.preventDefault();for(c=0;c<d.be.length;c++)d.be[c]||d.be.splice(c,1)}}function I(a){if(!ya||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var d=b(30,a.currentTarget);R(d,a);for(var c=0;c<d.be.length;c++){var e=d.be[c];
if(e){if("number"==typeof a.movementX)var f=a.movementX,g=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,g=a.mozMovementY):g=f=0;L[0]=f;L[1]=g;e(L)}}d.Zh&&a.preventDefault();for(c=0;c<d.be.length;c++)d.be[c]||d.be.splice(c,1)}}function B(a){if(!ya||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var d=b(30,a.currentTarget);R(d,a);for(var c=0;c<d.aj.length;c++){var e=
d.aj[c];e&&e(a.which)}d.Zh&&a.preventDefault();for(c=0;c<d.aj.length;c++)d.aj[c]||d.aj.splice(c,1)}}function P(a){!S.ZJ(a.relatedTarget)&&a.which&&d(a)}function d(a){if(!ya||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var d=b(30,a.currentTarget);R(d,a);for(var c=0;c<d.bj.length;c++){var e=d.bj[c];e&&e(a.which)}d.Zh&&a.preventDefault();for(c=0;c<d.bj.length;c++)d.bj[c]||d.bj.splice(c,1)}}function f(a){for(var d=b(30,a.currentTarget),c=0;c<d.cj.length;c++){var e=
d.cj[c];e&&e(-a.deltaY)}d.Zh&&a.preventDefault();for(c=0;c<d.cj.length;c++)d.cj[c]||d.cj.splice(c,1)}function r(a){for(var d=b(40,a.currentTarget),c=a.ctrlKey||a.altKey||a.metaKey?d.kK:d.Er,e=0;e<c.length;e++){var f=c[e];f?f(a.keyCode):c.splice(e--,1)}d.Zh&&a.preventDefault()}function g(a){for(var d=b(40,a.currentTarget),c=0;c<d.Xi.length;c++){var e=d.Xi[c];e&&e(a.keyCode)}d.Zh&&a.preventDefault();for(c=0;c<d.Xi.length;c++)d.Xi[c]||d.Xi.splice(c,1)}function Q(a){for(var d=b(50,a.currentTarget),c=
0;c<d.tj.length;c++){var e=d.tj[c];e&&e(a.targetTouches)}for(c=0;c<d.tj.length;c++)d.tj[c]||d.tj.splice(c,1)}function t(a){for(var d=b(50,a.currentTarget),c=0;c<d.sj.length;c++){var e=d.sj[c];e&&e(a.targetTouches)}d.Zh&&a.preventDefault();for(c=0;c<d.sj.length;c++)d.sj[c]||d.sj.splice(c,1)}function aa(a){for(var d=b(50,a.currentTarget),c=0;c<d.rj.length;c++){var e=d.rj[c];e&&e(a.targetTouches)}for(c=0;c<d.rj.length;c++)d.rj[c]||d.rj.splice(c,1)}function M(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function G(a){function b(){document.pointerLockElement===d||document.webkitPointerLockElement===d||document.mozPointerLockElement===d?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var d=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var c=d.requestPointerLock||d.webkitRequestPointerLock||d.mozRequestPointerLock;"function"===typeof c&&c.apply(d)}var T=m("__compat"),S=m("__container"),X=m("__config"),H=m("__print"),ma=m("__quat"),W=m("__util"),O=m("__vec3"),V=m("__vec4"),ga=X.B,v=X.$V;a.uh=10;a.Oe=20;a.bd=30;a.tp=40;a.yg=50;a.gt=60;a.$x=70;a.ay=80;a.by=90;a.IE=0;a.JE=1;a.HE=2;a.Vy=3;a.vt=0;a.tt=10;a.ut=20;a.tO=21;a.uO=22;a.Ry=23;a.Qy=24;a.Oy=25;a.Ty=26;a.Uy=27;a.Sy=28;
a.Py=29;a.vi=30;a.TE=31;a.fl=40;a.Cp=50;a.Dp=60;a.Ap=70;a.zp=80;a.ME=81;a.kl=90;a.Jp=100;a.jl=110;a.st=120;a.fn=130;a.qy=300;a.ry=301;a.Cy=302;a.Jy=303;a.Ky=304;a.Ly=305;a.pt=306;a.qt=307;a.My=308;a.Ny=309;a.sy=310;a.ty=311;a.uy=312;a.vy=313;a.wy=314;a.xy=315;a.yy=316;a.zy=317;a.Ay=318;a.By=319;a.Dy=320;a.Ey=321;a.Fy=322;a.Gy=323;a.Hy=324;a.Iy=325;a.lt=326;a.mt=327;a.nt=328;a.ot=329;a.ky=330;a.ly=331;a.my=332;a.ny=333;a.oy=334;a.py=335;a.iy=336;a.jy=337;var ba=ma.create(),ea=ma.create(),ca=O.create(),
na=-Infinity,pa=!1,L=new Float32Array(2);O.create();var Y=O.create(),xa=ma.create(),ya="ontouchstart"in document.documentElement,oa=[];a.Nz=l;a.ja=b;a.LD=function(a,b){a.Zh=b};a.UC=function(a){switch(a.type){case 20:if(a.kh)if(a.Rf)a.Rf.resetPose();else if(a.qi)for(var b=0;b<a.qi.length;b++)a.qi[b].resetSensor();break;default:H.error("reset_device() is undefined for device: ",a.type)}};a.Ti=function(a,b,d){switch(b){case 10:a:switch(a.type){case 20:O.copy(W.jn,d);if(a.Rf)d[0]=a.orientation[0],d[1]=
a.orientation[1],d[2]=a.orientation[2],d[3]=a.orientation[3];else if(a.qi)for(b=0;b<a.qi.length;b++){var c=a.qi[b],c=c.getState&&c.getState()||c.getImmediateState&&c.getImmediateState();c.orientation&&(d[0]=c.orientation.x,d[1]=c.orientation.y,d[2]=c.orientation.z,d[3]=c.orientation.w)}ma.normalize(d,d);a=ma.setAxisAngle(W.ri,Math.PI/2,ea);ma.multiply(a,d,d);break a;default:H.error("orientation_quat is undefined for device: ",a.type)}return d;case 20:a:switch(a.type){case 20:O.copy(W.hz,d);if(a.Rf)d[0]=
a.position[0],d[1]=a.position[1],d[2]=a.position[2];else if(a.qi)for(b=0;b<a.qi.length;b++)c=a.qi[b],c=c.getState&&c.getState()||c.getImmediateState&&c.getImmediateState(),c.position&&(d[0]=c.position.x,d[1]=-c.position.z,d[2]=c.position.y);break a;default:H.error("position is undefined for device: ",a.type)}return d;case 21:return p(a,"left",d);case 22:return p(a,"right",d);case 30:case 31:return d[0]=a.Zv[0],d[1]=a.Zv[1],d}};a.Zu=n;a.dD=function(a,b,d){switch(a.type){case 20:if(3===n(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=d[0];a.distortion_coefs[1]=d[1];break;case 23:a.Vi=d;h(a);break;case 25:a.Ij=d;h(a);break;case 26:a.Ck=d;h(a);break;case 27:a.an=d;h(a);break;case 28:a.bk=d;h(a);break;case 29:a.Jj=d,h(a)}break;case 60:case 70:case 80:case 90:a.Nu[b]=d}};a.DV=function(a,b){var d=b-300;return d<a.Xl.length?a.Xl[a.Nu[d]-300]:!1};a.CV=function(a,b){return b-326<a.Zj.length?a.Zj[a.Nu[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],d=0;d<oa.length;d++){var c=oa[d];switch(c.type){case 60:e(c);u(b[0],c);break;case 70:e(c);u(b[1],c);break;case 80:e(c);u(b[2],c);break;case 90:e(c);u(b[3],c);break;case 20:k(c,a)}}};a.yd=function(a,b,c){switch(b){case 120:a.ng.push(c);b=131;break;case 130:a.fh.push(c);b=131;break;case 40:a.aj.push(c);break;case 30:case 31:a.be.push(c);break;case 50:a.bj.push(c);break;case 60:a.cj.push(c);break;case 80:a.Er.push(c);break;case 81:a.kK.push(c);b=80;break;case 70:a.Xi.push(c);
break;case 90:a.tj.push(c);break;case 100:a.sj.push(c);break;case 110:a.rj.push(c)}if(-1==a.Yb.indexOf(b)&&(a.Yb.push(b),a.kh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",B,!1);break;case 30:a.element.addEventListener("mousemove",E,!1);break;case 31:a.element.addEventListener("mousemove",I,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",P,!1),a.element.addEventListener("mouseup",
d,!1));break;case 60:a.element.addEventListener("wheel",f,!1);break;case 80:a.element.addEventListener("keydown",r,!1);break;case 70:a.element.addEventListener("keyup",g,!1);break;case 90:a.element.addEventListener("touchstart",Q,!1);break;case 100:a.element.addEventListener("touchmove",t,!1);break;case 110:a.element.addEventListener("touchend",aa,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.Bd=function(a,b,d){F(a,b,d,!1)};a.UV=J;a.ua=function(){for(var a=0;a<oa.length;a++)for(var b=
oa[a],d=0;d<b.Yb.length;d++)F(b,b.Yb[d],null,!0);oa.length=0};a.gJ=function(a){a=b(M(a));for(var d=0;d<a.Xl.length;d++)if(a.Xl[d])return d+300;return-1};a.ZI=function(a){a=b(M(a));for(var d=0;d<a.Zj.length;d++)if(a.mI[d]-a.Zj[d])return d+326;return-1};a.SI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.DJ=function(){var a=b(20);return a&&a.Rf};a.EQ=function(a){a.element.addEventListener("mousedown",
function(){a.value||G(a)},!1)}};b4w.module.__objects=function(a,m){function l(a){var b=a.I;a=a.k;for(var d=0;d<b.length;d++){var c=b[d].yb;c.s.outline&&a.gh&&Q.pY(c)}}function c(a){a.k.gh=0;a=ca.indexOf(a);-1!=a&&ca.splice(a,1)}function b(a){if(a.Kn)for(var b=a.I,d=0;d<b.length;d++)Q.EN(b[d].yb,a)}function x(a,b){for(var d=a.I,c=b.I,e=0;e<d.length;e++){for(var f=!1,g=0;g<c.length;g++)if(d[e].yb==c[g].yb){f=!0;break}f||q(b,d[e].yb)&&B.Sp(b,d[e].yb)}}function q(a,b){return!b.EF&&"SPEAKER"==a.type||!b.BQ&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function A(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.kz||a.parent&&a.parent.kz)return!0;switch(a.type){case "MESH":var d=a.b4w_do_not_batch,c=a.b4w_collision,e=a.b4w_vehicle,f=a.b4w_floating,g=a.b4w_character,k=P.XV(a),l=E.xG(a),n=0<a.data.b4w_shape_keys.length,m=a.b4w_dynamic_geometry;if(!(d=u.yG(a,b)||d||c||e||n||f||k||g||l||m))a:{d=a.data;for(c=0;c<d.materials.length;c++)if(e=d.materials[c],e.b4w_water||e.b4w_lens_flares||h(e.node_tree)){d=!0;break a}d=!1}return d;case "EMPTY":return d=
E.xG(a),c=a.b4w_do_not_batch,e=Boolean(a.b4w_anchor),u.yG(a,b)||d||c||e;default:return!0}}function h(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var d=a[b];if("VECT_TRANSFORM"==d.type){var c=d.convert_from,e=d.convert_to,f=d.outputs[0];if(!(!f.is_linked||"WORLD"==c&&"CAMERA"==e||"CAMERA"==c&&"WORLD"==e||"OBJECT"==c&&"OBJECT"==e))return!0}if("NORMAL_MAP"==d.type&&(c=d.space,f=d.outputs[0],f.is_linked&&("OBJECT"==c||"BLENDER_OBJECT"==c))||"TEX_COORD"==d.type&&d.outputs[3].is_linked||"OBJECT_INFO"==
d.type&&(f=d.outputs[1],c=d.outputs[3],d.outputs[0].is_linked||f.is_linked||c.is_linked))return!0}return!1}function z(a,b){var d=a.animation_data,c=a.data?a.data.animation_data:null;d&&d.action&&(d=d.action,(d.s.type==u.bz||d.s.type==u.az&&"ARMATURE"==b.type||d.s.type==u.uP&&"LAMP"==b.type||d.s.type==u.tP&&"WORLD"==b.type)&&b.Lg.push(u.UJ(null,d)));c&&c.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Lg.push(u.UJ(null,c.action));"MESH"==b.type&&b.Lg.push.apply(b.Lg,u.lV(a))}function p(a,b,d){b=V[b]||
[];for(var c=[],e=0;e<b.length;e++){var f=b[e];if(f.k.Ve==d||-1==d)for(var g=f.I,h=0;h<g.length;h++)g[h].yb==a&&c.push(f)}return c}function n(a,b,d,c,e){for(var f=null,g=0;g<b.length;g++){var h=b[g];if(!((d?h.wm:h.name)!=a||h.k.Ve!=c&&-1!=c||e&&!h.Lj||(f=h,B.Ri(f))))break}return f}function k(a){V.ALL.push(a);V[a.type]||(V[a.type]=[]);V[a.type].push(a);var b=a.k.Ed;if(null!=b)for(var d=0;d<ea.length;d++){var c=ea[d];c.k.Ed==b&&c.ks.push(a)}}var u=m("__animation"),e=m("__batch"),y=m("__boundings"),
K=m("__camera"),F=m("__config"),J=m("__constraints"),D=m("__geometry"),R=m("__lights"),E=m("__nla"),I=m("__nodemat"),B=m("__obj_util"),P=m("__particles"),d=m("__physics"),f=m("__print"),r=m("__primitives"),g=m("__quat"),Q=m("__scenes"),t=m("__sfx"),aa=m("__transform"),M=m("__textures"),G=m("__tsr"),T=m("__util"),S=m("__vec3"),X=m("__armature"),H=m("__anchors"),ma=m("__renderer"),W=F.B,O=F.Wc,V={ALL:[]},ga=new Float32Array(24),v=0,ba=0,ea=[],ca=[],na=new Float32Array(3),pa=new Float32Array(4);a.hy=
0;a.gy=1;a.Pc=2;a.nc=-1;a.update=function(a){for(var b=0;b<ca.length;b++){var d=ca[b],e=d,f=a,g=0,h=e.WK;0==h.lx&&(h.lx=f);f-=h.lx;if(h.PC&&f/h.Kf>=h.PC)c(e);else{f%=h.Kf;if(f<h.sC)switch(h=f/(h.sC/5),f=Math.floor(h),f){case 0:g=(h-f)/2;break;case 1:g=(h-f)/2+.5;break;case 2:g=1;break;case 3:g=1-(h-f)/2;break;case 4:g=.5-(h-f)/2}e.k.gh=g}d.k.gh&&l(d)}if(a=V.ARMATURE)for(b=0;b<a.length;b++)d=a[b],d.kC&&(aa.D(d),d.kC=!1)};a.Go=function(a,b){a.k.gh=b;l(a)};a.pn=function(a,b,d,c){var e=a.WK;e.lx=0;e.sC=
b;e.Kf=d;e.PC=c;-1==ca.indexOf(a)&&ca.push(a)};a.nq=c;a.Uk=function(a,b){b.vj=a.uuid;b.Lj=!0;z(a,b);a.kz=b.Ra=A(a,b);a.CQ=!0;b.bf=a.b4w_vehicle;b.fg=a.b4w_character;b.km=a.b4w_floating;b.Um=a.b4w_collision;b.cc=a.b4w_collision_id;b.iu=a.b4w_correct_bounding_offset;var d=a.game;b.hh={Yr:d.physics_type,Rs:d.use_ghost,TN:d.use_sleep,Vh:d.mass,ZN:d.velocity_min,YN:d.velocity_max,IH:d.damping,FL:d.rotation_damping,YW:d.lock_location_x,ZW:d.lock_location_y,$W:d.lock_location_z,aX:d.lock_rotation_x,bX:d.lock_rotation_y,
cX:d.lock_rotation_z,wq:d.collision_margin,uq:d.collision_group,xq:d.collision_mask,kE:d.use_collision_bounds,eu:d.collision_bounds_type,Ns:d.use_collision_compound};if(d=a.b4w_vehicle_settings)b.nf={name:d.name,hf:d.part,XZ:d.suspension_rest_length,ID:d.suspension_compression,KD:d.suspension_stiffness,JD:d.suspension_damping,vE:d.wheel_friction,ZC:d.roll_influence,XB:d.max_suspension_travel_cm,$q:d.force_max,gq:d.brake_max,Vo:d.steering_max,jo:d.max_speed_angle,Mq:d.delta_tach_angle,Es:d.speed_ratio,
Gs:d.steering_ratio,yr:d.inverse_control,Tl:d.floating_factor,Zm:d.water_lin_damp,$m:d.water_rot_damp,dN:d.synchronize_position};if(d=a.b4w_floating_settings)b.Ln={name:d.name,hf:d.part,Tl:d.floating_factor,Zm:d.water_lin_damp,$m:d.water_rot_damp,dN:d.synchronize_position};if(d=a.b4w_character_settings)b.KG={t0:d.walk_speed,xY:d.run_speed,QZ:d.step_height,FW:d.jump_strength,v0:d.waterline};for(d=0;d<a.constraints.length;d++){var c=a.constraints[d];"RIGID_BODY_JOINT"==c.type&&b.AC.push({target:c.target.pb,
LX:c.pivot_type,MX:c.pivot_x,NX:c.pivot_y,OX:c.pivot_z,Ga:c.axis_x,Ha:c.axis_y,Ia:c.axis_z,f0:c.use_limit_x,g0:c.use_limit_y,h0:c.use_limit_z,b0:c.use_angular_limit_x,c0:c.use_angular_limit_y,d0:c.use_angular_limit_z,PW:c.limit_max_x,QW:c.limit_max_y,RW:c.limit_max_z,SW:c.limit_min_x,TW:c.limit_min_y,UW:c.limit_min_z,JW:c.limit_angle_max_x,KW:c.limit_angle_max_y,LW:c.limit_angle_max_z,MW:c.limit_angle_min_x,NW:c.limit_angle_min_y,OW:c.limit_angle_min_z})}d=b.k=B.Gq("MESH"===b.type?b.Ra?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.pb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Vr=a.parent_bone),a.pinverse_tsr&&(b.qw=G.create(),G.copy(a.pinverse_tsr,b.qw))):a.dg_parent&&(b.parent=a.dg_parent.pb,b.wk=!0);var c=a.location,f=a.scale[0];T.IC(a.rotation_quaternion,pa);aa.Gc(b,c);aa.ei(b,pa);aa.Fe(b,f);b.Ps=a.b4w_use_default_animation;b.pl=u.pz(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Vv={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,P2:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.Fx={FQ:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":X.Uk(a,b);c=d.Fg;f=u.TR(c);a.b4w_animation_mixing?(d.me=new Float32Array(f.Eb),d.Ee=new Float32Array(f.Eb),d.se=new Float32Array(f.trans),d.Ie=new Float32Array(f.trans)):(d.me=f.Eb,d.Ee=f.Eb,d.se=f.trans,d.Ie=f.trans);for(var g in c){var h=c[g];1==h.du.length&&X.y_(h,!0,f.trans,f.Eb)}d.bs=f;d.Ze=0;d.zi=a.b4w_animation_mixing;break;case "MESH":d.En=a.b4w_do_not_render;
d.tl=e.yR(a.data.b4w_boundings.bb);d.Dk=O.outlining_overview_mode||a.b4w_selectable;d.iw=a.b4w_selectable;d.Wc=O.outlining_overview_mode||a.b4w_outlining;d.hw=a.b4w_outlining;d.jw=O.outlining_overview_mode||a.b4w_outline_on_select;d.Eg=a.b4w_billboard;d.aq=a.b4w_pres_glob_orientation;d.cq="BASIC";d.bq="SPHERICAL"==a.b4w_billboard_geometry;g=d.Xh;g.qk=a.b4w_outline_settings.outline_duration;g.rk=a.b4w_outline_settings.outline_period;g.tk=a.b4w_outline_settings.outline_relapses;d.Dk&&(d.Oj=T.oI(v),
v++);for(g=0;g<a.data.b4w_vertex_anim.length;g++)c=a.data.b4w_vertex_anim[g],b.Zc.push({name:c.name,va:c.frame_start,Za:c.frame_end,G2:c.averaging,H2:c.averaging_interval,GQ:c.allow_nla});b.k.Zc=b.Zc.length?!0:!1;"MESH"!=a.type&&T.q("Wrong object type: "+a.name);g=b.k;if(a.data.b4w_shape_keys.length)for(g.Ke=!0,c=0;c<a.data.b4w_shape_keys.length;c++)f={},f.value=a.data.b4w_shape_keys[c].value,f.name=a.data.b4w_shape_keys[c].name,g.gi.push(f);else g.Ke=!1;d.Ge=a.b4w_shadow_cast;d.fe=a.b4w_shadow_receive;
d.qe=a.b4w_shadow_cast_only&&d.Ge;d.ee=a.b4w_reflexible;d.Hd=a.b4w_reflexible_only&&d.ee;d.Gd=a.b4w_reflective;d.jh=a.b4w_reflection_type;if(!d.Gd)for(g=a.data.materials,c=0;c<g.length;c++)f=g[c],f.use_nodes&&-1!=f.node_tree.jz.indexOf("BSDF_GLOSSY")&&(d.Gd=!0,d.jh="CUBE");d.Ig=a.b4w_caustics;if(d.qf=a.b4w_wind_bending)d.bn=a.b4w_wind_bending_angle,g=e.w0(a.b4w_wind_bending_angle,d.tl,a.scale[0]),d.rh=g,d.sh=a.b4w_wind_bending_freq,d.Ng=a.b4w_detail_bending_freq,d.Mg=a.b4w_detail_bending_amp,d.Hg=
a.b4w_branch_bending_amp,d.Zi=a.b4w_main_bend_stiffness_col,g=a.b4w_detail_bend_colors,d.ze.LB=g.leaves_stiffness_col,d.ze.KB=g.leaves_phase_col,d.ze.uC=g.overall_stiffness_col;d.Qh=a.b4w_hidden_on_load;d.Yf=a.b4w_dynamic_geometry;"MESH"!==a.type&&T.q("Wrong object");g=a.data.materials[0];d.Wl=g.physics.friction;d.Ql=g.physics.elasticity;d.$g=0;d.ff=B.Bp;d.ah=a.b4w_lod_transition;d.pw=a.pass_index;break;case "LINE":d.P=y.Qd();d.ba=y.Jg();d.Ta=y.Qd();d.qb=y.Jg();break;case "CAMERA":K.$R(a,b);K.oR(b);
break;case "LAMP":R.GW(a,b);break;case "SPEAKER":b.X=t.jT();d=!1;for(g=0;g<b.I.length;g++)if(b.I[g].yb.Sc){d=!0;break}d&&t.Uk(a,b);break;case "EMPTY":g=y.Qd(),d.P=g,g=y.Gh(),d.wa=g,a.field&&(b.Kn={type:a.field.type,XM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Dn:a.b4w_anchor.detect_visibility,Uj:a.b4w_anchor.element_id,oX:a.b4w_anchor.max_width})}k(b)};a.Y_=function(a,b){b.vj=a.uuid;b.Lj=!0;z(a,b);a.kz=b.Ra=A(a,b);a.CQ=!0;b.k=B.Gq(b.type);b.Ps=a.b4w_use_default_animation;
b.pl=u.pz(a.b4w_anim_behavior);k(b)};a.L_=function(a,b){var c=b.k;if(b.parent){!b.wk&&b.hh.Ns&&b.parent.hh.Ns&&(b.Um=!1);for(var e=!1,h=0;h<b.I.length;h++)if(b.I[h].yb.zc){e=!0;break}if(h=e)h=b.hh,h=b.bf||b.km||d.fg(b)||b.Um&&!h.Rs&&0<h.Vh&&("DYNAMIC"==h.Yr||"RIGID_BODY"==h.Yr);if(h)h=b.wk?G.copy(c.n,G.create()):c.n,G.multiply(b.parent.k.n,h,c.n),aa.Gc(b,G.F(c.n)),aa.Fe(b,G.td(c.n)),aa.ei(b,G.N(c.n));else if(b.wk||!b.Vr)if(h=G.copy(c.n,G.create()),b.Fx&&"CAMERA"==b.parent.type){h={distance:b.Fx.distance,
rotation:G.N(h)};switch(b.Fx.FQ){case "TOP_LEFT":h.top=0;h.left=0;break;case "TOP":h.top=0;h.left=.5;break;case "TOP_RIGHT":h.top=0;h.right=0;break;case "LEFT":h.top=.5;h.left=0;break;case "CENTER":h.top=.5;h.left=.5;break;case "RIGHT":h.top=.5;h.right=0;break;case "BOTTOM_LEFT":h.bottom=0;h.left=0;break;case "BOTTOM":h.bottom=0;h.left=.5;break;case "BOTTOM_RIGHT":h.bottom=0,h.right=0}J.sz(b,b.parent,h)}else J.KQ(b,b.parent,h);else h=G.copy(c.n,G.create()),J.LQ(b,b.parent,b.Vr,h)}if("ARMATURE"==b.type)for(e=
a.pose.bones,h=0;h<e.length;h++){var l=e[h],n=l.constraints;if(n)for(var m=0;m<n.length;m++){var v=n[m];"COPY_TRANSFORMS"!=v.type||v.subtarget||v.mute||J.ZQ(b,v.target.pb,l.name,T.rF,T.jn)}}if("MESH"==b.type)var r=u.DI(a);if(r){n=r.pb;h=n.k.bs;e=b.k;l=a.data;b.St=n;l=l.vertex_groups;if(l.length){var n=n.k.Fg,m=0,v={},t;for(t in n){var p=T.Dd("name",t,l);p&&(v[t]={bO:p.index,Kj:n[t].Kj,zA:m++})}e.Ci=v;t=m;l=u.YI();e.bh=t;t>2*l?(e.gk=!1,f.error('too many bones for "'+a.name+'" / '+e.bh+" bones (max "+
l+" with blending, "+2*l+" without blending). Skinning will be disabled.")):e.gk=!0}t=u.zU(h.trans,h.Eb,c.Ci);r.b4w_animation_mixing?(c.me=new Float32Array(t.Eb),c.Ee=new Float32Array(t.Eb),c.se=new Float32Array(t.trans),c.Ie=new Float32Array(t.trans)):(c.me=t.Eb,c.Ee=t.Eb,c.se=t.trans,c.Ie=t.trans);c.Up=new Float32Array(4);c.Tp=g.create();c.bs=t;c.Ze=0}if(c.Gd)if(c=b.k,"CUBE"==c.jh)c.Rd=ba++;else if("PLANE"==c.jh){a:{r=a.constraints;for(t=0;t<r.length;t++)if(h=r[t],"LOCKED_TRACK"==h.type&&"REFLECTION PLANE"==
h.name){if(h.target.pb){r=h.target.pb;break a}f.warn('Reflection plane target "'+h.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}r=null}r||(r=T.Js("%reflection%"),r=B.Fq(r,"EMPTY"),t=B.Gq("EMPTY"),r.k=t,x(b,r),J.TF(r,b,[0,0,0],null,1),k(r));t=null;for(h=0;h<ea.length;h++)if(ea[h]==r){t=h;break}null==t&&(t=ea.length,ea.push(r));r.k.Ed=t;c.Ed=t;r.ks.push(b)}};a.G_=b;a.u3=x;a.jS=q;a.M_=function(a){for(var b=0;b<a.length;b++){var d=a[b];!d.k||"DYNAMIC"!=
d.k.type&&"CAMERA"!=d.k.type||aa.D(d);d.Ps&&u.UK(d)&&(u.Qt(d),d.ia.length&&u.play(d,null,u.il))}};a.Tu=function(a){return T.R(a.Vv)};a.ua=function(){ba=v=0;ea.length=0;ca.length=0;V={ALL:[]}};a.copy=function(a,b,d){var c=b,h=B.Ri(a);b=h?B.pI(h.name,b):b;if(n(b,V.ALL,!1,-1)){for(var h=1,g;;){g="."+(3>String(h).length?("000"+String(h)).slice(-3):String(h));if(!n(b+g,V.ALL,!1,-1))break;h++}f.error('Object "'+b+'" already exists. Name was replaced by "'+b+g+'".');c+=g;b+=g}c=B.Fq(b,a.type,c);c.Lj=a.Lj;
c.Ra=a.Ra;c.Ar=a.Ar;c.Ps=a.Ps;c.Lg=a.Lg;c.k=B.Vz(a.k);c.Vv=B.hu(a.Vv);x(a,c);c.Lt=B.bA(a.Lt);c.parent=B.bA(a.parent);c.wk=a.wk;c.Vr=a.Vr;c.Zc=B.bA(a.Zc);c.pl=a.pl;!a.C||a.bf||a.fg||a.km||(c.Um=a.Um,c.C=null);c.cc=a.cc;c.iu=a.iu;c.hh=B.hu(a.hh);b=[];for(h=0;h<a.I.length;h++){g=c.I[h];var l=a.I[h].V;if(d){for(var m=g.V,r=0;r<l.length;r++)if(!l[r].bg){var t=B.hu(l[r]);t.Ba=D.FS(l[r].Ba);m.push(t);b.push(l[r].Ba)}for(r=0;r<l.length;r++)if(l[r].bg){t=B.hu(l[r]);m.push(t);for(var p=0;p<b.length;p++)b[p]==
l[r].Ba&&(t.Ba=m[p].Ba)}for(r=0;r<m.length;r++)m[r].Ba&&D.FN(m[r].Ba),W.nz&&ma.sR(m[r]),m[r].ok=c.vj,e.t_(m[r]);M.sZ(m)}else g.V=l;for(r=0;r<g.V.length;r++)for(l=g.V[r].ya,m=0;m<l.length;m++)M.uv(l[m])}d||(c.k.hp=!1);B.bD(c,!1);k(c);c.k.zv=!0;c.k.Av=d;c.k.Oj=T.oI(v);v++;return c};a.z_=function(a){for(var b=a.k,d=a.I[0].V,c,f,h,g,k,l,n,m,v,t,p,H,q=[],O=0;O<d.length;O++){var u=d[O];if("MAIN"==u.type){var z=D.pr("a_position"),z=D.$u(u.Ba.rc,z),B=u.Ba.ld.a_position.offset;c=g=z[B];f=k=z[B+1];h=l=z[B+
2]}}for(O=0;O<d.length;O++)if(u=d[O],u.Ba&&u.qb&&u.Ta){var z=D.pr("a_position"),z=D.$u(u.Ba.rc,z),B=u.Ba.ld.a_position.offset,Q=u.Ba.ld.a_position.length+B;n=t=z[B];m=p=z[B+1];v=H=z[B+2];for(var I=B;I<Q;I+=3){var B=z[I],x=z[I+1],ba=z[I+2];n=Math.max(B,n);m=Math.max(x,m);v=Math.max(ba,v);t=Math.min(B,t);p=Math.min(x,p);H=Math.min(ba,H)}u.P.max_x=n.toFixed(3);u.P.max_y=m.toFixed(3);u.P.max_z=v.toFixed(3);u.P.min_x=t.toFixed(3);u.P.min_y=p.toFixed(3);u.P.min_z=H.toFixed(3);y.yl(u.P,b.n,u.Ta);y.aI(u.Ta,
ga);for(z=q.length=0;z<ga.length;z++)q.push(ga[z]);u.qb=y.ju(q,!0);u.ba=y.OR(u.qb,b.n);u.wa=y.Dq(u.ba);u.lb=y.Dq(u.qb);u.Qf=y.DB(u.ba,u.wa);"MAIN"==u.type&&(c=Math.max(n,c),f=Math.max(m,f),h=Math.max(v,h),g=Math.min(t,g),k=Math.min(p,k),l=Math.min(H,l))}q={max_x:parseFloat(c.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(h.toFixed(3)),min_x:parseFloat(g.toFixed(3)),min_y:parseFloat(k.toFixed(3)),min_z:parseFloat(l.toFixed(3))};t=c-g;m=f-k;n=h-l;g=.5*(c+g);v=.5*(f+k);p=.5*(h+l);var P=
g,V=p;k=Math.max(t,Math.max(m,n))/2;l=Math.max(t,n)/2;var w=[g/(t?t:1),v/(m?m:1),p/(n?n:1)];H=.5;if(b.Eg)B=Math.max(Math.abs(q.max_x),Math.abs(q.min_x)),x=Math.max(Math.abs(q.max_y),Math.abs(q.min_y)),ba=Math.max(Math.abs(q.max_z),Math.abs(q.min_z)),h=Math.sqrt(B*B+x*x+ba*ba),O=Math.sqrt(B*B+x*x),q.max_x=q.max_y=q.max_z=h,q.min_x=q.min_y=q.min_z=-h,l=O,k=h,B=new Float32Array([0,0,0]),c=new Float32Array([k,k,k]),h=new Float32Array([0,0,0]);else{for(O=0;O<d.length;O++)if(u=d[O],"MAIN"==u.type)for(z=
D.pr("a_position"),z=D.$u(u.Ba.rc,z),Q=d[O].Ba.ld,B=Q.a_position.offset,Q=Q.a_position.length+B,I=B;I<Q;I+=3){var B=z[I],x=z[I+1],ba=z[I+2],G=Math.sqrt((g-B)*(g-B)+(v-x)*(v-x)+(p-ba)*(p-ba));if(G>k){var u=g-k*(B-g)/G,ma=v-k*(x-v)/G,G=p-k*(ba-p)/G;g=(u+B)/2;v=(ma+x)/2;p=(G+ba)/2;k=Math.sqrt((g-B)*(g-B)+(v-x)*(v-x)+(p-ba)*(p-ba))}ma=Math.sqrt((P-B)*(P-B)+(V-ba)*(V-ba));ma>l&&(u=P-l*(B-P)/ma,G=V-l*(ba-V)/ma,P=(u+B)/2,V=(G+ba)/2,l=Math.sqrt((P-B)*(P-B)+(V-ba)*(V-ba)));B/=t?t:1;x/=m?m:1;ba/=n?n:1;G=Math.sqrt((w[0]-
B)*(w[0]-B)+(w[1]-x)*(w[1]-x)+(w[2]-ba)*(w[2]-ba));G>H&&(u=w[0]-H*(B-w[0])/G,ma=w[1]-H*(x-w[1])/G,G=w[2]-H*(ba-w[2])/G,w[0]=(u+B)/2,w[1]=(ma+x)/2,w[2]=(G+ba)/2,H=Math.sqrt((w[0]-B)*(w[0]-B)+(w[1]-x)*(w[1]-x)+(w[2]-ba)*(w[2]-ba)))}O=t?t*w[0]:c;f=m?m*w[1]:f;h=n?n*w[2]:h;c=H*t;z=H*m;Q=H*n;B=new Float32Array([g,v,p]);c=new Float32Array([c,z,Q]);h=new Float32Array([O,f,h]);l=parseFloat(l.toFixed(3))}b.P=q;e.VY(b,l,l,q);q=y.Gz(k,B);b.wa=q;q=y.$p([c[0],0,0],[0,c[1],0],[0,0,c[2]],h);b.ba=q;aa.D(a);if(W.debug_view)for(O=
0;O<d.length;O++)if("DEBUG_VIEW"===d[O].type&&d[O].Ji){a=r.Ou(1,q.G);D.JL(a,[q.Ga[0],q.Ha[1],q.Ia[2]],q.G);D.kx(a,1,!0);a.qa.a_polyindex=D.Gu(a);e.s_(d[O],a);break}};a.Vb=p;a.nJ=function(a,b,d){b=V[b]||[];for(var c=[],e=0;e<b.length;e++){var f=b[e];if((f.k.Ve==d||-1==d)&&f.Lj)for(var h=f.I,g=0;g<h.length;g++)h[g].yb==a&&c.push(f)}return c};a.Pi=function(a){var b=V.ALL;if(-1==a)return b;for(var d=[],c=0;c<b.length;c++){var e=b[c];e.k.Ve==a&&d.push(e)}return d};a.jr=function(a){var b=V.MESH;if(b)for(var c=
0;c<b.length;c++){var e=b[c];if(d.fg(e))for(var f=e.I,h=0;h<f.length;h++)if(f[h].yb==a)return e}return null};a.BZ=function(a){var b=p(a,"LAMP",-1);if(b.length==a.s.o7){for(var d=[],c=0;c<b.length;c++){var e=b[c],e=B.ka(e,a);d[e.pm]=c}for(c=0;c<d.length-1;c++)for(e=c+1;e<d.length;e++){var f=b[d[c]].ub,h=b[d[e]].ub;if(h.Tm&&h.Vm&&(!f.Tm||!f.Vm)||!f.Tm&&(h.Tm||!f.Vm&&h.Vm))f=d[c],d[c]=d[e],d[e]=f}for(c=0;c<d.length;c++)e=b[d[c]],B.ka(e,a).pm=c,Q.gp(b[d[c]],a)}};a.fw=function(a,b,d,c){for(var e=0;e<a.I.length;e++)for(var f=
a.I[e].V,h=0;h<f.length;h++){var g=f[h];g.Ba.Wf=b;g.Wf=b;g.zb.Wf=d;""!==g.mk&&(g=I.aJ(g.mk))&&(g.VG=c)}};a.oJ=function(){var a=[],b=V.MESH;if(b)for(var d=0;d<b.length;d++){var c=b[d];c.k.Dk&&c.Lj&&a.push(c)}return a};a.A5=function(){var a=[],b=V.MESH;if(b)for(var d=0;d<b.length;d++){var c=b[d];c.k.Wc&&c.Lj&&a.push(c)}return a};a.wc=function(b,d,c,e){var f=null,h=V.ALL;switch(b){case a.hy:f=n(d,h,!0,c,e);break;case a.gy:a:{for(b=0;b<h.length;b++)if(f=h[b],f.wm==c&&(f.k.Ve==e||-1==e)){var g=B.Ri(f);
if(g&&g.wm==d)break a}f=null}break;case a.Pc:a:{for(e=0;e<h.length;e++){b=h[e];for(var f=d.length-1,g=b,k=!0;0<=f&&k;)k=g&&g.wm==d[f]&&(g.k.Ve==c||-1==c),g&&(g=B.Ri(g)),f--;if(k&&!g){f=b;break a}}f=null}}return f};a.av=function(a,b){return n("%meta_world%"+a,V.WORLD,!0,b)};a.uo=function(b,d){var c=Q.Nh();if(!c)return f.error("No active scene"),null;var e=H.JX(b,d);if(e)return e;e=Q.KX(c,b,d);if(!e)return null;for(var c=p(c,"MESH",-1),h=0;h<c.length;h++){var g=c[h].k,k=g.Oj;if(k&&3>Math.abs(255*k[0]-
e[0])&&3>Math.abs(255*k[1]-e[1])&&3>Math.abs(255*k[2]-e[2]))return g.Wc&&g.jw&&(O.outlining_overview_mode?a.pn(c[h],O.qk,O.rk,O.tk):(e=g.Xh,a.pn(c[h],e.qk,e.rk,e.tk))),c[h]}return null};a.tM=function(a,d){for(var c=p(a,"EMPTY",-1),e=0;e<c.length;e++){var h=c[e];if(h.Kn&&"WIND"===h.Kn.type){var g=h;break}}if(!g)return f.error("There is no wind on the scene"),0;"number"==typeof d.wind_dir&&(c=T.Cb(d.wind_dir),S.set(Math.sin(c),-Math.cos(c),0,na),T.DA(na,T.Oc,pa),aa.ei(g,pa));"number"==typeof d.wind_strength&&
(g.Kn.XM=d.wind_strength);b(g)};a.ls=function(a){J.kS(a)&&J.remove(a);var b=V.ALL,d=V[a.type],c=b.indexOf(a);a=d.indexOf(a);-1!=c&&b.splice(c,1);-1!=a&&d.splice(a,1)};a.BX=k;a.CX=function(a){return V[a.type]&&-1<V[a.type].indexOf(a)}};b4w.module.__nla=function(a,m){function l(){return{type:"CLIP",va:0,Za:0,kj:!1,paused:!1,Uf:"",Qp:"",Ac:0,no:null,Dj:0,ml:0,$H:0,ZH:0,RN:!1,scale:1,repeat:1,IF:0}}function c(a,b,e){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var f=0;f<d.length;f++)d[f].no=e,b.push(d[f])}a=a.nodes;for(f=0;f<a.length;f++)if(d=a[f],d.node_group){var h=d.node_group.node_tree;if(h){var g=e.slice();g.push(d.name);c(h,b,g)}}}function b(a,b){var c=Math.round(a)-b.va;b.uj&&(c%=b.Yj,0>c&&(c+=b.Yj));return b.Ub+
c}function x(a,b){var c=(b-E)*J.sd()+a.Ub;c>a.va?(c-=a.va,a.Sd&&(c%=a.Za-a.va+1),c+=a.va):c=a.va;return c}function q(a,b){a=D.W(a,b.va,b.Za);var c=a==b.Za?b.IF:b.Dj+(a-b.va)/b.scale%(b.ml-b.Dj);b.RN&&(c=b.ml-c+b.Dj);return c}function A(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],h=e.strips;if(h)for(var g=0;g<h.length;g++){var k=h[g],n=l();n.type=k.type;n.va=k.frame_start;n.Za=k.frame_end;n.Ac=b;n.Dj=k.action_frame_start;n.ml=k.action_frame_end;n.RN=k.use_reverse;n.scale=k.scale;n.repeat=k.repeat;
k.action&&(n.Uf=k.action.name,n.Qp=k.action.uuid,n.no=e.no);c.push(n)}}return c}function h(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function z(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function p(a,b){var c=y.A();if(c.ra){var d=x(c.ra,b);c.ra.Ub-=d-a;c.ra.Nn=!0}}var n=m("__animation");m("__config");var k=m("__objects"),u=m("__obj_util"),e=m("__print"),y=m("__scenes"),K=m("__sfx"),F=m("__textures"),J=m("__time"),D=m("__util"),R=[],E=-1;a.Uk=function(a,b){var e,d=null;for(e=b.I.length-1;0<=e;e--){var f=b.I[e];if(f.yb.b4w_use_nla&&(d=f,f.yb.EF))break}if(e=d){e.TK=!0;var k=0;if((d=a.animation_data)&&d.nla_tracks.length){var g=d.nla_tracks;if(u.im(b)||u.xa(b)||u.$d(b)||u.Xn(b)||u.Xg(b)||
u.$n(b)||u.HB(b))g=A(g,k),g.length&&(b.kg=b.kg.concat(g),k++)}h(a)&&(g=a.data.animation_data.nla_tracks,g=A(g,k),g.length&&(b.kg=b.kg.concat(g),k++));if(u.$d(b))for(f=a.data.materials,d=0;d<f.length;d++){var m=f[d];if(m.use_nodes&&m.node_tree&&(g=[],c(m.node_tree,g,[m.name]),g=A(g,k),g.length)){for(var m=k,t=g,p=n.iV(),q=[],z=0,y=0;y<t.length;y++){var x=t[y];""!=x.Qp?x=D.Dd("uuid",x.Qp,p):(x=x.Uf,x=D.Dd("name",x,p)||D.Dd("name",x+"_B4W_BAKED",p));if(x){var x=x.fcurves,F=[],H;for(H in x)F.push(H);
q.push(F)}}for(y=0;y<q.length;y++){p=!1;for(x=0;x<y;x++)if(D.mR(q[y],q[x])){t[y].Ac=t[x].Ac;p=!0;break}p||(t[y].Ac=k+z++)}k=m+z;b.kg=b.kg.concat(g)}}if(!u.HB(b)){for(d=0;d<a.particle_systems.length;d++)f=a.particle_systems[d],H=f.settings,"EMITTER"==H.type&&H.b4w_allow_nla&&(H=l(),H.type="CLIP",H.va=e.yb.frame_start,H.Za=e.yb.frame_end+1,H.Uf=f.name,H.Ac=k,H.Dj=H.va,H.ml=H.Za,b.kg.push(H),k++);e=k+1;for(d=0;d<b.Zc.length;d++)f=b.Zc[d],f.GQ&&(k=e,H=l(),H.type="CLIP",H.va=f.va,H.Za=f.Za,H.Uf=f.name,
H.Ac=k,H.Dj=H.va,H.ml=H.Za,b.kg.push(H))}}};a.R_=function(a,b,c){a.ra||(a.ra={va:a.frame_start,Za:a.frame_end,Ub:0,Hr:-1,ds:a.frame_end,es:a.frame_start,ip:null,Sd:b,eb:[],ya:[],KL:a.name,hk:!1,Nn:!1,YC:!0},R.push(a.ra));b=a.ra;for(var d=k.nJ(a,"ALL",c),f=0;f<d.length;f++){var h=d[f];if(h.kg.length){b.eb[c]||(b.eb[c]=[]);for(var g=0;g<h.I.length;g++){var n=h.I[g];n.yb==a&&n.TK&&b.eb[c].push(h)}for(var g=h.kg,n=b,m=h.name,p=0;p<g.length;p++){var q=g[p];n.va>q.Za||n.Za<q.va?(e.warn("NLA: Strip is out of scene range: "+
(m+" ["+q.va+":"+q.Za+"]")),g.splice(p,1),p--):q.Uf||"CLIP"!=q.type||(e.warn('NLA: no action in strip for object "'+m+'".'),g.splice(p,1),p--)}h=h.kg;g=b;for(n=0;n<h.length;n++){for(var m=h[n],p=g.va,q=g.Za+1,u=0;u<h.length;u++){var z=h[u];m.Ac==z.Ac&&(z.Za<=m.va&&(p=m.va),z.va>=m.Za&&(q=Math.min(q,z.va)))}m.$H=p;m.ZH=q;m.IF=0===m.repeat%1?m.ml:m.Dj+m.repeat%1*(m.ml-m.Dj)}}}a=a.s.mp;for(f=0;f<a.length;f++)d=a[f].s,d.Vk&&(d.Sa||d.wd)&&d.Ys==c&&(h=l(),h.type="VIDEO",d.uj?(h.va=0,h.Za=b.Za):(h.va=D.W(d.va,
0,b.Za),h.Za=D.W(d.va+d.Yj,0,b.Za)),h.Uf=a[f].name,b.ya.push(d))};a.start=function(){E=0};a.NV=function(){return E};a.Y4=function(a){return a.ra?a.ra.Ub:null};a.o8=function(a,b){return a.ra?(a.ra.Ub=b,!0):!1};a.update=function(a,c){if(!(0>E)){0==E&&(E=a);for(var e=0;e<R.length;e++){var d=R[e];d.hk&&(d.Ub-=J.sd()*c);var f=x(d,a);if((!d.hk||d.Nn)&&f>=d.ds)if(d.Sd){var f=d,h=a;f.ip&&f.ip();p(f.es,h);f.YC=!0;f=x(f,h)}else{var h=d,g=f;h.hk=!0;h.Ub-=g-h.ds;h.ip&&h.ip()}if(!d.hk||d.Nn){for(var h=d,g=f,k=
0;k<h.eb.length;k++){var l=h.eb[k];if(l)for(var m=0;m<l.length;m++){for(var u=l[m],z=u.kg,y=0;y<z.length;y++){var A=z[y];"SOUND"==A.type&&g<h.Hr-1E-6&&(A.kj=!1)}for(y=0;y<z.length;y++)switch(A=z[y],A.type){case "CLIP":if(A.$H<=g&&g<A.ZH&&!A.kj){var k=u,X=A,H=X.no;""!=X.Qp?n.fR(k,H,X.Qp,X.Ac):n.apply(k,H,X.Uf,X.Ac);n.ts(k,n.Nx,X.Ac);H=q(X.va,X);n.Fo(k,H,X.Ac);for(k=0;k<z.length;k++)z[k]!=A&&z[k].Ac==A.Ac&&(z[k].kj=!1);A.kj=!0}A.kj&&(X=u,H=q(g,A),1E-6<Math.abs(H-n.JI(X,A.Ac))&&n.Fo(X,H,A.Ac));break;
case "SOUND":if((g<h.Hr-1E-6||h.Hr<A.va)&&A.va<=g&&g<A.Za&&!A.kj){var X=u,ma=A,H=(ma.va-g)/J.sd(),ma=(ma.Za-ma.va)/J.sd();K.play(X,H,ma);A.kj=!0}h.Hr<A.Za&&A.Za<=g&&A.kj&&(A.kj=!1)}}}h=a;g=d;l=f;for(m=0;m<g.ya.length;m++)if(u=g.ya[m],u.Sa||u.wd){z=F.cO(u);y=u;A=D.W(b(l,y),y.Ub,y.Ub+F.dO(y)-1);y.wd&&(A=F.m0(y,A),A==y.qs&&A--);y=A;A=F.eO(u);X=k=!1;if(g.Nn||g.YC)X=!0;g.hk||(H=b(l,u),H=u.Ub<=H&&H<=u.Ub+F.dO(u),ma=F.fO(u),u.uj&&y==A&&(X=!0),ma||z==y||(X=!0),H&&!ma?F.fL(u):H&&ma?k=!0:!H&&ma&&(u.Sa&&z<y?
k=!0:F.xC(u)));X?(F.NY(u,y),u.wd&&(u.Fk=F.Gw(u,h))):k&&F.gO(u)&&(u.Sa?F.KN(u):(z=F.Gw(u,h),z!=u.Fk&&(u.lj=y,F.JN(u)),u.Fk=z))}d.Hr=f}d.Nn=!1;d.YC=!1}}};a.ua=function(a){if(0==a)R.length=0,E=-1;else for(var b=0;b<R.length;b++)R[b].eb[a]=null};a.xG=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||h(a)||z(a)?!0:!1};a.Fo=p;a.kr=function(a){var b=y.A();return b.ra?x(b.ra,a):-1};a.VM=function(){var a=y.A();if(a.ra){a.ra.hk=!0;for(var a=a.ra.ya,b=0;b<a.length;b++)F.xC(a[b])}};a.RX=function(){var a=
y.A();a.ra&&(a.ra.hk=!1,a.ra.ip=null)};a.Z4=function(){var a=y.A();return a.ra?a.ra.va:-1};a.UI=function(){var a=y.A();return a.ra?a.ra.Za:-1};a.Wi=function(){var a=y.A();return a.ra?!a.ra.hk:!1};a.Z2=function(){var a=y.A();return a.ra?a.b4w_use_nla:!1};a.Y2=function(){var a=y.A();return a.ra?0<a.b4w_logic_nodes.length:!1};a.D8=function(a,b){var c=y.A();if(c.ra)c.ra.es=a,c.ra.ds=b;else return!1};a.mD=function(a){var b=y.A();b.ra&&(b.ra.ds=a)};a.bZ=function(a){var b=y.A();b.ra&&(b.ra.es=a)};a.T7=function(){var a=
y.A();if(a.ra)a=a.ra,a.es=a.va,a.ds=a.Za;else return!1};a.h8=function(a){var b=y.A();if(b.ra)b.ra.Sd=a;else return!1};a.h3=function(){var a=y.A();a.ra&&(a.ra.ip=null)};a.hM=function(a){var b=y.A().ra;b&&(b.Ub=-(a-E)*J.sd()+b.es,b.Nn=!0)};a.UI=function(){var a=y.A().ra;return a?a.Za:null}};b4w.module.__sfx=function(a,m){function l(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(d){return D.error('Unable to initialize AudioContext: "'+d+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function c(a,d,c){var e=a.X;if("NONE"!=e.behavior){var f=e.loop,g=e.pitch;if(e.src&&(f||0<=c)){e.wz=Math.floor(5E4*Math.random());var k=M.currentTime+d,k=
Math.max(0,k);e.kf=k;e.state=20;var l=G.Sc;"POSITIONAL"==e.behavior&&"none"==l.Pq&&(e.behavior="BACKGROUND_SOUND");b(a,G.Sc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){d=M.createBufferSource();d.buffer=e.src;d.playbackRate.value=g;if(f){e.fc&&e.fc.disconnect();e.Kd&&e.Kd.disconnect();d.loop=!0;d.loopStart=e.wK;if(d.loopEnd=e.Ov)c=M.createBufferSource(),c.buffer=e.src,c.playbackRate.value=g,e.Kd=c,c.connect(e.Fd);d.start(k);e.duration=0}else f=d.buffer?d.buffer.duration:0,c>f?(f=
k+c+e.Df,d.loop=!0,d.start(k),d.stop(f),e.duration=c):(d.loop=!1,d.start(k),e.duration=f);d.connect(e.Fd);e.fc=d;q(e);A(e);h(e)}else"BACKGROUND_MUSIC"==e.behavior&&(E.un(e.xz),E.un(e.yz),c=function(){var b=a.X,d=b.src;d&&(d.volume=1,d.loop=b.loop,b.fc=b.fc||M.createMediaElementSource(d),b.fc.connect(b.Fd),20==b.state&&(d.currentTime&&(d.currentTime=0),d.play()))},0==d?c():e.xz=E.Sw(c,1E3*d),e.duration=f?0:F(a));z(e,k)}}}function b(a,b){var d=a.X;if(!d.Fd){var c=I.F(a.k.n),e=I.N(a.k.n);if(f.Wv){var h=
M.createBiquadFilter();h.type="peaking"}else h=null;var g=M.createGain();switch(d.behavior){case "POSITIONAL":var k=M.createPanner();"string"!=typeof k.panningModel?(k.panningModel=k.EQUALPOWER,k.distanceModel=k.INVERSE_DISTANCE):(k.panningModel="equalpower",k.distanceModel=b.Pq);k.setPosition(c[0],c[1],c[2]);P.copy(c,d.JB);c=r;B.pc(e,B.ad,c);k.setOrientation(c[0],c[1],c[2]);k.refDistance=d.dist_ref;k.maxDistance=d.dist_max;k.rolloffFactor=d.attenuation;k.coneInnerAngle=d.dH;k.coneOuterAngle=d.eH;
k.coneOuterGain=d.fH;var l=M.createGain();l.gain.value=K(d);h?(k.connect(h),h.connect(l)):k.connect(l);l.connect(g);d.Fd=k;if(d.Ym){var n=M.createGain();g.connect(n);n.connect(b.Fd)}else n=null,g.connect(b.Fd);break;case "BACKGROUND_SOUND":k=null;l=M.createGain();l.gain.value=K(d);h?(d.Fd=h,h.connect(l)):d.Fd=l;l.connect(g);d.Ym?(n=M.createGain(),g.connect(n),n.connect(b.Fd)):(n=null,g.connect(b.Fd));break;case "BACKGROUND_MUSIC":n=k=null,l=M.createGain(),l.gain.value=K(d),h?(d.Fd=h,h.connect(l)):
d.Fd=l,l.connect(g),g.connect(b.Fd)}d.vC=k;d.Rg=h;d.Pn=l;d.Xj=g;d.LC=n}}function x(a){var b=a.X,d=b.duration,b=b.OH+b.PH*Math.random();c(a,b,d)}function q(a){var b=a.Kd||a.fc;B.Sh(b.onended)&&(b.onended=function(){a.state=50})}function A(a){a.Ym&&a.LC.gain.cancelScheduledValues(a.kf);a.vo&&(a.fc.playbackRate.cancelScheduledValues(a.kf),a.Kd&&a.Kd.playbackRate.cancelScheduledValues(a.kf));a.Xs=a.kf}function h(a){if(a.Ym||a.vo){var b=a.LC,d=a.fc,c=d.buffer?d.buffer.duration:0;if(c){var e=a.kf;S[0]=
a.wz;for(var f=0;5>f;){var h=a.pitch+a.vo*B.qg(S);if(e>=a.Xs){if(a.Ym){var g=1-B.W(a.Ym,0,1)*Math.random();b.gain.setValueAtTime(g,e)}a.vo&&(d.playbackRate.setValueAtTime(h,e),a.Kd&&a.Kd.playbackRate.setValueAtTime(h,e));f++}e+=c/h}a.Xs=e-.001}}}function z(a,b){if(a.Sl||a.Df){var d=a.Xj;d.gain.cancelScheduledValues(b);a.Sl?(d.gain.setValueAtTime(0,b),d.gain.linearRampToValueAtTime(1,b+a.Sl)):d.gain.setValueAtTime(1,b);a.Df&&!a.loop&&(d.gain.setValueAtTime(1,b+a.duration),d.gain.linearRampToValueAtTime(0,
b+a.duration+a.Df))}}function p(a){"SPEAKER"!=a.type&&B.q("Wrong object type");var b=a.X;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var d=b.Xj,c=M.currentTime;b.Df&&(d.gain.setValueAtTime(d.gain.value,c),d.gain.linearRampToValueAtTime(0,c+b.Df));"BACKGROUND_MUSIC"==b.behavior?b.src&&(E.un(b.xz),E.un(b.yz),b.yz=E.Sw(function(){var b=a.X.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Df)):(d=b.fc,b.duration<d.buffer.duration?b.Df&&20==b.state?d.stop(c+b.Df):20==b.state&&
(d.stop(0),d.disconnect()):d.disconnect(),b.kf=0,b.wC=0,b.Hz=0);b.state=30}}function n(a){a=a.X;if(20==a.state){var b=M.currentTime;a.wC=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.Hz=b>a.kf?k(a,b):0,a.fc.onended=function(){},a.fc.stop(0),a.fc.disconnect(),A(a));a.state=40}}function k(a,b){S[0]=a.wz;for(var d=a.fc.buffer.duration,c=a.kf,e;c<b;)e=a.pitch+a.vo*B.qg(S),c+=d/e;return(d/e-(c-b))*e}function u(a){var b=a.X;if(40==b.state){var d=M.currentTime;b.kf+=d-b.wC;if("BACKGROUND_MUSIC"==
b.behavior)b.src.play();else{a=a.X;var c=M.createBufferSource();c.loop=a.fc.loop;c.loopStart=a.fc.loopStart;c.loopEnd=a.fc.loopEnd;c.buffer=a.fc.buffer;c.playbackRate.value=a.fc.playbackRate.value;c.connect(a.Fd);a.fc=c;a.Kd&&(c=M.createBufferSource(),c.loop=a.Kd.loop,c.buffer=a.Kd.buffer,c.playbackRate.value=a.Kd.playbackRate.value,c.connect(a.Fd),a.Kd=c);b.Xs=d;d=b.fc;q(b);d.start(b.kf,b.Hz);h(b)}z(b,b.kf);b.state=20}}function e(a,b,d){var c=1,c=b.fU;if(0<c){var e=b.IZ;if(0!=P.dot(a.Ax,a.Ax)||0!=
P.dot(b.qm,b.qm)){var f=P.subtract(a.JB,b.Uh,r),h=P.length(f);b=P.dot(f,b.qm)/h;f=P.dot(f,a.Ax)/h;f=-f;h=e/c;b=Math.min(-b,h);f=Math.min(f,h);c=(e-c*b)/(e-c*f);isFinite(c)||(c=0);c=Math.min(c,16);c=Math.max(c,.125);c=B.mc(c,a.pK,d,.3);a.fc.playbackRate.value=c;a.pK=c}}}function y(a){a=a.X;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function K(a){return a.muted?0:a.volume}function F(a){a=a.X;return(a=a.src)?a.duration:0}var J=m("__config"),D=m("__print"),R=m("__quat"),E=m("__time"),
I=m("__tsr"),B=m("__util"),P=m("__vec3"),d=J.B,f=J.X,r=new Float32Array(3),g=new Float32Array(3);new Float32Array(3);var Q=R.create(),t=[],aa=[],M=null,G=null,T=[],S=[1],X=null;a.CE=10;a.Ox=20;a.BE=30;a.jT=function(){return{vj:-1,Qg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,dH:360,eH:360,fH:1,autoplay:!1,Sd:!1,loop:!1,wK:0,Ov:0,OH:0,PH:0,Ym:0,vo:0,Sl:0,Df:0,kf:0,wC:0,Hz:0,duration:0,Xs:0,wz:1,src:null,state:10,JB:new Float32Array(3),Ax:new Float32Array(3),
Eu:!1,pK:1,xz:-1,yz:-1,Pl:0,Fd:null,fc:null,Kd:null,vC:null,Rg:null,Pn:null,Xj:null,LC:null,Tk:0}};a.Vg=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(t.push("ogg"),t.push("ogv"),t.push("oga")),""!=a.canPlayType("audio/mpeg")&&t.push("mp3"),""!=a.canPlayType("audio/mp4")&&(t.push("mp4"),t.push("m4v"),t.push("m4a")),""!=a.canPlayType("audio/webm")&&t.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(aa.push("ogv"),
aa.push("ogg"),aa.push("oga")),""!=b.canPlayType("video/mp4")&&(aa.push("m4v"),aa.push("mp4")),""!=b.canPlayType("video/webm")&&aa.push("webm"),""!=b.canPlayType("video/mpeg")&&aa.push("mp3"))};a.uR=function(a){f.tE&&!M&&(M=l())&&D.log("%cINIT WEBAUDIO: "+M.sampleRate+"Hz","color: #00a");if(M){var b={Uh:new Float32Array(3),qm:new Float32Array(3),Tk:0},d=M.createGain(),c=M.createGain();b.Pn=d;b.Xj=c;d.connect(c);c.connect(M.destination);if(a.b4w_enable_dynamic_compressor){var c=M.createDynamicsCompressor(),
e=a.b4w_dynamic_compressor_settings;c.threshold.value=e.threshold;c.knee.value=e.knee;c.ratio.value=e.ratio;c.attack.value=e.attack;c.release.value=e.release;c.connect(d);b.Cq=c;b.Fd=c}else b.Cq=null,b.Fd=d;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Pq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Pq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Pq="exponential";break;case "NONE":b.Pq="none";break;default:B.q("Wrong audio distance model")}b.fU=a.audio_doppler_factor;
b.IZ=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;d.gain.value=K(b);b.Pl=0}else b=null;a.Sc=b};a.DY=function(a){G=a};a.yu=function(a){a||(a="ogg");return-1<t.indexOf(a)?a:-1<t.indexOf("m4a")?"m4a":-1<t.indexOf("oga")?"oga":""};a.CA=function(a){a||(a="webm");return-1<aa.indexOf(a)?a:-1<aa.indexOf("m4v")?"m4v":-1<aa.indexOf("webm")?"webm":""};a.Uk=function(a,b){var c=a.data,e=b.X;e.vj=a.data.sound.uuid;e.Qg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":e.behavior=
M?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var f;M?(window.MediaElementAudioSourceNode?f=!0:(D.warn("MediaElementAudioSourceNode not found"),f=!1),f=f&&!d.TG?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";e.behavior=f;break;default:B.q("Wrong speaker behavior")}c.sound||(e.behavior="NONE");e.Eu=c.b4w_enable_doppler;e.muted=c.muted;e.volume=c.volume;e.pitch=c.pitch;e.attenuation=c.attenuation;e.dist_ref=c.distance_reference;e.dist_max=c.distance_max||1E4;e.dH=c.cone_angle_inner;e.eH=c.cone_angle_outer;
e.fH=c.cone_volume_outer;e.autoplay=c.b4w_auto_play;e.Sd=c.b4w_cyclic_play;e.loop=c.b4w_loop;e.wK=c.b4w_loop_start;e.Ov=c.b4w_loop_end;e.OH=c.b4w_delay;e.PH=c.b4w_delay_random;e.Ym=c.b4w_volume_random;e.vo=c.b4w_pitch_random;e.Sl=c.b4w_fade_in;e.Df=c.b4w_fade_out;T.push(b)};a.NM=function(b){"SPEAKER"!=b.type&&B.q("Wrong object type");switch(b.X.behavior){case "POSITIONAL":return a.Ox;case "BACKGROUND_SOUND":return a.Ox;case "BACKGROUND_MUSIC":return a.BE;case "NONE":return a.CE;default:B.q("Wrong speaker behavior")}};
a.W_=function(a,b){var d=a.X;switch(d.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":d.src=b;break;case "NONE":break;default:B.q("Wrong speaker behavior")}};a.eL=function(){var a=M.createBufferSource();a.buffer=M.createBuffer(1,22050,22050);a.connect(M.destination);a.start(0)};a.ZT=function(a,b,d){M?M.decodeAudioData(a,b,d):d()};a.FZ=function(a){p(a);a.X=null;T.splice(T.indexOf(a),1)};a.ua=function(){for(var a=0;a<T.length;a++){var b=T[a].X;"BACKGROUND_MUSIC"==b.behavior?
(b=b.src)&&b.pause():(b.fc&&b.fc.disconnect(),b.Kd&&b.Kd.disconnect())}G&&G.Sc&&(a=G.Sc,a.Uh[0]=0,a.Uh[1]=0,a.Uh[2]=0,a.qm[0]=0,a.qm[1]=0,a.qm[2]=0);G=null;T.splice(0);X=null};a.update=function(a){if(M&&0!=T.length){for(var b=0;b<T.length;b++){var d=T[b],c=d.X,e=c.fc,f=M.currentTime;!c.loop&&20==c.state&&c.duration&&c.kf+c.duration<f&&("BACKGROUND_MUSIC"==c.behavior||e&&!B.Sh(e.onended))&&(c.state=50);c.Sd&&50==c.state&&x(d);20==c.state&&3>c.Xs-f&&h(c)}X&&X.nj.length&&(-1==X.Ic||a>X.MF+X.VH[X.Ic])&&
(b=X,-1<b.Ic&&p(b.nj[b.Ic]),-1==b.Ic&&b.random?d=Math.round(Math.random()*(b.nj.length-1)):b.random?(d=1+Math.round(Math.random()*(b.nj.length-2)),d=(b.Ic+d)%b.nj.length):d=(b.Ic+1)%b.nj.length,x(b.nj[d]),b.Ic=d,b.MF=a)}};a.play=c;a.sw=x;a.stop=p;a.Ev=function(a){return 20==a.X.state};a.EZ=n;a.GZ=u;a.xK=function(a,b){var d=a.X,c=d.Kd;if(y(a)&&("POSITIONAL"==d.behavior||"BACKGROUND_SOUND"==d.behavior)&&c){var e=M.currentTime+b;d.fc.stop(e);c.start(e,d.Ov)}};a.BC=function(a,b){var d=a.X;d.pitch=b;!y(a)||
"POSITIONAL"!=d.behavior&&"BACKGROUND_SOUND"!=d.behavior||(d.fc.playbackRate.value=b,d.Kd&&(d.Kd.playbackRate.value=b),A(d),h(d))};a.eJ=function(a){return a.X.pitch};a.Sd=function(a,b){a.X.Sd=Boolean(b)};a.pW=function(a){return a.X.autoplay};a.EB=function(a){return a.X.Sd};a.WW=function(a,b,d,c,f){if(a=a.Sc){var h=r;h[0]=0;h[1]=0;h[2]=-1;P.transformQuat(h,d,h);g[0]=0;g[1]=1;g[2]=0;P.transformQuat(g,d,g);d=M.listener;d.setPosition(b[0],b[1],b[2]);d.setOrientation(h[0],h[1],h[2],g[0],g[1],g[2]);if(c&&
a.Tk!=f){if(a.ho)a.ho=!1,P.copy(b,a.Uh);else for(d=a.qm,d[0]=(b[0]-a.Uh[0])/c,d[1]=(b[1]-a.Uh[1])/c,d[2]=(b[2]-a.Uh[2])/c,P.copy(b,a.Uh),b=0;b<T.length;b++)d=T[b],h=d.X,y(d)&&"POSITIONAL"==h.behavior&&h.Eu&&e(h,a,c);a.Tk=f}else P.copy(b,a.Uh)}};a.ho=function(){var a=G.Sc;a&&(a.ho=!0)};a.HZ=function(a,b,d){var c=a.X;if(y(a)&&"POSITIONAL"==c.behavior){var f=I.jc(a.k.n,r);a=I.Yd(a.k.n,Q);var h=c.vC;h.setPosition(f[0],f[1],f[2]);B.pc(a,B.ad,g);h.setOrientation(g[0],g[1],g[2]);c.Eu&&(a=c.JB,b&&c.Tk!=d?
(c.Pm?(P.copy(f,a),c.Pm=!1):(h=c.Ax,h[0]=(f[0]-a[0])/b,h[1]=(f[1]-a[1])/b,h[2]=(f[2]-a[2])/b,P.copy(f,a),e(c,G.Sc,b)),c.Tk=d):P.copy(f,a))}};a.AD=function(a){var b=a.X;y(a)&&"POSITIONAL"==b.behavior&&b.Eu&&(b.Pm=!0)};a.kB=function(a){return a.X.behavior};a.LG=function(){for(var a=0;a<T.length;a++)if(y(T[a]))return!0;return!1};a.XY=function(a){var b=G.Sc;b&&(b.volume=a,M&&(b.Pn.gain.value=K(b)))};a.IV=function(){var a=G.Sc;return a?a.volume:0};a.rD=function(a,b){var d=a.X;d.volume=b;y(a)&&(d.Pn.gain.value=
K(d))};a.AJ=function(a){return a.X.volume};a.ec=function(a,b){a.X.muted=Boolean(b);y(a)&&(a.X.Pn.gain.value=K(a.X))};a.dK=function(a){return a.X.muted};a.wX=function(a){var b=G.Sc;b&&(b.muted=Boolean(a),M&&(b.Pn.gain.value=K(b)))};a.yW=function(){var a=G.Sc;return a?a.muted:!1};a.jB=function(){return T};a.pause=function(){for(var a=0;a<T.length;a++)n(T[a])};a.ci=function(){for(var a=0;a<T.length;a++)u(T[a])};a.VL=function(a,b){if(a.Sc&&a.Sc.Cq){var d=a.Sc.Cq;d.threshold.value=b.threshold;d.knee.value=
b.knee;d.ratio.value=b.ratio;d.attack.value=b.attack;d.release.value=b.release}};a.II=function(a){if(!a.Sc||!a.Sc.Cq)return null;a=a.Sc.Cq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.UH=function(a,b,d){if(y(a)){a=a.X;var c=a.Xj,e=M.currentTime;c.gain.setValueAtTime(c.gain.value,e);c.gain.linearRampToValueAtTime(b,e+d);a.Pl=d}};a.AN=function(a){if(y(a)){a=a.X;var b=a.Xj,d=M.currentTime;b.gain.setValueAtTime(b.gain.value,
d);b.gain.linearRampToValueAtTime(1,d+a.Pl);a.Pl=0}};a.iU=function(a,b){if(M){var d=G.Sc,c=d.Xj,e=M.currentTime;c.gain.setValueAtTime(c.gain.value,e);c.gain.linearRampToValueAtTime(a,e+b);d.Pl=b}};a.o_=function(){if(M){var a=G.Sc,b=a.Xj,d=M.currentTime;b.gain.setValueAtTime(b.gain.value,d);b.gain.linearRampToValueAtTime(1,d+a.Pl);a.Pl=0}};a.VF=function(a,b,d){X={Ic:-1,MF:0,random:d,nj:[],VH:[]};for(d=0;d<a.length;d++){var c=a[d],e=F(c);0==e?D.warn("Ignoring speaker with zero duration: "+c.name):(p(c),
c.X.Sd=!1,X.nj.push(c),X.VH.push(e+b))}};a.LI=F;a.ZG=function(){if(X)for(var a=X.nj,b=0;b<a.length;b++)p(a[b]);X=null};a.fJ=function(a){return(a=a.X)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.kM=function(a,b){var d=a.X;if(d&&"POSITIONAL"==d.behavior){d.dist_ref=b.dist_ref;d.dist_max=b.dist_max;d.attenuation=b.attenuation;var c=d.vC;c&&(c.refDistance=d.dist_ref,c.maxDistance=d.dist_max,c.rolloffFactor=d.attenuation)}};a.YL=function(a,b){var d=
a.X;d&&d.Rg&&(d.Rg.frequency.value=b.freq,d.Rg.Q.value=b.Q,d.Rg.gain.value=b.gain)};a.RI=function(a){return(a=a.X)&&a.Rg?{freq:a.Rg.frequency.value,Q:a.Rg.Q.value,gain:a.Rg.gain.value}:null};a.QI=function(a,b,d,c){a=a.X;if(!a||!a.Rg)return null;a.Rg.getFrequencyResponse(b,d,c)};a.reset=function(){t.length=0;aa.length=0;M=null}};b4w.module.__physics=function(a,m){function l(a,b){for(var d=a.Ue,c=0;c<d.length;c++)d[c].hh.Ns&&b.push(d[c]),l(d[c],b)}function c(a,b,d){for(var c=a.zc.sa,e=0;e<c.length;e++)for(var f=c[e].C,h=0;h<f.Te.length;h++){var g=f.Te[h];"ANY"!=g.cc&&d!=g.cc||R(g,a,b)}}function b(a,b,d){if(G.yv(a))switch(b){case G.JO:var c=x(a);c.zc.jO=!0;G.ga(a,G.UP,Date.now()-performance.now(),ea.max_fps,ea.Iz?ca.gI:0);break;case G.KO:S.ae("URANIUM:",d.slice(1));break;case G.FO:S.error(d);break;case G.GO:M.Hu.apply(this,
d.slice(1));break;case G.PO:var e=q(d.fa);if(e){a=d.trans;c=d.quat;b=d.Th;var f=d.Ah,e=e.C;e.ru=d.time;O.sg(a,1,c,e.vA);ga.copy(b,e.Th);ga.copy(f,e.Ah)}break;case G.MO:(a=q(d.Pz))&&O.sg(d.trans,1,d.quat,a.v.cs[d.HC]);break;case G.HO:if(c=q(d[1]))a=d[4],c=c.$f.$t[d[2]],W.Gc(c,d[3]),W.ei(c,a),W.D(c);break;case G.QO:if(e=q(d[1]))e.v.speed=d[2];break;case G.BO:c=x(a);A(c,d.vl,d.wl,d.result,null,null,0);break;case G.DO:c=x(a);A(c,d.vl,d.wl,d.result,d.El,d.coll_norm,d.coll_dist);break;case G.CO:if(e=q(d[1]))a=
e.C,a.Dl&&a.Dl(d[2]);break;case G.LE:case G.NO:c=x(a);if(a=c.zc.yk[d.id])if(c=q(d.sn),b==G.LE)b=a.callback,b(a.id,d.hit_fract,c,d.hit_time);else{b=d.hit_fract;var f=d.hit_time,e=d.hit_pos,h=a.callback;e?h(a.id,b,c,f,e,d.hit_norm):h(a.id,b,c,f)}break;case G.OO:B(id);break;case G.LO:a=L.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(d[2]-d[1]).toFixed(3)+" ms, IN "+(performance.now()-d[2]).toFixed(3)+" ms, ALL "+(performance.now()-d[1]).toFixed(3)+" ms");break;case G.IO:pa=d[1];break;case G.EO:a=
L.indexOf(a);console.log("Worker: #"+String(a));console.log(d[1]);break;default:S.error("Wrong message: "+b)}}function x(a){for(var b=0;b<L.length;b++)if(L[b]==a)return Y[b]}function q(a){return xa[a]||null}function A(a,b,d,c,e,f,g){a=a.zc.sa;for(var k=0;k<a.length;k++)for(var l=a[k].C,n=0;n<l.Te.length;n++){for(var m=l.Te[n],v=m.vk,r=!1,p=0;p<v.length;p++){var t=v[p];if(t[0]===b&&t[1]===d){m.Ur[p]=c;r=!0;break}}r&&(v=h(m),e&&m.Bz!=b&&(r=e,p=f,t=g,r[0]+=p[0]*t,r[1]+=p[1]*t,r[2]+=p[2]*t,p[0]*=-1,p[1]*=
-1,p[2]*=-1),m.callback(v,v?m.Bz==b?q(d):q(b):null,e,f,g))}}function h(a){a=a.Ur;for(var b=!1,d=0;d<a.length;d++)b=b||a[d];return b}function z(){Z.body++;return Z.body}function p(a){var b=oa.indexOf(a);return-1==b?(oa.push(a),oa.length-1):b}function n(a,b){return{fa:a,type:b,Vh:0,Bv:!1,Jk:!0,bf:!1,fg:!1,tW:!1,gu:null,cc:"",vq:0,q3:{},Te:[],Dl:null,ru:0,vA:new Float32Array([0,0,0,1,0,0,0,1]),Th:new Float32Array(3),Ah:new Float32Array(3),bu:new Float32Array(3),hq:new Float32Array(4),Or:null}}function k(a,
b){switch(a){case "BOX":var d=b.P;break;case "CYLINDER":d=b.Zp;break;case "CONE":d=b.Yp;break;case "SPHERE":d=b.wa;break;case "CAPSULE":d=b.Xp}return d}function u(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=a.G);
"number"===typeof a.Xa&&(b.radius=a.Xa);"number"===typeof a.height&&(b.height=a.height);return b}function e(a,b,d,c,e){var f=O.F(a.k.n),h=O.invert(b.k.n,N),g=new Float32Array(3);O.Hc(f,h,g);switch(b.v.type){case 10:b=b.nf;a=a.k.P;G.ga(e,G.xP,d,g,b.XZ,b.ZC,(a.max_z-a.min_z)/2,c);break;case 20:G.ga(e,G.wP,d,g,a.p9)}}function y(a){return a.C&&a.C.gu}function K(a,b,d,c,e,f,h,g,k,l){var n;Z.oc++;n=Z.oc.toString(16);var m=b.C.fa;G.ga(F(m),G.EP,n,a,g,m,d,c,e.C.fa,f,h,k,l);b.C.gu=n}function F(a){for(var b=
0;b<Y.length;b++)for(var d=Y[b].zc.sa,c=0;c<d.length;c++)if(d[c].C.fa==a)return L[b];return null}function J(a){var b=a.C;if(b=b?0===b.Vh?!0:!0===b.Bv?!0:!1===b.Jk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=O.jc(a.k.n,fa),d=O.Yd(a.k.n,ha),b=b[0]!=a.C.bu[0]||b[1]!=a.C.bu[1]||b[2]!=a.C.bu[2]||d[0]!=a.C.hq[0]||d[1]!=a.C.hq[1]||d[2]!=a.C.hq[2]||d[3]!=a.C.hq[3];if(b){var b=a.C,c=a.k,d=G.$I(G.xt);d.fa=b.fa;var e=O.jc(c.n,d.trans),c=O.Yd(c.n,d.quat);ga.copy(e,b.bu);X.copy(c,b.hq);"DYNAMIC"==
b.type&&X.identity(d.quat);G.ga(F(b.fa),G.xt)}a=a.Ue;for(b=0;b<a.length;b++)J(a[b])}function D(a,b,d,c,e){e=e||new Float32Array(3);a=O.N(a.k.n);e[0]=b;e[1]=d;e[2]=c;ga.transformQuat(e,a,e)}function R(a,b,d){var c=a.vk,e=a.Ur,f=a.Bz,h=[],g=a.cc;h||V.q("At least one destination required");for(var k=0;k<b.zc.sa.length;k++){var l=b.zc.sa[k];if("ANY"==g||l.C.cc==g&&"NAVMESH"!=l.C.type)l=l.C.fa,h&&-1==h.indexOf(l)&&h.push(l)}for(b=0;b<h.length;b++)g=h[b],f<g&&!E(c,f,g)?(c.push([f,g]),e.push(!1)):f>g&&!E(c,
g,f)&&(c.push([g,f]),e.push(!1));G.ga(d,G.vP,f);G.ga(d,G.DP,c,a.Dh)}function E(a,b,d){for(var c=0;c<a.length;c++)if(a[c][0]==b&&a[c][1]==d)return!0;return!1}function I(a){a.C&&a.C.Dl&&(a=a.C,G.ga(F(a.fa),G.QP,a.fa),a.Dl=null)}function B(a){var b=d(a),c=P(a).zc;c.yk[a]&&(delete c.yk[a],c.MC.splice(c.MC.indexOf,1),G.ga(b,G.ZP,a))}function P(a){for(var b=0;b<Y.length;b++){var d=Y[b];if(d.zc.yk[a])return d}return null}function d(a){for(var b=0;b<Y.length;b++)if(Y[b].zc.yk[a])return L[b];return null}function f(a,
b,d){if(b.Wo){a=a.C.fa;var c=b.Hn*b.$q,e=b.fq*b.gq,f=-b.Uo*b.Vo*2*Math.PI/b.Gs;b.yr&&(f*=-1);switch(b.type){case 10:G.ga(d,G.lQ,a,c,e,f);break;case 20:G.ga(d,G.kQ,a,c,e,f)}}}function r(a){return a.bf&&"CHASSIS"==a.nf.hf}function g(a){return a.bf&&"HULL"==a.nf.hf}function Q(a){return"NAVMESH"==a.hh.Yr}function t(a){return a.km&&"MAIN_BODY"==a.Ln.hf}var aa=m("__config"),M=m("__debug"),G=m("__ipc"),T=m("__obj_util"),S=m("__print"),X=m("__quat"),H=m("__scenes"),ma=m("__subscene"),W=m("__transform"),O=
m("__tsr"),V=m("__util"),ga=m("__vec3"),v=m("__version"),ba=m("__navmesh"),ea=aa.C,ca=aa.B,na=aa.Pd,pa=0,L=[],Y=[],xa={},ya=[],oa=["ANY"],Z={body:0,oc:0,uL:0},fa=new Float32Array(3);new Float32Array(4);var ha=new Float32Array(4);new Float32Array(16);var N=O.create(),ka=O.create();a.kW=function(a){a.zc={jO:!1,sa:[],yk:{},MC:[]};var d=ea.Ms;na.prevent_caching&&(d+=v.timestamp());S.log("%cLOAD PHYSICS","color: #0a0",ea.Vs?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ea.max_fps);S.log("%cPHYSICS PATH",
"color: #0a0",d);var c=G.OT(d,!ea.Vs);G.tR(c,b);L.push(c);Y.push(a);ea.ping&&setInterval(function(){G.ga(c,G.WP,performance.now())},1E3)};a.uS=function(a){return a.zc?a.zc.jO:!0};a.ua=function(){for(var a=0;a<L.length;a++)G.terminate(L[a]);L.length=0;Y.length=0;xa={};ya.length=0;oa.length=0;for(var b in Z)Z[b]=0};a.on=function(a,b){a.k||V.q("No object render: "+a.name);var d;a:{for(var h=0;h<Y.length;h++)if(Y[h]==b){d=L[h];break a}d=void 0}var m=[];a.hh.Ns&&l(a,m);var v=b.zc.sa;if(r(a)||g(a)||a.fg||
t(a)||a.Um){var q=Q(a),H;if(q){var B=a,x=z(),W=n(x,"NAVMESH"),P=T.ka(B,b).V;W.Or=null;for(var I=0;I<P.length;I++){var A=P[I];if("PHYSICS"==A.type){W.Or=ba.xX(A.Ba);break}}H=W}else{var ca=a,F=d,w=ca.k,D=ca.hh,ea=D.Yr,E=z();if("CAMERA"==ca.type)var ga=D.kE?D.eu:"BOX",M=k(ga,w),R=w.Wl,ma=w.Ql,R=.5,ma=0;else if("EMPTY"==ca.type)ga="EMPTY",M=null,ma=R=0;else{var ga=D.kE?D.eu:"BOX",M=k(ga,w),J=O.td(w.n);if(1!=J){var na=M;switch(ga){case "BOX":na.min_x*=J;na.max_x*=J;na.min_y*=J;na.max_y*=J;na.min_z*=J;
na.max_z*=J;break;case "CYLINDER":case "CONE":case "CAPSULE":na.height*=J;na.Xa*=J;break;case "SPHERE":na.Xa*=J}}R=w.Wl;ma=w.Ql}var pa=O.F(w.n),aa=O.N(w.n),Z=D.Rs,fa=D.TN,oa=D.Vh,Ta=D.ZN,za=D.YN,hb=D.IH,Va=D.FL,Ja=ca.cc,eb=p(Ja),ob=D.wq,$a=D.uq,sb=D.xq,fb=w.wa.Xa,lb=u(M),wb=ca.iu,Sa;var Mb=ga;if(m.length){var Zb=[],Nb={};Nb.quat=new Float32Array([0,0,0,1]);Nb.trans=new Float32Array(3);Nb.worker_bounding=lb;Nb.bounding_type=Mb;Zb.push(Nb);var mb=O.invert(w.n,N),pd=ha,Ib=O.N(w.n);X.invert(Ib,pd);for(var ib=
0;ib<m.length;ib++){var fc={},Fc=m[ib],$c=Fc.hh.eu,tc=new Float32Array(4),Pc=new Float32Array(3),gc=O.F(Fc.k.n),Xc=O.N(Fc.k.n);O.Hc(gc,mb,Pc);X.multiply(pd,Xc,tc);fc.trans=Pc;fc.quat=tc;fc.bounding_type=$c;fc.worker_bounding=u(k($c,Fc.k));Zb.push(fc)}Sa=Zb}else Sa=[];G.ga(F,G.AP,E,pa,aa,ea,Z,fa,oa,Ta,za,hb,Va,eb,ob,$a,sb,ga,lb,fb,R,ma,Sa,wb);xa[E]=ca;ya.push(ca);var xb=n(E,"BOUNDING");xb.type=ea;xb.Vh=oa;xb.Bv=Z;xb.cc=Ja;xb.vq=eb;H=xb}var Wa=H;a.C=Wa;var ad={za:null,C:Wa};q||(v.push(ad),c(b,d,Wa.cc))}else for(var Qc=
T.ka(a,b).V,Rc=0;Rc<Qc.length;Rc++){var Ob=Qc[Rc],uc;if(uc="PHYSICS"==Ob.type){var jd;a:{for(var vc=b.zc.sa,kd=0;kd<vc.length;kd++){var bd=vc[kd].za;if(bd&&bd.id==Ob.id){jd=!0;break a}}jd=!1}uc=!jd}if(uc)if(Ob.Mf.Ja)if(Ob.xj&&b.s.Nc){var $b=Ob,cd=b,Db=d,nb=cd.s.Nc;G.ga(Db,G.JP,nb.bl);if($b.u0){var jb={};jb.dst_noise_scale0=$b.dst_noise_scale0;jb.dst_noise_scale1=$b.dst_noise_scale1;jb.dst_noise_freq0=$b.dst_noise_freq0;jb.dst_noise_freq1=$b.dst_noise_freq1;jb.dir_min_shore_fac=$b.dir_min_shore_fac;
jb.dir_freq=$b.dir_freq;jb.dir_noise_scale=$b.dir_noise_scale;jb.dir_noise_freq=$b.dir_noise_freq;jb.dir_min_noise_fac=$b.dir_min_noise_fac;jb.dst_min_fac=$b.dst_min_fac;jb.waves_hor_fac=$b.waves_hor_fac;var kb=nb.waves_height,Gc=nb.waves_length;nb.Ik?G.ga(Db,G.fF,jb,nb.Mo[0],nb.Mo[1],nb.Lo[0],nb.Lo[1],nb.WB,kb,Gc,nb.wD,cd.s.vD):G.ga(Db,G.fF,jb,0,0,0,0,0,kb,Gc,0,null)}}else{var wc;if(Ob.Rs){var hc=a,Eb=Ob,ac=d,xc=z(),Rb=Eb.Mf,ic=Rb.aa[0].a_position,yc=Rb.na||null,pb=Eb.cc,ab=p(pb),Kc=Eb.wq,dd=Eb.uq,
Fb=Eb.xq,Yb=O.F(hc.k.n);G.ga(ac,G.GP,xc,ic,yc,Yb,ab,Kc,dd,Fb);var gb=n(xc,"STATIC_MESH");gb.Bv=!0;gb.cc=pb;gb.vq=ab;wc=gb}else{var qb=a,yb=Ob,Yc=d,Sc=z(),jc=yb.Mf,nc=jc.aa[0].a_position,Jb=jc.na||null,oc=O.F(qb.k.n),pc=yb.Wl,Tc=yb.Ql,zc=yb.cc,qc=p(zc);G.ga(Yc,G.IP,Sc,nc,Jb,oc,pc,Tc,qc,yb.wq,yb.uq,yb.xq);var Kb=n(Sc,"STATIC_MESH");Kb.cc=zc;Kb.vq=qc;wc=Kb}Wa=wc;a.C=Wa;ad={za:Ob,C:Wa};v.push(ad);c(b,d,Wa.cc)}else S.error("Object "+a.name+" has collision material with no assigned vertices")}if(r(a)||
g(a)){var Xa=a,Oa=d,Sb=Xa.C.fa;r(Xa)?(Xa.v.type=10,G.ga(Oa,G.BP,Sb,Xa.v.ID,Xa.v.KD,Xa.v.JD,Xa.v.vE,Xa.v.XB)):g(Xa)&&(Xa.v.type=20,G.ga(Oa,G.zP,Sb,Xa.v.Tl,Xa.v.Zm,Xa.v.$m));if(Xa.v.xk){var kc=Xa.v.xk;switch(Xa.v.type){case 10:e(kc[0],Xa,Sb,!0,Oa);e(kc[1],Xa,Sb,!0,Oa);e(kc[2],Xa,Sb,!1,Oa);e(kc[3],Xa,Sb,!1,Oa);break;case 20:for(var Ua=0;Ua<kc.length;Ua++)e(kc[Ua],Xa,Sb,!1,Oa)}}f(a,a.v,d)}else if(a.fg){var zb=d,Lb=a.k,Tb=a.C,bc=Lb.P.max_z-Lb.P.min_z,Gb=Tb.fa,Ab=a.KG,bb=Ab.t0,Bb=Ab.xY,Ka=Ab.QZ,cc=Ab.FW,
Ma=Ab.v0,dc=V.bU(a);G.ga(zb,G.CP,Gb,dc,bc,bb,Bb,Ka,cc,Ma);Tb.fg=!0}else if(t(a)){var Ha=a,tb=d,Pb=Ha.C.fa;G.ga(tb,G.FP,Pb,Ha.$f.Tl,Ha.$f.Zm,Ha.$f.$m);if(Ha.$f.$t)for(var Ub=Ha.$f.$t,rc=0;rc<Ub.length;rc++){var Lc=Ub[rc],lc=O.F(Lc.k.n),ld=O.invert(Ha.k.n,N),ed=new Float32Array(3);O.Hc(lc,ld,ed);G.ga(tb,G.yP,Pb,ed,Lc.wG)}Ha.C.tW=!0}for(Rc=0;Rc<ya.length;Rc++)if(a=ya[Rc],a.C){var Mc=a;if(!y(Mc))for(var Hc=0;Hc<Mc.AC.length;Hc++){var Vb=Mc.AC[Hc],cb=Vb.target,mc=Vb.LX;if(cb.C){var Ac=new Float32Array([Vb.MX,
Vb.NX,Vb.OX]),Ic,Cb=new Float32Array([Vb.Ga,Vb.Ha,Vb.Ia]);Ic=V.Wj(Cb,new Float32Array(4));var Wb=O.identity(N),Wb=O.pe(Ac,Wb),Wb=O.di(Ic,Wb),Bc=O.multiply(Mc.k.n,Wb,N),Qb=O.invert(cb.k.n,ka),rb=O.multiply(Qb,Bc,Qb),Uc=O.F(rb),Vc=O.N(rb),db=Vb,Ya={};Ya.use_limit_x=db.f0;Ya.use_limit_y=db.g0;Ya.use_limit_z=db.h0;Ya.use_angular_limit_x=db.b0;Ya.use_angular_limit_y=db.c0;Ya.use_angular_limit_z=db.d0;Ya.limit_max_x=db.PW;Ya.limit_min_x=db.SW;Ya.limit_max_y=db.QW;Ya.limit_min_y=db.TW;Ya.limit_max_z=db.RW;
Ya.limit_min_z=db.UW;Ya.limit_angle_max_x=db.JW;Ya.limit_angle_min_x=db.MW;Ya.limit_angle_max_y=db.KW;Ya.limit_angle_min_y=db.NW;Ya.limit_angle_max_z=db.LW;Ya.limit_angle_min_z=db.OW;K(mc,Mc,Ac,Ic,cb,Uc,Vc,Ya,null,null)}}}};a.IU=q;a.update=function(a,b){for(var d=0;d<L.length;d++){var c=L[d],e=a;c&&G.cK(c)&&G.ga(c,G.mQ,e,b);for(var f=0;f<ya.length;f++){var h=ya[f],g=h.C;if(g.Jk&&g.ru){var k=G.cK(c)?e-g.ru:performance.now()/1E3-g.ru,k=Math.min(k,10/ea.max_fps),k=k-1/ea.max_fps;ca.yX&&(k=0);var l=N;
O.nW(g.vA,k,g.Th,g.Ah,N);W.fi(h,l);W.D(h);J(h);if(h.v)for(var g=h,k=g.v.xk,l=g.k.n,n=N,m=0;m<k.length;m++){var v=k[m];O.multiply(l,g.v.cs[m],n);W.fi(v,n);W.D(v)}h.v&&h.v.Wo&&(n=h,k=n.v,g=k.Wo)&&(m=n.v.TM,O.multiply(n.k.n,n.v.UM,g.k.n),l=fa,O.Xc(m,n.k.n,l),n=ha,X.setAxisAngle(l,-k.Uo*k.Vo*2*Math.PI,n),k=O.N(g.k.n),X.multiply(n,k,k),W.D(g));h.v&&h.v.BD&&(n=h,k=n.v,g=k.BD)&&(m=n.v.OM,O.multiply(n.k.n,n.v.PM,g.k.n),l=fa,O.Xc(m,n.k.n,l),n=ha,m=Math.abs(k.speed)*k.Es,m>k.jo&&(m=k.jo),X.setAxisAngle(l,-m,
n),k=O.N(g.k.n),X.multiply(n,k,k),X.normalize(k,k),W.D(g));h.v&&h.v.MD&&(l=h,g=l.v,h=g.MD)&&(n=l.v.eN,O.multiply(l.k.n,l.v.fN,h.k.n),k=fa,O.Xc(n,l.k.n,k),l=ha,X.setAxisAngle(k,-Math.abs(g.Hn)*g.Mq,l),g=O.N(h.k.n),X.multiply(l,g,g),X.normalize(g,g),W.D(h))}}G.UX(c);c=Y[d];(e=c.s.Nc)&&0<e.waves_height&&(c=H.La(c,ma.Pb),e=ga.length(c.yj)||1,G.ga(L[d],G.jQ,c.time*e))}};a.hV=function(){return Y[0]};a.pause=function(){for(var a=0;a<L.length;a++)G.ga(L[a],G.VP)};a.ci=function(){for(var a=0;a<L.length;a++)G.ga(L[a],
G.$P)};a.XH=function(a){(a=a.C)||V.q("No object physics");if(!a.Jk){var b=a.fa,d=F(b);a.Jk=!0;G.ga(d,G.TP,b)}};a.FA=function(a){(a=a.C)||V.q("No object physics");if(a.Jk){var b=a.fa,d=F(b);a.Jk=!1;G.ga(d,G.SP,b)}};a.Dw=function(a){return Boolean(a.zc)};a.oa=function(a){return Boolean(a.C)};a.KJ=function(a){return(a=a.C)&&a.Jk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Vh&&0==a.Bv?!0:!1};a.rB=function(a){return(a=a.C)&&a.Jk?!0:!1};a.eM=function(a,b){var d=a.C.fa;G.ga(F(d),G.iQ,d,b)};a.WV=y;a.UF=
K;a.XG=function(a){a=a.C;G.ga(F(body_a),G.YP,a.gu);a.gu=null};a.nL=function(b,d,c,e,f,h){d=O.sg(d,1,c,N);f=O.sg(f,1,h,ka);O.invert(d,d);O.multiply(f,d,d);W.nr(e,f);O.multiply(f,d,d);W.fi(b,d);W.D(b);e=O.F(b.k.n);f=O.N(b.k.n);a.xs(b,e,f)};a.xs=function(a,b,d){var c=a.C,e=G.$I(G.xt),f=O.jc(a.k.n,e.trans);a=O.Yd(a.k.n,e.quat);O.sg(f,1,a,c.vA);e.fa=c.fa;ga.copy(b,e.trans);X.copy(d,e.quat);G.ga(F(c.fa),G.xt)};a.H=J;a.ZF=function(a,b,d,c){var e=fa;D(a,b,d,c,e);a=a.C.fa;b=Math.abs(0);d=Math.abs(0);c=Math.abs(0);
var f=Math.abs(e[0]),h=Math.abs(e[1]),g=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=h?e[1]/h*Math.max(h,d):0;e[2]=g?e[2]/g*Math.max(g,c):0;G.ga(F(a),G.hF,a,e[0],e[1],e[2])};a.$F=function(a,b,d,c){a=a.C.fa;G.ga(F(a),G.hF,a,b,d,c)};a.uz=function(a,b,d,c,e){var f=fa;e?(f[0]=b,f[1]=d,f[2]=c):D(a,b,d,c,f);a=a.C.fa;G.ga(F(a),G.KP,a,f[0],f[1],f[2])};a.YF=function(a,b,d,c){var e=fa;D(a,b,d,c,e);a=a.C.fa;G.ga(F(a),G.MP,a,e[0],e[1],e[2])};a.Jw=function(a,b,d){a=a.C.fa;G.ga(F(a),G.cQ,a,b,d)};a.Eo=function(a,
b){var d=a.C.fa;G.ga(F(d),G.dQ,d,b)};a.UL=function(a,b){var d=a.C.fa;G.ga(F(d),G.hQ,d,b)};a.TL=function(a,b){var d=a.C.fa;G.ga(F(d),G.fQ,d,b)};a.QL=function(a,b){var d=a.C.fa;G.ga(F(d),G.aQ,d,b)};a.Oz=function(a){a=a.C.fa;G.ga(F(a),G.OP,a)};a.JG=function(a,b,d){a=a.C.fa;G.ga(F(a),G.PP,a,b,d)};a.us=function(a,b,d){a=a.C.fa;G.ga(F(a),G.eQ,a,b,d)};a.RL=function(a,b){var d=a.C.fa;G.ga(F(d),G.bQ,d,b)};a.SL=function(a,b){var d=a.C.fa;G.ga(F(d),G.gQ,d,b)};a.qz=function(a,b,d,c){var e=a.C;if(!e.Or){for(var f=
e.fa,h=0;h<e.Te.length;h++)if(a=e.Te[h],a.cc==b&&a.callback==d)return;a={Bz:f,Dh:c||!1,cc:b,callback:d,vk:[],Ur:[]};e.Te.push(a);b=F(f);R(a,x(b),b)}};a.QC=function(a,b,d){a=a.C;for(var c=F(a.fa),e=x(c),f=0;f<a.Te.length;f++){var g=a.Te[f];if(g.cc==b&&g.callback==d){if(h(g)){var k=ga.set(0,0,0,fa);g.callback(!1,null,k,k,0)}a.Te.splice(f,1);f--;for(var k=c,g=g.vk,l=e.zc.sa,n=0;n<l.length;n++)for(var m=l[n].C,v=0;v<m.Te.length;v++)for(var r=m.Te[v],p=0;p<r.vk.length;p++)for(var t=r.vk[p],q=0;q<g.length;q++){var u=
g[q];t[0]==u[0]&&t[1]==u[1]&&(g.splice(q,1),q--)}g.length&&G.ga(k,G.gF,g)}}};a.tz=function(a,b){a.C&&a.C.Dl&&I(a);var d=a.C;G.ga(F(d.fa),G.LP,d.fa);d.Dl=b};a.Tz=I;a.Pt=function(a,b,d,c,e,f,h,g,k){var l;Z.uL++;l=Z.uL;a={id:l,fa:a?a.C.fa:0,from:new Float32Array(b),to:new Float32Array(d),cc:c,vq:p(c),fG:f,NR:h,Dh:g,sv:k,callback:e};b=F(a.fa)||L[0];d=x(b).zc;l=a.id;d.yk[l]=a;d.MC.push(a);G.ga(b,G.HP,a.id,a.fa,a.from,a.to,a.vq,a.fG,a.NR,a.Dh,a.sv);return l};a.RC=B;a.HG=function(a,b,c){var e=d(a),f=P(a).zc.yk[a];
f&&!f.fG&&(f.from.set(b),f.to.set(c),G.ga(e,G.NP,a,b,c))};a.eK=function(a){return P(a).zc.yk[a]?!0:!1};a.kp=function(a,b){var d=a.v;d.Hn=b;f(a,d,F(a.C.fa))};a.jp=function(a,b){var d=a.v;d.Uo=b;f(a,d,F(a.C.fa))};a.nE=function(a,b){var d=a.v;d.fq=b;f(a,d,F(a.C.fa))};a.cf=r;a.df=g;a.T6=Q;a.rW=function(a){if(!a.bf)return!1;a=a.nf.hf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.qW=function(a){return a.bf?"BOB"==a.nf.hf?!0:!1:!1};a.uW=function(a){return a.km?
"BOB"==a.Ln.hf?!0:!1:!1};a.gK=function(a){return a.bf&&"STEERING_WHEEL"==a.nf.hf?!0:!1};a.fK=function(a){return a.bf&&"SPEEDOMETER"==a.nf.hf?!0:!1};a.hK=function(a){return a.bf&&"TACHOMETER"==a.nf.hf?!0:!1};a.xJ=function(a){return a.v.speed};a.x0=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.fg=function(a){return a.fg};a.O6=t;a.AV=function(){return pa};a.YT=function(){for(var a=0;a<L.length;a++)G.ga(L[a],
G.RP)};a.ls=function(a){if("BOUNDING"==a.C.type){var b=ya.indexOf(a);-1==b&&S.error("Object "+a.name+" doesn't have bounding physics");delete xa[d];ya.splice(b,1)}for(var d=a.C.fa,b=F(d),c=x(b),e=d,f=c.zc.sa,g=[],k=0;k<f.length;k++)for(var l=f[k].C,n=0;n<l.Te.length;n++)for(var m=l.Te[n],v=0;v<m.vk.length;v++){var r=m.vk[v],p=m.Ur[v];if(r[0]==e||r[1]==e)m.vk.splice(v,1),m.Ur.splice(v,1),v--,p&&!h(m)&&(p=ga.set(0,0,0,fa),m.callback(!1,null,p,p,0)),g.push(r)}g.length&&G.ga(b,G.gF,g);a.C&&a.C.Dl&&I(a);
a=c.zc.sa;for(c=0;c<a.length;c++)a[c].C.fa==d&&(a.splice(c,1),c--);G.ga(b,G.XP,d)}};b4w.module.__ipc=function(a,m){function l(a,b,c){for(var d=0;d<u.length;d+=2)u[d+1]==a&&(k[d+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var h=c[e];switch(h.constructor){case Float32Array:d+=h.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.JO=0;var x=a.BO=1,q=a.DO=2;a.CO=3;a.FO=4;a.GO=5;a.HO=6;a.KO=7;var A=a.MO=8,h=a.LE=9,z=a.NO=10;a.OO=11;var p=a.PO=12;a.QO=13;a.LO=14;a.IO=15;a.EO=16;a.UP=100;a.vP=101;a.wP=102;a.xP=103;a.yP=104;a.AP=105;a.zP=106;
a.BP=107;a.CP=108;a.DP=109;a.EP=110;a.FP=111;a.GP=112;a.IP=113;a.JP=114;a.XP=115;a.KP=116;a.LP=117;a.MP=118;a.OP=119;a.PP=120;a.QP=121;a.SP=122;a.TP=123;a.VP=124;a.HP=125;a.ZP=126;a.NP=127;a.gF=128;a.YP=129;a.$P=130;a.aQ=131;a.bQ=132;a.cQ=133;a.dQ=134;a.eQ=135;a.fQ=136;a.gQ=137;a.hQ=138;a.iQ=139;a.hF=140;var n=a.xt=141;a.jQ=142;a.fF=143;a.kQ=144;a.lQ=145;a.WP=146;a.RP=147;a.mQ=148;var k=b4w.worker_listeners,u=b4w.worker_namespaces,e={Jf:p,fa:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Th:new Float32Array(3),Ah:new Float32Array(3),len:0},y={Jf:A,Pz:0,HC:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},K={Jf:h,id:0,sn:0,hit_fract:0,hit_time:0,len:0},F={Jf:z,id:0,sn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},J={Jf:x,vl:0,wl:0,result:0,len:0},D={Jf:q,vl:0,wl:0,result:0,El:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},R={Jf:n,fa:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},E=[e,y,K,F,J,D,
R];a.OT=function(a,c){var e={Cv:a?!0:!1,cl:null,Ch:[],Zf:""};if(c)if(e.cl={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");l(e.Zf,e.Cv,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");l(e.Zf,e.Cv,null)},postMessage:function(a){var b;a:{for(b=0;b<u.length;b+=2)if(u[b+1]==e.Zf){b=k[b+Number(!!e.Cv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<u.length;a+=2)if(u[a+1]==e.Zf){k.splice(a,2);u.splice(a,2);break}}},e.Cv){var d=
m("__util"),f=m("__container"),h=b4w.get_namespace(m),d=d.Js(h+"_worker");u.push(h);u.push(d);k.push(null);k.push(null);e.Zf=d;(f=f.KU(a))?b?f.addEventListener("load",function(){b4w.require("__bindings",e.Zf)},!1):(b4w.ua("__bindings",e.Zf),b4w.ua("__ipc",e.Zf),b4w.require("__bindings",e.Zf)):(f=document.createElement("script"),f.src=a,f.defer="defer",f.async="async",f.addEventListener("load",function(){b=!1;b4w.require("__bindings",e.Zf)},!1),document.head.appendChild(f))}else e.Zf=b4w.get_namespace(m);
else e.cl=a?new Worker(a):self;return e};a.tR=function(a,b){function k(d){if(d.constructor==ArrayBuffer)d=new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var c=0;c<d.length;c++)k(d[c]);return}c=d[0]|0;switch(c){case p:var l=e;l.fa=d[1]|0;l.time=d[2];l.trans[0]=d[3];l.trans[1]=d[4];l.trans[2]=d[5];l.quat[0]=d[6];l.quat[1]=d[7];l.quat[2]=d[8];l.quat[3]=d[9];l.Th[0]=d[10];l.Th[1]=d[11];l.Th[2]=d[12];l.Ah[0]=d[13];l.Ah[1]=d[14];l.Ah[2]=d[15];break;case A:l=y;l.Pz=d[1]|0;l.HC=d[2]|0;l.trans[0]=
d[3];l.trans[1]=d[4];l.trans[2]=d[5];l.quat[0]=d[6];l.quat[1]=d[7];l.quat[2]=d[8];l.quat[3]=d[9];break;case h:l=K;l.id=d[1]|0;l.sn=d[2]|0;l.hit_fract=d[3];l.hit_time=d[4];break;case z:l=F;l.id=d[1]|0;l.sn=d[2]|0;l.hit_fract=d[3];l.hit_time=d[4];l.hit_pos[0]=d[5];l.hit_pos[1]=d[6];l.hit_pos[2]=d[7];l.hit_norm[0]=d[8];l.hit_norm[1]=d[9];l.hit_norm[2]=d[10];break;case x:l=J;l.vl=d[1]|0;l.wl=d[2]|0;l.result=!!d[3];break;case q:l=D;l.vl=d[1]|0;l.wl=d[2]|0;l.result=!!d[3];l.El[0]=d[4];l.El[1]=d[5];l.El[2]=
d[6];l.coll_norm[0]=d[7];l.coll_norm[1]=d[8];l.coll_norm[2]=d[9];l.coll_dist=d[10];break;case n:l=R;l.fa=d[1]|0;l.trans[0]=d[2];l.trans[1]=d[3];l.trans[2]=d[4];l.quat[0]=d[5];l.quat[1]=d[6];l.quat[2]=d[7];l.quat[3]=d[8];break;default:l=d}b(a,c,l)}c(E);a.cl.addEventListener("message",function(a){k(a.data)},!1)};a.ua=function(){};a.ga=function(a,b){if(a)switch(b){case p:var c=e,d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.fa;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=
c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Th[0];d[11]=c.Th[1];d[12]=c.Th[2];d[13]=c.Ah[0];d[14]=c.Ah[1];d[15]=c.Ah[2];a.Ch.push(d.buffer);break;case A:c=y;d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.Pz;d[2]=c.HC;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.Ch.push(d.buffer);break;case h:c=K;d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.id;d[2]=c.sn;d[3]=c.hit_fract;d[4]=c.hit_time;a.Ch.push(d.buffer);break;case z:c=F;d=new Float32Array(c.len);
d[0]=c.Jf;d[1]=c.id;d[2]=c.sn;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.Ch.push(d.buffer);break;case x:c=J;d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.vl;d[2]=c.wl;d[3]=c.result;a.Ch.push(d.buffer);break;case q:c=D;d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.vl;d[2]=c.wl;d[3]=c.result;d[4]=c.El[0];d[5]=c.El[1];d[6]=c.El[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.Ch.push(d.buffer);break;case n:c=R;d=new Float32Array(c.len);d[0]=c.Jf;d[1]=c.fa;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.Ch.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.cl.postMessage(d)}};a.UX=function(a){a&&a.Ch.length&&(a.cl.postMessage(a.Ch),a.Ch.length=0)};a.$I=function(a){switch(a){case p:return e;case A:return y;case h:return K;case z:return F;case x:return J;case q:return D;case n:return R;
default:return null}};a.terminate=function(a){a.cl.terminate();a.cl=null};a.yv=function(a){return!!a.cl};a.cK=function(a){return!!a.Zf}};b4w.module.__transform=function(a,m){function l(a,b){k.dg(a)?J.pe(b,k.cg(a)):J.pe(b,a.k.n)}function c(a,b){var d=a.k;if(k.dg(a)){J.di(b,d.n);var c=k.Ru(a),c=J.invert(c,P);J.multiply(c,d.n,k.cg(a))}else J.di(b,d.n)}function b(a,b){k.dg(a)?J.di(b,k.cg(a)):J.di(b,a.k.n)}function x(a,b){J.Yd(a.k.n,b);return b}function q(a,b){k.dg(a)?J.Yd(k.cg(a),b):J.Yd(a.k.n,b);return b}function A(a,b){k.dg(a)?J.copy(b,k.cg(a)):J.copy(b,a.k.n)}function h(a,b){k.dg(a)?J.copy(k.cg(a),b):J.copy(a.k.n,b);return b}function z(a){var b=
a.k,d=a.I,c=a.type;"CAMERA"==c&&n.hE(a);k.F_(a,f);"CAMERA"==c&&n.D_(a);var h=J.jc(b.n,E),l=J.Yd(b.n,B);p.yl(b.P,b.n,b.Ta);p.eq(b.wa,b.n,b.lb);if(b.hp)for(var m=0;m<d.length;m++)for(var q=d[m].V,x=0;x<q.length;x++){var H=q[x];p.yl(H.P,b.n,H.Ta);p.eq(H.wa,b.n,H.lb);H.Qf&&p.dq(H.ba,b.n,H.qb)}else b.Qf&&p.dq(b.ba,b.n,b.qb);switch(c){case "MESH":a.LK&&J.invert(a.k.n,a.k.Mx);if(q=a.St)J.invert(q.k.n,P),J.multiply(P,b.n,P),J.QV(P,b.Up),J.Yd(P,b.Tp);b.ar=!0;break;case "CAMERA":for(m=0;m<d.length;m++)n.E_(a,
d[m]);break;case "SPEAKER":F.HZ(a,f,r);break;case "LAMP":u.I_(a)}for(m=0;m<d.length;m++)if(x=d[m],x.yv){q=x.yb;H=q.s;switch(c){case "MESH":b.Ge&&K.cD(q);H=x.Hi;null!=b.Rd&&H&&K.DN(H,h);break;case "EMPTY":e.G_(a);break;case "CAMERA":K.zY(q);if(H.xd){H.xd.enable_csm&&K.cD(q);var A=y.ka(a,q).da[0];K.T_(A,H.Wa)}K.A()==q&&K.Mh(q)==a&&F.WW(q,h,l,f,r);break;case "LAMP":K.gp(a,q)}H=x.Yh;A=a.ks;if(A.length)for(x=0;x<H.length;x++){var W=H[x].p;K.GN(H[x],h,l);y.HN(A,W.qc);n.kZ(W,K.Mh(q));D.In(W.md,W.Lh)}}b=
a.Ue;for(m=0;m<b.length;m++)z(b[m]);a=a.$z;for(m=0;m<a.length;m++)b=a[m],q=b[0],k.x_(q,b[1])}var p=m("__boundings"),n=m("__camera"),k=m("__constraints"),u=m("__lights"),e=m("__objects"),y=m("__obj_util"),K=m("__scenes"),F=m("__sfx"),J=m("__tsr"),D=m("__util"),R=m("__vec3"),E=new Float32Array(3),I=new Float32Array(3),B=new Float32Array(4);new Float32Array(9);var P=J.create(),d=J.create(),f=0,r=0;a.qF=0;a.mn=1;a.update=function(a){f=a;r++};a.Gc=function(a,b){var d=a.k;if(k.dg(a)){J.pe(b,d.n);var c=
k.Ru(a),c=J.invert(c,P);J.multiply(c,d.n,k.cg(a))}else J.pe(b,d.n)};a.Tw=l;a.Zd=function(a,b){J.jc(a.k.n,b);return b};a.vJ=function(a,b){k.dg(a)?J.jc(k.cg(a),b):J.jc(a.k.n,b);return b};a.ei=c;a.Rw=b;a.bm=x;a.kJ=q;a.Qw=function(a,b){var d=D.Wj(b,B);c(a,d)};a.nD=function(a,d){var c=D.Wj(d,B);b(a,c)};a.iJ=function(a,b){x(a,B);return b=D.yw(euler,b)};a.jJ=function(a,b){q(a,B);return b=D.yw(euler,b)};a.Fe=function(a,b){var d=a.k;if(k.dg(a)){var d=k.cg(a),c=J.td(k.Ru(a));J.Fe(b/c,d)}else J.Fe(b,d.n)};a.oD=
function(a,b){var d=a.k;k.dg(a)?J.Fe(b,k.cg(a)):J.Fe(b,d.n)};a.td=function(a){return J.td(a.k.n)};a.mJ=function(a){return k.dg(a)?J.td(k.cg(a)):J.td(a.k.n)};a.fi=function(a,b){J.copy(b,a.k.n);if(k.dg(a)){var d=k.Ru(a),d=J.invert(d,P);J.multiply(d,a.k.n,k.cg(a))}};a.Uw=A;a.nr=function(a,b){return J.copy(a.k.n,b)};a.or=h;a.Vu=function(a){var b=a.k;a=b.tl;var d=J.td(b.n),b=d*(a.max_x-a.min_x),c=d*(a.max_y-a.min_y);a=d*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+c*c+a*a)};a.Uu=function(a,b,d){b?(a=a.k,R.copy(a.lb.G,
d)):(a=a.k,b=a.tl,d[0]=(b.max_x+b.min_x)/2,d[1]=(b.max_y+b.min_y)/2,d[2]=(b.max_z+b.min_z)/2,J.Hc(d,a.n,d));return d};a.dh=function(a,b,d,c){var e=h(a,P),f=E;f[0]=b;f[1]=d;f[2]=c;J.Hc(f,e,f);l(a,f)};a.$C=function(a,b){var c=h(a,P),e=J.di(b,J.identity(d));J.multiply(c,e,e);A(a,e)};a.D=z;a.distance=function(a,b){var d=J.jc(a.k.n,E),c=J.jc(b.k.n,I);return R.dist(d,c)};a.po=function(a,b){var d=J.jc(a.k.n,E);return R.dist(d,b)};a.cJ=function(a){return{max_x:a.k.Ta.max_x,min_x:a.k.Ta.min_x,max_y:a.k.Ta.max_y,
min_y:a.k.Ta.min_y,max_z:a.k.Ta.max_z,min_z:a.k.Ta.min_z}}};"object"==typeof module&&module.MA&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function m(){var a=l,c=a.getDate(),c=10>c?"0"+String(c):String(c),m=a.getMonth()+1,m=10>m?"0"+String(m):String(m),A=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),z=a.getMinutes(),z=10>z?"0"+String(z):String(z),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+m+"."+A+" "+h+":"+z+":"+a}var l=new Date(2017,3,14,12,58,32),c=[16,12,1];a.version=function(){return c};a.oE=function(){for(var a="",l=0;l<c.length;l++)a=1==l?a+(10>c[l]?"0"+
c[l]:c[l]):a+c[l],l!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.JH=function(){return l};a.xA=m;a.timestamp=function(){var a=m(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.MA&&b4w.module.__version(exports);b4w.module.__navmesh=function(a,m){function l(a,d){function c(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.al,f=d.al,h=[],k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);if(2>h.length)return[];0<=b(h,e[0])&&0<=b(h,e[e.length-1])&&c(e);0<=b(h,f[0])&&0<=b(h,f[f.length-1])&&c(f);h=[];for(k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);return h}function c(a){function b(a){for(var d=a.jg,c=0;c<d.length;c++){var e=d[c];void 0==e.island&&(e.island=a.island,b(e))}}a=a.SX;for(var d=[],c=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=c++,b(f));d[f.island]||(d[f.island]=[]);d[f.island].push(a[e])}return d}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var d=0;d<a.length;d++)if(a[d]==b)return d;return-1}function x(a){function b(a,d){for(var c=0;c<a.length;c++)if(d===a[c])return c}for(var d={},e=a.lp,f=0;f<e.length;f++)e[f][0]=parseFloat(e[f][0].toFixed(2)),e[f][1]=parseFloat(e[f][1].toFixed(2)),e[f][2]=parseFloat(e[f][2].toFixed(2));d.lp=a.lp;a=c(a);d.IB=[];for(f=0;f<a.length;f++){for(var e=
[],h=a[f],k=0;k<h.length;k++){for(var g=[],n=h[k],m=0;m<n.jg.length;m++)g.push(b(h,n.jg[m]));for(var r=[],m=0;m<n.jg.length;m++)r.push(l(n,n.jg[m]));n.gd[0]=parseFloat(n.gd[0].toFixed(2));n.gd[1]=parseFloat(n.gd[1].toFixed(2));n.gd[2]=parseFloat(n.gd[2].toFixed(2));e.push({id:b(h,n),jg:g,al:n.al,gd:n.gd,Vc:n.Vc,TX:r,QA:0,cr:0,Ib:0,KS:1,qE:!1,closed:!1,parent:null})}d.IB.push(e)}return d}function q(a,b,d,c,e){function f(a,b){D.subtract(a,b,E);return D.dot(E,E)}function h(a,b){for(var d=[],c=0;c<b.jg.length;c++)d.push(a[b.jg[c]]);
return d}(function(a){for(var b=0;b<a.length;b++){var d=a[b];d.QA=0;d.cr=0;d.Ib=0;d.KS=1;d.qE=!1;d.closed=!1;d.parent=null}})(a);var k=K.BR(function(a){return a.QA});for(K.pG(k,b);0<k.content.length;){var g=K.CR(k);if(g===d){a=g;for(d=[];a.parent;)d.push(a),a=a.parent;d.push(b);return d.reverse()}g.closed=!0;for(var l=h(a,g),n=0,m=l.length;n<m;n++){var r=l[n];if(!r.closed){var p=g.cr+D.dist(r.gd,g.gd),t=r.qE;if(!t||p<r.cr)r.qE=!0,r.parent=g,r.Ib=r.Ib||f(r.gd,e)+f(r.gd,c),r.cr=p,r.QA=r.cr+r.Ib,t?K.DR(k,
r):K.pG(k,r)}}}return[]}function A(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function h(a,b,d,c){b=D.subtract(b,a,E);a=D.subtract(d,a,I);a=D.cross(b,a,E);return J.sign(D.dot(c,a))}function z(a,b){D.subtract(a,b,E);return 1E-5>D.dot(E,E)}function p(a,b,d){var c=D.subtract(b.right,b.left,E),e=d.Vc,f=b.Vc;d=Math.acos(D.dot(e,f));e=J.sign(D.dot(c,D.cross(e,f,I)));d*=-e;e=F.identity(g);F.translate(e,b.left,e);F.rotate(e,d,c,e);F.translate(e,D.scale(b.left,-1,I),e);F.multiply(a,e,a)}function n(a,b,c,
e,h,k,g,l,n){for(var m=F.identity(f),r=h;r<c;r++)if(a[r].aK&&(r>h||!r)){var t,q=b,u=e;t=a[r].left;var z=a[r].right,y=k,x=m,G=D.create(),Q=D.transformMat4(t,x,B);Q[3]=1;x=D.transformMat4(z,x,E);x=D.subtract(x,Q,P);q=D.subtract(u,q,E);y=D.cross(y,q,d);.01>Math.abs(D.dot(y,x))?u=.5:(D.normalize(y,y),y[3]=-D.dot(y,u),u=-R.dot(y,Q)/R.dot(y,x));z=D.subtract(z,t,E);t=D.scaleAndAdd(t,z,u,G);A(g,t);l&&A(n,a[r].Vc);r&&p(m,a[r],a[r-1])}}function k(a,b){function d(b,c){B=y=u=c;g=k=f=b;D.copy(b,l);D.copy(b,m);
D.copy(a[u].Vc,q)}var c=[],e=[],f,k,g,l,m,q,u=0,y=0,B=0;f=a[0].right;k=a[0].left;g=a[0].right;l=D.copy(k,Q);m=D.copy(g,t);q=D.copy(a[0].Vc,G);A(c,f);b&&A(e,a[0].Vc);for(var x=F.identity(r),L=1;L<a.length;L++){var I=a[L].left,P=a[L].right,K=D.transformMat4(I,x,aa),E=D.transformMat4(P,x,M);a[L].aK&&p(x,a[L],a[L-1]);if(0>=h(f,m,E,q)){var R=z(f,g);if(R||0<h(f,l,E,q))g=P,D.copy(E,m),B=L;else{(I=z(l,f))||n(a,l,y,f,u,q,c,b,e);x=F.identity(x);d(k,y);L=u;I||(A(c,f),b&&A(e,a[L].Vc));continue}}0<=h(f,l,K,q)&&
((R=z(f,k))||0>h(f,m,K,q)?(k=I,D.copy(K,l),y=L):((I=z(m,f))||n(a,m,B,f,u,q,c,b,e),x=F.identity(x),d(g,B),L=u,I||(A(c,f),b&&A(e,a[L].Vc))))}x=a.length-1;L=a[x].left;(I=z(f,L))||n(a,l,x,f,u,q,c,b,e);I&&u||A(c,L);return b?(A(e,a[x].Vc),{positions:new Float32Array(c),normals:new Float32Array(e)}):{positions:new Float32Array(c),normals:null}}function u(a,b,d,c,e){for(var f=null,h=Number.MAX_VALUE,k=0;k<a.length;k++){var g=a[k],l=e(d,g.gd,g.al,b,h);l<h&&(f=g,h=l)}return 0<c&&h>c?null:f}function e(a,b,d,
c,e){a.push({left:b,right:d,aK:c,Vc:e})}var y=m("__geometry"),K=m("__math"),F=m("__mat4"),J=m("__util"),D=m("__vec3"),R=m("__vec4"),E=D.create(),I=D.create(),B=R.create(),P=R.create(),d=R.create(),f=F.create(),r=F.create(),g=F.create(),Q=D.create(),t=D.create(),aa=D.create(),M=D.create(),G=D.create();a.xX=function(a){var b=y.$u(a.rc,y.rQ),d=a.ke;a=[];for(var c=0;c<d.length;c+=3)a.push({na:new Uint32Array([d[c],d[c+1],d[c+2]]),gd:new Float32Array(3),Vc:new Float32Array(3)});d=[];for(c=0;c<b.length;c+=
3){var e=new Float32Array(3);e[0]=b[c];e[1]=b[c+1];e[2]=b[c+2];d.push(e)}for(b=0;b<a.length;b++)c=a[b],D.add(d[c.na[0]],d[c.na[1]],E),D.add(E,d[c.na[2]],E),D.scale(E,1/3,c.gd);for(b=0;b<a.length;b++){var c=a[b],e=D.subtract(d[c.na[1]],d[c.na[0]],E),f=D.subtract(d[c.na[2]],d[c.na[0]],I),e=D.cross(e,f,E);D.normalize(e,e);D.copy(e,c.Vc)}for(var h={},b=[],c=[],k,g,l=Math.pow(10,4),e=0,f=d.length;e<f;e++)k=d[e],g=Math.round(k[0]*l)+"_"+Math.round(k[1]*l)+"_"+Math.round(k[2]*l),void 0===h[g]?(h[g]=e,b.push(k),
c[e]=b.length-1):c[e]=c[h[g]];h=[];e=0;for(f=a.length;e<f;e++)for(k=a[e],k.na[0]=c[k.na[0]],k.na[1]=c[k.na[1]],k.na[2]=c[k.na[2]],k=[k.na[0],k.na[1],k.na[2]],g=0;3>g;g++)if(k[g]==k[(g+1)%3]){h.push(e);break}for(e=h.length-1;0<=e;e--)a.splice(h[e],1);d.length=0;for(e in b)d.push(b[e]);c=[];for(b=e=0;b<a.length;b++)f=a[b],c.push({id:e++,al:f.na,gd:f.gd,Vc:f.Vc,jg:[]});a={SX:c,lp:d};d={};for(b=0;b<c.length;b++)for(e=0;3>e;e++)f=c[b].al[e],h=c[b].al[(e+1)%3],f=f>h?h+"-"+f:f+"-"+h,f in d||(d[f]=[]),d[f].push(c[b]);
c=Object.keys(d);b=0;for(h=c.length;b<h;b++)for(f=c[b],e=0;e<d[f].length;e++)for(k=e+1;k<d[f].length;k++)d[f][e].jg.push(d[f][k]),d[f][k].jg.push(d[f][e]);return x(a)};a.JK=function(a,b,d){for(var c=null,e=Number.MAX_VALUE,f=a.IB,h=0;h<f.length;h++)for(var k=0;k<f[h].length;k++){var g=f[h][k];D.subtract(g.gd,b,E);g=d(b,g.gd,g.al,a.lp,e);g<e&&(c=h,e=g)}return c};a.AW=function(a,b,d){for(var c=[],e=0;e<b.length;e++)c.push(d[b[e]]);b=!1;d=-1;for(var e=c.length,f=e-1;++d<e;f=d)(c[d][1]<=a[1]&&a[1]<c[f][1]||
c[f][1]<=a[1]&&a[1]<c[d][1])&&a[0]<(c[f][0]-c[d][0])*(a[1]-c[d][1])/(c[f][1]-c[d][1])+c[d][0]&&(b=!b);return b?!0:!1};a.IK=function(a,b,d,c){var f;f=a.IB[c.island];var h=a.lp,g=u(f,h,b,c.allowed_distance,c.distance_to_closest);f=g?(h=u(f,h,d,c.allowed_distance,c.distance_to_farthest))?q(f,g,h,b,d):null:null;if(f&&f.length)if(c.do_not_pull_string)if(d=f,c.return_normals){b=new Float32Array(3*d.length);for(f=0;f<d.length;f++)b.set(d[f].gd,3*f);d={positions:b,normals:null}}else{b=new Float32Array(3*
d.length);a=new Float32Array(3*d.length);for(f=0;f<d.length;f++)b.set(d[f].gd,3*f),a.set(d[f].Vc,3*f);d={positions:b,normals:a}}else{a=a.lp;c=c.return_normals;g=[];e(g,b,b,!1,f[0]&&f[0].Vc||J.Oc);for(b=0;b<f.length;b++){var l=f[b];if(h=f[b+1]){var n=.999>Math.abs(D.dot(l.Vc,h.Vc));a:{for(var m=0;m<l.jg.length;m++)if(l.jg[m]===h.id){l=l.TX[m];break a}l=void 0}e(g,a[l[0]],a[l[1]],n,h.Vc)}}e(g,d,d,!1,g[g.length-1].Vc);d=k(g,c)}else d=null;return d}};b4w.module.__primitives=function(a,m){function l(a,b,c,l){for(var e=[],m=[],q=[],z=[],x=2*c/(a-1),D=2*l/(b-1),R=0;R<a;R++)for(var E=-c+R*x,I=0;I<b;I++)if(m.push(E,-l+I*D,0),z.push(0,0,0,1),q.push(R/(a-1),I/(b-1)),R&&I){var B=R*b+I,P=B-1,d=(R-1)*b+I,f=d-1;e.push(B,P,d);e.push(P,f,d)}a=h.Kg();a.a_position=new Float32Array(m);a.a_tbn_quat=new Float32Array(z);z=A.Hf("GRID_PLANE");z.aa[0]=a;z.qa.a_texcoord=new Float32Array(q);z.na=new Uint32Array(e);z.Ja=m.length/3;return z}function c(a){var b=a.length;
b%4&&h.q("Wrong array");for(var c=[],l=[],e=0;e<b;e+=4){var m=a[e+1],q=a[e+2],z=a[e+3];x(a[e],l);x(m,l);x(q,l);x(z,l);c.push(e,e+1,e+2);c.push(e,e+2,e+3)}a=h.Kg();a.a_position=new Float32Array(l);b=A.Hf("FROM_QUADS");b.aa[0]=a;b.na=new Uint32Array(c);b.Ja=l.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function x(a,b){b.push(a[0],a[1],a[2])}var q=m("__config"),A=m("__geometry");m("__print");var h=m("__util"),z=q.B;a.eV=function(){var a=A.Hf("LINE"),b=h.Kg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.na=new Uint32Array(1);a.Ja=1;return a};a.x4=function(a,b){var c=l(2,2,a,b);c.name="PLANE";return c};a.w4=l;a.YU=function(a,b,c){function l(a,b){return 1==a%2&&(0==b||b==x-1)||1==b%2&&(0==a||a==q-1)?!0:!1}var e=c/=Math.pow(2,a-1),m=c,q=b+1,x=b+1;b=[];c=[];for(var J=[],D=0,R=0,E=-1,I=[],B=0;B<a;B++){for(var P=2*e/(q-1),d=2*m/(x-1),f=[],r=[],g=0,Q=0;Q<q;Q++){for(var t=-e+Q*P,aa=[],M=0;M<x;M++){var G=-m+M*d;if(t>-D&&t<D&&G>-R&&G<R)aa.push(-1),g++;else{for(var T=
null,S=0;S<I.length;S+=3)if(t==I[S]&&G==I[S+1]){T=I[S+2];break}S=null!==T?T:E+1;l(Q,M)?(aa.push(-2),g++):(null==T&&(0==M||M==x-1||0==Q||Q==q-1?(T=B==a-1?P:2*P,f.push(t,G,S)):T=P,c.push(t,G,T),J.push(.707,0,0,.707),E++),aa.push(S));if(Q&&M)if(1==Q)if(l(Q-1,M)){if(1<M){var G=S-1,T=r[Q-1][M+1],X=T-1;b.push(X,G,S)}else T=r[Q-1][M+1],X=T-1;b.push(T,X,S)}else l(Q,M)||(G=S-1,T=r[Q-1][M],b.push(T,G,S));else if(Q==q-1){if(!l(Q,M))if(M==x-1)G=S-1,T=r[Q-1][M-1],X=r[Q-2][M],b.push(T,G,S),b.push(X,T,S);else{var G=
S-1,T=r[Q-1][M],X=T-1,H=T+1;b.push(X,G,S);b.push(T,X,S);b.push(H,T,S);2==M&&(H=r[Q-2][M-2],b.push(X,H,G))}}else 1==M?l(Q,M-1)?(G=r[Q-1][M],T=r[Q-1][M-1],b.push(G,T,S)):(G=aa[M-1],T=r[Q-1][M],X=r[Q-2][M-1],b.push(T,G,S),b.push(T,X,G)):M==x-1?l(Q,M)||(G=aa[M-1],T=r[Q-1][M-1],X=r[Q-2][M],b.push(T,G,S),b.push(X,T,S)):-1!=r[Q-1][M]&&-1!=r[Q-1][M-1]&&-1!=aa[M-1]?(G=aa[M-1],T=r[Q-1][M],X=r[Q-1][M-1],b.push(T,G,S),b.push(T,X,G),M==x-2&&l(Q,M+1)&&(H=r[Q-1][M+1],b.push(H,T,S))):M==x-2&&l(Q,M+1)&&(T=r[Q-1][M],
H=r[Q-1][M+1],b.push(H,T,S))}}r.push(aa)}I=f;D=e;R=m;e*=2;m*=2}if(2E4>D)for(a=-(2*D)/(q-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-D,-R,a),c.push(-D,R,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(D,-R,a),c.push(D,R,a),S=E+1,b.push(S+1,S+2,S+3,S+1,S+0,S+2,S+2,S+4,S+6,S+2,S+0,S+4,S+1,S+7,S+5,S+1,S+3,S+7,S+7,S+4,S+5,S+6,S+4,S+7),Q=0;8>Q;Q++)J.push(.707,0,0,.707);a=h.Kg();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(J);e=A.Hf("MULTIGRID_PLANE");e.aa[0]=a;e.na=new Uint32Array(b);
e.Ja=c.length/3;z.hO&&(A.kx(e,1,!0),a.a_polyindex=A.Gu(e));return e};a.v4=function(a){var b=a.length;b%3&&h.q("Wrong array");for(var c=[],l=[],e=0;e<b;e+=3){var m=a[e+1],q=a[e+2];x(a[e],l);x(m,l);x(q,l);c.push(e,e+1,e+2)}a=h.Kg();a.a_position=new Float32Array(l);b=A.Hf("FROM_TRIANGLES");b.aa[0]=a;b.na=new Uint32Array(c);b.Ja=l.length/3;return b};a.u4=c;a.bV=function(a){a=h.k0(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.Uc=function(){var a=A.Hf("FULLSCREEN_TRI"),b=h.Kg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.na=new Uint32Array([0,1,2]);a.Ja=3;return a};a.cV=function(){var a=A.Hf("FULLSCREEN_QUAD"),b=h.Kg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.XU=function(){var a=A.Hf("BILLBOARD"),b=h.Kg();b.a_bb_vertex=A.nI(1);a.aa[0]=b;a.na=
new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.ZU=function(){var a=A.Hf("CUBEMAP_BOARD"),b=h.Kg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.Ou=function(a,c){var k=A.Hf("UV_SPHERE"),l,e,m=[],q=[],z=[];for(e=0;8>=e;e++)for(l=0;16>=l;l++){var J=l/16,D=e/8;q.push(-a*Math.cos(2*J*Math.PI)*Math.sin(D*Math.PI)+c[0],a*Math.cos(D*Math.PI)+c[1],a*Math.sin(2*J*Math.PI)*Math.sin(D*Math.PI)+c[2])}for(e=J=0;8>e;e++)for(l=0;16>l;l++){var D=
b(q,17*e+l+1),R=b(q,17*e+l),E=b(q,17*(e+1)+l),I=b(q,17*(e+1)+l+1);Math.abs(D[1])==a+c[1]?(x(D,m),x(E,m),x(I,m),z.push(J,J+1,J+2),J+=3):Math.abs(E[1])==a+c[1]?(x(D,m),x(R,m),x(E,m),z.push(J,J+1,J+2),J+=3):(x(D,m),x(R,m),x(E,m),x(I,m),z.push(J,J+1,J+2),z.push(J,J+2,J+3),J+=4)}l={};l.a_position=m;q=A.VR(z,q,m);q=A.SR(z,m,q);l.a_tbn_quat=h.fr(q);k.aa[0]=l;k.na=z;k.Ja=m.length/3;return k};a.rI=function(a){var b=A.Hf("INDEX"),c=h.Kg();c.a_index=new Float32Array(3*a);for(var l=new Uint16Array(3*a),e=0;e<
3*a;e++)c.a_index[e]=e,l[e]=e;b.aa[0]=c;b.na=l;b.Ja=3*a;return b}};b4w.module.__prerender=function(a,m){function l(a,c){var k=a.gf;k.co=!1;if(k.Qh)return!1;var l=c.p,m=c.type==h.dd?l.Nv:z.jc(l.n,u);if("STATIC"==k.type&&k.Yn)var x=k.Kr,A=k.Lr;else x=k.lb.G,A=k.lb.Xa;var E=k.$g,I=k.ff,m=n.dist(x,m);if(!(m<E?0:I==q.Bp||m<I+k.ah*A))return!1;k.co=!0;I=a.za;if(c.type==h.uf)return c.debug_view_mode==b.it?I.Ji:!I.Ji;if(c.type==h.Ag&&0==k.gh)return!1;k.hp?(A=I.lb,E=I.qb,k=I.Qf):(A=k.lb,E=k.qb,k=k.Qf);if(I=!I.Tj)l=l.Lh,I=A.G,p.JZ(I,l,A.Xa)?I=!0:k?(I=E.G,I=p.mU(I,l,E.Ga,E.Ha,
E.Ia)):I=!1;return I?!1:!0}function c(a){var b=a.gb;if(b&&b.KK){a=a.Ba;x.hX(a);var c=a.ld,h=c.a_position.offset;x.WN(a.rc,"a_position",b.EC,h);h=c.a_tbn_quat.offset;x.WN(a.rc,"a_tbn_quat",b.PD,h);x.FN(a)}}m("__config");var b=m("__debug"),x=m("__geometry"),q=m("__obj_util"),A=m("__renderer"),h=m("__subscene"),z=m("__tsr"),p=m("__util"),n=m("__vec3"),k=[h.Pb,h.Qc,h.Nd,h.nd,h.vf,h.Pe,h.ge,h.Sf,h.dd,h.wf,h.Ag,h.uf,h.sf,h.si],u=new Float32Array(3);a.uw=function(a){if(-1<k.indexOf(a.type)){for(var b=!1,
n=a.type==h.nd||a.type==h.Pe,m=a.Qa,p=0;p<m.length;p++){for(var q=m[p],u=q.sa,z=!1,x=0;x<u.length;x++){var B=u[x],P=B.za;if(n)for(var d=0;6>d;d++)a.p.Lh=a.Iq[d],B.HA[d]=l(B,a),B.HA[d]&&(z=b=!0,c(P));else B.dc=l(B,a),B.dc&&(z=b=!0,c(P));a.Aa&&(P.zb.Pr=!0)}q.dc=z}a.Aa=!1;switch(a.type){case h.uf:break;default:a.type==h.Pb||a.type==h.wf||a.type==h.ge||a.type==h.Nd||a.type==h.nd||b?a.dc=!0:(a.dc&&A.clear(a),a.dc=!1)}}else if(a.Aa){m=a.Qa;for(p=0;p<m.length;p++)for(u=m[p].sa,x=0;x<u.length;x++)B=u[x],
P=B.za,P.zb.Pr=!0;a.Aa=!1}a.hC&&h.AZ(a)}};b4w.module.__scenegraph=function(a,m){function l(a,b){var d=[];t.vg(a,function(b,c,e){-1<d.indexOf(e)?t.mY(a,b,c,e,R(e)):d.push(e)});t.pa(a,function(a,c){for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];b||c.type!=M.Nd&&c.type!=M.nd&&c.type!=M.Sf||(f.mf=!0);-1<d.indexOf(f)?c.Ya[e]=R(f):d.push(f)}})}function c(a,d){t.pa(a,function(b,c){c.type==M.yE&&t.li(a,b,function(a,b){if(b.type==M.vh)for(var d=0;d<b.Ya.length;d++){var c=b.Ya[d];c.Na=G.K;c.Ma=G.K}});d||t.li(a,b,function(a,b,d){"DEPTH"==d.from&&(d.mf=
!0)})});t.pa(a,function(d){var c={};b(a,d,c);for(var e in c){d=c[e];for(var f=d[0],h=0;h<d.length;h++)if(d[h].Na==G.K){f=d[h];break}for(var k=d[0],h=0;h<d.length;h++)if(d[h].Ma==G.K){k=d[h];break}for(var g=d[0],h=0;h<d.length;h++)if(!d[h].mf){g=d[h];break}for(h=0;h<d.length;h++)d[h].Na=f.Na,d[h].Ma=k.Ma,d[h].mf=g.mf}})}function b(a,d,c){t.li(a,d,function(d,e,f){f.Ic&&f.from==f.to&&(c[f.from]=c[f.from]||[],-1==c[f.from].indexOf(f)&&c[f.from].push(f),b(a,d,c))});t.Qk(a,d,function(a,b,d){d.Ic&&(c[d.from]=
c[d.from]||[],-1==c[d.from].indexOf(d)&&c[d.from].push(d))});d=t.Va(a,d);if(d.type==M.vh)for(var e=0;e<d.Ya.length;e++){var f=d.Ya[e];c[f.from].push(f)}}function x(a){var b=[M.vh,M.dz,M.Dt,M.Nd,M.nd,M.Ep],d=t.UD(a),c=[];t.pa(d,function(a,e){for(var f=0;f<e.Ya.length;f++){var k=e.Ya[f];-1<b.indexOf(e.type)&&(k.tx=!0);var g=p(c,k,q(k));k.jb=g;e.ki[f]=g}for(f=0;f<e.ki.length;f++)g=e.ki[f],z(c,g);t.Qk(d,a,function(f,k,g){-1<b.indexOf(e.type)&&(g.tx=!0);g.jb||((f=A(d,a,g.from))&&g.Ic&&!g.jb?h(c,f):f=p(c,
g,q(g)),g.jb=f)});t.li(d,a,function(a,b,d){z(c,d.jb)});t.Qk(d,a,function(a,b,d){d.jb&&"NONE"==d.to&&z(c,d.jb)})})}function q(a){a=T.Eh(a);delete a.to;delete a.Ic;delete a.jb;return JSON.stringify(a)}function A(a,b,d){var c=null;t.li(a,b,function(a,b,e){if(e.Ic&&e.from==e.to&&e.from==d&&e.jb)return c=e.jb,!0});t.Qk(a,b,function(a,b,e){if(e.Ic&&e.from==d&&e.jb)return c=e.jb,!0});return c}function h(a,b){for(var d=0;d<a.length;d++){var c=a[d];c.QD===b&&c.hs++}}function z(a,b){for(var d=0;d<a.length;d++){var c=
a[d];c.QD===b&&c.hs&&c.hs--}}function p(a,b,d){if(b.ro)return h(a,b.ro.jb),b.ro.jb;if(b.tx)return n(b);for(var c=null,e=0;e<a.length;e++){var f=a[e];if(f.id==d&&0===f.hs){c=f;break}}if(c&&!X.dI)return c.hs++,c.QD;b=n(b);a.push({id:d,hs:1,QD:b});return b}function n(a){var b=a.Jm*a.size,d=a.Km*a.size;switch(a.from){case "COLOR":if(a.mf){var c=G.Jl(a.kk?G.It:G.Ht,a.Os);G.resize(c,b,d)}else c=G.Jl(G.wh,a.Os),G.resize(c,b,d),G.fD(c,a.Na,a.Ma);return c;case "DEPTH":return a.mf?(c=G.Jl(a.kk?G.Gt:G.Ft,a.Os),
G.resize(c,b,d)):(c=G.Jl(G.ll,a.Os),G.resize(c,b,d),G.fD(c,a.Na,a.Ma)),c;case "CUBEMAP":return c=G.kH(b);case "SCREEN":case "NONE":return null;default:T.q("Wrong slink param: "+a.from)}}function k(a,b){var d=!1;t.vg(a,function(c,e,f){if(f&&(c=t.Va(a,c),e=t.Va(a,e),b(f,!1,c,e)))return d=!0});d||t.pa(a,function(a,d){for(var c=0;c<d.Ya.length;c++)if(b(d.Ya[c],!0,d,null))return!0})}function u(a){t.pa(a,function(b,d){if(d.type!=M.ln){var c=d.p;t.Qk(a,b,function(a,b,d){d.Ic&&d.jb&&(r.Iw(c,d.from,d.jb),
d.from==d.to&&b.p&&r.Iw(b.p,d.from,d.jb))});for(var e=0;e<d.Ya.length;e++){var f=d.Ya[e];f.Ic&&f.from==f.to&&r.Iw(c,f.from,d.ki[e])}!c.vc&&!c.We||c.$e||(c.$e=aa.iY(c.vc,c.We))}});t.pa(a,function(b,d){if(d.type==M.kn||d.type==M.Wx){var c=B(a,d);d.p.br=c[0].p.$e}})}function e(a){var b=null,d=0;t.pa(a,function(a,c){if(c.type==S.WZ){if(d==S.VZ)return b=c,!0;d++}});return b}function y(a,b){var d=t.eh(a,b),c=M.Ad("NONE"),e=t.J(a,c),f=t.mr(a)[0];t.vg(a,function(b,d){d==f&&t.cY(a,b,f,b,e)});var h=K(b,a);
t.vg(a,function(e,f,k){if(e==d){if(h){e=M.nu();t.J(a,e);f=D("COLOR","RESOLVE",1,1,1,!0);f.kk=!0;f.mf=!0;var g=D("DEPTH","RESOLVE",1,1,1,!0);g.kk=!0;g.mf=!0;t.r(a,b,e,f);t.r(a,b,e,g);b=e}t.r(a,b,c,D(S.uZ,"u_color",k.size,k.Jm,k.Km,k.Ks));return!0}});t.fd(a,e,f,D("SCREEN","NONE",.5,.5,.5,!0))}function K(a,b){var d=!1,c=t.eh(b,a);t.og(b,c)&&(d=t.Ug(b,c,0),c=t.Xd(b,c,d,0),"COLOR"==c.from&&"COLOR"==c.to||"DEPTH"==c.from&&"DEPTH"==c.to?(c=t.Va(b,d),d=K(c,b)):d="RESOLVE"==c.to);return d}function F(a,b,d,
c){var e=d.da,f=b.pv,h=b.ai.Yh,k=b.ai.rw,g=t.ix(a,t.JV(a,c),t.ft),l=[],n=[],m=[],g=t.clone(g,function(b){var c;if(-1<ma.indexOf(b.type))n.push(b),c=b;else{c=M.GS(b);if(c.type==M.Nd)for(var g=0;g<h.length;g++)if(h[g][0]==b){h[g]=[b,c];c.p.qc=b.p.qc;d.da.push(c.p);break}if(b.type==M.vf)for(g=0;g<h.length;g++){if(k[g][0]==b){k[g]=[b,c];c.p=h[g][1].p;break}}else-1<e.indexOf(b.p)&&(f?(r.Qv(b.p,r.Qe),r.Qv(c.p,r.Re)):(r.Qv(b.p,r.Rc),r.Qv(c.p,r.ed)),e.push(c.p));var p=t.eh(a,b);t.li(a,p,function(a,b,d){-1<
ma.indexOf(b.type)&&l.push([b,c,d])});if(b.type!==M.vh)for(g=0;g<b.Ya.length;g++)c.Ya[g].ro=b.Ya[g];b=!0;for(g=0;g<t.Vn(a,p);g++){var q=t.Si(a,p,g),q=t.Va(a,q);-1==ma.indexOf(q.type)&&(b=!1)}b&&m.push(c)}return c},function(a){var b=R(a,!0);b.ro=a;return b});t.vg(g,function(a,b,d){t.Va(g,a).type===M.vh&&(d.ro=null)});for(var p=0;p<n.length;p++)t.rg(g,t.eh(g,n[p]));t.Sz(g);b=M.LT(f);var p=t.J(a,b),q=M.nA();t.J(a,q);var u=D("COLOR","COPY",1,1,1,!0);t.r(a,c,q,u);var z=D("COLOR","u_sampler_left",1,1,1,
!0);z.tx=!0;z.Na=G.K;z.Ma=G.K;t.r(a,q,b,z);c.yc||(c=M.nA(),t.J(g,c),z=D("COLOR","COPY",1,1,1,!0),z.ro=u,u=t.mr(g)[0],u=t.Va(g,u),t.r(g,u,c,z));c=D("COLOR","u_sampler_right",1,1,1,!0);c.Na=G.K;c.Ma=G.K;t.bR(g,a,[t.mr(g)[0],p,c]);for(p=0;p<l.length;p++)t.r(a,l[p][0],l[p][1],l[p][2]);c=D("SCREEN","NONE",0,0,0,!1);for(p=0;p<m.length;p++)t.r(a,q,m[p],c);f&&J(a,.5,1);return b}function J(a,b,d){var c=[];t.pa(a,function(b,d){if(-1==ma.indexOf(d.type)&&d.Ya.length&&E(a,d,M.wi))for(var e=0;e<d.Ya.length;e++){var f=
d.Ya[e];-1==c.indexOf(f)&&c.push(f)}});t.vg(a,function(b,d,e){b=t.Va(a,b);d=t.Va(a,d);-1==ma.indexOf(b.type)&&E(a,d,M.wi)&&-1==c.indexOf(e)&&c.push(e)});for(var e=0;e<c.length;e++)c[e].Jm*=b,c[e].Km*=d}function D(a,b,d,c,e,f){return{from:a,to:b,size:d,Jm:c,Km:e,Ks:f,Ic:!0,jb:null,kk:!1,mf:!1,Na:G.ve,Ma:G.ve,tx:!1,Os:!1}}function R(a,b){if(b){var d=a.jb;a.jb=null}a.jb&&T.q("Failed to clone slink with attached texture");var c=T.Eh(a);b&&(a.jb=d,c.jb=d);return c}function E(a,b,d){if(b.type==d)return!0;
b=P(a,b);for(var c=0;c<b.length;c++)if(E(a,b[c],d))return!0;return!1}function I(a,b,d){if(b.type==d)return!0;b=B(a,b);for(var c=0;c<b.length;c++)if(I(a,b[c],d))return!0;return!1}function B(a,b){var d=t.eh(a,b);d==t.$y&&T.q("Subscene not in graph");for(var c=[],e=t.Vn(a,d),f=0;f<e;f++){var h=t.Si(a,d,f);h!=d&&c.push(t.Va(a,h))}return c}function P(a,b){var d=t.eh(a,b);d==t.$y&&T.q("Subscene not in graph");for(var c=[],e=t.og(a,d),f=0;f<e;f++){var h=t.Ug(a,d,f);h!=d&&c.push(t.Va(a,h))}return c}function d(a){var b=
[],d=[];k(a,function(a){a.jb&&-1==b.indexOf(a.jb)&&(b.push(a.jb),d.push(a.jb,b.length-1))});return d}function f(a,b){var d;d=""+(a.from+"\\n");d+="NONE"!=a.to?a.to+"\\n":"";d+="(";if(a.Ks){var c=a.Jm,e=a.Km;Math.round(c)!=c&&(c=c.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));d+=(1==c?"":c)+"Sx"+((1==e?"":e)+"S")}else c=a.Jm,e=a.Km,d+=a.size*c+"x"+a.size*e;if("SCREEN"!=a.from){d+=" ";if(a.mf)d+="RR";else{var c=a.Na,e=a.Ma,f="";c==G.K?f+="L":c==G.ve&&(f+="N");e==G.K?f+="L":e==G.ve&&(f+="N");d+=f}for(c=
0;c<b.length;c+=2)b[c]==a.jb&&(d+=" "+b[c+1])}return d+")\\n"}var r=m("__camera"),g=m("__config"),Q=m("__debug"),t=m("__graph"),aa=m("__renderer"),M=m("__subscene"),G=m("__textures"),T=m("__util"),S=g.Lq,X=g.B,H=g.Do,ma=[M.ui,M.dd,M.nd,M.Pe];a.tS=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.l_=k;a.hT=function(a,b,d,f){function h(d){var c=r.Jc(Na,!0);b.da.push(c);c=M.Il(d,c,!1,K,
E,Ca,Ea,Ba,a.qj);t.J(g,c);d==M.Sf?(t.r(g,k[0],c,D("COLOR","COLOR",1,1,1,!0)),c.Ya.push(D("DEPTH","DEPTH",1,1,1,!0))):(d=Za&&k[0].type==M.kn?Ib:k[0],t.r(g,d,c,Fa),t.r(g,d,c,ub));Ja&&(t.r(g,Ja,c,eb),t.r(g,Ja,c,ob));for(d=0;d<m.length;d++)t.r(g,m[d],c,p[d]);Wa&&t.r(g,Wa,c,ad);if(q.length){var e=q.length;for(d=0;d<e;d++)t.r(g,q[d],c,z[d])}if(A.length)for(d=0;d<A.length;d++)t.r(g,A[d],c,I[d]);gc&&t.r(g,gc,c,Xc);return c}var g=t.create(),k=[],n=[],m=[],p=[],q=[],z=[],A=[],I=[],E=a.HW,K=a.Nc,J=a.Hk,ma=a.wZ,
N=a.ssao,aa=a.god_rays,C=a.ai,ia=a.AK,qa=a.ER,ja=a.motion_blur,va=a.compositing,ta=a.antialiasing,Ea=a.pp,Ca=a.kO,Ba=a.xd,la=a.pX,ua=a.dS,wa=a.SV,Pa=a.EX,Ga=a.dof,Qa=a.$T,Aa=a.refractions,w=Boolean(f.length),Za=1<X.Fc,ub=D("COLOR","COLOR",1,1,1,!0),Fa=D("DEPTH","DEPTH",1,1,1,!0);if(Za){R(Fa);var Ec=R(Fa);ub.kk=!0;ub.mf=!0;Fa.kk=!0;Fa.mf=!0}var Na=b.da[0];if(Ba){r.gE(Na,Ba);for(var da=0;da<Ba.Zg.length;da++)for(var Da=Ba.csm_num,ra=0;ra<Da;ra++){var U=M.GT(ra,da,Ba,E);t.J(g,U);m.push(U);var La=Ba.csm_resolution,
sa=U.p;b.BM.push(sa);sa.width=La;sa.height=La;U.wb=!1;var Ia=D("DEPTH","u_shadow_map"+(0<da?da:ra),La,1,1,!1);X.zq&&(Ia.Na=G.K,Ia.Ma=G.K,Ia.Os=!0);p.push(Ia);(Q.lS()||X.CM)&&U.Ya.push(D("COLOR","COLOR",La,1,1,!1))}}if(C&&C.QK&&!w)for(ra=0;ra<C.QK;ra++){sa=r.hd(r.Od);sa.width=a.Ii;sa.height=a.Ii;r.Lw(sa,90,.1,100);r.Gk(sa,sa.Ab);var Ra=M.Il(M.nd,sa,!1,K,E,Ca,Ea,null,a.qj);Ra.Kl=T.dV();for(da=0;6>da;da++)Ra.Iq.push(r.WS());t.J(g,Ra);var vb=D("CUBEMAP","u_cube_reflection",a.Ii,1,1,!1);vb.Na=G.K;vb.Ma=
G.K;I.push(vb);if(C.JJ){var Ta=M.Il(M.Pe,sa,!1,K,E,Ca,Ea,null,a.qj);Ta.Kl=Ra.Kl;Ta.Iq=Ra.Iq;t.J(g,Ta);var za=D("DEPTH","DEPTH",a.Ii,1,1,!1),hb=D("COLOR","COLOR",a.Ii,1,1,!1);t.r(g,Ra,Ta,za);t.r(g,Ra,Ta,hb);A.push(Ta);C.tA.push(Ta)}else{var Va=D("DEPTH","DEPTH",a.Ii,1,1,!1);Ra.Ya.push(Va);A.push(Ra)}C.Hi.push(Ra)}if(C&&0<C.wL.length&&!w)for(da=0;da<C.wL.length;da++)sa=r.Jc(Na,!0),sa.qc=new Float32Array(4),b.da.push(sa),Ra=M.Il(M.Nd,sa,!1,K,E,Ca,Ea,null,a.qj),t.J(g,Ra),vb=D("COLOR","u_plane_reflection",
1,a.ih,a.ih,!0),vb.Na=G.K,vb.Ma=G.K,z.push(vb),C.JJ?(Ta=M.Il(M.vf,sa,!1,K,E,Ca,Ea,null,a.qj),t.J(g,Ta),za=D("DEPTH","DEPTH",1,a.ih,a.ih,!0),hb=D("COLOR","COLOR",1,a.ih,a.ih,!0),hb.Na=G.ve,hb.Ma=G.ve,t.r(g,Ra,Ta,za),t.r(g,Ra,Ta,hb),C.rw.push([Ta]),q.push(Ta)):(Va=D("DEPTH","DEPTH",1,a.ih,a.ih,!0),Ra.Ya.push(Va),q.push(Ra)),C.Yh.push([Ra]);if(a.jd){var Ja=M.zT();t.J(g,Ja);La=H.rr;Ja.p.width=La;Ja.p.height=La;var eb=D("DEPTH","u_grass_map_depth",La,1,1,!1);X.gc||(eb.Na=G.K,eb.Ma=G.K);var ob=D("COLOR",
"u_grass_map_color",La,1,1,!1);ob.Na=G.K;ob.Ma=G.K}else ob=eb=Ja=null;if(Qa&&Ba){var $a=r.Jc(Na,!0);b.da.push($a);var sb=M.HT($a,E);t.J(g,sb);sb.self_shadow_normal_offset=Ba.self_shadow_normal_offset;for(ra=0;ra<m.length;ra++)U=m[ra],t.r(g,U,sb,p[ra]);var fb=D("COLOR","u_color",1,1,1,!0),lb=D("DEPTH","u_depth",1,1,1,!0);if(N){var wb=r.Jc(Na,!0);b.da.push(wb);var Sa=a.PZ,Mb=M.JT(wb,Ca,Sa);t.J(g,Mb);var Zb=D("COLOR","u_ssao_mask",1,1,1,!0);t.r(g,sb,Mb,fb);t.r(g,sb,Mb,lb);var Nb=r.Jc(Na,!0);b.da.push(Nb);
var mb=M.KT(Nb,Sa);t.J(g,mb);var pd=D("COLOR","u_shadow_mask",1,1,1,!0);t.r(g,Mb,mb,Zb);t.r(g,sb,mb,lb)}Za?sb.Ya.push(D("DEPTH","DEPTH",1,1,1,!0)):sb.Ya.push(Fa);Ja&&(t.r(g,Ja,sb,eb),t.r(g,Ja,sb,ob))}else sb=null;var Ib=M.Il(M.Pb,Na,!0,K,E,Ca,Ea,null,a.qj);t.J(g,Ib);if(Za){var ib=M.nu();t.J(g,ib);n.push(ib);var fc=D("COLOR","RESOLVE",1,1,1,!0);fc.kk=!0;fc.mf=!0;var Fc=D("DEPTH","RESOLVE",1,1,1,!0);Fc.kk=!0;Fc.mf=!0;t.r(g,Ib,ib,fc);t.r(g,Ib,ib,Fc)}else n.push(Ib);sb&&(Zb?t.r(g,mb,Ib,pd):Ba?t.r(g,sb,
Ib,D("COLOR","u_shadow_mask",1,1,1,!0)):T.q("Internal error"));Ja&&(t.r(g,Ja,Ib,eb),t.r(g,Ja,Ib,ob));if(q.length)for(var $c=q.length,da=0;da<$c;da++)t.r(g,q[da],Ib,z[da]);if(A.length)for(da=0;da<A.length;da++)t.r(g,A[da],Ib,I[da]);k=n;n=[];if(!w&&a.HS){sa=r.Jc(Na,!0);sa.width=1;sa.height=1;b.da.push(sa);var tc=M.wH(sa,!1,E);t.J(g,tc);if(a.th){sa=r.Jc(Na,!0);sa.width=1;sa.height=1;b.da.push(sa);var Pc=M.wH(sa,!0,E);t.J(g,Pc);t.r(g,tc,Pc,D("COLOR","COLOR",1,1,1,!1));t.r(g,tc,Pc,D("DEPTH","DEPTH",1,
1,1,!1))}}else tc=null;if(!ia.refractions&&!Aa||w)gc=null;else{if(Za)gc=ib;else{var gc=M.nA();t.J(g,gc);t.r(g,k[0],gc,D("COLOR","COPY",1,1,1,!0))}var Xc=D("COLOR","u_refractmap",1,1,1,!0)}if(Qa&&(Aa||J||ma)){var xb=r.Jc(Na,!0);b.da.push(xb);var Wa=M.wT(xb);t.J(g,Wa);t.r(g,Za?ib:Ib,Wa,D("DEPTH","u_depth",1,1,1,!0));var ad=D("COLOR","u_scene_depth",1,1,1,!0);ad.Na=G.ve;ad.Ma=G.ve}else Wa=null;if(a.cv){var Qc=h(M.Qc);n.push(Qc);k=n;n=[]}if(a.Ui){var Rc=r.Jc(Na,!0);b.da.push(Rc);var Ob=M.Il(M.ge,Rc,!1,
K,E,Ca,Ea);t.J(g,Ob);Wa&&t.r(g,Wa,Ob,ad);gc&&t.r(g,gc,Ob,Xc);Ja&&(t.r(g,Ja,Ob,eb),t.r(g,Ja,Ob,ob));if(q.length)for($c=q.length,da=0;da<$c;da++)t.r(g,q[da],Ob,z[da]);if(A.length)for(da=0;da<A.length;da++)t.r(g,A[da],Ob,I[da]);t.r(g,Za?ib:Ib,Ob,Za?Ec:Fa);var uc=M.Ad("X_GLOW_BLUR");uc.Fb="GLOW_MASK_SMALL";uc.ug=a.$j.small_glow_mask_width;var jd=D("COLOR","u_color",1,1,1,!0);jd.Na=G.K;jd.Ma=G.K;t.J(g,uc);t.r(g,Ob,uc,jd);var vc=M.Ad("Y_GLOW_BLUR");vc.Fb="GLOW_MASK_SMALL";vc.ug=a.$j.small_glow_mask_width;
var kd=D("COLOR","u_color",1,.5,.5,!0);kd.Na=G.K;kd.Ma=G.K;t.J(g,vc);t.r(g,uc,vc,kd);var bd=M.Ad("X_GLOW_BLUR");bd.Fb="GLOW_MASK_LARGE";bd.ug=a.$j.large_glow_mask_width;var $b=D("COLOR","u_color",1,.5,.5,!0);$b.Na=G.K;$b.Ma=G.K;t.J(g,bd);t.r(g,vc,bd,$b);var cd=M.Ad("Y_GLOW_BLUR");cd.Fb="GLOW_MASK_LARGE";cd.ug=a.$j.large_glow_mask_width;var Db=D("COLOR","u_color",1,.25,.25,!0);Db.Na=G.K;Db.Ma=G.K;t.J(g,cd);t.r(g,bd,cd,Db);var nb=r.Jc(Na,!0);b.da.push(nb);var jb=M.xT(nb,a);t.J(g,jb);var kb=D("COLOR",
"u_src_color",1,1,1,!0);if(a.cv)if(Za){var Gc=M.nu();t.J(g,Gc);t.r(g,Qc,Gc,fc);t.r(g,Qc,Gc,Fc);t.r(g,Gc,jb,kb)}else t.r(g,Qc,jb,kb);else t.r(g,Za?ib:Ib,jb,kb);t.r(g,a.cv?Qc:Ib,jb,Fa);var wc=D("COLOR","u_glow_mask_small",1,.5,.5,!0);wc.Na=G.K;wc.Ma=G.K;t.r(g,vc,jb,wc);var hc=D("COLOR","u_glow_mask_large",1,.25,.25,!0);hc.Na=G.K;hc.Ma=G.K;t.r(g,cd,jb,hc);k=[jb];n=[]}a.cv||(Qc=h(M.Qc),n.push(Qc),k=n,n=[]);if(X.debug_view){sa=r.Jc(Na,!0);b.da.push(sa);var Eb=M.vT(sa);n.push(Eb);t.J(g,Eb);t.r(g,k[0],Eb,
ub);t.r(g,k[0],Eb,Fa);Ja&&(t.r(g,Ja,Eb,eb),t.r(g,Ja,Eb,ob));Q.IY(Eb);k=n;n=[]}if(Za){var ac=M.nu();t.J(g,ac);n.push(ac);t.r(g,k[0],ac,fc);t.r(g,k[0],ac,Fc);k=n;n=[]}var xc=k.slice(0);if(!w&&a.HQ){sa=r.Jc(Na,!0);b.da.push(sa);var Rb=M.rT(sa);t.J(g,Rb);t.r(g,k[0],Rb,Za?Ec:Fa)}if(aa&&Qa&&!w){var ic=wa.io,yc=wa.zB,pb=wa.Xo,ab=k[0],Kc=K?!0:!1,dd=D("DEPTH","u_input",1,1,1,!0),Fb=D("COLOR","u_input",1,.25,.25,!0);Fb.Na=G.K;Fb.Ma=G.K;var Yb=ic/pb,gb=r.Jc(Na,!0);b.da.push(gb);var qb=M.oA(gb,Kc,ic,!0,Yb,E,
pb);t.J(g,qb);t.r(g,ab,qb,dd);var Yb=ic/pb*.5,yb=r.Jc(Na,!0);b.da.push(yb);var Yc=M.oA(yb,Kc,ic,!1,Yb,E,pb);t.J(g,Yc);t.r(g,qb,Yc,Fb);var Yb=ic/pb*.25,Sc=r.Jc(Na,!0);b.da.push(Sc);var jc=M.oA(Sc,Kc,ic,!1,Yb,E,pb);t.J(g,jc);t.r(g,Yc,jc,Fb);var nc=M.yT(yc,E);n.push(nc);t.J(g,nc);t.r(g,ab,nc,D("COLOR","u_main",1,1,1,!0));t.r(g,jc,nc,D("COLOR","u_god_rays",1,1,1,!0));k=n;n=[]}if(qa&&!w){var ab=k[0],Jb=M.AT();t.J(g,Jb);t.r(g,ab,Jb,D("COLOR","u_input",1,1,1,!0));var oc=M.sT();t.J(g,oc);oc.p.width=X.Tq?
2:1;oc.p.height=X.Tq?2:1;var pc=D("COLOR","u_input",1,.25,.25,!0);pc.Na=G.K;pc.Ma=G.K;var Tc=D("COLOR","u_luminance",1,.25,.25,!0);Tc.Na=G.K;Tc.Ma=G.K;t.r(g,Jb,oc,pc);var zc=qa.key,qc=qa.edge_lum,Kb=r.Jc(Na,!0);b.da.push(Kb);var Xa=M.BT(zc,qc,E,Kb);t.J(g,Xa);t.r(g,ab,Xa,D("COLOR","u_main",1,1,1,!0));t.r(g,Jb,Xa,Tc);t.r(g,oc,Xa,D("COLOR","u_average_lum",1,1,1,!1));var Oa=D("COLOR","u_color",1,.25,.25,!0);Oa.Na=G.K;Oa.Ma=G.K;uc=M.vH("X_BLUR");t.J(g,uc);t.r(g,Xa,uc,Oa);vc=M.vH("Y_BLUR");t.J(g,vc);t.r(g,
uc,vc,Oa);var Sb=M.tT(qa.blur);t.J(g,Sb);var kc=D("COLOR","u_bloom",1,.25,.25,!0);kc.Na=G.K;kc.Ma=G.K;t.r(g,vc,Sb,kc);t.r(g,ab,Sb,D("COLOR","u_main",1,1,1,!0));n.push(Sb);k=n;n=[]}if(Ga&&Qa&&!w){var ab=k[0],Ua=r.Jc(Na,!0);b.da.push(Ua);if(d.dof_bokeh){var zb=D("COLOR","u_color",1,1,1,!0);zb.Na=G.K;zb.Ma=G.K;var Lb=D("DEPTH","u_depth",1,1,1,!0),Tb=D("COLOR","u_color",1,.5,.5,!0);Tb.Na=G.ve;Tb.Ma=G.ve;Oa=D("COLOR","u_color",1,.5,.5,!0);Oa.Na=G.ve;Oa.Ma=G.ve;var bc=D("COLOR","u_blurred1",1,.5,.5,!0);
bc.Na=G.K;bc.Ma=G.K;var Gb=D("COLOR","u_blurred2",1,.5,.5,!0);Gb.Na=G.K;Gb.Ma=G.K;var Ab=xc[0];if(d.Cd){var bb=r.Jc(Na,!0);b.da.push(bb);var Bb=M.mA(bb,"COC_FOREGROUND");bb.dof_distance=d.dof_distance;bb.dof_object=d.dof_object;bb.dof_front_start=d.dof_front_start;bb.dof_front_end=d.dof_front_end;bb.dof_rear_start=d.dof_rear_start;bb.dof_rear_end=d.dof_rear_end;bb.dof_power=d.dof_power;bb.dof_bokeh=d.dof_bokeh;bb.dof_bokeh_intensity=d.dof_bokeh_intensity;bb.Cd=d.Cd;bb.dof_on=!0;t.J(g,Bb);t.r(g,ab,
Bb,zb);t.r(g,Ab,Bb,Lb);var Ka=M.Ad("X_ALPHA_BLUR");t.J(g,Ka);t.r(g,Bb,Ka,Tb);var cc=M.Ad("Y_ALPHA_BLUR");t.J(g,cc);t.r(g,Ka,cc,Oa);var Ma=r.Jc(Na,!0),dc=M.mA(Ma,"COC_COMBINE");b.da.push(Ma);Ma.dof_distance=d.dof_distance;Ma.dof_object=d.dof_object;Ma.dof_front_start=d.dof_front_start;Ma.dof_front_end=d.dof_front_end;Ma.dof_rear_start=d.dof_rear_start;Ma.dof_rear_end=d.dof_rear_end;Ma.dof_power=d.dof_power;Ma.dof_bokeh=d.dof_bokeh;Ma.dof_bokeh_intensity=d.dof_bokeh_intensity;Ma.Cd=d.Cd;Ma.dof_on=!0;
t.J(g,dc);t.r(g,ab,dc,zb);t.r(g,Ab,dc,Lb);t.r(g,cc,dc,D("COLOR","u_coc_fg",1,.5,.5,!0))}else Ma=r.Jc(Na,!0),b.da.push(Ma),dc=M.mA(Ma,"COC_ALL"),Ma.dof_distance=d.dof_distance,Ma.dof_object=d.dof_object,Ma.dof_front_start=d.dof_front_start,Ma.dof_front_end=d.dof_front_end,Ma.dof_rear_start=d.dof_rear_start,Ma.dof_rear_end=d.dof_rear_end,Ma.dof_power=d.dof_power,Ma.dof_bokeh=d.dof_bokeh,Ma.dof_bokeh_intensity=d.dof_bokeh_intensity,Ma.Cd=d.Cd,Ma.dof_on=!0,t.J(g,dc),t.r(g,ab,dc,zb),t.r(g,Ab,dc,Lb);var Ha=
M.Ad("X_DOF_BLUR");Ha.p.dof_bokeh_intensity=d.dof_bokeh_intensity;t.J(g,Ha);t.r(g,dc,Ha,Tb);var tb=M.Ad("Y_DOF_BLUR");tb.p.dof_bokeh_intensity=d.dof_bokeh_intensity;t.J(g,tb);t.r(g,Ha,tb,Oa);var Pb=M.Ad("Y_DOF_BLUR");Pb.p.dof_bokeh_intensity=d.dof_bokeh_intensity;t.J(g,Pb);t.r(g,Ha,Pb,Oa);var Ub=M.xH(Ua);Ua.dof_distance=d.dof_distance;Ua.dof_object=d.dof_object;Ua.dof_front_start=d.dof_front_start;Ua.dof_front_end=d.dof_front_end;Ua.dof_rear_start=d.dof_rear_start;Ua.dof_rear_end=d.dof_rear_end;Ua.dof_power=
d.dof_power;Ua.dof_bokeh=d.dof_bokeh;Ua.dof_bokeh_intensity=d.dof_bokeh_intensity;Ua.Cd=d.Cd;Ua.dof_on=!0;n.push(Ub);t.J(g,Ub);t.r(g,ab,Ub,D("COLOR","u_sharp",1,1,1,!0));t.r(g,tb,Ub,bc);t.r(g,Pb,Ub,Gb)}else{var rc=D("COLOR","u_color",1,1,1,!0);rc.Na=G.K;rc.Ma=G.K;var Lc=D("COLOR","u_color",1,1,1,!0);Lc.Na=G.K;Lc.Ma=G.K;Ha=M.Ad("X_BLUR");t.J(g,Ha);t.r(g,ab,Ha,rc);var lc=M.Ad("Y_BLUR");t.J(g,lc);t.r(g,Ha,lc,Lc);var ld=xc[0],Ub=M.xH(Ua);Ua.dof_distance=d.dof_distance;Ua.dof_object=d.dof_object;Ua.dof_front_start=
d.dof_front_start;Ua.dof_front_end=d.dof_front_end;Ua.dof_rear_start=d.dof_rear_start;Ua.dof_rear_end=d.dof_rear_end;Ua.dof_power=d.dof_power;Ua.dof_bokeh=d.dof_bokeh;Ua.dof_bokeh_intensity=d.dof_bokeh_intensity;Ua.Cd=d.Cd;Ua.dof_on=!0;n.push(Ub);t.J(g,Ub);t.r(g,ab,Ub,D("COLOR","u_sharp",1,1,1,!0));t.r(g,lc,Ub,D("COLOR","u_blurred",1,1,1,!0));t.r(g,ld,Ub,D("DEPTH","u_depth",1,1,1,!0))}k=n;n=[]}if(a.th){var ed=h(M.Sf);n.push(ed);k=n;n=[]}if(ja&&!w){var Mc=k[0],Hc=M.CT(la.mb_decay_threshold,la.mb_factor);
n.push(Hc);t.J(g,Hc);t.r(g,Mc,Hc,D("COLOR","u_mb_tex_curr",1,1,1,!0));Hc.Ya.push(D("COLOR","u_mb_tex_accum",1,1,1,!0));k=n;n=[]}if(!w&&a.outline){var ab=k[0],Vb=r.Jc(Na,!0);b.da.push(Vb);var cb=M.ET(Vb,E);t.J(g,cb);var mc=M.Ad("X_EXTEND"),Ac=D("COLOR","u_color",1,1,1,!0),Ic=D("COLOR","u_outline_mask",1,1,1,!0);mc.zr=!0;t.J(g,mc);t.r(g,cb,mc,Ac);var Cb=D("COLOR","u_color",1,.5,.5,!0);Cb.Na=G.K;Cb.Ma=G.K;var Wb=M.Ad("Y_EXTEND");Wb.zr=!0;t.J(g,Wb);t.r(g,mc,Wb,Cb);Ha=M.Ad("X_BLUR");Ha.zr=!0;t.J(g,Ha);
t.r(g,Wb,Ha,Cb);var Bc=D("COLOR","u_color",1,.25,.25,!0);Bc.Na=G.K;Bc.Ma=G.K;var Qb=D("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Qb.Na=G.K;Qb.Ma=G.K;lc=M.Ad("Y_BLUR");lc.zr=!0;t.J(g,lc);t.r(g,Ha,lc,Bc);var rb=M.DT(Pa);t.J(g,rb);t.r(g,ab,rb,D("COLOR","u_outline_src",1,1,1,!0));t.r(g,cb,rb,Ic);t.r(g,lc,rb,Qb);n.push(rb);k=n;n=[]}l(g,Qa);if((a.anaglyph_use||a.pv)&&!w){var Uc=F(g,a,b,k[0]);n.push(Uc);k=n;n=[]}if(va&&!w){var ab=k[0],Vc=M.uT(ua.brightness,ua.contrast,ua.exposure,ua.saturation);t.J(g,
Vc);t.r(g,ab,Vc,D("COLOR","u_color",1,1,1,!0));n.push(Vc);k=n;n=[]}if(ta){ab=k[0];if(X.smaa){var db=D("COLOR","u_color",1,1,1,!0);db.Na=G.K;db.Ma=G.K;var Ya=M.pA(M.Ct,a);t.J(g,Ya);t.r(g,ab,Ya,db);var Jc=M.pA(M.Ip,a);t.J(g,Jc);t.r(g,Ya,Jc,db);var Nc=D("COLOR","u_search_tex",1,1,1,!1),Cc=D("COLOR","u_area_tex",1,1,1,!1);Nc.Na=G.K;Nc.Ma=G.K;Cc.Na=G.K;Cc.Ma=G.K;Jc.Ya.push(Nc);Jc.Ya.push(Cc);var ec=M.pA(M.Dt,a);t.J(g,ec);t.r(g,ab,ec,db);var Zc=D("COLOR","u_blend",1,1,1,!0);Zc.Na=G.K;Zc.Ma=G.K;t.r(g,Jc,
ec,Zc);n.push(ec)}else{var Xb=M.qT(a);t.J(g,Xb);var Oc=D("COLOR","u_color",1,1,1,!0);Oc.Na=G.K;Oc.Ma=G.K;t.r(g,ab,Xb,Oc);n.push(Xb)}k=n;n=[]}var Dc=t.eh(g,k[0]);if(k[0].type==M.vh||k[0].type==M.kn)var qd=!0;else qd=!1,t.li(g,Dc,function(a,b,d){if(d.from==d.to)return qd=!0});if(qd){var md=M.Ad("NONE");t.J(g,md);t.r(g,k[0],md,D("COLOR","u_color",1,1,1,!0));n.push(md);k=n;n=[]}n.push(k[0]);tc&&(Pc?n.push(Pc):n.push(tc));Rb&&n.push(Rb);La=H.qu;if(a.$w.zL){var nd=a.$w,wd=a.pp,rd=wd.Po,La=rd?rd.c_:La,fd=
M.IT(wd,E,nd,La);t.J(g,fd);n.push(fd)}var sc=M.yH();t.J(g,sc);for(ra=0;ra<n.length;ra++){var gd=n[ra];switch(gd.type){case M.sf:case M.si:t.r(g,gd,sc,D("COLOR","NONE",1,1,1,!1));t.r(g,gd,sc,D("DEPTH","NONE",1,1,1,!1));break;case M.Bg:t.r(g,gd,sc,D("CUBEMAP","u_sky",La,1,1,!1));break;case M.cn:t.r(g,gd,sc,D("COLOR","NONE",1,1,1,!0));break;default:if(w){var sd=f[0],hd=D("COLOR","OFFSCREEN",1,1,1,!0);hd.jb=sd;t.r(g,n[ra],sc,hd);for(da=1;da<f.length;da++){var td=f[da],Hb=M.Ad("NONE");t.J(g,Hb);t.r(g,
n[ra],Hb,D("COLOR","SCALE",1,1,1,!0));var xd=td.mj/sd.mj,hd=D("COLOR","OFFSCREEN",1,xd,xd,!0);hd.jb=td;t.r(g,Hb,sc,hd)}}else t.r(g,n[ra],sc,D("SCREEN","NONE",1,1,1,!0))}}ib&&!P(g,ib).length&&(t.rg(g,t.eh(g,ib)),t.Sz(g));l(g,Qa);c(g,Qa);if(S.enabled){var Wc=e(g);Wc&&y(g,Wc)}x(g);u(g);Ba&&t.pa(g,function(a,b){if(b.type==M.wf||b.type==M.Qc||b.type==M.Sf){for(var d=0,c=B(g,b),e=0,f=0;f<c.length;f++){var h=c[f];h.type==M.dd&&(e++,b.zm=b.zm||[],b.zm[0<h.nh?h.nh:d]=h.p.xb,d++)}b.xx&&b.wx||(X.Pv?b.mE=new Float32Array(9*
e):(b.xx=new Float32Array(4*e),b.wx=new Float32Array(4*e)))}});return g};a.vX=J;a.Jd=function(a,b,d){var c=a.ug;a.RD[0]=b*a.Gb[0]*c;a.RD[1]=d*a.Gb[1]*c};a.Mc=function(a,b){a.ug=b};a.fT=function(){var a=t.create(),b=M.FT(),d=r.hd(r.qd);d.width=512;d.height=512;b.p=d;t.J(a,b);b.Ya.push(D("COLOR","u_color",512,1,1,!1));d=M.yH();t.J(a,d);t.r(a,b,d,D("COLOR","NONE",512,1,1,!1));x(a);u(a);return a};a.JU=function(a){var b=null;t.pa(a,function(a,d){return d.p&&null===d.p.$e?(b=d,!0):!1});return b};a.Db=function(a,
b,d){a=B(a,b);for(b=0;b<a.length;b++)if(a[b].type==d)return a[b];return null};a.eB=function(a,b,d){a=B(a,b);b=[];for(var c=0;c<a.length;c++)a[c].type==d&&b.push(a[c]);return b};a.n6=E;a.q6=I;a.GV=B;a.KV=P;a.ic=function(a,b){var d=null;t.pa(a,function(a,c){return c.type==b?(d=c,!0):!1});return d};a.VT=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=d(a);t.pa(a,function(a,d){var e=
b+="    ",h=M.GD(d);if(d.p){for(var h=h+"\\n",g=0;g<c.length;g+=2){var k=d.p.vc;c[g]==k&&(h=G.Zn(k)?h+("CR"+c[g+1]+" "):h+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)k=d.p.We,c[g]==k&&(h=G.Zn(k)?h+("DR"+c[g+1]):h+("D"+c[g+1]))}d.Ya.length&&(h+="\\n-----\\n");for(g=0;g<d.Ya.length;g++)h+=f(d.Ya[g],c);g=d.type==M.ln?"dotted":d.Vd?"solid":"dashed";b=e+(String(a)+' [label="'+h+'" color="black" style="'+(g+",bold")+'"];\n')});t.vg(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+f(e,
c)+'" style="'+(e.Ic?"solid":"dotted")+'"];\n'});return b+="}"};a.iT=function(a){a=t.f_(a);for(var b=[],d=0;d<a.length;d++){var c=a[d];c.Vd&&b.push(c)}return b}};b4w.module.__shaders=function(a,m){function l(a,b,d){var e=a.Ki;"string"==typeof d?(a=c(a,d))&&(d=a[1]):d=String(d);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=d;break}}function c(a,b){for(var d=a.Ki,c=0;c<d.length;c++)if(d[c][0]==b)return d[c];return!1}function b(a,b){var d=a+b;if(!(d in T)){var c=e(t.shaders_path,a),f=e(t.shaders_path,b),c=K(c),f=K(f),h;for(h in f)c[h]=f[h];f=[];for(h in c)f.push([h,c[h]]);T[d]=f}return T[d]}function x(a,b){return a+b}function q(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(x,0)}function A(a,b){var d=u(a.type),c=u(b.type),e=a.sl,f=b.sl;return d>c?-1:d<c?1:e>f?-1:e<f?1:0}function h(a){if(g.gc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ma}else b=W;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],sl:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return p(a,V,Q.Sv)}function z(a,b,d){a=a.split(";").map(function(a){return(a=a.match(H))&&{type:a[2],sl:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return p(a,b,d)}function p(a,b,d){function c(){for(var d=0;m<a.length;){var e=a[m];if(3!=u(e.type))break;d+=k(e.type)*e.sl;m++}g=l+d;if(g>ea)return!1;n(b,l,d,0,3);return!0}function e(){for(var d=ea-g,c=d,f=d;m<a.length;){var h=a[m];if(2!=u(h.type))break;h=k(h.type)*h.sl;if(h<=c)c-=h;else if(h<=f)f-=h;else return!1;m++}f=d-f;n(b,g,d-c,0,2);n(b,ea-f,f,2,2);return!0}function f(){for(;m<a.length;){for(var c=a[m],c=k(c.type)*c.sl,e=-1,h=d+1,g=-1,l=0;4>l;l++){var v=O;
v[0]=0;v[1]=1;var r;r=b;for(var t=l,p=c,q=v;ba<r.length&&15===r[ba];)ba++;for(;0<ea&&15===r[ea];)ea--;if(ea-ba<p)r=!1;else{for(var t=1<<t,u=0,z=-1,y=r.length+1,x=!1,B=ba;B<=ea;B++)B<ea&&!(r[B]&t)?x||(u=B,x=!0):(x&&(x=B-u,x>=p&&x<y&&(y=x,z=u)),x=!1);0>z?r=!1:(q[0]=z,q[1]=y,r=!0)}r&&v[1]<h&&(g=v[0],h=v[1],e=l)}if(0>e)return!1;n(b,g,c,e,1);m++}return!0}if(!a.length)return!0;for(var h=0;h<d;h++)b[h]=0;ea=d;a.sort(A);var g=0,l=0,m=0;return function(){for(;m<a.length;){var d=a[m];if(4!=u(d.type))break;
l+=k(d.type)*d.sl;m++}if(l>ea)return!1;ba=l;n(b,0,l,0,4);return!0}()&&c()&&e()&&f()}function n(a,b,d,c,e){for(var f=0,h=0;h<e;h++)f|=1<<c+h;for(h=0;h<d;h++)a[b+h]|=f}function k(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function u(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=
1}return b}function e(a,b){var d=a+b;if(M[d])return M[d];if(G){var c=G[b];if(!c)return null;c=m("__gpp_parser").x7.parse(c)}else if(c=m("shader_texts")[b],!c)return null;return M[d]=c}function y(a,b){for(var d={},c=b.Ki||[],e=0;e<c.length;e++)d[c[e][0]]=[c[e][1]];for(e=0;e<b.lg.length;e++)d["USE_NODE_"+b.lg[e].id]=["1"];g.gc?(d.GLSL1=["0"],d.GLSL3=["1"],d.GLSL_VERSION=["300 es"],d.GLSL_IN=["in"],d.GLSL_OUT=["out"],d.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],d.GLSL_TEXTURE=["texture"],d.GLSL_TEXTURE_CUBE=
["texture"],d.GLSL_TEXTURE_PROJ=["textureProj"]):(d.GLSL1=["1"],d.GLSL3=["0"],d.GLSL_VERSION=["100"],d.GLSL_IN="vert"==a?["attribute"]:["varying"],d.GLSL_OUT="vert"==a?["varying"]:[""],d.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],d.GLSL_TEXTURE=["texture2D"],d.GLSL_TEXTURE_CUBE=["textureCube"],d.GLSL_TEXTURE_PROJ=["texture2DProj"]);d.GLSL_SMPLR2D_SHDW=g.zq?["sampler2DShadow"]:["sampler2D"];for(var h in d)d[h][0].constructor!=String&&f.warn("Warning! The value of a directive '"+h+"' is not of type string.");
return d}function K(a){function b(a){"var"==a.a?c[a.c]=a.b.join(""):"include"==a.a&&(a=e(t.shaders_path,t.AM+a.o),d(a,b))}function d(a,b,c){if(a instanceof Array)for(var e=0;e<a.length;e++)d(a[e],b,c);else if(a instanceof Object&&a){b&&b(a);for(e in a)d(a[e],b,c);c&&c(a)}}var c={};d(a,b);return c}function F(a,b,d){function c(b){b=b.d;for(var d=0;d<b.length;d++){var g=b[d];switch(g.a){case "cond":a:for(var g=g.d,v=0;v<g.length;v++){var y=g[v];switch(y.a){case "if":case "elif":if(h(y.g)){c(y.h);break a}break;
case "else":c(y.h);break a;case "ifdef":y.c in u&&c(y.h);break;case "ifndef":y.c in u||c(y.h)}}break;case "include":g=g.o;v=e(t.shaders_path,t.AM+g);x.push("include/"+g);c(v);x.pop();break;case "var":break;case "define":u[g.c]=g.b;break;case "error":r.q("Shader error: #error "+g.b.join(" "));break;case "line":break;case "pragma":q.push("#pragma "+g.c+" "+g.b.join(" "));break;case "undef":delete u[g.c];break;case "warning":f.warn("Shader warning: #warning "+g.b.join(" "));break;case "extension":g=
m(g.b,u,z,!1);q.push("#extension "+g.join(" "));break;case "version":g=m(g.b,u,z,!1),q.push("#version "+g.join(" "));case "#":break;case "node":H[g.c]=g;break;case "nodes_global":g=p;for(v=0;v<g.length;v++){var y=g[v],B=H[y.id];if(B)for(var A=0,G=0;G<B.l.length;G++){var Q=B.l[G];if("node_param"==Q.a){var E;if("PARTICLE_INFO"==y.id&&Q.e)if(1==u.PARTICLE_BATCH)switch(E=!1,A){case 0:E=I(y.Tb,"PART_INFO_IND")||I(y.Tb,"PART_INFO_AGE")||I(y.Tb,"PART_INFO_LT")||I(y.Tb,"PART_INFO_SIZE");break;case 1:E=I(y.Tb,
"PART_INFO_LOC");break;case 2:E=I(y.Tb,"PART_INFO_VEL");break;case 3:E=I(y.Tb,"PART_INFO_A_VEL");break;case 4:E=I(y.Tb,"PART_INFO_IND")}else E=!1;else E=!0;E&&(Q=Q.f.join(" ")+" ","vert"==a?Q+=y.oi[A]:"frag"==a&&(Q+=y.rb[A],null!==y.mw[A]&&(Q+="="+y.mw[A])),Q+=";",n(l(Q)));A++}}}break;case "nodes_main":g=p;for(v=0;v<g.length;v++)if(y=g[v],B=H[y.id]){A={};F=D=P=0;G=B;Q=y;E=G;for(var K={},ba=0;ba<E.m.length;ba++){var ca=E.m[ba];K[ca.c]=[ca.b.join("")]}E=K;for(K=0;K<Q.Tb.length;K++)ba=Q.Tb[K][0],ba in
E&&(E[ba]=[Q.Tb[K][1]]);for(K=ba=0;K<G.l.length;K++)ca=G.l[K],"node_out"==ca.a&&(E["USE_OUT_"+ca.c]=[-1<O.indexOf(Q.fb[ba])|0],ba++);G=E;Q=y;E=B.l;K=A;ba=G;for(ca=0;ca<E.length;ca++){var M=E[ca];switch(M.a){case "node_in":var R=Q.L[P];if(null!==Q.yB[P]){if(("MATERIAL_BEGIN"==Q.id&&3===P||!ba.MATERIAL_EXT&&("MATERIAL_BEGIN"==Q.id&&4===P||"MATERIAL_END"==Q.id&&3===P||"MATERIAL_END"==Q.id&&4===P||"MATERIAL_END"==Q.id&&5===P)||"TEXTURE_COLOR"==Q.id||"TEXTURE_NORMAL"==Q.id)&&M.e){K[M.c]=Q.yB[P];P++;continue}var J=
M.f.join(" ")+" ",J=J+(R+"="+Q.yB[P]+";");n(l(J))}K[M.c]=R;P++;break;case "node_out":R=Q.fb[D];if(!M.e||-1<O.indexOf(R))J=M.f.join(" ")+" ",J+=R+";",n(l(J)),K[M.c]=R;D++;break;case "node_param":"vert"==a?R=Q.oi[F]:"frag"==a&&(R=Q.rb[F]),K[M.c]=R,F++}}q.push("{");k(y,B.j,A,G);q.push("}")}break;case "txt":n(g.b);break;default:r.q("Unknown element type: "+g.a)}}}function h(a,b){var d;d=m(a,u,z,!0,b);for(var c=[],e=0;e<d.length;e++)if(d[e]instanceof Object)switch(d[e].a){case "conditional_expr":var g=
c.pop(),k=c.pop();c.pop()?c.push(k):c.push(g);break;case "logical_or_expr":for(var k=c.pop(),l=0;l<d[e].i-1;l++)g=c.pop(),k=k||g;c.push(k);break;case "logical_and_expr":k=c.pop();for(l=0;l<d[e].i-1;l++)g=c.pop(),k=k&&g;c.push(k);break;case "logical_bitor_expr":k=c.pop();for(l=0;l<d[e].i-1;l++)k|=c.pop();c.push(k);break;case "logical_bitxor_expr":k=c.pop();for(l=0;l<d[e].i-1;l++)k^=c.pop();c.push(k);break;case "logical_bitand_expr":k=c.pop();for(l=0;l<d[e].i-1;l++)k&=c.pop();c.push(k);break;case "equal_expr":g=
c.pop();k=c.pop();c.push(k==g);break;case "non_equal_expr":g=c.pop();k=c.pop();c.push(k!=g);break;case "le_expr":g=c.pop();k=c.pop();c.push(k<=g);break;case "ge_expr":g=c.pop();k=c.pop();c.push(k>=g);break;case "l_expr":g=c.pop();k=c.pop();c.push(k<g);break;case "g_expr":g=c.pop();k=c.pop();c.push(k>g);break;case "left_shift_expr":k=c.pop();g=c.pop();c.push(k<<g);break;case "right_shift_expr":k=c.pop();g=c.pop();c.push(k>>g);break;case "add_expr":k=c.pop();g=c.pop();c.push(k+g);break;case "sub_expr":k=
c.pop();g=c.pop();c.push(k-g);break;case "mul_expr":k=c.pop();g=c.pop();c.push(k*g);break;case "div_expr":k=c.pop();g=c.pop();c.push(k/g);break;case "mod_expr":k=c.pop();g=c.pop();c.push(k%g);break;case "pre_inc_expr":case "post_inc_expr":g=c.pop();c.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=c.pop();c.push(--g);break;case "positive_expr":g=c.pop();c.push(+g);break;case "negative_expr":g=c.pop();c.push(-g);break;case "one_compl_expr":g=c.pop();c.push(~g);break;case "logic_negative_expr":g=
c.pop();c.push(!g);break;default:r.q("Unknown operation type: "+d[e].a)}else g=d[e],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?(c.push(0),0!=g.indexOf("USE_NODE_")&&(k=x[x.length-1],k in B||(B[k]=[]),-1==B[k].indexOf(g)&&(B[k].push(g),f.error("Undefined directive '"+g+"' in shader '"+k+"'. Should it be defined with #var/#node_var or #define?")))):c.push(parseFloat(d[e]));1==c.length?d=c[0]:(r.q("Incorrect expression: "+d.join(" ")),d=void 0);return d}function k(a,b,d,c){for(var e=0;e<b.length;e++){var f=
b[e];switch(f.a){case "node_cond":a:for(var g=a,f=f.d,l=d,m=c,v=0;v<f.length;v++){var r=f[v];switch(r.a){case "node_if":case "node_elif":if(h(r.g,m)){k(g,r.j,l,m);break a}break;case "node_else":k(g,r.j,l,m);break a;case "node_ifdef":(r.c in u||r.c in m)&&k(g,r.j,l,m);break;case "node_ifndef":r.c in u||r.c in m||k(g,r.j,l,m)}}break;case "txt":g=[];for(l=0;l<f.b.length;l++)m=f.b[l],m in d?g.push(d[m]):g.push(m);n(g,c)}}}function l(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function n(b,d){var c=
b;g.gc||"frag"!=a||(c=c.join(" "),Q&&(c.match(/[^;]*;/)?(c=c.replace(/[^;]*;/,""),Q=!1):c=""),c=c.replace(/GLSL_OUT [^;]*;/g,""),c.match(/GLSL_OUT(?:$| [^;]*)/)&&(c=c.replace(/GLSL_OUT(?:$| [^;]*)/,""),Q=!0),c=c.replace(/ {2,}/g," "),c=(c=c.trim())?c.split(" "):[]);b=c;b.length&&(c=m(b,u,z,!1,d),q.push(c.join(" ")))}function m(a,b,d,c,e){var f=[];v(a,b,d,c,f,e);return f}function v(a,b,d,c,e,f){for(var g=0;g<a.length;g++){var h=a[g];if(f&&h in f)h=f[h];else if(h in b)h=b[h];else{e.push(h);continue}0==
h.length&&c?e.push(0):v(h,b,d,c,e,f)}}var p=d.lg,q=[],u=y(a,d),z={},x=[d[a]],B={},H={},O=[],A;for(A in p)for(var G in p[A].L)O.push(p[A].L[G]);var Q=!1;c(b);var P=0,D=0,F=0;return q.join("\n")}function J(a,b,d){d=a.createShader(d);a.shaderSource(d,b);a.compileShader(d);return d}function D(a){na.deleteProgram(a.$h);na.deleteShader(a.Gx);na.deleteShader(a.Mu);delete aa[a.tD]}function R(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return E(a);case 2:return"vec2("+E(a[0])+","+E(a[1])+")";case 3:return"vec3("+
E(a[0])+","+E(a[1])+","+E(a[2])+")";case 4:return"vec4("+E(a[0])+","+E(a[1])+","+E(a[2])+","+E(a[3])+")";case 9:return"mat3("+E(a[0])+","+E(a[1])+","+E(a[2])+","+E(a[3])+","+E(a[4])+","+E(a[5])+","+E(a[6])+","+E(a[7])+","+E(a[8])+")";case 16:return"mat4("+E(a[0])+","+E(a[1])+","+E(a[2])+","+E(a[3])+","+E(a[4])+","+E(a[5])+","+E(a[6])+","+E(a[7])+","+E(a[8])+","+E(a[9])+","+E(a[10])+","+E(a[11])+","+E(a[12])+","+E(a[13])+","+E(a[14])+","+E(a[15])+")";default:r.q("Wrong glsl value dimension")}}function E(a){return a%
1?String(a):String(a)+".0"}function I(a,b){for(var d=0;d<a.length;d++)if(a[d][0]==b)return!0;return!1}var B=m("__assets"),P=m("__config"),d=m("__debug"),f=m("__print"),r=m("__util"),g=P.B,Q=P.Fi,t=P.De,aa={},M={},G=null,T={},S="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.gz=0;a.wO=1;a.vO=2;a.zO=4;a.yO=8;a.xO=16;a.rO=32;var X=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,H=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ma=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,W=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
O=new Int16Array(2),V=null,ga=null,v=null,ba=0,ea=0,ca=[],na=null,pa=!1;a.Lf=function(a){na=a};a.ha=l;a.rV=c;a.JY=function(a){a.Ki=r.Eh(b(a.wg,a.Ye));l(a,"PRECISION",P.B.precision);"highp"==P.B.precision?l(a,"EPSILON",R(1E-6)):l(a,"EPSILON",R(1E-4));l(a,"CONSTANTS_HACK",g.sD|0);l(a,"SRGB",g.srgb_type);l(a,"COMPARED_MODE",g.zq|0)};a.d6=function(a){return a.wg};a.W4=function(a){return a.Ye};a.mV=function(a){var b=JSON.stringify(a.wg)+JSON.stringify(a.Ye)+JSON.stringify(a.Ki)+JSON.stringify(a.lg),c=
aa[b];if(c)return c;var f=a.Ye,k=e(t.shaders_path,a.wg),f=e(t.shaders_path,f);if(!k||!f)return null;var k=F("vert",k,a),f=F("frag",f,a),c=0,l=q(f,X);a.lN=l;l>Q.YB&&(c|=1);V||(V=new Uint32Array(Q.Sv));ga||(ga=new Uint32Array(Q.Rv));v||(v=new Uint32Array(Q.Mr));z(f,ga,Q.Rv)||(c|=2);z(k,v,Q.Mr)||(c|=4);l=g.gc?(k.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(k.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.dG=l;l>Q.ZB&&(c|=8);h(f)||(c|=16);a.status=
c;if(0===a.status){var c=na,n=J(c,k,c.VERTEX_SHADER),m=J(c,f,c.FRAGMENT_SHADER),l=c.createProgram();c.attachShader(l,n);c.attachShader(l,m);c.linkProgram(l);for(var n={Gx:n,Mu:m,$h:l,attributes:{},Rm:{},Xr:r.Sj(),yC:r.Sj(),zC:{},Pr:!0,bw:!1,yN:r.Sj(),xN:r.Sj(),hb:r.Eh(a),tD:b,Wf:!0},p=c.getProgramParameter(l,c.ACTIVE_ATTRIBUTES),m=0;m<p;m++){var u=c.getActiveAttrib(l,m).name;n.attributes[u]=c.getAttribLocation(l,u)}p=c.getProgramParameter(l,c.ACTIVE_UNIFORMS);for(m=0;m<p;m++)u=c.getActiveUniform(l,
m).name.split("[0]").join(""),n.Rm[u]=c.getUniformLocation(l,u);aa[b]=c=n;l=!na.getShaderParameter(c.Mu,na.COMPILE_STATUS);n=!na.getShaderParameter(c.Gx,na.COMPILE_STATUS);m=!na.getProgramParameter(c.$h,na.LINK_STATUS);l?d.AL(c.Mu,b,f):n?d.AL(c.Gx,b,k):m&&d.oY(c.$h,b,k,f);if(l||n||m)a.status|=32,c=null}else c=null;return c};a.XW=function(){pa=!1;if(b4w.module_check("shader_texts"))pa=!0;else{for(var a=[],b=B.Rx,d=0;d<S.length;d++){var c=r.hj(t.shaders_path+S[d]);a.push({id:S[d],type:b,url:c})}b=function(a,
b){G||(G={});G[b]=a};a.length?B.Vd(a,b,function(){pa=!0}):f.error("Shaders have not been found.")}};a.RG=function(){return pa};a.E3=function(){return ca};a.HI=function(){return aa};a.ua=function(){for(var a in aa)D(aa[a]);for(var b in M)delete M[b];for(var d in ca)delete ca[d];v=ga=V=null;T={}};a.BS=D;a.F3=function(a){var b=a.Ki;f.log("Shader: "+a.wg+" "+a.Ye+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)f.log("  "+b[a][0],b[a][1])};a.M=R;a.SG=function(a,b){return b in a.Rm?!0:!1};
a.reset=function(){na=null}};b4w.module.__assets=function(a,m){function l(){return y.YJ()?m(y.De.au).data:null}function c(){var a={Kt:null,DQ:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var d=b.length,c=new Int8Array(d),e=0;e<d;e++)c[e]=b.charCodeAt(e);return c.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,d){a.Kt=d;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=l();b&&a.Kt in b&&(a.status=200,b[a.Kt]&&(a.response=a.DQ(b[a.Kt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var d=0,c=0;c<b.length;c++){var e=b[c];20===e.state&&d++;if(d>=I.nX)break;if(10===e.state)switch(e.state=20,d++,e.type){case a.at:x(e,"arraybuffer");break;case a.dn:x(e,"json");break;case a.Rx:x(e,"text");break;case a.Px:q(e);break;case a.bt:A(e);break;case a.Qx:h(e);break;case a.et:z(e);break;
case a.dt:p(e);break;default:D.q("Wrong asset type: "+e.type)}}}function x(b,d){var e=b.url.split("?t=")[0];if(e in f)"json"==d?b.ac(D.R(f[e]),b.id,b.type,b.url,b.Jb):b.ac(f[e],b.id,b.type,b.url,b.Jb);else{var g=l(),h=g&&b.url in g?new c:new XMLHttpRequest,g=null;if("GET"==b.bi)h.open("GET",b.url,!0);else if("POST"==b.bi)switch(h.open("POST",b.url,!0),b.xo){case a.AE:g="text/plain";break;case a.zE:g="application/json"}if(b.uk)for(var k in b.uk)"Content-Type"==k?g=b.uk[k]:h.setRequestHeader(k,b.uk[k]);
g&&h.setRequestHeader("Content-Type",g);"text"==d?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==d?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=d;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,b.EW)}catch(c){F.error(c+" (parsing JSON "+b.url+")");b.ac(null,b.id,b.type,b.url,b.Jb);return}b.Wg&&(f[e]="json"==d?D.R(a):a);b.ac(a,
b.id,b.type,b.url,b.Jb)}else F.error("empty responce when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb)}else F.error(h.status+" when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.mL(a.loaded/a.total)},!1);h.send(b.Dm)}}function q(a){var b=a.url.split("?t=")[0];if(b in Q)a.ac(Q[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.bi&&D.q("Unsupported request type for audio buffer");var d=(b=l())&&a.url in
b?new c:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?J.ZT(b,function(b){a.ac(b,a.id,a.type,a.url,a.Jb);a.state=30;a.Wg&&(Q[a.url.split("?t=")[0]]=b)},function(){a.ac(null,a.id,a.type,a.url,a.Jb);F.error("failed to decode "+a.url);a.state=30}):(a.ac(null,a.id,a.type,a.url,a.Jb),F.error("empty responce when trying to get "+a.url),a.state=30)}else a.ac(null,a.id,
a.type,a.url,a.Jb),F.error(d.status+" when trying to get "+a.url),a.state=30};d.send(a.Dm)}}function A(a){var b=a.url.split("?t=")[0];if(b in r)a.ac(r[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.bi&&D.q("Unsupported request type for image element");var d=document.createElement("img");E.allow_cors&&(d.crossOrigin="Anonymous");d.onload=function(){40!=a.state&&(a.ac(d,a.id,a.type,a.url,a.Jb),a.state=30,a.Wg&&(r[a.url.split("?t=")[0]]=d))};d.addEventListener("error",function(){40!=a.state&&(a.ac(null,
a.id,a.type,a.url,a.Jb),F.error("could not load image: "+a.url),a.state=30)},!1);if((b=l())&&a.url in b)if(b[a.url]){var c=k(a.url);d.src="data:"+c+";base64,"+b[a.url]}else K.Br()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),d.dispatchEvent(b);else d.src=a.url}}function h(a){var b=a.url.split("?t=")[0];if(b in g)a.ac(g[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.bi&&D.q("Unsupported request type for audio element");var d=document.createElement("audio");
E.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){40!=a.state&&(a.ac(d,a.id,a.type,a.url,a.Jb),a.state=30,a.Wg&&(g[a.url.split("?t=")[0]]=d))},!1);d.addEventListener("error",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),F.error("could not load sound: "+a.url),a.state=30)},!1);d.addEventListener("stalled",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),F.error("could not load sound: "+a.url),a.state=30)},!1);if((b=l())&&a.url in b)if(b[a.url]){var c=
u(a.url);d.src="data:"+c+";base64,"+b[a.url];40!=a.state&&(a.ac(d,a.id,a.type,a.url,a.Jb),a.state=30)}else K.Br()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),d.dispatchEvent(b);else d.src=a.url,E.is_mobile_device&&d.load();E.bC&&(d.autoplay=!0,d.pause());setTimeout(function(){d.zZ=1},5E3)}}function z(a){function b(){40!=a.state&&(a.ac(null,a.id,a.type,a.url),F.error("could not load video: "+a.url,a.Jb),a.state=30)}var d=a.url.split("?t=")[0];
if(d in r)a.ac(r[d],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.bi&&D.q("Unsupported request type for video element");var c=document.createElement("video");c.muted=!0;E.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30,a.Wg&&(r[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",b,!1);if((d=l())&&a.url in d)if(d[a.url]){var f=e(a.url);c.src="data:"+f+";base64,"+
d[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.ac(c,a.id,a.type,a.url,a.Jb);a.state=30},!1)}else K.Br()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.url,E.is_mobile_device&&c.load();E.bC&&(c.autoplay=!0,c.pause());setTimeout(function(){c.zZ=1},1E4)}}function p(b){function d(a){b.ac(a,b.id,b.type,b.url,b.Jb);b.state=30;b.Wg&&(r[b.url.split("?t=")[0]]=a)}var e=b.url.split("?t=")[0];if(e in
r)b.ac(r[e],b.id,b.type,b.url,b.Jb),b.state=30;else{"GET"!=b.bi&&D.q("Unsupported request type for seq video element");var f=(e=l())&&b.url in e?new c:new XMLHttpRequest;if(null==b.xo&&null==b.Dm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.xo){case a.AE:f.setRequestHeader("Content-type","text/plain");break;case a.zE:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?n(a,d):(b.ac(null,b.id,b.type,b.url,b.Jb),F.error("empty responce when trying to get "+b.url),b.state=30)}else b.ac(null,b.id,b.type,b.url,b.Jb),F.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.mL(a.loaded/a.total)},!1);f.send(b.Dm)}}function n(a,b){for(var d=new Int32Array(a),c=new Int8Array(a),e=d[3],f={images:[],uG:[],Sg:d[4]},g=20,h=0;h<e;h++){var k=d[g/4],l=new Blob([c.subarray(g+4,g+4+k)],
{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(l);f.images.push(n);f.uG.push(l);g+=k+8-k%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.uG;b(f)}}function k(a){var b="image";switch(D.cB(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function u(a){var b="audio";switch(D.cB(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function e(a){var b="video";switch(D.cB(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var y=m("__config"),K=m("__compat"),F=m("__print"),J=m("__sfx"),D=m("__util"),R=m("__version"),E=y.B,I=y.Pd;a.at=10;a.dn=20;a.Rx=30;a.Px=40;a.bt=50;a.Qx=60;a.et=70;a.dt=80;a.zE=a.dn;a.AE=a.Rx;var B=[],P=0,d={},f={},r={},g={},Q={};a.Nm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.M5=function(a){if(d[a])return d[a];var b=I.prevent_caching?a+R.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return d[a]=b;D.q("Error XHR: responce is empty, GET "+a)}else D.q("Error XHR: "+c.status+", GET "+a)};a.ua=function(){for(var a=0;a<B.length;a++)B[a].state=40;B=[];P=0;d={}};a.Vd=function(a,d,c,e,f){for(var g=0;g<a.length;g++){var h=a[g],h={id:h.id,type:h.type,url:h.url,
Wg:h.Wg,bi:h.bi?h.bi:"GET",xo:h.xo?h.xo:null,uk:h.uk?h.uk:null,Dm:h.Dm?h.Dm:null,Jb:h.Jb?h.Jb:null,state:10,ac:d||function(){},ZK:c||function(){},mL:e||function(){},EW:f||null,$K:P};if(I.prevent_caching){var k=l();k&&h.url in k||(h.url+=R.timestamp())}B.push(h)}b(B);P++};a.update=function(){b(B);for(var a=B,d=0,c=!0,e=0;e<a.length;e++){var f=a[e];f.$K===a[d].$K?30!==f.state&&(c=!1):(c&&(a[e-1].ZK(),c=e-d,a.splice(d,c),e-=c),d=e,c=30===a[e].state?!0:!1);e===a.length-1&&c&&(a[e].ZK(),a.splice(d))}};
a.pS=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.DS=function(){f={};r={};g={};Q={}}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__reformer=function(a,m){function l(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var e=a[c],d=0;d<e.strips.length;d++){var f=e.strips[d];"action"in f||(f.action=null,b("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,b("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,b("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,b("strip",f,"repeat"));
"use_reverse"in f||(f.use_reverse=!1,b("strip",f,"use_reverse"));"scale"in f||(f.scale=1,b("strip",f,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={ED:[],BL:"undefined",type:a});D[c].ED.push(b.name)}function x(a,b,c){c=c+">>"+a;c in D||(D[c]={ED:[],BL:"deprecated",type:a});D[c].ED.push(b.name)}function q(a){n.warn(a)}function A(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=u.Eh(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var h=u.sq(d[c]);e.submeshes.push(h)}return e}var h=m("__boundings"),z=m("__curve"),p=m("__mat4"),n=m("__print"),k=m("__quat"),u=m("__util"),e=m("__vec3"),y=m("__mat3"),K=m("__logic_nodes"),F=m("__animation"),J=[5,4],D={},R=y.create(),E=k.create();a.QG=function(a){return-1!=u.$N(a,J)};a.iS=function(a){D={};var e=a.worlds;if(0==e.length){n.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var h={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};e.push(h)}for(var e=a.worlds,d=0;d<e.length;d++){h=e[d];"use_sky_blend"in h||(b("world",h,"use_sky_blend"),h.use_sky_blend=!1);"use_sky_paper"in h||(b("world",h,"use_sky_paper"),
h.use_sky_paper=!1);"use_sky_real"in h||(b("world",h,"use_sky_real"),h.use_sky_real=!1);"b4w_sky_settings"in h&&"rayleigh_brightness"in h.b4w_sky_settings||(b("world",h,"rayleigh_brightness"),h.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
h||(b("world",h,"fog_settings"),h.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in h&&(h.fog_settings.use_custom_color=!0,h.fog_settings.color=h.b4w_fog_color),"b4w_fog_density"in h&&0<h.b4w_fog_density&&(h.fog_settings.depth=1/h.b4w_fog_density));"render_sky"in h.b4w_sky_settings||(b("world",h,"render_sky"),h.b4w_sky_settings.render_sky=!1);for(var f=h.texture_slots,k=0;k<f.length;k++){var g=f[k];"blend_type"in
g||(g.blend_type="MIX",b("world_texture_slot",g,"blend_type"));"use_map_blend"in g||(g.use_map_blend=!1,b("world_texture_slot",g,"use_map_blend"));"use_map_horizon"in g||(g.use_map_horizon=!0,b("world_texture_slot",g,"use_map_horizon"));"use_map_zenith_up"in g||(g.use_map_zenith_up=!1,b("world_texture_slot",g,"use_map_zenith_up"));"use_rgb_to_intensity"in g||(g.use_rgb_to_intensity=!1,b("world_texture_slot",g,"use_rgb_to_intensity"));"invert"in g||(g.invert=!1,b("world_texture_slot",g,"invert"));
"color"in g||(g.color=[1,0,1],b("world_texture_slot",g,"color"));"blend_factor"in g||(g.blend_factor=0,b("world_texture_slot",g,"blend_factor"));"horizon_factor"in g||(g.horizon_factor=1,b("world_texture_slot",g,"horizon_factor"));"zenith_up_factor"in g||(g.zenith_up_factor=0,b("world_texture_slot",g,"zenith_up_factor"));"zenith_down_factor"in g||(g.zenith_down_factor=0,b("world_texture_slot",g,"zenith_down_factor"));"default_value"in g||(g.default_value=1,b("world_texture_slot",g,"default_value"))}"b4w_use_default_animation"in
h||(b("world",h,"b4w_use_default_animation"),h.b4w_use_default_animation=!1);"b4w_anim_behavior"in h||(b("world",h,"b4w_anim_behavior"),h.b4w_anim_behavior="CYCLIC")}k=a.scenes;for(d=0;d<k.length;d++)f=k[d],g=f.world,"timeline_markers"in f||(f.timeline_markers=null,b("scene",f,"timeline_markers")),"b4w_reflection_quality"in f||(f.b4w_reflection_quality="MEDIUM",b("scene",f,"b4w_reflection_quality")),"b4w_use_nla"in f||(f.b4w_use_nla=!1,b("scene",f,"b4w_use_nla")),"fps"in f||(f.fps=24,b("scene",f,
"fps")),"b4w_nla_cyclic"in f||(f.b4w_nla_cyclic=!1,b("scene",f,"b4w_nla_cyclic")),"b4w_logic_nodes"in f||(f.b4w_logic_nodes=[],b("scene",f,"b4w_logic_nodes")),"b4w_detect_collisions"in f&&(x("scene",f,"b4w_detect_collisions"),delete f.b4w_detect_collisions),"audio_doppler_speed"in f||(f.audio_doppler_speed=343.3),"audio_doppler_factor"in f||(f.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in f||(f.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",f,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in f||(f.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in f||(f.b4w_enable_bloom=!1,b("scene",f,"b4w_enable_bloom")),"b4w_enable_motion_blur"in f||(f.b4w_enable_motion_blur=!1,b("scene",f,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in f||(f.b4w_enable_color_correction=!1,b("scene",f,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in f||(f.b4w_antialiasing_quality="MEDIUM",b("scene",f,"b4w_antialiasing_quality")),
"b4w_tags"in f||(f.b4w_tags={title:"",description:""},b("scene",f,"b4w_tags")),"b4w_enable_object_selection"in f||(f.b4w_enable_object_selection="AUTO",b("scene",f,"b4w_enable_object_selection")),"b4w_enable_outlining"in f||(f.b4w_enable_outlining="AUTO",b("scene",f,"b4w_enable_outlining")),"b4w_enable_glow_materials"in f||(f.b4w_enable_glow_materials="AUTO",b("scene",f,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in f||(f.b4w_enable_anchors_visibility="AUTO",b("scene",f,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in f||(f.b4w_outline_color=[1,1,1],b("scene",f,"b4w_outline_color")),"b4w_outline_factor"in f||(f.b4w_outline_factor="b4w_glow_factor"in f?f.b4w_glow_factor:1,b("scene",f,"b4w_outline_factor")),"b4w_shadow_settings"in f||(b("scene",f,"b4w_shadow_settings"),e=g.b4w_shadow_settings,f.b4w_shadow_settings=e?e:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),e=f.b4w_shadow_settings,"csm_resolution"in e||(b("scene",f,"b4w_shadow_settings.csm_resolution"),e.csm_resolution=2048),"blur_samples"in e||(b("scene",f,"b4w_shadow_settings.blur_samples"),e.blur_samples="16x"),"soft_shadows"in e||(b("scene",f,"b4w_shadow_settings.soft_shadows"),e.soft_shadows=!0),"self_shadow_polygon_offset"in e||(b("scene",f,"b4w_shadow_settings.self_shadow_polygon_offset"),e.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in e||(b("scene",f,"b4w_shadow_settings.self_shadow_normal_offset"),e.self_shadow_normal_offset=.01),"b4w_enable_csm"in e||(b("scene",f,"b4w_shadow_settings.b4w_enable_csm"),e.b4w_enable_csm=!1),"csm_num"in e||(b("scene",f,"b4w_shadow_settings.csm_num"),e.csm_num=1),"csm_first_cascade_border"in e||(b("scene",f,"b4w_shadow_settings.csm_first_cascade_border"),e.csm_first_cascade_border=10),"first_cascade_blur_radius"in e||(b("scene",f,"b4w_shadow_settings.first_cascade_blur_radius"),
e.first_cascade_blur_radius=3),"csm_last_cascade_border"in e||(b("scene",f,"b4w_shadow_settings.csm_last_cascade_border"),e.csm_last_cascade_border=100),"last_cascade_blur_radius"in e||(b("scene",f,"b4w_shadow_settings.last_cascade_blur_radius"),e.last_cascade_blur_radius=1.5),"fade_last_cascade"in e||(b("scene",f,"b4w_shadow_settings.fade_last_cascade"),e.fade_last_cascade=!0),"blend_between_cascades"in e||(b("scene",f,"b4w_shadow_settings.blend_between_cascades"),e.blend_between_cascades=!0),"b4w_ssao_settings"in
f||(b("scene",f,"b4w_ssao_settings"),e=g.b4w_ssao_settings,f.b4w_ssao_settings=e?e:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),e=f.b4w_ssao_settings,"dist_factor"in e||(b("scene",f,"b4w_ssao_settings.dist_factor"),e.dist_factor=0),"samples"in e||(b("scene",f,"b4w_ssao_settings.samples"),e.samples=16),"hemisphere"in e||(b("scene",f,"b4w_ssao_settings.hemisphere"),e.hemisphere=!1),"blur_depth"in e||(b("scene",f,"b4w_ssao_settings.blur_depth"),e.blur_depth=!1),"blur_discard_value"in
e||(b("scene",f,"b4w_ssao_settings.blur_discard_value"),e.blur_discard_value=1),"b4w_bloom_settings"in f||(b("scene",f,"b4w_bloom_settings"),e=g.b4w_bloom_settings,f.b4w_bloom_settings=e?e:{key:.2,blur:4,edge_lum:1}),"key"in f.b4w_bloom_settings||(b("scene",f,"b4w_bloom_settings.key"),f.b4w_bloom_settings.key=.2),"blur"in f.b4w_bloom_settings||(b("scene",f,"b4w_bloom_settings.blur"),f.b4w_bloom_settings.blur=4),"edge_lum"in f.b4w_bloom_settings||(b("scene",f,"b4w_bloom_settings.edge_lum"),f.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in f||(b("scene",f,"b4w_motion_blur_settings"),e=g.b4w_motion_blur_settings,f.b4w_motion_blur_settings=e?e:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in f.b4w_motion_blur_settings||(b("scene",f,"b4w_motion_blur_settings.motion_blur_factor"),f.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in f.b4w_motion_blur_settings||(b("scene",f,"b4w_motion_blur_settings.motion_blur_decay_threshold"),f.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in f||(b("scene",f,"b4w_color_correction_settings"),e=g.b4w_color_correction_settings,f.b4w_color_correction_settings=e?e:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in f||(b("scene",f,"b4w_god_rays_settings"),e=g.b4w_god_rays_settings,f.b4w_god_rays_settings=e?e:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in f.b4w_god_rays_settings||(b("scene",f,"b4w_god_rays_settings.steps_per_pass"),f.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in f||(b("scene",f,"b4w_glow_settings"),f.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},e=f.b4w_glow_settings,"b4w_render_glow_over_blend"in g&&(e.render_glow_over_blend=g.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in g&&(e.small_glow_mask_coeff=g.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in g&&(e.large_glow_mask_coeff=g.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
g&&(e.small_glow_mask_width=g.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in g&&(e.large_glow_mask_width=g.b4w_large_glow_mask_width)),g=f.b4w_render_shadows,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(f.b4w_render_shadows=g?"ON":"OFF"),g=f.b4w_render_reflections,"OFF"!=g&&"ON"!=g&&(f.b4w_render_reflections=g?"ON":"OFF"),g=f.b4w_render_refractions,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(f.b4w_render_refractions=g?"ON":"OFF"),"b4w_render_dynamic_grass"in f||(b("scene",f,"b4w_render_dynamic_grass"),f.b4w_render_dynamic_grass=
"AUTO"),f.b4w_nla_script&&x("scene",f,"b4w_nla_script"),"audio_distance_model"in f||(b("scene",f,"audio_distance_model"),f.audio_distance_model="INVERSE_CLAMPED");f=a.meshes;for(d=0;d<f.length;d++){g=f[d];g.b4w_boundings||(b("mesh",g,"b4w_boundings"),g.b4w_boundings={},e=g.b4w_boundings,e.bb=g.b4w_bounding_box?g.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},e.bb_src=g.b4w_bounding_box_source?g.b4w_bounding_box_source:g.b4w_bounding_box,e.bs_cen=g.b4w_bounding_sphere_center?g.b4w_bounding_sphere_center:
[0,0,0],e.bc_cen=g.b4w_bounding_cylinder_center?g.b4w_bounding_cylinder_center:[0,0,0],e.be_cen=g.b4w_bounding_ellipsoid_center?g.b4w_bounding_ellipsoid_center:[0,0,0],g.b4w_bounding_ellipsoid_axes?e.be_ax=g.b4w_bounding_ellipsoid_axes:(k=e.bb,e.be_ax=[(k.max_x-k.min_x)/2,(k.max_y-k.min_y)/2,(k.max_z-k.min_z)/2]),g.b4w_rotated_bounding_box?e.rbb=g.b4w_rotated_bounding_box:(k=e.bb,e.rbb={rbb_c:[(k.max_x+k.min_x)/2,(k.max_y+k.min_y)/2,(k.max_z+k.min_z)/2],rbb_s:[1,1,1]}),e.caxis_x=g.b4w_cov_axis_x?
g.b4w_cov_axis_x:[1,0,0],e.caxis_y=g.b4w_cov_axis_y?g.b4w_cov_axis_y:[0,1,0],e.caxis_z=g.b4w_cov_axis_z?g.b4w_cov_axis_z:[0,0,1]);g.uv_textures||(b("mesh",g,"uv_textures"),g.uv_textures=[]);"b4w_shape_keys"in g||(g.b4w_shape_keys=[],b("mesh",g,"b4w_shape_keys"));e=!0;for(h=0;h<g.submeshes.length;h++){var m=g.submeshes[h];"boundings"in m||(e=!1,m.boundings={be_ax:g.b4w_bounding_ellipsoid_axes,be_cen:g.b4w_bounding_ellipsoid_center,bb:{max_x:g.b4w_bounding_box.max_x,max_y:g.b4w_bounding_box.max_y,max_z:g.b4w_bounding_box.max_z,
min_x:g.b4w_bounding_box.min_x,min_y:g.b4w_bounding_box.min_y,min_z:g.b4w_bounding_box.min_z}});"be_ax"in m.boundings||(m.boundings.be_ax=g.b4w_bounding_ellipsoid_axes);"be_cen"in m.boundings||(m.boundings.be_cen=g.b4w_bounding_ellipsoid_center);"bb"in m.boundings||(m.boundings.bb=g.b4w_bounding_box);"rbb"in m.boundings||(k=g.b4w_bounding_box,m.boundings.rbb={rbb_c:[(k.max_x+k.min_x)/2,(k.max_y+k.min_y)/2,(k.max_z+k.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in m.boundings||(m.boundings.caxis_x=[1,0,0]);
"caxis_y"in m.boundings||(m.boundings.caxis_y=[0,1,0]);"caxis_z"in m.boundings||(m.boundings.caxis_z=[0,0,1])}e||b("mesh",g,"submesh_bd");k=g;e=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];h=null;for(m=0;m<e.length;m++)k[e[m]]&&(h?(k[e[m]]=!1,n.warn('WARNING property "'+e[m]+'" of object "'+k.name+'" has been set to "false". Foreground property "'+h+'" already exists.')):h=e[m]);for(k=0;k<g.b4w_vertex_anim.length;k++)e=g.b4w_vertex_anim[k],
"allow_nla"in e||(b('mesh["b4w_vertex_anim"]',g,"allow_nla"),e.allow_nla=!0)}k=a.cameras;for(d=0;d<k.length;d++)f=k[d],f.type||(f.type="PERSP",b("camera",f,"type")),"b4w_eye_target_dist"in f&&(delete f.b4w_eye_target_dist,x("camera",f,"b4w_eye_target_dist")),"b4w_hover_zero_level"in f||(f.b4w_hover_zero_level=0,b("camera",f,"b4w_hover_zero_level")),"b4w_trans_velocity"in f||(f.b4w_trans_velocity=1,b("camera",f,"b4w_trans_velocity")),"b4w_rot_velocity"in f||(f.b4w_rot_velocity=1,b("camera",f,"b4w_rot_velocity")),
"b4w_zoom_velocity"in f||(f.b4w_zoom_velocity=.1,b("camera",f,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in f||(f.b4w_use_target_distance_limits=f.b4w_use_distance_limits||!1,b("camera",f,"b4w_use_target_distance_limits")),"b4w_use_zooming"in f||(f.b4w_use_zooming=f.b4w_use_distance_limits||!1,b("camera",f,"b4w_use_zooming")),"b4w_distance_min"in f||(f.b4w_distance_min=1,b("camera",f,"b4w_distance_min")),"b4w_distance_max"in f||(f.b4w_distance_max=100,b("camera",f,"b4w_distance_max")),
"b4w_horizontal_translation_min"in f||(f.b4w_horizontal_translation_min=-100,b("camera",f,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in f||(f.b4w_horizontal_translation_max=100,b("camera",f,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in f||(f.b4w_vertical_translation_min=-100,b("camera",f,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in f||(f.b4w_vertical_translation_max=100,b("camera",f,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
f||(f.b4w_use_horizontal_clamping=!1,b("camera",f,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in f||(f.b4w_rotation_left_limit=-Math.PI,b("camera",f,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in f||(f.b4w_rotation_right_limit=Math.PI,b("camera",f,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in f||(f.b4w_horizontal_clamping_type="LOCAL",b("camera",f,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in f||(f.b4w_use_vertical_clamping=!1,b("camera",f,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in f||(f.b4w_rotation_down_limit=-Math.PI/2,b("camera",f,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in f||(f.b4w_rotation_up_limit=Math.PI/2,b("camera",f,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in f||(f.b4w_vertical_clamping_type="LOCAL",b("camera",f,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in f||(f.b4w_hover_angle_min=Math.PI/6,b("camera",f,"b4w_hover_angle_min")),"b4w_hover_angle_max"in f||(f.b4w_hover_angle_max=Math.PI/6,b("camera",f,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in f||(f.b4w_enable_hover_hor_rotation=!0,b("camera",f,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in f||(f.b4w_use_panning=!0,b("camera",f,"b4w_use_panning")),"b4w_use_pivot_limits"in f||(f.b4w_use_pivot_limits=!1,f.b4w_pivot_z_min=0,f.b4w_pivot_z_max=10,b("camera",f,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in f||(f.b4w_dof_bokeh=!1,b("camera",f,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in f||(f.b4w_dof_bokeh_intensity=.3,b("camera",f,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in f||(f.b4w_dof_foreground_blur=!1,b("camera",f,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in f||(f.b4w_dof_front_start=0,b("camera",f,"b4w_dof_front_start")),"b4w_dof_front_end"in f||(f.b4w_dof_front_end=f.b4w_dof_front,b("camera",f,"b4w_dof_front_end")),"b4w_dof_rear_start"in f||(f.b4w_dof_rear_start=0,b("camera",f,"b4w_dof_rear_start")),"b4w_dof_rear_end"in f||(f.b4w_dof_rear_end=f.b4w_dof_rear,b("camera",f,"b4w_dof_rear_end"));k=a.lamps;for(d=0;d<k.length;d++)f=
k[d],"b4w_generate_shadows"in f||(f.b4w_generate_shadows=!1,b("lamp",f,"b4w_generate_shadows")),"b4w_dynamic_intensity"in f||(f.b4w_dynamic_intensity=!1,b("lamp",f,"b4w_dynamic_intensity")),"use_diffuse"in f||(f.use_diffuse=!0,b("lamp",f,"use_diffuse")),"use_specular"in f||(f.use_specular=!0,b("lamp",f,"use_specular")),"clip_start"in f||(f.clip_start=.1,b("lamp",f,"clip_start")),"clip_end"in f||(f.clip_end=30,b("lamp",f,"clip_end")),"POINT"!=f.type&&"SPOT"!=f.type||"use_sphere"in f||(f.use_sphere=
!1,b("lamp",f,"use_sphere"));k=a.speakers;for(d=0;d<k.length;d++)f=k[d],"b4w_behavior"in f||(f.b4w_behavior=f.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in f||(f.b4w_auto_play=!1,b("speaker",f,"b4w_auto_play")),"b4w_enable_doppler"in f||(f.b4w_enable_doppler=!1,b("speaker",f,"b4w_enable_doppler")),"b4w_delay"in f||(f.b4w_delay=0),"b4w_delay_random"in f||(f.b4w_delay_random=0),"b4w_volume_random"in f||(f.b4w_volume_random=0),"b4w_pitch_random"in f||(f.b4w_pitch_random=0),
"b4w_fade_in"in f||(f.b4w_fade_in=0),"b4w_fade_out"in f||(f.b4w_fade_out=0),"b4w_loop"in f||(f.b4w_loop=!1),"b4w_loop_start"in f||(f.b4w_loop_start=0,b("speaker",f,"b4w_loop_start")),"b4w_loop_end"in f||(f.b4w_loop_end=0,b("speaker",f,"b4w_loop_end")),f.animation_data&&c(f.animation_data);k=a.textures;for(d=0;d<k.length;d++)f=k[d],"b4w_anisotropic_filtering"in f||(f.b4w_anisotropic_filtering="OFF",b("texture",f,"b4w_anisotropic_filtering")),"b4w_water_foam"in f||(f.b4w_water_foam=!1,b("texture",f,
"b4w_water_foam")),"b4w_foam_uv_freq"in f||(f.b4w_foam_uv_freq=[1,1],b("texture",f,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in f||(f.b4w_foam_uv_magnitude=[1,1],b("texture",f,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in f||(f.b4w_parallax_steps=5,b("material",f,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in f||(f.b4w_parallax_lod_dist=10,b("material",f,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in f||(f.b4w_shore_dist_map=!1,b("texture",f,"b4w_shore_dist_map")),"b4w_shore_boundings"in
f||(f.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",f,"b4w_shore_boundings")),"b4w_max_shore_dist"in f||(f.b4w_max_shore_dist=100,b("texture",f,"b4w_max_shore_dist")),"b4w_disable_compression"in f||(f.b4w_disable_compression=!1,b("texture",f,"b4w_disable_compression")),"b4w_source_type"in f||(f.b4w_source_type="",b("texture",f,"b4w_source_type")),"b4w_source_id"in f||(f.b4w_source_id="",b("texture",f,"b4w_source_id")),"b4w_source_size"in f||(f.b4w_source_size=1024,b("texture",f,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in f||(f.b4w_enable_canvas_mipmapping=!0,b("texture",f,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in f||(f.b4w_nla_video=!1,b("texture",f,"b4w_nla_video"));k=a.images;for(d=0;d<k.length;d++)f=k[d],"colorspace_settings_name"in f||(f.colorspace_settings_name="sRGB",b("image",f,"colorspace_settings_name"));e=a.materials;for(d=0;d<e.length;d++){h=e[d];"ALPHA_ANTIALIASING"==h.game_settings.alpha_blend&&(h.game_settings.alpha_blend="CLIP");"use_tangent_shading"in h||(h.use_tangent_shading=
!1,b("material",h,"use_tangent_shading"));"b4w_node_mat_type"in h&&x("material",h,"b4w_node_mat_type");"b4w_skydome"in h&&x("material",h,"b4w_skydome");"b4w_procedural_skydome"in h&&x("material",h,"b4w_procedural_skydome");"b4w_lens_flares"in h||(h.b4w_lens_flares=!1,b("material",h,"b4w_lens_flares"));"LENS_FLARES"===h.name&&(h.b4w_lens_flares||n.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),h.b4w_lens_flares=!0);h.b4w_water&&("b4w_water_shore_smoothing"in
h||(h.b4w_water_shore_smoothing=!1,b("material",h,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in h||(h.b4w_water_dynamic=!1,b("material",h,"b4w_water_dynamic")),"b4w_waves_height"in h||(h.b4w_waves_height=1,b("material",h,"b4w_waves_height")),"b4w_waves_length"in h||(h.b4w_waves_length=1,b("material",h,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in h||(h.b4w_water_dst_noise_scale0=.05,b("material",h,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in h||(h.b4w_water_dst_noise_scale1=
.03,b("material",h,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in h||(h.b4w_water_dst_noise_freq0=1.3,b("material",h,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in h||(h.b4w_water_dst_noise_freq1=1,b("material",h,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in h||(h.b4w_water_dir_min_shore_fac=.4,b("material",h,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in h||(h.b4w_water_dir_freq=.5,b("material",h,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
h||(h.b4w_water_dir_noise_scale=.05,b("material",h,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in h||(h.b4w_water_dir_noise_freq=.07,b("material",h,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in h||(h.b4w_water_dir_min_noise_fac=.5,b("material",h,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in h||(h.b4w_water_dst_min_fac=.2,b("material",h,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in h||(h.b4w_water_waves_hor_fac=5,b("material",h,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in h||(h.b4w_water_absorb_factor=6,b("material",h,"b4w_water_absorb_factor")),"b4w_water_fog_color"in h||(h.b4w_water_fog_color=[.5,.7,.7],b("material",h,"b4w_water_fog_color")),"b4w_foam_factor"in h||(h.b4w_foam_factor=5,b("material",h,"b4w_foam_factor")),"b4w_generated_mesh"in h||(h.b4w_generated_mesh=!1,b("material",h,"b4w_generated_mesh")),"b4w_water_num_cascads"in h||(h.b4w_water_num_cascads=5,b("material",h,"b4w_water_num_cascads")),"b4w_water_subdivs"in h||(h.b4w_water_subdivs=
64,b("material",h,"b4w_water_subdivs")),"b4w_water_detailed_dist"in h||(h.b4w_water_detailed_dist=1E3,b("material",h,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in h||(h.b4w_water_enable_caust=!1,b("material",h,"b4w_water_enable_caust")),"b4w_water_caust_scale"in h||(h.b4w_water_caust_scale=.25,b("material",h,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in h||(h.b4w_water_caust_brightness=.5,b("material",h,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in h||(h.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in h||(h.b4w_dynamic_grass_color="");"diffuse_intensity"in h||(h.diffuse_intensity=1,b("material",h,"diffuse_intensity"));"b4w_use_ghost"in h||(h.b4w_use_ghost=!1);"b4w_collision_margin"in h||(h.b4w_collision_margin=.04,b("material",h,"b4w_collision_margin"));"b4w_collision_group"in h||(h.b4w_collision_group=128,b("material",h,"b4w_collision_group"));"b4w_collision_mask"in h||(h.b4w_collision_mask=127,b("material",h,"b4w_collision_mask"));"b4w_do_not_render"in h||(h.b4w_do_not_render=
!1,b("material",h,"b4w_do_not_render"));"HALO"!=h.type||"b4w_halo_sky_stars"in h||(h.b4w_halo_sky_stars=!1,b("material",h,"b4w_halo_sky_stars"));"HALO"!=h.type||"b4w_halo_stars_blend_height"in h||(h.b4w_halo_stars_blend_height=10,b("material",h,"b4w_halo_stars_blend_height"));"HALO"!=h.type||"b4w_halo_stars_min_height"in h||(h.b4w_halo_stars_min_height=0,b("material",h,"b4w_halo_stars_min_height"));"specular_shader"in h||(h.specular_shader="COOKTORR",b("material",h,"specular_shader"));"diffuse_shader"in
h||(h.diffuse_shader="LAMBERT",b("material",h,"diffuse_shader"));"roughness"in h||(h.roughness=.5,b("material",h,"roughness"));"diffuse_fresnel"in h||(h.diffuse_fresnel=.1,b("material",h,"diffuse_fresnel"));"diffuse_fresnel_factor"in h||(h.diffuse_fresnel_factor=.5,b("material",h,"diffuse_fresnel_factor"));"specular_slope"in h||(h.specular_slope=.2,b("material",h,"specular_slope"));"specular_toon_size"in h||(h.specular_toon_size=.5,b("material",h,"specular_toon_size"));"specular_toon_smooth"in h||
(h.specular_toon_smooth=.1,b("material",h,"specular_toon_smooth"));"specular_alpha"in h||(h.specular_alpha=1,b("material",h,"specular_alpha"));"b4w_wettable"in h||(h.b4w_wettable=!1,b("material",h,"b4w_wettable"));"b4w_refractive"in h||(h.b4w_refractive=!1,b("material",h,"b4w_refractive"));"b4w_refr_bump"in h||(h.b4w_refr_bump=0,b("material",h,"b4w_refr_bump"));"b4w_shallow_water_col"in h||(h.b4w_shallow_water_col=[0,.8,.3],b("material",h,"b4w_shallow_water_col"));"b4w_shore_water_col"in h||(h.b4w_shore_water_col=
[0,.9,.2],b("material",h,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in h||(h.b4w_shallow_water_col_fac=1,b("material",h,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in h||(h.b4w_shore_water_col_fac=.5,b("material",h,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in h||(h.b4w_water_sss_strength=5.9,b("material",h,"b4w_water_sss_strength"));"b4w_water_sss_width"in h||(h.b4w_water_sss_width=.45,b("material",h,"b4w_water_sss_width"));"b4w_render_above_all"in h||(h.b4w_render_above_all=
!1,b("material",h,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in h||(h.b4w_water_norm_uv_velocity=.05,b("material",h,"b4w_water_norm_uv_velocity"));"specular_ior"in h||(h.specular_ior=1,b("material",h,"specular_ior"));"darkness"in h||(h.darkness=0,b("material",h,"darkness"));"diffuse_toon_size"in h||(h.diffuse_toon_size=0,b("material",h,"diffuse_toon_size"));"diffuse_toon_smooth"in h||(h.diffuse_toon_smooth=0,b("material",h,"diffuse_toon_smooth"));"pass_index"in h||(h.pass_index=0,b("material",
h,"pass_index"));f=h.texture_slots;for(k=0;k<f.length;k++)g=f[k],"blend_type"in g||(g.blend_type="MIX",b("texture_slot",g,"blend_type"));if(h.node_tree){f=h.node_tree.nodes;for(k=0;k<f.length;k++)l(f[k]);h.node_tree.animation_data&&c(h.node_tree.animation_data)}}g=a.node_groups;for(d=0;d<g.length;d++)for(f=g[d].node_tree.nodes,k=0;k<f.length;k++)l(f[k]);f=a.objects;for(d=0;d<f.length;d++){g=f[d];switch(g.type){case "MESH":"b4w_dynamic_geometry"in g||(g.b4w_dynamic_geometry=!1);"b4w_reflexible"in g||
(g.b4w_reflexible=!1);"b4w_reflexible_only"in g||(g.b4w_reflexible_only=!1);"b4w_reflective"in g||(g.b4w_reflective=!1);"b4w_reflection_type"in g||(g.b4w_reflection_type="PLANE",b("object",g,"b4w_reflection_type"));"b4w_wind_bending"in g||(g.b4w_wind_bending=!1,b("object",g,"b4w_wind_bending"));"b4w_wind_bending_angle"in g||(g.b4w_wind_bending_angle=10,g.b4w_wind_bending_freq=.25,b("object",g,"wind bending params"));"b4w_detail_bending_amp"in g||(g.b4w_detail_bending_amp=.1,g.b4w_branch_bending_amp=
.3,b("object",g,"detail bending params"));"b4w_detail_bending_freq"in g||(g.b4w_detail_bending_freq=1,b("object",g,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in g||(g.b4w_main_bend_stiffness_col="",b("object",g,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in g||(g.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",g,"b4w_detail_bend_colors"));"b4w_caustics"in g||(g.b4w_caustics=!1);"vertex_groups"in g&&g.vertex_groups.length&&
g.data&&0==g.data.vertex_groups.length&&(g.data.vertex_groups=g.vertex_groups,delete g.vertex_groups,b("object",g,"vertex_groups"));"b4w_vertex_anim"in g&&g.b4w_vertex_anim.length&&g.data&&0==g.data.b4w_vertex_anim.length&&(g.data.b4w_vertex_anim=g.b4w_vertex_anim,delete g.b4w_vertex_anim,b("object",g,"b4w_vertex_anim"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1);"b4w_hidden_on_load"in g||(g.b4w_hidden_on_load=!1);"use_ghost"in g.game||(g.game.use_ghost=!1);"use_sleep"in g.game||(g.game.use_sleep=
!1);"velocity_min"in g.game||(g.game.velocity_min=0);"velocity_max"in g.game||(g.game.velocity_max=0);"collision_group"in g.game||(g.game.collision_group=1);"collision_mask"in g.game||(g.game.collision_mask=255);k=g;e=k.game;h=e.collision_bounds_type;e.use_collision_bounds&&"BOX"!=h&&"CYLINDER"!=h&&"CONE"!=h&&"SPHERE"!=h&&"CAPSULE"!=h&&"EMPTY"!=h&&(n.error("Wrong collision bounds type "+h+". Disable physics for object "+k.name),k.b4w_collision=!1,k.b4w_floating=!1,k.b4w_vehicle=!1,k.b4w_character=
!1);"b4w_vehicle_settings"in g?g.b4w_vehicle_settings&&("steering_ratio"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_ratio=10),"steering_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_max=1),"inverse_control"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.inverse_control=!1),"force_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.force_max=1500),"brake_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.brake_max=100),"speed_ratio"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.water_rot_damp=.9)):(g.b4w_vehicle_settings=null,b("object",g,"b4w_vehicle_settings"));"b4w_floating_settings"in g?g.b4w_floating_settings&&("floating_factor"in g.b4w_floating_settings||(g.b4w_floating_settings.floating_factor=3),"water_lin_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_rot_damp=
.8)):(g.b4w_floating_settings=null,b("object",g,"b4w_floating_settings"));"b4w_character_settings"in g?g.b4w_character_settings&&("walk_speed"in g.b4w_character_settings||(g.b4w_character_settings.walk_speed=4),"run_speed"in g.b4w_character_settings||(g.b4w_character_settings.run_speed=8),"step_height"in g.b4w_character_settings||(g.b4w_character_settings.step_height=.25),"jump_strength"in g.b4w_character_settings||(g.b4w_character_settings.jump_strength=5),"waterline"in g.b4w_character_settings||
(g.b4w_character_settings.waterline=0)):(g.b4w_character_settings=null,b("object",g,"b4w_character_settings"));"b4w_selectable"in g||(g.b4w_selectable=!1,b("object",g,"b4w_selectable"));"b4w_outlining"in g||(g.b4w_outlining=!1,b("object",g,"b4w_outlining"));"b4w_outline_on_select"in g||(g.b4w_outline_on_select=!1,b("object",g,"b4w_outline_on_select"));"b4w_billboard"in g||(g.b4w_billboard=!1,b("object",g,"b4w_billboard"));"b4w_billboard_geometry"in g||(g.b4w_billboard_geometry="SPHERICAL",b("object",
g,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in g||(g.b4w_pres_glob_orientation=!1,b("object",g,"b4w_pres_glob_orientation"));"b4w_outline_settings"in g||("b4w_glow_settings"in g?g.b4w_outline_settings=g.b4w_glow_settings:(g.b4w_outline_settings={},g.b4w_outline_settings.outline_duration=1,g.b4w_outline_settings.outline_period=1,g.b4w_outline_settings.outline_relapses=0),b("object",g,"b4w_outline_settings"));"b4w_lod_transition"in g||(g.b4w_lod_transition=.01,b("object",g,"b4w_lod_transition"));
"lod_levels"in g||(g.lod_levels=[],b("object",g,"lod_levels"));"b4w_animation_mixing"in g||(g.b4w_animation_mixing=!1,b("object",g,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in g||(g.b4w_anchor=null,b("object",g,"b4w_anchor")),!g.b4w_anchor||"max_width"in g.b4w_anchor||(g.b4w_anchor.max_width=250)}"collision_margin"in g.game||(g.game.collision_margin=.04,b("object",g,"collision_margin"));"b4w_anim_behavior"in g||(g.b4w_anim_behavior=g.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
g,"b4w_anim_behavior"));if(!("rotation_quaternion"in g)){k=[0,0,0,1];u.Wj(g.rotation_euler,k);var e=k,h=k[0],m=k[1],p=k[2];e[0]=k[3];e[1]=h;e[2]=m;e[3]=p;g.rotation_quaternion=k;b("object",g,"rotation_quaternion")}"webgl_do_not_batch"in g&&(g.b4w_do_not_batch=g.webgl_do_not_batch)&&x("object",g,"webgl_do_not_batch");"b4w_shadow_cast_only"in g||(g.b4w_shadow_cast_only=!1,b("object",g,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in g||(g.b4w_correct_bounding_offset="AUTO",b("object",g,"b4w_correct_bounding_offset"));
e=g.particle_systems;for(k=0;k<e.length;k++)h=e[k],m=h.settings,"use_rotation_dupli"in m||(m.use_rotation_dupli=!1,b("particle_settings",m,"use_rotation_dupli")),"use_whole_group"in m||(m.use_whole_group=!1,b("particle_settings",m,"use_whole_group")),h.transforms||(h.transforms=new Float32Array,b("particle_system",h,"transforms")),"b4w_billboard_align"in m||(m.b4w_billboard_align="VIEW",b("particle_settings",m,"b4w_billboard_align")),"b4w_dynamic_grass"in m||(m.b4w_dynamic_grass=!1,b("object",m,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in m||(m.b4w_dynamic_grass_scale_threshold=.01,b("object",m,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in m||(m.b4w_initial_rand_rotation=!1,b("particle_settings",m,"b4w_initial_rand_rotation")),"b4w_rotation_type"in m||(m.b4w_rotation_type="Z",b("particle_settings",m,"b4w_rotation_type")),"b4w_rand_rotation_strength"in m||(m.b4w_rand_rotation_strength=1,b("particle_settings",m,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in m||(m.b4w_hair_billboard=
!1,b("particle_settings",m,"b4w_hair_billboard")),"b4w_hair_billboard_type"in m||(m.b4w_hair_billboard_type="BASIC",b("particle_settings",m,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in m||(m.b4w_hair_billboard_jitter_amp=0,b("particle_settings",m,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in m||(m.b4w_hair_billboard_jitter_freq=0,b("particle_settings",m,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in m||(m.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",m,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in m||(m.b4w_wind_bend_inheritance="PARENT",b("particle_settings",m,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in m||(m.b4w_shadow_inheritance="PARENT",b("particle_settings",m,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in m||(m.b4w_reflection_inheritance="PARENT",b("particle_settings",m,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in m||(m.b4w_vcol_from_name="",b("particle_settings",m,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in m||(m.b4w_vcol_to_name="",b("particle_settings",m,"b4w_vcol_to_name")),"b4w_coordinate_system"in m||(m.b4w_coordinate_system="LOCAL",b("particle_settings",m,"b4w_coordinate_system")),"b4w_allow_nla"in m||(m.b4w_allow_nla=!0,b("particle_settings",m,"b4w_allow_nla")),"b4w_enable_soft_particles"in m||(m.b4w_enable_soft_particles=!1,b("particle_settings",m,"b4w_enable_soft_particles")),"b4w_particles_softness"in m||(m.b4w_particles_softness=1,b("particle_settings",m,"b4w_particles_softness")),
"billboard_tilt"in m||(m.billboard_tilt=0,b("particle_settings",m,"billboard_tilt")),"billboard_tilt_random"in m||(m.billboard_tilt_random=0,b("particle_settings",m,"billboard_tilt_random")),"use_rotations"in m||(m.use_rotations=!1,b("particle_settings",m,"use_rotations"));"constraints"in g||(g.constraints=[],b("object",g,"constraints"));e=g.modifiers;for(k=0;k<e.length;k++){a:{h=e[k];switch(h.type){case "ARRAY":if(!("fit_type"in h)){n.error("WARNING Incomplete modifier "+String(h.type)+' for "'+
g.name+'", reexport "'+a.b4w_filepath_blend+'" scene');h=!1;break a}}h=!0}h||(e.splice(k,1),k--)}"animation_data"in g||(g.animation_data={action:null,nla_tracks:[]},b("object",g,"animation_data"));g.animation_data&&("action"in g.animation_data||(g.animation_data.action=null,q("no action in animation data "+g.name)),"nla_tracks"in g.animation_data||(g.animation_data.nla_tracks=[],q("no NLA in animation data "+g.name)),c(g.animation_data));"b4w_collision_id"in g||(g.b4w_collision_id="",b("object",g,
"b4w_collision_id"));"b4w_viewport_alignment"in g||(g.b4w_viewport_alignment=null,b("object",g,"b4w_viewport_alignment"));"pinverse_tsr"in g||(g.pinverse_tsr=null,b("object",g,"pinverse_tsr"));"b4w_cluster_data"in g||(g.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",g,"b4w_cluster_data"));"pass_index"in g||(g.pass_index=0,b("object",g,"pass_index"));(0>g.scale[0]||0>g.scale[1]||0>g.scale[2])&&q('negative scale for object "'+g.name+'", can lead to some errors');k=
g.scale;0==k[0]&&0==k[1]&&0==k[2]?k=!0:(e=Math.abs((k[1]-k[2])/k[1]),k=.005>Math.abs((k[0]-k[1])/k[0])&&.005>e);k||q("non-uniform scale for object "+g.name)}for(var z in D)d=D[z],k=z.match(/.*?(?=>>|$)/i)[0],n.warn('Property "'+String(k)+'" is '+d.BL+' for "'+d.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.eS=function(a,b){"num_channels"in a||(a.num_channels=1,q('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.hR=function(a){var b;a:{b=
a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=A(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var f=a[c];switch(f.type){case "ARRAY":for(var d=b,l=f,g=0,n=0,m=0,q=new Float32Array(16),f=[],x=1;x<l.count;x++){l.use_constant_offset&&(g+=l.constant_offset_displace[0],n+=l.constant_offset_displace[1],m+=l.constant_offset_displace[2]);if(l.use_relative_offset)var G=d.b4w_bounding_box,g=g+(G.max_x-G.min_x)*l.relative_offset_displace[0],
n=n+(G.max_y-G.min_y)*l.relative_offset_displace[1],m=m+(G.max_z-G.min_z)*l.relative_offset_displace[2];u.g_(g,n,m,q);for(var D=G=A(d),F=q,K=y.fromMat4(F,R),K=k.fromMat3(K,E),H=0;H<D.submeshes.length;H++){var J=D.submeshes[H];u.wo(J.position,F,J.position,0);u.sL(J.tbn_quat,K,J.tbn_quat,0)}f.push(G)}for(x=0;x<f.length;x++)for(l=d,g=f[x],n=0;n<l.submeshes.length;n++){m=l.submeshes[n];q=g.submeshes[n];G=m.base_length;D=m.indices.length;m.base_length+=q.base_length;for(var W in m)if("base_length"!=W&&
"boundings"!=W)if("indices"==W)for(m[W]=u.n_(m[W],q[W]),F=D;F<m.indices.length;F++)m.indices[F]+=G;else"vertex_colors"!=W&&(m[W]=u.LU(m[W],q[W]))}break;case "CURVE":for(d=b,x=z.mT(f.object),l=new Float32Array(16),n=x.ek?4:3,g=new Float32Array(n),n=new Float32Array(n),m=new Float32Array(3),q=new Float32Array(4),G=new Float32Array(4),D=new Float32Array(3),F=new Float32Array(3),K=new Float32Array(3),new Float32Array(4),new Float32Array(4),H=0;H<d.submeshes.length;H++){var O=d.submeshes[H],J=O.position,
O=O.tbn_quat,V;a:{V=f.deform_axis;switch(V){case "POS_X":case "NEG_X":V=0;break a;case "POS_Y":case "NEG_Y":V=1;break a;case "POS_Z":case "NEG_Z":V=2;break a;default:u.q("Wrong deform axis value "+V)}V=void 0}D[0]=0;D[1]=0;D[2]=0;D[V]=1;for(var ga=z.MZ(x),v=0;v<J.length/3;v++){K[0]=J[3*v];K[1]=J[3*v+1];K[2]=J[3*v+2];var ba=K[V],ea=z.LZ(x,ba);z.NZ(x,ea,g);m[0]=g[0];m[1]=g[1];m[2]=g[2];z.KZ(x,ea,n);F[0]=n[0];F[1]=0;F[2]=n[2];e.normalize(F,F);k.rotationTo(D,F,q);0>ba?(g[0]=F[0],g[1]=F[1],g[2]=F[2],e.scale(g,
ba,g),e.add(m,g,m)):ba>ga&&(g[0]=F[0],g[1]=F[1],g[2]=F[2],e.scale(g,ba-ga,g),e.add(m,g,m));p.fromRotationTranslation(q,m,l);x.ek&&(k.setAxisAngle(D,g[3],G),e.transformQuat(K,G,K));K[V]=0;e.transformMat4(K,l,K);J[3*v]=K[0];J[3*v+1]=K[1];J[3*v+2]=K[2];O.length&&(E[0]=O[4*v],E[1]=O[4*v+1],E[2]=O[4*v+2],E[3]=O[4*v+3],k.multiply(E,q,E),O[4*v]=E[0],O[4*v+1]=E[1],O[4*v+2]=E[2],O[4*v+3]=E[3])}}}h.bY(b)}return b};a.bT=function(){return{name:"DEFAULT",uuid:u.UA(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,
.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.pR=function(a,b){function c(b,d){for(var e in b){var f=b[e],h=f[0];if(1<f.length)for(var k=1;k<f.length;k++)h+="*"+f[k];for(k=0;k<a.length;k++)if(f=a[k],f.name==h)for(var g in d)f[g]=d[g]}}for(var d=b.b4w_logic_nodes,e=0;e<d.length;e++)for(var h=d[e],g=0;g<h.length;g++){var k=h[g],l={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in l)n in k&&(k[l[n]]=k[n]);for(var m in k.variables)"boolean"!=
typeof k.variables[m][0]&&(k.variables[m]=[!1,k.variables[m]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(k.type)&&("variable1"in k&&(k.variables.v1=[!1,k.variable1]),"variable2"in k&&(k.variables.v2=[!1,k.variable2]),"variabled"in k&&(k.variables.vd=[!1,k.variabled]));switch(k.type){case "SELECT":for(var p=0;p<a.length;p++)l=a[p],l.name==k.object&&(l.b4w_selectable=!0);k.bools||(k.bools={});k.bools.not_wait||(k.bools.not_wait=!1);q('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(k.objects_paths,
{b4w_selectable:!0});if(k.links instanceof Array){q('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var l={},u=0;for(p in k.objects_paths)l[p]=k.links[u],u++;k.links=l}break;case "SELECT_PLAY":q('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');k.mute=!0;break;case "SELECT_PLAY_ANIM":q('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(k.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(k.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(k.objects_paths,{b4w_do_not_batch:!0});switch(k.common_usage_names.space_type){case "WORLD":k.common_usage_names.space_type=K.qP;break;case "PARENT":k.common_usage_names.space_type=K.pP;break;case "LOCAL":k.common_usage_names.space_type=K.oP}break;case "OUTLINE":c(k.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":k.condition&&(k.common_usage_names.condition=
k.condition);if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=K.VE;break;case "LEQUAL":k.common_usage_names.condition=K.XE;break;case "GREATER":k.common_usage_names.condition=K.WE;break;case "LESS":k.common_usage_names.condition=K.YE;break;case "NOTEQUAL":k.common_usage_names.condition=K.ZE;break;case "EQUAL":k.common_usage_names.condition=K.UE}void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&
(k.input2=k.number2);k.bools||(k.bools={});void 0===k.bools.str&&(k.bools.str=!1,k.floats.inp1=k.input1,k.floats.inp2=k.input2);break;case "SEND_REQ":k.bools||(k.bools={});k.strings||(k.strings={});void 0===k.bools.ct&&(k.bools.ct=!1);void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "MATH":void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&(k.input2=k.number2);void 0!=k.input1&&(k.floats.inp1=k.input1);void 0!=k.input2&&(k.floats.inp2=k.input2);break;case "REGSTORE":k.floats||
(k.floats={});k.strings||(k.strings={});void 0!=k.number1&&(k.input1=k.number1);if(void 0!=k.input1)switch(typeof k.input1){case "number":k.floats.inp1=k.input1;k.common_usage_names.variable_type="NUMBER";break;default:k.strings.inp1=k.input1,k.common_usage_names.variable_type="STRING"}switch(k.common_usage_names.variable_type){case "NUMBER":k.common_usage_names.variable_type=K.rP;break;case "STRING":k.common_usage_names.variable_type=K.sP}break;case "PAGEPARAM":k.bools||(k.bools={});void 0===k.bools.hsh&&
(k.bools.hsh=!1);k.floats||(k.floats={});void 0===k.floats.ptp&&(k.floats.ptp=0);break;case "PLAY_ANIM":c(k.objects_paths,{b4w_do_not_batch:!0});k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);(l=k.common_usage_names.param_anim_behavior)||(l="FINISH_STOP");k.common_usage_names.param_anim_behavior=F.pz(l);break;case "STOP_ANIM":k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);break;case "STRING":switch(k.common_usage_names.string_operation){case "JOIN":k.common_usage_names.string_operation=
K.lP;break;case "FIND":k.common_usage_names.string_operation=K.kP;break;case "REPLACE":k.common_usage_names.string_operation=K.mP;break;case "SPLIT":k.common_usage_names.string_operation=K.nP;break;case "COMPARE":k.common_usage_names.string_operation=K.jP}if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=K.VE;break;case "LEQUAL":k.common_usage_names.condition=K.XE;break;case "GREATER":k.common_usage_names.condition=
K.WE;break;case "LESS":k.common_usage_names.condition=K.YE;break;case "NOTEQUAL":k.common_usage_names.condition=K.ZE;break;case "EQUAL":k.common_usage_names.condition=K.UE}break;case "REDIRECT":void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "SET_CAMERA_MOVE_STYLE":switch(k.common_usage_names.camera_move_style){case "STATIC":k.common_usage_names.camera_move_style=K.cP;break;case "TARGET":k.common_usage_names.camera_move_style=K.dP;break;case "EYE":k.common_usage_names.camera_move_style=
K.aP;break;case "HOVER":k.common_usage_names.camera_move_style=K.bP}break;case "ENTRYPOINT":k.bools||(k.bools={});void 0===k.bools.js&&(k.bools.js=!1);k.bools.js&&(k.mute=!0);break;case "JS_CALLBACK":for(n in k=k.common_usage_names.js_cb_params,k)switch(k[n]){case "OBJECT":k[n]=K.eP;break;case "VARIABLE":k[n]=K.fP}}}}};b4w.module.__logic_nodes=function(a,m){function l(){return function(a,b,d,c){d=c[0];var e=c[1];c=c[2];if(-2==d.state){for(var f=0;f<d.Fw;f++)if(E.Ff(a,b,f))for(var h=0;h<d.Ew.length;h++)if(d.Ew[h]==f){e.um==d.mN?(K.Wi(e.ra)&&(d.state=-1),c.Of.Gf||(d.state=1,d.zs=d.Mv[h])):(d.state=1,d.zs=d.Mv[h]);return}d.state=0}}}function c(){return function(a,b,d,c){d=c[0];var e=c[1];c=c[2];for(var f=0;f<d.Fw;f++)if(E.Ff(a,b,f)&&f==d.ML){if(K.Wi(e.ra)&&e.um==d.mN)d.state=-1;else if(!c.Of.Gf||d.S.no_wait)d.state=
1;return}d.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,zs:a.slot_idx_jump,va:a.frame_range[0],Za:a.frame_range[1],QU:a.frame_range_mask?a.frame_range_mask[0]:!0,PU:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Fw:-1,ML:-1,FX:a.param_name,DX:a.operation,ec:a.mute,Rq:a.object,ea:null,kc:null,uc:null,eb:{},Uf:a.anim_name,Ac:u.il,HX:a.parse_json_vars,GX:a.parse_json_paths,Lc:a.objects_paths,PK:a.nodes_paths,Hb:a.floats,S:a.bools,U:a.variables,pj:a.strings,
TB:a.materials_names,zM:a.shader_nd_type,xe:a.common_usage_names,pU:a.encode_json_vars,oU:a.encode_json_paths,mN:b,lL:O[a.type]?O[a.type]:h,vw:!1,mx:0,Ew:null,VW:a.links,Mv:[]}}function x(a,b,d){return a[0]?b[a[1]]:d[a[1]]}function q(a,b,d,c){a[0]?b[a[1]]=c:d[a[1]]=c}function A(a,b,d){switch(b.state){case 2:d.ma=a.Oa}}function h(a,b,d){switch(b.state){case 1:J.error("Unknown node type: "+a.type);break;case 2:d.ma=a.Oa}}function z(a){return F.wc(F.Pc,a.Rq||[],0)}function p(a,d){var c=a.b4w_logic_nodes,
e=d.le;d.state=1;for(var f=0;f<c.length;f++){var h={Y:[],Of:{yb:a,ma:0,Gf:!1,SD:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(h);for(var k=e[e.length-1],g=c[f],l=0;l<g.length;l++){var n=b(g[l],k);k.Y.push(n)}for(g=0;g<k.Y.length;g++)n=k.Y[g],n.ec||n.lL(n,d,h.Of,0,0)}var c=a.timeline_markers,m;for(m in c)d.As.push(c[m]);d.As.sort(function(a,b){return a-b});d.state=2;V.push(d)}function n(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function k(a){switch(typeof a){case "string":return n(a,1);case "number":return n(a,0);default:return n(a,1)}}var u=m("__animation"),e=m("__assets"),y=m("__camera"),K=m("__nla"),F=m("__objects"),J=m("__print"),D=m("__scenes"),R=m("__config"),E=m("__controls"),I=m("__batch"),B=m("__geometry"),P=m("__mat3"),d=m("__mat4"),f=m("__physics"),r=m("__quat"),g=m("__sfx"),Q=m("__time"),t=m("__transform"),aa=m("__tsr"),M=m("__util"),G=m("__vec3"),T=new Float32Array(4);new Float32Array(4);var S=new Float32Array(3),
X=new Float32Array(3),H=new Float32Array(2),ma=new Float32Array(9),W=new Float32Array(16);a.rP=0;a.sP=1;a.lP=0;a.kP=1;a.mP=2;a.nP=3;a.jP=4;a.VE=0;a.XE=1;a.WE=2;a.YE=3;a.ZE=4;a.UE=5;a.qP=0;a.pP=1;a.oP=2;a.cP=0;a.dP=1;a.aP=2;a.bP=3;a.eP=0;a.fP=1;var O={ENTRYPOINT:function(a,b,d){switch(b.state){case 2:d.ma=a.Oa}},HIDE:function(a,b,d){switch(b.state){case 1:a.ea=z(a);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:D.lq(a.ea,!0),d.ma=a.Oa}},SHOW:function(a,
b,d){switch(b.state){case 1:a.ea=z(a);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:D.lq(a.ea,!1),d.ma=a.Oa}},PAGEPARAM:function(a,b,d){switch(b.state){case 2:var c=a.U.vd;b=b.u;var e=d.u,f;a:{f=a.FX;var h=a.Hb.ptp,k=a.S.hsh,g=R.get("url_params");if(g&&f in g)f=Number(g[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),g=0;g<k.length;g++){var l=k[g].split("=");if(1<l.length&&l[0]==f){f=n(l[1],h);break a}}f=0}}q(c,b,e,f);d.ma=a.Oa}},
SWITCH_SELECT:function(a,b,d){switch(b.state){case 1:a:{d=b.le[d.SD];var c=F.oJ();a.Ew=[];a.Mv=[];for(var e in a.Lc){var f=F.wc(F.Pc,a.Lc[e],0),h=c.indexOf(f);if(-1==h){J.error("logic script error: non-selectable object:",a.Lc[e][a.Lc[e].length-1]);break a}a.Ew.push(h);a.Mv.push(a.VW[e])}a.state=-1;a.Fw=c.length;e=[];for(h=0;h<c.length;h++)e.push(E.mu(c[h],!1));E.T(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,E.Ne,e,E.vu,l(),[a,b,d])}break;case 2:if(-1==a.state){b=b.le[d.SD].Y;for(f=0;f<b.length;f++)c=
b[f],"SWITCH_SELECT"==c.type&&(c.state=-1);a.state=-2}if(0==a.state||1==a.state)d.ma=a.state?a.zs:a.Oa,a.state=-1}},SELECT:function(a,b,d){switch(b.state){case 1:d=b.le[d.SD];var e=z(a),f=F.oJ(),h=f.indexOf(e);if(-1==h)J.error("logic script error: non-selectable object:",a.Rq[a.Rq.length-1]);else{a.state=-1;a.Fw=f.length;a.ML=h;for(var h=[],k=0;k<f.length;k++)h.push(E.mu(f[k],!1));E.T(e,"LOGIC_NODES_SELECT_"+a.label,E.Ne,h,E.vu,c(),[a,b,d])}break;case 2:if(0==a.state||1==a.state){d.ma=a.state?a.zs:
a.Oa;a.state=-1;break}a.S.not_wait&&(d.ma=a.Oa)}},PLAY:function(a,b,d,c){switch(b.state){case 1:K.VM();a.state=-1;a.S.not_wait||(a.S.not_wait=!1);break;case 2:switch(a.state){case -1:if(K.Wi(b.ra))if(b.uA==b.um&&d.Gf)break;else{var e=b.um;if(e){e.Of.ma=e.Y[e.Of.ma].Oa;e.Y[e.Of.ma].state=-1;for(var e=b.um.Y,f=0;f<e.length;f++){var h=e[f];"PLAY"==h.type&&(h.state=-1)}}}d.Gf=!a.S.not_wait;b.um=b.uA;a.state=0;a.QU&&(K.bZ(a.va),K.hM(c));if(a.PU)K.mD(a.Za);else{c=K.kr(c);var e=-1,k;for(k in b.As)if(c<b.As[k]){e=
k;break}0<=e?K.mD(b.As[e]):K.mD(K.UI())}K.RX();a.S.not_wait&&(d.ma=a.Oa,a.state=-1,d.Gf=!1);break;case 0:K.Wi()||(d.ma=a.Oa,a.state=-1,d.Gf=!1);break;case 1:d.ma=a.Oa;a.state=-1;b.um=null;d.Gf=!1;break;default:M.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,d){switch(b.state){case 2:window.location.href=a.S.url?n(x(a.U.url,b.u,d.u),1):a.pj.url,b.state=3}},MATH:function(a,b,d){switch(b.state){case 2:var c=-1==a.U.v1[1]?a.Hb.inp1:n(x(a.U.v1,b.u,d.u),0),e=-1==a.U.v2[1]?a.Hb.inp2:
n(x(a.U.v2,b.u,d.u),0),f=0;switch(a.DX){case "ADD":f=c+e;break;case "MUL":f=c*e;break;case "SUB":f=c-e;break;case "DIV":0==e&&M.q("Division by zero in Logic script");f=c/e;break;case "RAND":f=Math.random()*(e-c)+c}q(a.U.vd,b.u,d.u,f);d.ma=a.Oa}},CONDJUMP:function(a,b,d){switch(b.state){case 2:var c=a.S.str?1:0,e=a.S.str?a.pj:a.Hb,f=-1==a.U.v1[1]?e.inp1:n(x(a.U.v1,b.u,d.u),c);b=-1==a.U.v2[1]?e.inp2:n(x(a.U.v2,b.u,d.u),c);c=!1;switch(a.xe.condition){case 5:f==b&&(c=!0);break;case 4:f!=b&&(c=!0);break;
case 3:f<b&&(c=!0);break;case 2:f>b&&(c=!0);break;case 1:f<=b&&(c=!0);break;case 0:f>=b&&(c=!0)}d.ma=c?a.zs:a.Oa}},REGSTORE:function(a,b,d){switch(b.state){case 2:q([a.S.gl||a.U.vd[0],a.U.vd[1]],b.u,d.u,(1==a.xe.variable_type?a.pj:a.Hb).inp1),d.ma=a.Oa}},PLAY_ANIM:function(a,b,d){switch(b.state){case 1:a.ea=a.S.env?F.av(a.Rq[0],0):z(a);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:switch(0!=a.state||u.Wi(a.ea,a.Ac)||(a.state=1),a.state){case -1:for(var c in b.le){var e=
b.le[c].Of.ma;-1!=e&&(e=b.le[c].Y[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.ea==a.ea&&(e.state=1))}b=a.xe.param_anim_behavior;if(""==a.Uf)u.Qt(a.ea),u.ts(a.ea,b,u.il);else{a:{c=a.ea;for(var e=a.Uf,f=-1,h=0;8>h;h++){var k=c.ia[h];if(k&&k.Ai&&u.YM(k.Ai)==u.YM(e))if(-1!=f)f=h;else{c=-1;break a}}c=f}-1==c?(a.Ac=u.vZ(a.ea,a.Uf),u.apply(a.ea,null,a.Uf,a.Ac)):a.Ac=c;u.ts(a.ea,b,a.Ac)}a.S.not_wait||(d.Gf=!0);u.play(a.ea,null,a.Ac);a.state=0;a.S.not_wait&&(d.ma=a.Oa,a.state=-1);break;case 0:break;case 1:a.S.not_wait||
(d.Gf=!1);d.ma=a.Oa;a.state=-1;break;default:M.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:A,SEND_REQ:function(a,b,d){function c(a,e,f,h,k){a=JSON.stringify(a);q(k[0].U.dst,b.u,d.u,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var f=a.S.url?n(x(a.U.url,b.u,d.u),1):a.pj.url,h={};a.S.ct&&(h["Content-Type"]=a.pj.ct);"GET"==a.xe.request_type?e.Vd([{id:f,type:e.dn,url:f,uk:h,Jb:[a,d.u]}],c,null,null,null):"POST"==a.xe.request_type&&e.Vd([{id:f,type:e.dn,url:f,uk:h,
bi:"POST",xo:e.dn,Dm:n(x(a.U.dst1,b.u,d.u),1),Jb:[a,d.u]}],c,null,null,null);break;case 1:a.state=-1,d.ma=a.Oa}}},INHERIT_MAT:function(a,b,d){switch(b.state){case 1:for(b=0;2>b;b++)a.eb["id"+b]=F.wc(F.Pc,a.Lc["id"+b],0),a.eb["id"+b]||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:I.eW(a.eb.id0,a.TB.id0,a.eb.id1,a.TB.id1),d.ma=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,d){switch(b.state){case 1:a.Lc.id0&&(a.eb.id0=F.wc(F.Pc,a.Lc.id0,0),a.Lc.id0||(J.error("Logic script error: object not found. Node: ",
a.name),a.ec=!0),a.PK.id0.unshift(a.TB.id0));break;case 2:var c=a.eb.id0,e=a.PK.id0,f=e[0],h=I.GU(c,f,"MAIN");d.ma=a.Oa;if(null===h){J.error('Material "'+f+'" was not found in the object "'+c.name+'".');break}if("ShaderNodeRGB"==a.zM){var k=I.bJ(h.dj,e);I.YY(c,f,k,a.S.id0?n(x(a.U.id0,b.u,d.u),0):a.Hb.id0,a.S.id1?n(x(a.U.id1,b.u,d.u),0):a.Hb.id1,a.S.id2?n(x(a.U.id2,b.u,d.u),0):a.Hb.id2)}"ShaderNodeValue"==a.zM&&(k=I.bJ(h.ej,e),I.ZY(c,f,k,a.S.id0?n(x(a.U.id0,b.u,d.u),0):a.Hb.id0))}},DELAY:function(a,
b,d,c,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.mx=0,d.Gf=!0):0==a.state&&(a.mx+=e,(a.S.dl?n(x(a.U.dl,b.u,d.u),0):a.Hb.dl)<a.mx&&(a.state=-1,d.ma=a.Oa,d.Gf=!1))}},APPLY_SHAPE_KEY:function(a,b,d){switch(b.state){case 1:b=a.eb.id0=F.wc(F.Pc,a.Lc.id0,0);b||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);d=a.xe.sk;B.sS(b)?B.YV(b,d)||(J.error("Wrong key name:",d),a.ec=!0):(J.error("No shape keys in object:",b.name),a.ec=!0);break;case 2:B.jR(a.eb.id0,a.xe.sk,a.S.skv?n(x(a.U.skv,
b.u,d.u),0):a.Hb.skv),d.ma=a.Oa}},OUTLINE:function(a,b,d){switch(b.state){case 1:var c=a.eb.id0=F.wc(F.Pc,a.Lc.id0,0);c||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);c&&c.k&&c.k.Wc||(J.error("Can't evaluate 'Outline' logic node: wrong object"),a.ec=!0);break;case 2:c=a.eb.id0;switch(a.xe.outline_operation){case "PLAY":b=c.k.Xh;F.pn(c,b.qk,b.rk,b.tk);break;case "STOP":F.nq(c);break;case "INTENSITY":c.k.gh=a.S["in"]?n(x(a.U["in"],b.u,d.u),0):a.Hb["in"]}d.ma=a.Oa}},MOVE_CAMERA:function(a,
b,c){function e(a,b,d,c){switch(y.am(a)){case y.Kb:y.ws(a,b,d);break;case y.od:case y.zg:t.fi(a,c);break;case y.cd:G.sub(d,b,S),G.normalize(S,S),y.Nw(a,d),d=b=0,X[0]=S[0],X[1]=0,X[2]=S[2],b=G.dot(X,S),d=Math.acos(b/(G.length(X)*G.length(S))),b=S[2]?Math.atan(S[0]/S[2]):0<S[0]?0:Math.PI,0<S[2]&&0<S[0]?H[1]=-(Math.PI+H[1]):0<S[2]&&0>S[0]?H[1]=-(Math.PI+H[1]):0>S[2]&&0>S[0]?(H[0]+=Math.PI,b=-(Math.PI-b)):0>S[2]&&0<S[0]&&(H[0]+=Math.PI,b-=Math.PI),y.ns(a,b+Math.PI,-d,!0,!0)}t.D(a);f.H(a)}function h(a,
b,c,e){d.lookAt(b,c,M.Oc,W);d.invert(W,W);P.fromMat4(W,ma);r.fromMat3(ma,T);r.normalize(T,T);a=aa.td(a.k.n);aa.sg(b,a,T,e)}switch(b.state){case 1:var k=null,k=a.eb.ca=F.wc(F.Pc,a.Lc.id0,0);k||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.eb.tr=F.wc(F.Pc,a.Lc.id1,0);a.eb.tr||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.eb.ta=F.wc(F.Pc,a.Lc.id2,0);a.eb.ta||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.state=-1;a.uc=
{uN:new Float32Array(3),tN:new Float32Array(3),BB:new Float32Array(3),OD:new Float32Array(3),hN:new Float32Array(3),AB:new Float32Array(3),Sk:new Float32Array(8),mi:new Float32Array(8),wr:new Float32Array(8)};break;case 2:var g=a.eb.ca,k=aa.F(a.eb.tr.k.n),l=aa.F(a.eb.ta.k.n);switch(a.state){case -1:b=a.S.dur?n(x(a.U.dur,b.u,c.u),0):a.Hb.dur;if(0==b){h(g,k,l,a.uc.mi);e(g,k,l,a.uc.mi);c.ma=a.Oa;break}c=aa.F(g.k.n);G.copy(c,a.uc.uN);var m=y.am(g);m==y.cd?G.copy(g.k.Wb,a.uc.OD):m==y.zg||m==y.od?(aa.copy(g.k.n,
a.uc.Sk),h(g,k,l,a.uc.mi)):G.copy(g.k.pivot,a.uc.OD);G.copy(k,a.uc.tN);G.copy(l,a.uc.hN);a.state=0;var p=Q.Fj(0,1,1E3*b,function(b){D.Ca()&&(m==y.zg||m==y.od?aa.xr(a.uc.Sk,a.uc.mi,M.Lm(b),a.uc.wr):(a.uc.AB=G.lerp(a.uc.OD,a.uc.hN,M.Lm(b),a.uc.AB),a.uc.BB=G.lerp(a.uc.uN,a.uc.tN,M.Lm(b),a.uc.BB)),e(g,a.uc.BB,a.uc.AB,a.uc.wr),1==b&&(a.state=1))});break;case 1:Q.tn(p),a.state=-1,c.ma=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,d){switch(b.state){case 1:var c=null,c=a.eb.ca=F.wc(F.Pc,a.Lc.id0,0);c||(J.error("Logic script error: object not found. Node: ",
a.name),a.ec=!0);b=c.k;a.ZR={Ok:b.Ok,use_panning:b.use_panning,mb:b.mb,la:b.la,tb:b.tb,Bc:b.Bc,Cc:b.Cc,ce:b.ce,Jh:b.Jh};break;case 2:var c=a.eb.ca,e=c.k,h=a.ZR;y.$s(c);switch(a.xe.camera_move_style){case 0:e.vb=y.zg;break;case 2:e.vb=y.od;var k=aa.F(e.n);y.vM(c,k,null,h.mb,h.la);break;case 3:e.vb=y.cd;var k=aa.F(e.n),g=S;a.S.pvo?(g=F.wc(F.Pc,a.Lc.id1,0),g=aa.F(g.k.n)):(g[0]=a.S.pvx?n(x(a.U.pvx,b.u,d.u),0):a.Hb.pvx,g[1]=a.S.pvy?n(x(a.U.pvy,b.u,d.u),0):a.Hb.pvy,g[2]=a.S.pvz?n(x(a.U.pvz,b.u,d.u),0):
a.Hb.pvz);y.wM(c,k,g,h.tb,h.la,h.Bc,h.Cc,h.Jh);break;case 1:e.vb=y.Kb,k=aa.F(e.n),g=S,a.S.pvo?(g=F.wc(F.Pc,a.Lc.id1,0),g=aa.F(g.k.n)):(g[0]=a.S.pvx?n(x(a.U.pvx,b.u,d.u),0):a.Hb.pvx,g[1]=a.S.pvy?n(x(a.U.pvy,b.u,d.u),0):a.Hb.pvy,g[2]=a.S.pvz?n(x(a.U.pvz,b.u,d.u),0):a.Hb.pvz),y.xM(c,k,g,h.mb,h.la,h.M3,h.ce,h.use_panning)}X[0]=a.S.vtr?n(x(a.U.vtr,b.u,d.u),0):a.Hb.vtr;X[1]=a.S.vro?n(x(a.U.vro,b.u,d.u),0):a.Hb.vro;X[2]=a.S.vzo?n(x(a.U.vzo,b.u,d.u),0):a.Hb.vzo;X[0]=M.W(X[0],0,Infinity);X[1]=M.W(X[1],0,Infinity);
X[2]=M.W(X[2],0,.99);e.Yk=X[0];e.Xk=X[1];e.Zk=X[2];t.D(c);f.H(c);y.Wn(c);d.ma=a.Oa}},MOVE_TO:function(a,b,d){function c(a,b){t.fi(a,b);t.D(a);f.H(a)}switch(b.state){case 1:a.eb.ob=F.wc(F.Pc,a.Lc.id0,0);a.eb.ob||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.eb.de=F.wc(F.Pc,a.Lc.id1,0);a.eb.de||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.state=-1;a.kc={RH:new Float32Array(8),BA:new Float32Array(8),WJ:new Float32Array(8)};break;case 2:var e=
a.eb.ob;aa.copy(a.eb.ob.k.n,a.kc.RH);aa.copy(a.eb.de.k.n,a.kc.BA);switch(a.state){case -1:b=a.S.dur?n(x(a.U.dur,b.u,d.u),0):a.Hb.dur;if(0==b){c(e,a.kc.BA);d.ma=a.Oa;break}a.state=0;var h=Q.Fj(0,1,1E3*b,function(b){D.Ca()&&(a.kc.J6=aa.xr(a.kc.RH,a.kc.BA,M.Lm(b),a.kc.WJ),c(e,a.kc.WJ),1==b&&(a.state=1))});break;case 1:Q.tn(h),a.state=-1,d.ma=a.Oa}}},TRANSFORM_OBJECT:function(a,b,d){function c(a,b,d){0==d?t.fi(a,b):t.Uw(a,b);t.D(a);f.H(a)}switch(b.state){case 1:a.eb.ob=F.wc(F.Pc,a.Lc.id0,0);a.eb.ob||
(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);a.state=-1;a.kc={fx:0,Sk:new Float32Array(8),mi:new Float32Array(8),wr:new Float32Array(8)};break;case 2:var e=a.eb.ob;switch(a.state){case -1:X[0]=a.S.trx?n(x(a.U.trx,b.u,d.u),0):a.Hb.trx;X[1]=a.S["try"]?n(x(a.U["try"],b.u,d.u),0):a.Hb["try"];X[2]=a.S.trz?n(x(a.U.trz,b.u,d.u),0):a.Hb.trz;S[0]=a.S.rox?n(x(a.U.rox,b.u,d.u),0)*Math.PI/180:a.Hb.rox;S[1]=a.S.roy?n(x(a.U.roy,b.u,d.u),0)*Math.PI/180:a.Hb.roy;S[2]=a.S.roz?n(x(a.U.roz,
b.u,d.u),0)*Math.PI/180:a.Hb.roz;var h=a.S.sc?x(a.U.sc,b.u,d.u):a.Hb.sc;M.Wj(S,T);aa.sg(X,h,T,a.kc.mi);a.kc.fx=a.xe.space_type;switch(a.kc.fx){case 0:t.nr(e,a.kc.Sk);break;case 1:t.or(e,a.kc.Sk);break;case 2:t.or(e,a.kc.Sk),aa.multiply(a.kc.Sk,a.kc.mi,a.kc.mi)}b=a.S.dur?n(x(a.U.dur,b.u,d.u),0):a.Hb.dur;if(0==b){c(e,a.kc.mi,a.kc.fx);d.ma=a.Oa;break}a.state=0;h=Q.Fj(0,1,1E3*b,function(b){D.Ca()&&(aa.xr(a.kc.Sk,a.kc.mi,M.Lm(b),a.kc.wr),c(e,a.kc.wr,a.kc.fx),1==b&&(a.state=1))});break;case 1:Q.tn(h),a.state=
-1,d.ma=a.Oa}}},SPEAKER_PLAY:function(a,b,d){switch(b.state){case 1:a.ea=F.wc(F.Pc,a.Lc.id0,0);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);void 0==a.S.not_wait&&(a.S.not_wait=!0);break;case 2:switch(g.Ev(a.ea)||0!=a.state||(a.state=1),a.state){case -1:for(var c in b.le){var e=b.le[c].Of.ma;-1!=e&&(e=b.le[c].Y[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.ea==a.ea&&(e.state=1))}a.S.not_wait||(d.Gf=!0);g.sw(a.ea);a.state=0;break;case 0:a.S.not_wait&&(d.ma=a.Oa,a.state=
-1);break;case 1:a.S.not_wait||(d.Gf=!1);d.ma=a.Oa;a.state=-1;break;default:M.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,d){switch(b.state){case 1:a.ea=F.wc(F.Pc,a.Lc.id0,0);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:g.stop(a.ea),d.ma=a.Oa}},STOP_ANIM:function(a,b,d){switch(b.state){case 1:a.ea=a.S.env?F.av(a.Rq[0],0):z(a);a.ea||(J.error("Logic script error: object not found. Node: ",a.name),a.ec=!0);break;case 2:u.stop(a.ea,
u.il),a.S.rst&&u.gD(a.ea,u.il),d.ma=a.Oa}},STOP_TIMELINE:function(a,b,d,c){switch(b.state){case 2:a.S.rst&&K.hM(c),K.VM(),d.ma=a.Oa}},CONSOLE_PRINT:function(a,b,d){switch(b.state){case 2:var c={},e;for(e in a.U)c[a.U[e][1]]=x(a.U[e],b.u,d.u);J.log(a.xe.msg,JSON.stringify(c));d.ma=a.Oa}},STRING:function(a,b,d){switch(b.state){case 2:var c=a.S.id0?n(x(a.U.id0,b.u,d.u),1):a.pj.id0,e=a.S.id1?n(x(a.U.id1,b.u,d.u),1):a.pj.id1,f=0;switch(a.xe.string_operation){case 0:f=c+e;break;case 1:f=c.indexOf(e);break;
case 2:f=c.replace(e,a.S.id2?n(x(a.U.id2,b.u,d.u),1):a.pj.id2);break;case 3:var h=a.U,f=c.substring(0,c.indexOf(e));q(h.dst1,b.u,d.u,c.substring(c.indexOf(e)+1,c.length));""==x(h.dst,b.u,d.u)&&(f=x(h.dst1,b.u,d.u),q(h.dst1,b.u,d.u,""));break;case 4:switch(a.xe.condition){case 5:f=c==e?1:0;break;case 4:f=c!=e?1:0;break;case 3:f=c<e?1:0;break;case 2:f=c>e?1:0;break;case 1:f=c<=e?1:0;break;case 0:f=c>=e?1:0}}q(a.U.dst,b.u,d.u,f);d.ma=a.Oa}},GET_TIMELINE:function(a,b,d,c){switch(b.state){case 2:c=a.S.nla?
n(K.kr(c),0):n(Q.kr(c),0),q(a.U.vd,b.u,d.u,c),d.ma=a.Oa}},JSON:function(a,b,d){function c(a,b,d,e){for(var f=0;f<b.length;f++){for(var h=b[f].split("."),g=a,l=d[f],n=0;n<h.length&&(g=g[h[n]],void 0!==g&&null!==g);n++);g=k(g);e[l]=g}}function e(a,b,d,c){c||(c={});for(var f=0;f<b.length;f++){var h=b[f].split("."),g=c,l=d[f];if(!(!l in a)){for(var n=0;n<h.length-1;n++)void 0===g[h[n]]&&(g[h[n]]=isNaN(h[n+1])?{}:[]),g=g[h[n]];g[h[h.length-1]]=k(a[l])}}}switch(b.state){case 2:switch(a.xe.json_operation){case "PARSE":try{var f=
JSON.parse(n(x(a.U.jsn,b.u,d.u),1));c(f,a.GX,a.HX,d.u)}catch(h){J.error("logic script error: non valid JSON string")}break;case "ENCODE":f={},e(d.u,a.oU,a.pU,f),f=n(JSON.stringify(f),1),q(a.U.jsn,b.u,d.u,f)}d.ma=a.Oa}},JS_CALLBACK:function(a,b,d){switch(b.state){case 2:for(var c=a.S.cb?n(x(a.U.cb,b.u,d.u),1):a.pj.cb,e=[],f=0,h="id"+f,g=a.xe.js_cb_params;h in g;)h=0==g[h]?F.wc(F.Pc,a.Lc[h],0):x(a.U[h],b.u,d.u),e.push(h),f++,h="id"+f;g=[];f=0;for(h="out"+f;h in a.U;)h=x(a.U[h],b.u,d.u),g.push(h),f++,
h="out"+f;f=1;if(c in ga){if(f=!ga[c](e,g))for(c=0;c<g.length;c++)h="out"+c,h in a.U&&q(a.U[h],b.u,d.u,k(g[c]))}else J.error("logic script error: no custom callback with id "+c);f&&(d.ma=a.Oa)}},EMPTY:A},V=[],ga={};a.vB=function(a,b){var d={Ve:b,KL:a.name,state:0,um:null,yb:a,uA:null,le:[],As:[],u:{}};a.j2=d;p(a,d)};a.update=function(a,b){var d=K.NV();if(!(0>=d))for(var c=0;c<V.length;c++)for(var e=c,f=a,h=b,k=d,g=V[e],l=0;l<V[e].le.length;l++){g.uA=V[e].le[l];var n=V[e].le[l],m=g,r=f,p=h,q=k,t=n.Y;
if(t.length){for(var u=0;u<t.length;u++)t[u].vw=!1;for(u=0;u<t.length;u++){if(0<=n.Of.ma)var z=t[n.Of.ma];else break;if(z.vw)break;if(z.ec)if("ENTRYPOINT"==z.type)break;else n.Of.ma=z.Oa,z.vw=!0;else z.lL(z,m,n.Of,r,p,q),z.vw=!0}}}};a.m2=function(a,b){ga[a]=b};a.L7=function(a){delete ga[a]};a.Y7=function(a,b){for(var d=0;d<V.length;d++)if(V[d].KL==a){for(var d=V[d],c=0;c<d.le.length;c++){var e=d.le[c].Y[0];if(e.name==b){e.S.js&&(e.ec=!1);d.le[c].Of.ma=0;break}}break}};a.ua=function(){V.length=0;ga=
{}}};b4w.module.__controls=function(a,m){function l(a,b){b||(b=u.af());return{type:a,value:0,Z:null,element:b,Ka:!1,key:0,cc:"",Dh:!1,Yz:null,Xz:function(){},Wz:null,aH:function(){},hi:null,from:new Float32Array(3),to:new Float32Array(3),XJ:!1,sv:!1,fs:0,vL:function(){},axis:"",Pf:0,cp:new Float32Array(3),xw:new Float32Array(4),threshold:0,pL:new Float32Array(4),Ut:0,Tt:0,GL:0,Vt:0,Kf:0,repeat:!1,YH:!1,Yl:0,callback:function(){}}}function c(a){function b(){return{Qj:new Float32Array(2),nm:!0,ea:null,identifier:-1,
Fv:!0}}a||(a=u.af());for(var d=0;d<Q.length;d++){var c=Q[d];if(a==c.element)return c}c={element:a,Dr:!0,Be:0,Gv:!0,Xv:0,Yv:0,sm:0,tm:0,$r:0,as:0,ph:new Float32Array(2),re:new Float32Array(2),qh:new Float32Array(2),He:new Float32Array(2),ox:0,aE:0,sN:0,Xe:new Uint8Array(256),Lx:0,nB:null,Wh:b(),Qm:Array(10),GB:!1,IJ:J.create(),hv:0,gv:0,fv:0,pB:0,oB:0,ev:Infinity,rC:null,qC:null,gC:null,cC:null,eC:null,ZD:null,YD:null,fC:null,dC:null,DC:null,V6:null,$D:null,XD:null,WD:null,jj:{}};for(d=0;10>d;++d)c.Qm[d]=
b();c.rC=function(a){c.GB||(e.UV(a,c.IJ),c.GB=!0)};c.qC=function(a){a=I.copy(a,M);c.fv=a[0];c.gv=a[1];c.hv=a[2];Infinity==c.ev&&(c.ev=a[0],c.oB=a[1],c.pB=a[2])};c.gC=function(a){c.Lx+=a*B.tX};c.cC=function(a){var b=e.ja(e.bd,c.element),b=e.Ti(b,e.vi,t);c.Xv=b[0];c.Yv=b[1];c.sm=b[0];c.tm=b[1];if(3==c.Be||0==c.Be)c.Be=1;c.which=a};c.eC=function(){var a=e.ja(e.bd,c.element),a=e.Ti(a,e.vi,t),a=u.oq(a[0],a[1],t);c.Wh.nm=!1;c.Wh.Qj[0]=a[0];c.Wh.Qj[1]=a[1]};c.ZD=function(a){for(var b=0;b<a.length;++b){for(var d=
a[b],e=null,f=null,h=0;h<c.Qm.length;h++){var k=c.Qm[h];if(k.identifier==d.identifier){k.Fv&&(f=k);break}else!e&&k.Fv&&(e=k,e.identifier=d.identifier)}if(d=f||e)e=u.oq(a[b].clientX,a[b].clientY,t),d.nm=!1,d.Fv=!1,d.Qj[0]=e[0],d.Qj[1]=e[1]}};c.YD=function(a){for(var b=0;b<c.Qm.length;++b){for(var d=c.Qm[b],e=!1,f=0;f<a.length;++f)if(a[f].identifier==d.identifier){e=!0;break}e||(d.nm=!0,d.Fv=!0,d.ea=null)}};c.fC=function(a){var b=e.ja(e.bd,c.element),b=e.Ti(b,e.vi,t);c.Xv=b[0];c.Yv=b[1];c.sm=b[0];c.tm=
b[1];0<c.Be&&(c.Be=3);c.which=a};c.dC=function(a){if(!P.Sn||c.Be)c.sm=a[0],c.tm=a[1]};c.DC=function(a){if(!P.Sn||c.Be)c.$r+=a[0],c.as+=a[1]};c.jK=function(a){2!=c.Xe[a]&&(c.Xe[a]=1,c.Dr=!1)};c.lK=function(){for(var a=0;a<c.Xe.length;a++)0!=c.Xe[a]&&(c.Xe[a]=3,c.Dr=!1)};c.mK=function(a){c.Dr=!1;c.Xe[a]=3};c.$D=function(a){c.Gv=!1;if(1==a.length)c.ph[0]=a[0].clientX,c.ph[1]=-1,c.qh[0]=a[0].clientY,c.qh[1]=-1;else if(1<a.length){c.ox=c.aE=p(a);c.ph[0]=a[0].clientX;c.ph[1]=a[1].clientX;c.qh[0]=a[0].clientY;
c.qh[1]=a[1].clientY;var b=a[0];a=a[1];c.sN=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}c.re.set(c.ph);c.He.set(c.qh)};c.XD=function(a){1===a.length?(c.re[0]=a[0].clientX,c.re[1]=-1,c.He[0]=a[0].clientY,c.He[1]=-1):1<a.length&&(c.re[0]=a[0].clientX,c.re[1]=a[1].clientX,c.He[0]=a[0].clientY,c.He[1]=a[1].clientY,c.ox=p(a))};c.WD=function(a){0==a.length&&(c.Gv=!0)};Q.push(c);return c}function b(a,b){if(b in a.jj&&0<a.jj[b])a.jj[b]+=1;else switch(a.jj[b]=1,b){case "orientation_quat":var d=e.ja(e.uh);
d&&e.yd(d,e.fn,a.rC);break;case "orientation_angles":(d=e.ja(e.uh))&&e.yd(d,e.fn,a.qC);break;case "mouse_wheel":(d=e.ja(e.bd,a.element))&&e.yd(d,e.Dp,a.gC);break;case "mouse_down_which":(d=e.ja(e.bd,a.element))&&e.yd(d,e.fl,a.cC);break;case "mouse_select":(d=e.ja(e.bd,a.element))&&e.yd(d,e.fl,a.eC);break;case "touch_select":if(d=e.ja(e.yg,a.element))e.yd(d,e.kl,a.ZD),e.yd(d,e.jl,a.YD);break;case "mouse_up_which":(d=e.ja(e.bd,a.element))&&e.yd(d,e.Cp,a.fC);break;case "mouse_location":(d=e.ja(e.bd,
a.element))&&e.yd(d,e.vi,a.dC);break;case "mouse_pointerlock":(d=e.ja(e.bd,a.element))&&e.yd(d,e.TE,a.DC);break;case "keyboard_downed_keys":if(d=e.ja(e.tp,a.element))e.yd(d,e.zp,a.jK),e.yd(d,e.ME,a.lK),e.yd(d,e.Ap,a.mK);break;case "touch_start":(d=e.ja(e.yg,a.element))&&e.yd(d,e.kl,a.$D);break;case "touch_move":(d=e.ja(e.yg,a.element))&&e.yd(d,e.Jp,a.XD);break;case "touch_end":(d=e.ja(e.yg,a.element))&&e.yd(d,e.jl,a.WD)}}function x(a,b){if(!(!b in a.jj)&&0<a.jj[b]&&(--a.jj[b],!a.jj[b]))switch(b){case "orientation_quat":var d=
e.ja(e.uh);d&&e.Bd(d,e.st,a.rC);break;case "orientation_angles":(d=e.ja(e.uh))&&e.Bd(d,e.fn,a.qC);break;case "mouse_wheel":(d=e.ja(e.bd,a.element))&&e.Bd(d,e.Dp,a.gC);break;case "mouse_down_which":(d=e.ja(e.bd,a.element))&&e.Bd(d,e.fl,a.cC);break;case "mouse_select":(d=e.ja(e.bd,a.element))&&e.Bd(d,e.fl,a.eC);break;case "touch_select":if(d=e.ja(e.yg,a.element))e.Bd(d,e.kl,a.ZD),e.Bd(d,e.jl,a.YD);break;case "mouse_up_which":(d=e.ja(e.bd,a.element))&&e.Bd(d,e.Cp,a.fC);break;case "mouse_location":(d=
e.ja(e.bd,a.element))&&e.Bd(d,e.vi,a.dC);break;case "mouse_pointerlock":(d=e.ja(e.bd,a.element))&&e.Bd(d,e.TE,a.DC);break;case "keyboard_downed_keys":if(d=e.ja(e.tp,a.element))e.Bd(d,e.zp,a.jK),e.Bd(d,e.ME,a.lK),e.Bd(d,e.Ap,a.mK);break;case "touch_start":(d=e.ja(e.yg,a.element))&&e.Bd(d,e.kl,a.$D);break;case "touch_move":(d=e.ja(e.yg,a.element))&&e.Bd(d,e.Jp,a.XD);break;case "touch_end":(d=e.ja(e.yg,a.element))&&e.Bd(d,e.jl,a.WD)}}function q(a,b){a.value=Number(b)}function A(a){for(var b=a.Ek,d=a.CY,
c=0;c<b.length;c++)d[c]=b[c].value;return a.dX(d)}function h(a,b){a=a||f;var c=a.mh;if(c){var e=a.Im;if(b){var k=c[b];if(k){for(var l=k.Ek,n=0;n<l.length;n++){var m=l[n],p;p=r.indexOf(m);p=-1<p?g[p]:[];1==p.length?(z(m),m=r.indexOf(m),-1<m?(r.splice(m,1),g.splice(m,1)):E.q("Sensors cache is corrupted")):1<p.length&&p.splice(p.indexOf(k),1)}delete c[b];n=e.indexOf(k);-1<n?e.splice(n,1):E.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=d.indexOf(a),-1<c?d.splice(c,1):K.error("Wrong object"))}}else{e=
[];for(b in c)e.push(b);for(n=0;n<e.length;n++)h(a,e[n])}T=!0}}function z(a){switch(a.type){case 90:F.QC(a.Yz,a.cc,a.Xz);a.Ka=!0;break;case 100:F.Tz(a.Wz);a.Ka=!0;break;case 110:F.RC(a.fs);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=c(a.element);x(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=c(a.element);x(b,"mouse_wheel");a.Ka=!0;break;case 40:b=c(a.element);x(b,"mouse_down_which");x(b,"mouse_up_which");x(b,"mouse_location");a.Ka=!0;break;case 260:b=c(a.element);x(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=c(a.element);x(b,"mouse_down_which");x(b,"mouse_up_which");a.Ka=!0;break;case 60:b=c(a.element);x(b,"touch_start");x(b,"touch_move");x(b,"touch_end");a.Ka=!0;break;case 70:b=c(a.element);x(b,"touch_start");x(b,"touch_move");a.Ka=!0;break;case 75:b=c(a.element);x(b,"touch_start");x(b,"touch_move");a.Ka=!0;break;case 80:b=c(a.element);x(b,"touch_start");x(b,"touch_end");a.Ka=!0;break;case 170:b=c(a.element);x(b,"mouse_select");x(b,"touch_select");x(b,"touch_start");x(b,"touch_end");
x(b,"mouse_down_which");x(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=c(a.element);x(b,"orientation_angles");a.Ka=!0;break;case 200:b=c(a.element);x(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function p(a){var b=a[0],d=a[1];a=b.clientX-d.clientX;b=b.clientY-d.clientY;return Math.sqrt(a*a+b*b)}function n(a){return 0==a?e.ja(e.gt):1==a?e.ja(e.$x):2==a?e.ja(e.ay):e.ja(e.by)}var k=m("__config"),u=m("__container"),e=m("__input"),y=m("__objects"),K=m("__print"),F=m("__physics"),
J=m("__quat"),D=m("__time"),R=m("__tsr"),E=m("__util"),I=m("__vec3"),B=k.controls,P=k.B,d=[],f={},r=[],g=[],Q=[],t=new Float32Array(2),aa=new Float32Array(2),M=I.create(),G=J.create(),T=!1,S=0;a.tf=10;a.kb=20;a.ti=30;a.Ne=40;a.sp=50;a.Xx=60;a.At=0;a.zt=1;a.yt=2;a.cz=3;var X=1;a.update=function(b,h){for(var k=0;k<Q.length;k++){var g=Q[k];g.Wh.nm||(g.Wh.ea=y.uo(g.Wh.Qj[0],g.Wh.Qj[1]),g.Wh.nm=!0,g.nB=g.Wh.ea);for(var l=0;10>l;++l){var m=g.Qm[l];m.nm||(m.ea=y.uo(m.Qj[0],m.Qj[1]),m.nm=!0,g.nB=m.ea)}}for(k=
0;k<r.length;k++)if(g=r[k],m=b,l=h)switch(g.type){case 120:var p=g.hi,u=R.jc(p.k.n,M),p=R.Yd(p.k.n,G),z=I.dist(g.cp,u),x=g.pL;J.invert(g.xw,x);J.multiply(p,x,x);J.normalize(x,x);x=Math.abs(2*Math.acos(x[3]));z/=l;g.Ut=E.mc(z,g.Ut,l,.3);g.Z[0]=z;z=x/l;g.Tt=E.mc(z,g.Tt,l,.3);g.Z[1]=z;g.Ut>=g.threshold||g.Tt>=g.GL?q(g,1):q(g,0);I.copy(u,g.cp);J.copy(p,g.xw);g.Pf=m;break;case 130:p=g.hi;u=R.jc(p.k.n,M);p=Math.abs(u[1]-g.cp[1])/l;g.Vt=E.mc(p,g.Vt,l,.3);g.Z=p;g.Vt>=g.threshold?q(g,1):q(g,0);I.copy(u,g.cp);
g.Pf=m;break;case 140:!g.Ka&&0<=g.Kf&&m-g.Pf>=g.Kf&&(q(g,1),g.repeat?g.Pf=m:g.Kf=-g.Kf);break;case 150:g.Pf||(g.Pf=m);q(g,m-g.Pf);g.Pf=m;break;case 160:q(g,m);break;case 180:m=c(g.element);g.Z[0]=m.hv-m.pB;g.Z[1]=m.gv-m.oB;g.Z[2]=m.fv-m.ev;break;case 190:m=c(g.element);g.Z[0]=m.hv;g.Z[1]=m.gv;g.Z[2]=m.fv;break;case 200:m=c(g.element);J.copy(m.IJ,g.Z);break;case 210:l=e.ja(e.Oe);e.Ti(l,e.tt,g.Z);break;case 220:l=e.ja(e.Oe);e.Ti(l,e.ut,g.Z);break;case 240:l=n(g.Yl);g.value=e.DV(l,g.key);break;case 250:l=
n(g.Yl);g.value=e.CV(l,g.key);break;case 230:q(g,g.callback());break;case 30:m=c(g.element);q(g,m.Lx);break;case 40:m=c(g.element);if(!P.Sn||1==m.Be||2==m.Be)switch(u=m.sm-m.Xv,p=m.tm-m.Yv,g.Z.coords[0]=m.sm,g.Z.coords[1]=m.tm,g.axis){case "X":q(g,u);break;case "Y":q(g,p);break;case "XY":l=Math.sqrt(u*u+p*p),q(g,l)}break;case 260:m=c(g.element);P.Sn||(u=m.$r,p=m.as,z=E.mc(u,0,l,.1*X),l=E.mc(p,0,l,.1*X),.01<Math.abs(u)||.01<Math.abs(p)?(m.$r-=z,m.as-=l,g.Z.coords[0]=z,g.Z.coords[1]=l):(g.Z.coords[0]=
0,g.Z.coords[1]=0),q(g,Math.sqrt(u*u+p*p)));break;case 50:m=c(g.element);q(g,0<m.Be|0);g.Z.which=m.which;g.Z.coords[0]=m.sm;g.Z.coords[1]=m.tm;break;case 170:m=c(g.element);q(g,0);if(g.YH)m.nB==g.hi&&q(g,1);else if(m.Be&&m.Wh.ea==g.hi)q(g,1);else if(!m.Gv)for(l=0;10>l;++l)if(m.Qm[l].ea==g.hi){q(g,1);break}break;case 20:m=c(g.element);g.Z=m.Xe[g.key];1==g.Z||m.Xe[0]&&16==g.key?q(g,1):g.Z||q(g,0);break;case 60:m=c(g.element);if(-1==m.re[1]&&-1==m.He[1]){u=m.re[0]-m.ph[0];p=m.He[0]-m.qh[0];l=Math.sqrt(u*
u+p*p);if(-1!=m.ph[1]&&-1!=m.qh[1]){var z=m.re[0]-m.ph[1],x=m.He[0]-m.qh[1],B=Math.sqrt(z*z+x*x);B<l&&(u=z,p=x,l=B)}g.Z.gesture=a.At}else l=t,l[0]=(m.re[0]+m.re[1])/2,l[1]=(m.He[0]+m.He[1])/2,p=aa,p[0]=(m.ph[0]+m.ph[1])/2,p[1]=(m.qh[0]+m.qh[1])/2,u=l[0]-p[0],p=l[1]-p[1],l=Math.sqrt(u*u+p*p),g.Z.gesture=a.yt;g.Z.coords[0]=m.re[0];g.Z.coords[1]=m.He[0];switch(g.axis){case "X":q(g,u);break;case "Y":q(g,p);break;case "XY":q(g,l)}break;case 70:m=c(g.element);l=m.ox-m.aE;g.Z=a.zt;q(g,l);break;case 75:m=
c(g.element);-1!=m.re[1]&&(l=Math.atan2(m.He[0]-m.He[1],m.re[0]-m.re[1]),g.Z=a.cz,q(g,l-m.sN));break;case 80:m=c(g.element),g.Z.coords[0]=m.re[0],g.Z.coords[1]=m.He[0],m.Gv?q(g,0):q(g,1)}for(k=0;k<d.length;k++)for(m=d[k],g=m.Im,l=0;l<g.length;l++)if(u=g[l],u.Tk!=S){u.Tk=S;x=u;p=0;switch(x.type){case a.tf:p=(z=A(x))?1:0;break;case a.kb:p=x.Yi;(z=A(x))?(p=1,x.Yi=1):1==p?(p=-1,x.Yi=-1):p=0;break;case a.ti:p=x.Yi;(z=A(x))&&-1==p?(p=1,x.Yi=1):z||1!=p?p=0:(p=-1,x.Yi=-1);break;case a.Ne:p=x.Yi;(z=A(x))&&
-1==p?(p=1,x.Yi=1):z||1!=p?p=0:(p=0,x.Yi=-1);break;case a.sp:z=A(x);x.qK!=z?(p=1,x.qK=z):p=0;break;case a.Xx:z=x.Ek;x=x.IW;for(B=0;B<z.length;B++){var D=z[B].value;p||D==x[B]||(p=1);x[B]=D}break;default:E.q("Wrong sensor manifold type: "+x.type)}if(p&&(z=m==f?null:m,T=!1,u.callback(z,u.id,p,u.YR),T)){k=-1;break}}for(k=0;k<d.length;k++)for(m=d[k],g=m.Im,l=0;l<g.length;l++)for(u=g[l],m=u.Ek,u=0;u<m.length;u++)switch(p=m[u],p.type){case 30:q(p,0);break;case 40:q(p,0);break;case 60:q(p,0);break;case 70:q(p,
0);break;case 75:q(p,0);break;case 80:q(p,0);break;case 140:q(p,0)}for(k=0;k<Q.length;k++){g=Q[k];if(!g.Dr){for(l=0;l<g.Xe.length;l++)1==g.Xe[l]?g.Xe[l]=2:3==g.Xe[l]&&(g.Xe[l]=0);g.Dr=!0}1==g.Be?g.Be=2:3==g.Be&&(g.Be=0);g.Lx=0;g.Xv=g.sm;g.Yv=g.tm;g.Xe[0]=0;g.ph.set(g.re);g.qh.set(g.He);g.aE=g.ox;g.pB=g.hv;g.oB=g.gv;g.ev=g.fv;g.GB=!1}S++};a.hA=function(a){var b=l(10);q(b,a);return b};a.Qb=function(a){var b=l(20,document);b.key=a;b.Ka=!0;return b};a.ku=function(a,b){var d=l(240,document);b=b||e.SI();
d.Yl=b;d.key=a;d.Ka=!0;return d};a.wn=function(a,b){var d=l(250,document);b=void 0==b?e.SI():b;d.Yl=b;d.key=a;d.Ka=!0;return d};a.gA=function(a,b,d){if(!a||!F.oa(a))return K.error("Wrong collision object"),null;var c=l(90);c.Yz=a;c.cc=b;c.Dh=d;c.Z={coll_obj:null,coll_pos:d?new Float32Array(3):null,coll_norm:d?new Float32Array(3):null,coll_dist:0};c.Xz=function(a,b,d,e,f){q(c,a);a=c.Z;a.coll_obj=b;c.Dh&&(a.coll_pos.set(d),a.coll_norm.set(e),a.coll_dist=f)};c.Ka=!0;return c};a.iH=function(a){if(!a||
!a.C)return K.error("Wrong collision impulse object"),null;var b=l(100);b.Wz=a;b.aH=function(a){q(b,a)};b.Ka=!0;return b};a.tH=function(a,b,d,c,e,f,h){var g=l(110);g.hi=a;g.from=b;g.to=d;g.cc=c;g.XJ=e;g.Dh=f;g.sv=h;g.Z={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),fs:0};g.vL=function(a,b,d,c,e,f){g.XJ?q(g,-1==b?0:1):q(g,b);g.Z.hit_fract=b;g.Z.obj_hit=d;g.Z.hit_time=c;g.Dh&&(g.Z.hit_pos.set(e),g.Z.hit_norm.set(f))};g.Ka=!0;return g};a.Eq=function(a){a=
l(50,a);a.Ka=!0;a.Z={coords:new Float32Array(2),which:null};return a};a.kA=function(a){a=l(30,a);a.Ka=!0;return a};a.yn=function(a,b){var d=l(40,b);d.axis=a||"XY";d.Z={coords:new Float32Array(2)};d.Ka=!0;return d};a.ou=function(a,b){var d=l(60,b);d.axis=a||"XY";d.Z={coords:new Float32Array(2),gesture:0};d.Ka=!0;return d};a.rA=function(a){a=l(70,a);a.Z=0;a.Ka=!0;return a};a.CH=function(a){a=l(75,a);a.Z=0;a.Ka=!0;return a};a.BH=function(a){a=l(80,a);a.Z={coords:new Float32Array(2)};a.Ka=!0;return a};
a.qH=function(a,b,d){if(!a)return K.error("Wrong collision object"),null;var c=l(120);c.hi=a;var e=R.F(a.k.n);a=R.N(a.k.n);c.pL=new Float32Array(4);c.cp=new Float32Array(e);c.xw=new Float32Array(a);c.Ut=0;c.Tt=0;c.threshold=b||.1;c.GL=d||.1;c.Pf=0;c.Z=new Float32Array([0,0]);return c};a.DH=function(a,b){if(!a)return K.error("Wrong collision object"),null;var d=l(130);d.hi=a;var c=R.F(a.k.n),e=R.N(a.k.n);d.cp=new Float32Array(c);d.xw=new Float32Array(e);d.Vt=0;d.threshold=b||1;d.Pf=0;d.Z=0;return d};
a.qA=function(a,b){var d=l(140);d.Kf=a;d.repeat=b;d.Ka=!0;return d};a.CL=function(a,b,d,c){a=a||f;a=a.mh;if(!a||!a[b])return K.error("reset_timer_sensor(): wrong object"),null;b=a[b].Ek[d];if(!b)return K.error("reset_timer_sensor(): sensor not found"),null;b.Pf=D.cm();b.Kf=c};a.Gl=function(){var a=l(150);a.Pf=0;return a};a.mH=function(){var a=l(180,window);a.Z=new Float32Array(3);e.ja(e.uh)?q(a,1):q(a,0);a.Ka=!0;return a};a.lH=function(){var a=l(190,window);a.Z=new Float32Array(3);e.ja(e.uh)?q(a,
1):q(a,0);a.Ka=!0;return a};a.nH=function(){var a=l(200,window);a.Z=J.create();e.ja(e.uh)?q(a,1):q(a,0);a.Ka=!0;return a};a.pH=function(){var a=l(210,window);a.Z=J.create();e.ja(e.Oe)?q(a,1):q(a,0);a.Ka=!0;return a};a.oH=function(){var a=l(220,window);a.Z=I.create();e.ja(e.Oe)?q(a,1):q(a,0);a.Ka=!0;return a};a.AH=function(){return l(160)};a.mu=function(a,b){var d=l(170);d.hi=a;d.YH=b;d.Ka=!0;return d};a.fA=function(a,b){var d=l(230);d.callback=a;q(d,b);return d};a.rH=function(a){a=l(260,a);a.Z={coords:new Float32Array(2)};
a.Ka=!0;return a};a.sH=function(a){a=l(270,a);a.Ka=!0;return a};a.BY=q;a.Ff=function(a,b,d){a=a||f;a=a.mh;if(!a||!a[b])return K.error("get_sensor_value(): wrong object"),null;b=a[b].Ek[d];return b?b.value:(K.error("get_sensor_value(): sensor not found"),null)};a.Oh=function(a,b,d){a=a||f;a=a.mh;if(!a||!a[b])return K.error("get_sensor_payload(): wrong object"),null;b=a[b].Ek[d];return b?b.Z:(K.error("get_sensor_payload(): sensor not found"),null)};a.ua=function(){d=[];f={};for(var a=0;a<r.length;a++)z(r[a]);
r.length=0;g.length=0};a.Al=function(a,b){a=a||f;if(!a.mh)return!1;if(b&&a.mh[b])return!0;if(!b)for(var d in a.mh)return!0;return!1};a.T=function(a,k,l,m,n,p,q){a=a||f;a.Im=a.Im||[];a.mh=a.mh||{};var u=a.mh,t=a.Im;u[k]&&h(a,k);l={id:k,type:l,Ek:m.slice(0),dX:n,CY:Array(m.length),callback:p,YR:q,Yi:-1,qK:0,IW:Array(m.length),Tk:-1};u[k]=l;t.push(l);-1==d.indexOf(a)&&d.push(a);m=l.Ek;for(a=0;a<m.length;a++){u=k=m[a];if(u.Ka){switch(u.type){case 90:F.qz(u.Yz,u.cc,u.Xz,u.Dh);break;case 100:F.tz(u.Wz,
u.aH);break;case 110:u.fs=F.Pt(u.hi,u.from,u.to,u.cc,u.vL,!1,!1,u.Dh,u.sv);u.Z.fs=u.fs;break;case 140:u.Pf=D.cm();0>u.Kf&&(u.Kf=-u.Kf);break;case 20:t=c(u.element);b(t,"keyboard_downed_keys");break;case 30:t=c(u.element);b(t,"mouse_wheel");break;case 40:t=c(u.element);b(t,"mouse_down_which");b(t,"mouse_up_which");b(t,"mouse_location");break;case 260:t=c(u.element);b(t,"mouse_pointerlock");break;case 270:e.EQ(u);break;case 50:t=c(u.element);b(t,"mouse_down_which");b(t,"mouse_up_which");break;case 60:t=
c(u.element);b(t,"touch_start");b(t,"touch_move");b(t,"touch_end");break;case 70:t=c(u.element);b(t,"touch_start");b(t,"touch_move");break;case 75:t=c(u.element);b(t,"touch_start");b(t,"touch_move");break;case 80:t=c(u.element);b(t,"touch_start");b(t,"touch_end");break;case 170:t=c(u.element);b(t,"mouse_select");b(t,"touch_select");b(t,"touch_start");b(t,"touch_end");b(t,"mouse_down_which");b(t,"mouse_up_which");break;case 180:case 190:t=c(u.element);b(t,"orientation_angles");break;case 200:t=c(u.element);
b(t,"orientation_quat");break;case 240:0==u.Yl?e.ja(e.gt):1==u.Yl?e.ja(e.$x):2==u.Yl?e.ja(e.ay):e.ja(e.by)}u.Ka=!1}u=r.indexOf(k);-1==u?(r.push(k),g.push([l])):g[u].push(l)}T=!0};a.uu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.vu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.Fm=h;a.reset=function(){for(var a=0;a<d.length;a++){var b=d[a],c=b.mh,b=b.Im,e;for(e in c)delete c[e];b.length=0}for(a=0;a<r.length;a++)z(r[a]);d.length=
0;r.length=0;g.length=0};a.debug=function(){K.log(String(d.length)+" objects with manifolds",d);K.log(String(r.length)+" sensors",r);for(var a=[],b=[],c=0;c<r.length;c++){var e=r[c];90==e.type&&a.push(e);110==e.type&&b.push(e)}K.log(String(a.length)+" collision sensors",a);K.log(String(b.length)+" ray sensors",b)};a.lD=function(a){X=a}};b4w.module.__loader=function(a,m){function l(b,e,h,l){var m=D,d=K.create(),f;for(f in e){var n=c(e[f]);(l&&n.Xb||!b&&n.lc)&&k(n);K.J(d,n)}for(f in e)for(n=e[f],n.name=f,b=0;b<n.L.length;b++)K.r(d,e[n.L[b]],n,null);e=c({name:"out",Nb:a.sO,bc:function(a,b,d,c,e){b.Mb&&(m.DD=!0);y(b)||(b.status=2);b.vK(b.id,!0);e(b,d);F.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Zb:5});if(h)h=K.mr(d);else{f=K.clone(d);do{h=K.mr(f);n=[];for(b=0;b<h.length;b++){l=h[b];var g=K.Va(f,l);g.Sb&&n.push(l)}for(b=
0;b<n.length;b++)K.rg(f,n[b]);n.length&&K.Sz(f)}while(n.length)}K.J(d,e);for(b=0;b<h.length;b++)l=h[b],g=K.Va(d,l),e.L.push(g.name),K.r(d,g,e,null);return d}function c(a){a.Sb=a.Sb||!1;a.Nb||0===a.Nb||(a.Nb=a.ue);a.L=a.L||[];a.jm=a.jm||!1;a.yD=a.yD||!1;a.Zb=a.Zb||0;a.Xb=a.Xb||!1;a.lc=a.lc||!1;a.status=0;a.f7=0;a.QB=0;a.jq=a.jq||null;return a}function b(a,b){for(var c=[],e=[],h=0;h<b.length;h++){var d=b[h];K.Va(a.ii,d).jm&&(K.Qk(a.ii,d,function(d){var e=!0;K.li(a.ii,d,function(a,b){if(!b.jm)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),e.push(h))}for(h=e.length-1;0<=h;h--)b.splice(e[h],1);return c}function x(a){function c(b,d){var e=K.Va(a.ii,b),h=K.Va(a.ii,d),k=h.Nb-e.Nb;0==k&&(k=e.Sb-h.Sb);return k}var e=[],h=a.oj,k=!1;do{var d=b(a,h);e.push.apply(e,h);0<d.length&&(k=!0);h=d}while(0<d.length);k&&e.sort(c);a.oj=e;return a.oj.length}function q(a,b,c){if(b.yD)return b.jm=!0,h(a,b),!1;if(!b.bc&&!b.Mj&&!b.iq)return h(a,b),!1;if(0==b.status&&(b.status++,b.bc))return b.bc(c,a,
b,b.jq,h,z),!0;if(1==b.status){if(b.Mj)return b.Mj(c,a,b,b.jq,h,z),!0;b.status++}return 2==b.status&&(b.status++,b.iq)?(b.iq(c,a,b,b.jq,h,z),!0):!1}function A(a){if(0==a.gx)return 100;var b=0;K.pa(a.ii,function(c,e){a.do_not_load_resources&&e.Xb||(b+=e.QB*e.Zb)});return J.trunc(100*b/a.gx)}function h(a,b){b.jm=!0;b.status=3;p(a,b,1)}function z(a,b,c){1>c?p(a,b,c):b.status++}function p(a,b,c){var e=D;if(b.bc||b.Mj||b.iq)if(b.QB=c,b=A(a),a.HH!=b||1==c)a.CD(b,performance.now()-a.qN),a.HH=b,e.SB=!0}function n(a,
b){var c=null;K.pa(a.ii,function(a,e){if(e.name==b)return c=e,1});return c}function k(a){a.yD=!0;a.QB=1}function u(a){a.CD=null;a.Zz=null;a.ii=null;a.oj=null}function e(){return 0==D.Mt}function y(a){return a&&(3==a.status||4==a.status)}var K=m("__graph"),F=m("__print"),J=m("__util");a.ue=0;a.xg=1;a.sO=2;var D=null;a.hB=function(){return D};a.uH=function(){var a={oh:[],wA:0,Mt:0,DD:!1,SB:!1};return D=a};a.zH=function(a,b,c,e,h,d,f,k,g){var m=D,n=m.oh.length,p={id:n,Mb:0==n,status:0,Qg:b,qG:"",vK:c||
function(){},uK:k||!1,W9:d,qN:0,HH:0,gx:0,WC:!1,CD:e||function(){},Zz:h||function(){},ii:null,oj:null,sB:!1,qB:!1,wB:!1,fk:g};a=l(p.Mb,a,d,f);p.ii=a;b=[];c=K.MV(a);for(e=0;e<c.length;e++)b.push(c[e]);p.oj=b;K.pa(a,function(a,b){!(b.bc||b.Mj||b.iq)||p.do_not_load_resources&&b.Xb||(p.gx+=b.Zb)});m.oh.push(p);m.Mt++;return p.id};a.S_=function(b){var c=D;if(c&&!e())if(c.SB)c.SB=!1;else{var h=performance.now();do{var k=c.oh[c.wA],l=b[k.id];if(!y(k))if(0==k.status&&(k.status=1,k.qN=performance.now(),k.CD(0,
0)),x(k)){var d=k,f=d.oj.length;do{var m=K.Va(d.ii,d.oj[0]),g=q(d,m,l);m.Nb==a.xg&&(d.WC=!0);m=d.oj.shift();d.oj.push(m);f--}while(!g&&0!=f)}else d=c,f=k,f.Zz(l,f),f.status=3,d.Mt--,u(f);c.DD&&(c.wA=(c.wA+1)%c.oh.length);if(k.WC){k.WC=!1;break}}while(16>performance.now()-h)}};a.GF=function(a){var b=D;a.Zz(null,a);a.status=3;b.Mt--;u(a);a.status=4;a.Mb&&(b.DD=!0);a.vK(a.id,!1)};a.i9=z;a.Zw=function(a,b){var c=n(a,b);null!==c&&k(c)};a.jm=e;a.d_=y;a.Yg=function(a){var b=D;if(!b)return!1;a|=0;return b.oh[a]&&
(3==b.oh[a].status||2==b.oh[a].status)};a.TV=function(){F.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ua=function(){D=null}};b4w.module.__md5=function(a){function m(a,h){var m=a[0],p=a[1],n=a[2],k=a[3],m=c(m,p,n,k,h[0],7,-680876936),k=c(k,m,p,n,h[1],12,-389564586),n=c(n,k,m,p,h[2],17,606105819),p=c(p,n,k,m,h[3],22,-1044525330),m=c(m,p,n,k,h[4],7,-176418897),k=c(k,m,p,n,h[5],12,1200080426),n=c(n,k,m,p,h[6],17,-1473231341),p=c(p,n,k,m,h[7],22,-45705983),m=c(m,p,n,k,h[8],7,1770035416),k=c(k,m,p,n,h[9],12,-1958414417),n=c(n,k,m,p,h[10],17,-42063),p=c(p,n,k,m,h[11],22,-1990404162),m=c(m,p,n,k,h[12],7,1804603682),k=c(k,m,p,n,
h[13],12,-40341101),n=c(n,k,m,p,h[14],17,-1502002290),p=c(p,n,k,m,h[15],22,1236535329),m=b(m,p,n,k,h[1],5,-165796510),k=b(k,m,p,n,h[6],9,-1069501632),n=b(n,k,m,p,h[11],14,643717713),p=b(p,n,k,m,h[0],20,-373897302),m=b(m,p,n,k,h[5],5,-701558691),k=b(k,m,p,n,h[10],9,38016083),n=b(n,k,m,p,h[15],14,-660478335),p=b(p,n,k,m,h[4],20,-405537848),m=b(m,p,n,k,h[9],5,568446438),k=b(k,m,p,n,h[14],9,-1019803690),n=b(n,k,m,p,h[3],14,-187363961),p=b(p,n,k,m,h[8],20,1163531501),m=b(m,p,n,k,h[13],5,-1444681467),k=
b(k,m,p,n,h[2],9,-51403784),n=b(n,k,m,p,h[7],14,1735328473),p=b(p,n,k,m,h[12],20,-1926607734),m=l(p^n^k,m,p,h[5],4,-378558),k=l(m^p^n,k,m,h[8],11,-2022574463),n=l(k^m^p,n,k,h[11],16,1839030562),p=l(n^k^m,p,n,h[14],23,-35309556),m=l(p^n^k,m,p,h[1],4,-1530992060),k=l(m^p^n,k,m,h[4],11,1272893353),n=l(k^m^p,n,k,h[7],16,-155497632),p=l(n^k^m,p,n,h[10],23,-1094730640),m=l(p^n^k,m,p,h[13],4,681279174),k=l(m^p^n,k,m,h[0],11,-358537222),n=l(k^m^p,n,k,h[3],16,-722521979),p=l(n^k^m,p,n,h[6],23,76029189),m=
l(p^n^k,m,p,h[9],4,-640364487),k=l(m^p^n,k,m,h[12],11,-421815835),n=l(k^m^p,n,k,h[15],16,530742520),p=l(n^k^m,p,n,h[2],23,-995338651),m=x(m,p,n,k,h[0],6,-198630844),k=x(k,m,p,n,h[7],10,1126891415),n=x(n,k,m,p,h[14],15,-1416354905),p=x(p,n,k,m,h[5],21,-57434055),m=x(m,p,n,k,h[12],6,1700485571),k=x(k,m,p,n,h[3],10,-1894986606),n=x(n,k,m,p,h[10],15,-1051523),p=x(p,n,k,m,h[1],21,-2054922799),m=x(m,p,n,k,h[8],6,1873313359),k=x(k,m,p,n,h[15],10,-30611744),n=x(n,k,m,p,h[6],15,-1560198380),p=x(p,n,k,m,h[13],
21,1309151649),m=x(m,p,n,k,h[4],6,-145523070),k=x(k,m,p,n,h[11],10,-1120210379),n=x(n,k,m,p,h[2],15,718787259),p=x(p,n,k,m,h[9],21,-343485551);a[0]=m+a[0]&4294967295;a[1]=p+a[1]&4294967295;a[2]=n+a[2]&4294967295;a[3]=k+a[3]&4294967295}function l(a,b,c,l,m,k){b=(b+a&4294967295)+(l+k&4294967295)&4294967295;return(b<<m|b>>>32-m)+c&4294967295}function c(a,b,c,m,n,k,q){return l(b&c|~b&m,a,b,n,k,q)}function b(a,b,c,m,n,k,q){return l(b&m|c&~m,a,b,n,k,q)}function x(a,b,c,m,n,k,q){return l(c^(b|~m),a,b,n,
k,q)}var q="0123456789abcdef".split("");a.NJ=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var l;for(l=64;l<=b.length;l+=64){for(var n=b.substring(l-64,l),k=[],u=void 0,u=0;64>u;u+=4)k[u>>2]=n.charCodeAt(u)+(n.charCodeAt(u+1)<<8)+(n.charCodeAt(u+2)<<16)+(n.charCodeAt(u+3)<<24);m(a,k)}b=b.substring(l-64);n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(l=0;l<b.length;l++)n[l>>2]|=b.charCodeAt(l)<<(l%4<<3);n[l>>2]|=128<<(l%4<<3);if(55<l)for(m(a,n),l=0;16>l;l++)n[l]=0;n[14]=8*
c;m(a,n);for(b=0;b<a.length;b++){c=a[b];l="";for(n=0;4>n;n++)l+=q[c>>8*n+4&15]+q[c>>8*n&15];a[b]=l}return a.join("")}};b4w.module.controls=function(a,m){var l=m("__controls"),c=m("__print");a.tf=l.tf;a.kb=l.kb;a.ti=l.ti;a.Ne=l.Ne;a.sp=l.sp;a.Xx=l.Xx;a.e1=8;a.S1=9;a.n1=13;a.XO=16;a.i1=17;a.c1=18;a.L1=19;a.g1=20;a.p1=27;a.YO=32;a.QE=37;a.SE=38;a.RE=39;a.OE=40;a.T0=49;a.U0=50;a.V0=51;a.W0=52;a.X0=53;a.Y0=54;a.Z0=55;a.$0=56;a.a1=57;a.Wy=65;a.d1=66;a.NE=67;a.Xy=68;a.m1=69;a.PE=70;a.r1=71;a.t1=72;a.u1=73;a.w1=74;a.RO=75;a.SO=76;a.x1=77;a.z1=78;a.K1=79;a.UO=80;a.N1=81;a.VO=82;a.Yy=83;a.ZO=84;a.T1=85;a.U1=86;a.Zy=87;a.V1=
88;a.W1=89;a.X1=90;a.A1=96;a.B1=97;a.C1=98;a.D1=99;a.E1=100;a.F1=101;a.G1=102;a.H1=103;a.I1=104;a.J1=105;a.y1=106;a.b1=107;a.Q1=109;a.k1=110;a.l1=111;a.O1=186;a.o1=187;a.h1=188;a.j1=189;a.M1=190;a.q1=191;a.s1=192;a.TO=219;a.f1=220;a.WO=221;a.P1=222;a.At=l.At;a.zt=l.zt;a.yt=l.yt;a.cz=l.cz;a.uu=l.uu;a.vu=l.vu;a.ku=l.ku;a.wn=l.wn;a.hA=l.hA;a.Qb=l.Qb;a.gA=function(a,c,m){return l.gA(a,c||"ANY",m||!1)};a.iH=l.iH;a.tH=function(a,c,m,A,h,z,p){return l.tH(a,c,m,A||"ANY",h||!1,z||!1,p||!1)};a.Eq=l.Eq;a.kA=
l.kA;a.yn=l.yn;a.rH=l.rH;a.sH=l.sH;a.ou=l.ou;a.rA=l.rA;a.CH=l.CH;a.BH=l.BH;a.qH=l.qH;a.DH=l.DH;a.lH=l.lH;a.nH=l.nH;a.mH=l.mH;a.pH=l.pH;a.oH=l.oH;a.qA=function(a,c){return l.qA(a,c||!1)};a.CL=l.CL;a.Gl=l.Gl;a.AH=l.AH;a.mu=function(a,c){return l.mu(a,c||!1)};a.fA=function(a,c){return l.fA(a,c||0)};a.g8=function(a,c){l.BY(a,c)};a.M4=function(a){return a.value};a.Ff=l.Ff;a.Oh=l.Oh;a.T=function(a,c,m,A,h,z,p){h=h||l.uu;l.T(a,c,m,A,h,z,void 0===p?null:p)};a.xn=function(a,c,m,A,h){var z;A=l.Qb(A);l.T(a,
c,m,[A],l.uu,h,void 0===z?null:z)};a.f3=function(a){return l.Al(a,null)};a.Al=l.Al;a.Fm=l.Fm;a.reset=l.reset;a.H7=function(){c.O("controls.register_keyboard_events() deprecated")};a.I7=function(){c.O("controls.register_mouse_events() deprecated")};a.K7=function(){c.O("controls.register_wheel_events() deprecated")};a.J7=function(){c.O("controls.register_touch_events() deprecated")};a.G7=function(){c.O("controls.register_device_orientation() deprecated")};a.I9=function(){c.O("controls.unregister_keyboard_events() deprecated")};
a.J9=function(){c.O("controls.unregister_mouse_events() deprecated")};a.L9=function(){c.O("controls.unregister_wheel_events() deprecated")};a.K9=function(){c.O("controls.unregister_touch_events() deprecated")};a.H9=function(){c.O("controls.unregister_device_orientation() deprecated")};a.lD=l.lD};b4w.module.scenes=function(a,m){function l(){var a=x.Qi();return h.uo(a.clientWidth/2,a.clientHeight/2)}var c=m("__batch"),b=m("__camera"),x=m("__container"),q=m("__data"),A=m("__graph"),h=m("__objects"),z=m("__obj_util"),p=m("__print"),n=m("__scenes"),k=m("__subscene"),u=m("__util");a.nc=h.nc;a.Hw=function(a){var b=n.gr();n.Hw(u.Dd("name",a,b))};a.A=function(){return n.Ca()?n.A().name:""};a.G5=function(){for(var a=n.gr(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.Oi=function(){if(n.Ca())return n.Mh(n.A());
p.error("No active scene");return!1};a.lr=function(a){var b=h.wc(h.hy,a,0,!0);if(b)return b;p.error("get object "+a+": not found")};a.o5=function(a,b,c){if(a=h.wc(h.gy,a,b,c|0))return a;p.error("get object "+b+": not found")};a.p5=function(a,b){var c=h.wc(h.Pc,a,b|0);if(c)return c;p.error("get object "+a+": not found")};a.av=function(a,b){var c=h.av(a,b|0);if(c)return c;p.error("get object "+a+": not found")};a.fB=function(a){return z.fB(a)};a.uo=function(a,b){var c=n.Nh();return c?(c=n.La(c,k.wi))&&
c.enable_hmd_stereo?(p.O("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),l()):h.uo(a,b):(p.error("No active scene"),null)};a.B7=l;a.tC=function(a){return a&&a.k&&a.k.Wc};a.Go=function(a,b){a&&a.k&&a.k.Wc?h.Go(a,b):p.error("set_outline_intensity(): wrong object")};a.z5=function(a){if(a&&a.k&&a.k.Wc)return a.k.gh;p.error("get_outline_intensity(): wrong object")};a.pn=function(a,b,c,k){a&&a.k&&a.k.Wc?h.pn(a,b,c,k):p.error("apply_outline_anim(): wrong object")};
a.iR=function(a){if(a&&a.k&&a.k.Wc){var b=a.k.Xh;h.pn(a,b.qk,b.rk,b.tk)}else p.error("apply_outline_anim_def(): wrong object")};a.nq=function(a){a&&a.k&&a.k.Wc?h.nq(a):p.error("clear_outline_anim(): wrong object")};a.iM=n.iM;a.y5=function(a){var b=n.A();if(b=n.La(b,k.gn))return a=a||new Float32Array(3),a.set(b.ij),a};a.Mw=function(a){n.Ca()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),n.Mw(a)):p.error("No active scene")};a.H5=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A(),b=n.La(a,k.dd);if(!b)return null;var c=a.s.xd,h=n.La(a,k.Pb),l=n.La(a,k.wf),m={};m.csm_resolution=c.csm_resolution;m.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
l&&(m.self_shadow_normal_offset=l.self_shadow_normal_offset);m.enable_csm=c.enable_csm;m.csm_num=c.csm_num;m.csm_first_cascade_border=c.csm_first_cascade_border;m.first_cascade_blur_radius=c.first_cascade_blur_radius;m.csm_last_cascade_border=c.csm_last_cascade_border;m.last_cascade_blur_radius=c.last_cascade_blur_radius;m.fade_last_cascade=c.fade_last_cascade;m.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(m.csm_borders=n.oV(a,h.p),m.blur_radii=new Float32Array(c.csm_num),m.blur_radii.set(h.p.so.subarray(0,
c.csm_num))):(m.csm_borders=null,m.blur_radii=null);return m};a.J8=function(a){if(n.Ca()){var h=n.A();"number"==typeof a.self_shadow_polygon_offset&&A.pa(h.s.Wa,function(b,d){d.type==k.dd&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var l=n.La(h,k.wf);l&&("number"==typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius));var m=n.La(h,k.Qc);m&&("number"==typeof a.self_shadow_normal_offset&&
(m.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(m.pcf_blur_radius=a.pcf_blur_radius),m.Aa=!0);m=h.s.xd;"number"==typeof a.csm_first_cascade_border&&(m.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(m.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(m.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(m.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(l){for(var q=l.Qa,u=0;u<q.length;u++)for(var x=q[u].sa,E=0;E<x.length;E++){var I=x[E];if(I.gf.fe){var B=I.za;c.bG(B,m);c.Yc(B);k.Tc(l,I)}}l.Aa=!0}l=z.ka(h.Cj,h).da;for(u=0;u<l.length;u++)b.gE(l[u],m);n.cD(h)}else p.error("No active scene")};a.NI=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.NI(a)};a.Kw=function(a,b,c){if(n.Ca()){var h=n.A(),l=n.La(h,k.Pb);n.Kw(h,a||0==a?parseFloat(a):l.Pg,b||0==b?b:l.je,c||0==c?c:l.te)}else p.error("No active scene")};
a.TI=function(a){if(!n.Ca())return p.error("No active scene"),!1;var b=n.A();return n.TI(b,a)};a.hD=function(a){if(n.Ca()){var b=n.A();n.hD(b,a)}else p.error("No active scene")};a.X4=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A(),b={};b.Zq=n.xV(a);b.fog_depth=n.vV(a);b.fog_start=n.yV(a);b.fog_height=n.wV(a);return b};a.m8=function(a){if(n.Ca()){var b=n.A();"number"==typeof a.Zq&&n.aM(b,a.Zq);"number"==typeof a.fog_depth&&n.ZL(b,a.fog_depth);"number"==typeof a.fog_start&&n.bM(b,
a.fog_start);"number"==typeof a.fog_height&&n.$L(b,a.fog_height)}else p.error("No active scene")};a.sJ=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.sJ(a)};a.oM=function(a){if(n.Ca()){var b=n.A();n.oM(b,a)}else p.error("No active scene")};a.H4=function(){if(!n.Ca())return p.error("No active scene"),null;var a=n.A(),a=n.La(a,k.Vx);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.f8=
function(a){if(n.Ca()){var b=n.A();if(b=n.La(b,k.Vx))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Aa=!0}else p.error("No active scene")};a.qJ=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.qJ(a)};a.mM=function(a){if(n.Ca()){var b=n.A();n.mM(b,a)}else p.error("No active scene")};a.KI=function(){if(!n.Ca())return p.error("No active scene"),
!1;var a=n.A();return n.La(a,k.wp)?n.KI(a):null};a.XL=function(a){if(n.Ca()){var b=n.A();n.XL(b,a)}else p.error("No active scene")};a.WI=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.La(a,k.Bj)?n.WI(a):null};a.dM=function(a){if(n.Ca()){var b=n.A();n.dM(b,a)}else p.error("No active scene")};a.CI=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.La(a,k.qp)?n.CI(a):null};a.NL=function(a){if(n.Ca()){var b=n.A();n.NL(b,a)}else p.error("No active scene")};
a.VI=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.La(a,k.yp)?n.VI(a):null};a.cM=function(a){if(n.Ca()){var b=n.A();n.cM(b,a)}else p.error("No active scene")};a.FJ=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.FJ(a)};a.tM=function(a){if(n.Ca()){var b=n.A();h.tM(b,a)}else p.error("No active scene")};a.CJ=function(a,b){if(!n.Ca())return p.error("No active scene"),0;var c=n.A();return c.s.Nc?n.CJ(c,a,b):(p.error("No water parameters on the active scene"),
0)};a.sM=function(a){if(n.Ca()){var b=n.A();n.sM(b,a)}else p.error("No active scene")};a.BJ=function(a){if(n.Ca()){var b=n.A();n.BJ(b,a)}else p.error("No active scene")};a.O9=function(){if(n.Ca()){var a=n.A();n.IN(a)}else p.error("No active scene")};a.w6=function(a,b){b=b||!1;!z.$d(a)&&!z.Xn(a)||z.Ra(a)?b?n.lq(a,!0):n.IG(a,!0):p.error("show/hide is only supported for dynamic objects.")};a.a9=function(a,b){b=b||!1;!z.$d(a)&&!z.Xn(a)||z.Ra(a)?b?n.lq(a,!1):n.IG(a,!1):p.error("show/hide is only supported for dynamic objects.")};
a.FB=function(a){if(z.sW(a)||z.Xn(a)||z.Xg(a))return n.FB(a);p.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.co=function(a){return a.k.co};a.a3=function(a){p.Rb("scenes.check_object","scenes.check_object_by_name");return n.Ca()?h.CX(a,n.A()):(p.error("No active scene"),!1)};a.d3=function(a,b){return h.wc(h.hy,a,b|0,!0)?!0:!1};a.b3=function(a,b,c){return h.wc(h.gy,a,b,c|0)?!0:!1};a.c3=function(a,b){return h.wc(h.Pc,a,b|0)?!0:!1};a.Pi=function(a,b){var c=n.A();
a||(a="ALL");b||0===b||(b=h.nc);return h.nJ(c,a,b)};a.u5=function(a){return a?a.wm:(p.error("Wrong object name"),"")};a.v5=function(a){if(!a)return p.error("Wrong object name"),null;for(var b=[];a;)b.push(a.wm),a=z.Ri(a);return b.reverse()};a.w5=function(a){return a&&a.type?a.type:(p.error("Wrong object"),"UNDEFINED")};a.s5=function(a){p.Rb("scenes.get_object_dg_parent","objects.get_dg_parent");return z.Ri(a)};a.r5=function(a){return a.Ue.slice(0)};a.jr=function(){return h.jr(n.A())};a.pJ=function(a,
b){b||0===b||(b=1);if(!n.Ca())return p.error("No active scene"),!1;var c=n.A();return n.pJ(c,a,b)};a.EI=function(){return n.EI()};a.Q5=function(a){return z.$d(a)?a.k.type:null};a.Tu=function(){if(!n.Ca())return p.error("No active scene"),!1;var a=n.A();return n.Tu(a)};a.on=function(a,b){if(a.k.zv){if(b)var c=n.gr(),c=u.Dd("name",b,c);else c=n.A();n.on(c,a,!0)}else p.error('object "'+a.name+'" has been created not by coping.')};a.ls=function(a){(z.$d(a)||z.Xn(a))&&z.Ra(a)?(h.fw(a,a.k.Av,!1,!1),q.WX(a),
h.fw(a,!0,!0,!0),h.ls(a)):p.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.zK=function(a){var b=n.A();if(b.timeline_markers&&a in b.timeline_markers)return n.zK(b,a);p.error('"'+a+'" marker not found.');return 0};a.l5=function(){var a=n.A();return(a=n.La(a,k.vh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.w8=function(a){var b=n.A();(b=n.La(b,k.vh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):p.error("The motion blur subscene doesn't exist.")};a.N2=function(){var a=n.A();return Boolean(n.La(a,k.sf))}};b4w.module.container=function(a,m){var l=m("__container"),c=m("__print");a.Qi=l.Qi;a.FI=l.FI;a.af=l.af;a.xv=function(a,m){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&m&&l.xv(a,m)};a.PL=l.PL;a.CN=l.CN;a.oq=l.oq;a.SA=l.SA;a.resize=function(a,m,q){a&&m||c.warn("Wrong canvas container dimensions: "+a+"x"+m+". Zero dimensions aren't allowed. Resized to: "+l.Zx+"x"+l.Yx+".");l.resize(a,m,q)};a.Bk=function(a){l.Bk(a||!1)}};b4w.module.physics=function(a,m){function l(a,b,c,l){return q.eU(a,l[c[0]],l[c[1]],l[c[2]])}function c(a,b,c,l,k){b=Math.abs(a[2]-b[2]);return b<k&&A.AW(a,c,l)?b:Number.MAX_VALUE}m("__config");var b=m("__physics"),x=m("__print"),q=m("__util"),A=m("__navmesh");m("__vec3");new Float32Array(3);a.EE=0;a.pO=1;a.B0=2;a.DE=3;a.XH=function(a){b.oa(a)?b.XH(a):x.O("No physics for object "+a.name)};a.FA=function(a){b.oa(a)?b.FA(a):x.O("No physics for object "+a.name)};a.p6=function(a){return b.oa(a)};a.rB=function(a){return b.rB(a)};
a.KJ=function(a){return b.KJ(a)};a.eM=function(a,c){b.oa(a)?b.eM(a,c):x.O("No physics for object "+a.name)};a.xs=function(a,c,l){b.oa(a)?b.xs(a,c,l):x.O("No physics for object "+a.name)};a.H=function(a){b.oa(a)?b.H(a):x.O("No physics for object "+a.name)};a.ZF=function(a,c,l,m){b.oa(a)?b.ZF(a,c,l,m):x.O("No physics for object "+a.name)};a.$F=function(a,c,l,m){b.oa(a)?b.$F(a,c,l,m):x.O("No physics for object "+a.name)};a.uz=function(a,c,l,m){b.oa(a)?b.uz(a,c,l,m,!1):x.O("No physics for object "+a.name)};
a.w2=function(a,c,l,m){b.oa(a)?b.uz(a,c,l,m,!0):x.O("No physics for object "+a.name)};a.YF=function(a,c,l,m){b.oa(a)?b.YF(a,c,l,m):x.O("No physics for object "+a.name)};a.kp=function(a,c){b.oa(a)?(b.cf(a)||b.df(a)||x.error("Wrong object"),b.kp(a,q.W(c,-1,1))):x.O("No physics for object "+a.name)};a.T9=function(a,c,l){if(b.oa(a)){b.cf(a)||b.df(a)||x.error("Wrong object");c=q.W(c,0,1);var m=a.v.Hn;-1==l||1==l?m=Math.max(-1,Math.min(m+l*c,1)):0==l&&0<=m?(m-=c,m=Math.max(0,m)):0==l&&0>m?(m+=c,m=Math.min(0,
m)):x.error("Wrong steering direction");b.kp(a,q.W(m,-1,1))}else x.O("No physics for object "+a.name)};a.jp=function(a,c){b.oa(a)?(b.cf(a)||b.df(a)||x.error("Wrong object"),b.jp(a,q.W(c,-1,1))):x.O("No physics for object "+a.name)};a.S9=function(a,c,l){if(b.oa(a)){b.cf(a)||b.df(a)||x.error("Wrong object");c=q.W(c,0,1);var m=a.v.Uo;-1==l||1==l?m=Math.max(-1,Math.min(m+l*c,1)):0==l&&0<=m?(m-=c,m=Math.max(0,m)):0==l&&0>m?(m+=c,m=Math.min(0,m)):x.error("Wrong steering direction");b.jp(a,q.W(m,-1,1))}else x.O("No physics for object "+
a.name)};a.nE=function(a,c){b.oa(a)?(b.cf(a)||b.df(a)||x.error("Wrong object"),b.nE(a,q.W(c,0,1))):x.O("No physics for object "+a.name)};a.R9=function(a,c){if(b.oa(a)){b.cf(a)||b.df(a)||x.error("Wrong object");c=q.W(c,-1,1);var l=a.v.fq;b.nE(a,q.W(l+l*c,0,1))}else x.O("No physics for object "+a.name)};a.cf=function(a){return b.cf(a)};a.df=function(a){return b.df(a)};a.V5=function(a){if(!b.oa(a))return x.O("No physics for object "+a.name),null;if(b.cf(a)||b.df(a))return a.nf.name;x.error("Wrong object");
return null};a.X5=function(a){if(!b.oa(a))return x.O("No physics for object "+a.name),null;if(b.cf(a)||b.df(a))return a.v.Hn;x.error("Wrong object");return null};a.W5=function(a){if(!b.oa(a))return x.O("No physics for object "+a.name),null;if(b.cf(a)||b.df(a))return a.v.Uo;x.error("Wrong object")};a.U5=function(a){if(!b.oa(a))return x.O("No physics for object "+a.name),null;if(b.cf(a)||b.df(a))return a.v.fq;x.error("Wrong object")};a.xJ=function(a){if(!b.oa(a))return x.O("No physics for object "+
a.name),null;if(b.cf(a)||b.df(a))return b.xJ(a);x.error("Wrong object")};a.fg=function(a){return b.fg(a)};a.Jw=function(a,c,l){b.oa(a)?b.Jw(a,c,l):x.O("No physics for object "+a.name)};a.Eo=function(a,c){b.oa(a)?b.Eo(a,c):x.O("No physics for object "+a.name)};a.UL=function(a,c){b.oa(a)?b.UL(a,c):x.O("No physics for object "+a.name)};a.TL=function(a,c){b.oa(a)?b.TL(a,c):x.O("No physics for object "+a.name)};a.QL=function(a,c){b.oa(a)?b.QL(a,c):x.O("No physics for object "+a.name)};a.Oz=function(a){b.oa(a)?
b.Oz(a):x.O("No physics for object "+a.name)};a.JG=function(a,c,l){b.oa(a)?b.JG(a,c,l):x.O("No physics for object "+a.name)};a.us=function(a,c,l){b.oa(a)?b.us(a,c,l):x.O("No physics for object "+a.name)};a.SL=function(a,c){b.oa(a)?b.SL(a,c):x.O("No physics for object "+a.name)};a.RL=function(a,c){b.oa(a)?b.RL(a,c):x.O("No physics for object "+a.name)};a.qz=function(a,c,l,m){b.oa(a)?b.qz(a,c||"ANY",l,m||!1):x.O("No physics for object "+a.name)};a.QC=function(a,c,l){b.oa(a)?b.QC(a,c||"ANY",l):x.O("No physics for object "+
a.name)};a.tz=function(a,c){b.oa(a)?b.tz(a,c):x.O("No physics for object "+a.name)};a.Tz=function(a){b.oa(a)?b.Tz(a):x.O("No physics for object "+a.name)};a.Pt=function(a,c,l,m,k,q){a=a||null;if(null==a||b.oa(a))return b.Pt(a,c,l,m||"ANY",k,q||!1,!1,!1,!1);x.O("No physics for object "+a.name)};a.p2=function(a,c,l,m,k,q,e,y,A){a=a||null;if(null==a||b.oa(a))return b.Pt(a,c,l,m||"ANY",k,q||!1,e||!1,y||!1,A||!1);x.O("No physics for object "+a.name)};a.RC=function(a){b.eK(a)?b.RC(a):x.error("Wrong ray test ID")};
a.HG=function(a,c,l){b.eK(a)?b.HG(a,c,l):x.error("Wrong ray test ID")};a.UF=function(a,c,l,m,k,q,e,y,A,F){b.oa(c)&&b.oa(k)?b.UF(a,c,l,m,k,q,e,y,A,F):x.error("Wrong objects")};a.XG=function(a){b.oa(a)&&b.WV(a)?b.XG(a):x.error("Wrong object")};a.nL=function(a,c,l,m,k,q){b.oa(a)&&b.oa(m)?b.nL(a,c,l,m,k,q):x.error("Wrong objects")};a.JK=function(a,c,m){m||(m=l);if(b.oa(a)){var n=a.C.Or;return n?A.JK(n,c,m):(x.error(a.name+" is not a navigation mesh object"),null)}x.O("No physics for object "+a.name)};
a.IK=function(a,m,p,n){if(b.oa(a)){var k=a.C.Or;if(!k)return x.error(a.name+" is not a navigation mesh object"),null;n=n||{};a={};a.do_not_pull_string=Boolean(n.do_not_pull_string);a.distance_to_closest=n.distance_to_closest||l;a.distance_to_farthest=n.distance_to_farthest||c;a.island=n.island||0;a.allowed_distance=n.allowed_distance||Number.MAX_VALUE;a.return_normals=n.return_normals||!1;return A.IK(k,m,p,a)}x.O("No physics for object "+a.name)}};b4w.module.animation=function(a,m){var l=m("__animation"),c=m("__armature"),b=m("__obj_util"),x=m("__print"),q=m("__tsr");a.pd=l.pd;a.kF=l.kF;a.lF=l.lF;a.mF=l.mF;a.nF=l.nF;a.oF=l.oF;a.pF=l.pF;a.Bt=l.Bt;a.il=l.il;a.bF=l.bF;a.az=l.az;a.bz=l.bz;a.eF=l.eF;a.dF=l.dF;a.cF=l.cF;a.aF=l.aF;a.wE=l.wE;a.xE=l.xE;a.Nx=l.Nx;var A=q.create();a.Dc=function(a){return l.Dc(a)};a.xI=function(a){return l.UK(a)?l.xI(a):[]};a.L4=function(a,b){if(!l.Dc(a))return null;b=b||l.pd;return l.jV(a,b)};a.apply=function(a,b,c){if(c>
l.Bt)x.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||l.pd;if(l.Dc(a)){var m=l.Yu(a,b);if(-1!=m&&m!=c){x.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+m+'").');return}}l.VN(a,b)?l.apply(a,null,b,c):x.error('No fcurves in action "'+b+'"')}};a.u2=function(a,b,c){if(c>l.Bt)x.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=
c||l.pd;var m=b[0];if(l.Dc(a)){var k=l.Yu(a,m);if(-1!=k&&k!=c){x.error('Animation "'+m+'" is already applied to object "'+a.name+'" (slot "'+k+'").');return}}l.VN(a,m)?l.apply(a,b.slice(1),m,c):x.error('No fcurves in action "'+m+'"')}};a.remove=function(a){l.remove(a)};a.yL=function(a,b){l.Dc(a)&&(b=b||l.pd,l.yL(a,b))};a.Qt=function(a){l.Qt(a)};a.play=function(a,b,c){l.Dc(a)?(c=c||l.pd,l.play(a,b,c),l.K_(a,0,c,!0)):x.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){l.Dc(a)&&
(b=b||l.pd,l.stop(a,b))};a.Wi=function(a,b){if(!l.Dc(a))return!1;b=b||l.pd;return l.Wi(a,b)};a.Fo=function(a,b,c){l.Dc(a)&&(c=c||l.pd,l.Fo(a,b,c))};a.gD=function(a,b){l.Dc(a)&&l.gD(a,b)};a.q8=function(a,b){if(l.Dc(a)){b=b||l.pd;var c=l.YA(a,b),m=l.XA(a,b);l.Fo(a,c+m-l.$O,b)}};a.kr=function(a,b){if(!l.Dc(a))return 0;b=b||l.pd;return l.JI(a,b)};a.nM=function(a,b,c){l.Dc(a)&&(c=c||l.pd,l.nM(a,b||1,c))};a.rJ=function(a,b){if(!l.Dc(a))return 0;b=b||l.pd;return a.ia[b]?l.rJ(a,b):0};a.YA=function(a,b){return l.Dc(a)&&
(b=b||l.pd,a.ia[b])?l.YA(a,b):-1};a.XA=function(a,b){return l.Dc(a)&&(b=b||l.pd,a.ia[b])?l.XA(a,b):-1};a.ts=function(a,b,c){l.Dc(a)&&(c=c||l.pd,l.ts(a,b,c))};a.BI=function(a,b){if(!l.Dc(a))return null;b=b||l.pd;return l.BI(a,b)};a.WF=function(a,b,c,m){m=m||l.pd;l.Dc(a)&&l.WF(a,b,c,m)};a.iI=function(a){return l.iI(a)};a.A4=function(a,l,m){x.Rb("get_bone_translation","armature.get_bone_tsr");if(!b.im(a))return null;if(!c.gS(a,l))return x.error('There is no bone: "',l,'" in "',a.name,'".'),null;m||(m=
new Float32Array(3));c.Qu(a,l,!1,A);m[0]=A[0];m[1]=A[1];m[2]=A[2];return m};a.U4=function(){x.O("get_first_armature_object() deprecated");return null};a.Yu=function(a,b){return l.Dc(a)&&b?l.Yu(a,b):-1};a.yI=function(a,b){return l.Dc(a)?l.yI(a,b):null};a.XF=function(a,b){return l.XF(a,b)};a.K5=function(a){return a.k.Bh};a.lM=function(a,c,m){b.im(a)?(c=Math.min(Math.max(c,0),1),a.k.Bh!=c&&l.lM(a,c,m||0)):x.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.sfx=function(a,m){var l=m("__obj_util"),c=m("__scenes"),b=m("__sfx"),x=m("__print");a.play=function(a,c,h){b.play(a,c||0,h||0)};a.sw=function(a){b.sw(a)};a.Wi=function(a){return b.Ev(a)};a.Ev=function(a){return b.Ev(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.EZ(a)};a.ci=function(a){b.GZ(a)};a.xK=function(a,c,h){b.xK(a,c||0,h||!1)};a.BC=function(a,c){b.BC(a,c)};a.eJ=function(a){return b.eJ(a)};a.Sd=function(a,c){b.Sd(a,c)};a.EB=function(a){return b.EB(a)};a.a7=function(){b.ho()};
a.ho=function(){b.ho()};a.e9=function(a){b.AD(a)};a.AD=function(a){b.AD(a)};a.AJ=function(a){return a&&"object"===typeof a?b.AJ(a):b.IV()};a.rD=function(a,c){a&&"object"===typeof a?b.rD(a,c):b.XY(c)};a.ec=function(a,c){a&&"object"===typeof a?b.ec(a,c):b.wX(c)};a.dK=function(a){return a&&"object"===typeof a?b.dK(a):b.yW()};a.jB=function(){return b.jB().slice(0)};a.LG=b.LG;a.VL=function(a){b.VL(c.A(),a)};a.II=function(){return b.II(c.A())};a.UH=function(a,c,h){a&&"object"===typeof a?b.UH(a,c,h):b.iU(c,
h)};a.AN=function(a){a&&"object"===typeof a?b.AN(a):b.o_()};a.VF=b.VF;a.ZG=b.ZG;a.yu=b.yu;a.CA=b.CA;a.kM=b.kM;a.fJ=b.fJ;a.YL=b.YL;a.RI=b.RI;a.QI=b.QI;a.LI=function(a){if(a&&l.$n(a))return b.LI(a);x.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.time=function(a,m){var l=m("__time");a.Sw=l.Sw;a.un=l.un;a.cm=l.cm;a.Fj=l.Fj;a.tn=l.tn};b4w.module.transform=function(a,m){var l=m("__obj_util"),c=m("__physics"),b=m("__print"),x=m("__quat"),q=m("__transform"),A=m("__tsr"),h=m("__util"),z=A.create(),p=new Float32Array(3),n=new Float32Array(4);a.mn=q.mn;a.qF=q.qF;a.Gc=function(a,h,e,m){l.Ra(a)?(p[0]=h,p[1]=e,p[2]=m,q.Gc(a,p),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Tw=function(a,h,e,m){l.Ra(a)?(p[0]=h,p[1]=e,p[2]=m,q.Tw(a,p),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.gZ=function(a,
h){l.Ra(a)?(q.Gc(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.N8=function(a,h){l.Ra(a)?(q.Tw(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.M8=function(a,m,e,n,x){l.Ra(a)?(p[0]=m,p[1]=e,p[2]=n,m=A.F(x.k.n),x=A.N(x.k.n),h.Hc(p,1,x,m,p),q.Gc(a,p),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Zd=function(a,b){b||(b=new Float32Array(3));q.Zd(a,b);return b};a.vJ=function(a,b){b||(b=new Float32Array(3));q.vJ(a,b);return b};
a.ei=function(a,h,e,m,p){l.Ra(a)?(n[0]=h,n[1]=e,n[2]=m,n[3]=p,q.ei(a,n),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Rw=function(a,h,e,m,p){l.Ra(a)?(n[0]=h,n[1]=e,n[2]=m,n[3]=p,q.Rw(a,n),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.I8=function(a,h){l.Ra(a)?(q.ei(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.H8=function(a,h){l.Ra(a)?(q.Rw(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.bm=
function(a,b){b||(b=new Float32Array(4));q.bm(a,b);return b};a.kJ=function(a,b){b||(b=new Float32Array(4));q.kJ(a,b);return b};a.Qw=function(a,h,e,m){l.Ra(a)?(p[0]=h,p[1]=e,p[2]=m,q.Qw(a,p),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.iJ=function(a,b){b||(b=new Float32Array(3));q.iJ(a,b);return b};a.jJ=function(a,b){b||(b=new Float32Array(3));q.jJ(a,b);return b};a.nD=function(a,h,e,m){l.Ra(a)?(p[0]=h,p[1]=e,p[2]=m,q.nD(a,p),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.G8=function(a,h){l.Ra(a)?(q.Qw(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.F8=function(a,h){l.Ra(a)?(q.nD(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Fe=function(a,c){l.Ra(a)?(q.Fe(a,c),q.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.oD=function(a,c){l.Ra(a)?(q.oD(a,c),q.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.td=function(a){return q.td(a)};a.mJ=function(a){return q.mJ(a)};
a.P3=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var h=0;h<a.Ue.length;h++)if(!l.Ra(a.Ue[h])){b.error('Wrong object: "'+a.Ue[h].name+'" is not dynamic.');return}q.Gc(a,[0,0,0]);q.ei(a,[0,0,0,1]);q.Fe(a,1);q.D(a);c.H(a)}};a.Vu=function(a){return l.$d(a)?q.Vu(a):(b.error("Wrong object: "+a.name),0)};a.Uu=function(a,c,e){if(!l.$d(a))return b.error("Wrong object: "+a.name),null;e||(e=new Float32Array(3));return q.Uu(a,c,e)};a.dh=function(a,h,e,m){l.Ra(a)?(q.dh(a,h,e,m),q.D(a),
c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.V7=function(a,m){if(l.Ra(a)){var e=x.setAxisAngle(h.ri,m,n);q.$C(a,e);q.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.W7=function(a,m){if(l.Ra(a)){var e=x.setAxisAngle(h.el,m,n);q.$C(a,e);q.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.X7=function(a,m){if(l.Ra(a)){var e=x.setAxisAngle(h.Oc,m,n);q.$C(a,e);q.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.cJ=function(a){return q.cJ(a)};a.fi=function(a,h){l.Ra(a)?(q.fi(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Uw=function(a,h){l.Ra(a)?(q.Uw(a,h),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.nr=function(a,b){b||(b=new Float32Array(8));q.nr(a,b);return b};a.or=function(a,b){b||(b=new Float32Array(8));q.or(a,b);return b};a.distance=function(a,b){return q.distance(a,b)};a.t8=function(a,h){l.Ra(a)?(A.Tg(h,z),q.fi(a,z),q.D(a),c.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.u8=function(a,h){l.Ra(a)?(A.Tg(h,z),q.Uw(a,z),q.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.j5=function(a,b){b||(b=new Float32Array(16));q.nr(a,z);A.nx(z,b);return b};a.k5=function(a,b){b||(b=new Float32Array(16));q.or(a,z);A.nx(z,b);return b}};b4w.module.util=function(a,m){var l=m("__compat"),c=m("__obj_util"),b=m("__print"),x=m("__quat"),q=m("__util"),A=m("__vec3"),h=new Float32Array(6);a.ri=new Float32Array([1,0,0]);a.zj=new Float32Array([0,1,0]);a.Oc=new Float32Array([0,0,1]);a.Sx=new Float32Array([-1,0,0]);a.el=new Float32Array([0,-1,0]);a.ad=new Float32Array([0,0,-1]);a.sF=q.sF;a.zF=q.zF;a.AF=q.AF;a.uF=q.uF;a.wF=q.wF;a.CF=q.CF;a.tF=q.tF;a.yF=q.yF;a.iz=q.iz;a.vF=q.vF;a.xF=q.xF;a.BF=q.BF;a.Cf=function(a){return q.Cf(a||0)};a.assert=
q.assert;a.nK=q.nK;a.Dd=q.Dd;a.UB=function(a){return q.UB(a)};a.Wj=function(a,b){b||(b=new Float32Array(4));return q.Wj(a,b)};a.pC=function(a,b,c){c||(c=x.create());return q.pC(a,b,c)};a.rL=function(a,b,c){c||(c=A.create());return q.rL(a,b,c)};a.yw=function(a,b){b||(b=new Float32Array(3));return q.yw(a,b)};a.sign=q.sign;a.W=q.W;a.pc=q.pc;a.h6=function(a,b){return q.JC(a,q.ad,q.Oc,q.zj,b)};a.Lz=function(a,b){return q.Lz(a,b)};a.JC=function(a,c,h,k,l){return 0!=A.dot(h,k)?(b.error("Wrong in-plane direction"),
null):q.JC(a,c,h,k,l)};a.MJ=q.MJ;a.mc=q.mc;a.ex=q.ex;a.ik=q.ik;a.dA=q.dA;a.qL=q.qL;a.tL=q.tL;a.PJ=q.PJ;a.PB=function(a,c,l,k,m){b.Rb("util.line_plane_intersect","math.line_plane_intersect");h[0]=l[0];h[1]=l[1];h[2]=l[2];h[3]=k[0];h[4]=k[1];h[5]=k[2];return q.PB(a,c,h,m)};a.$d=function(a){b.Rb("util.is_mesh","objects.is_mesh");return c.$d(a)};a.im=function(a){b.Rb("util.is_armature","objects.is_armature");return c.im(a)};a.yi=q.yi;a.Dg=q.Dg;a.Lm=q.Lm;a.lerp=q.lerp;a.Cb=q.Cb;a.ne=q.ne;a.DA=q.DA;a.Br=
l.Br;a.fr=q.fr};b4w.module.constraints=function(a,m){var l=m("__camera"),c=m("__constraints"),b=m("__obj_util"),x=m("__physics"),q=m("__print"),A=m("__transform");a.SF=function(a,b,l){var m;m=m||1;b instanceof Array&&2==b.length?c.YQ(a,b[0],b[1],l,m):c.TF(a,b,l,void 0,m);A.D(a);x.H(a)};a.UQ=function(a,b){c.WQ(a,b);A.D(a);x.H(a)};a.q2=function(a,b,m,n,k,u,e,y){l.xc(a)?(k=k||-Math.PI/2,u=u||Math.PI/2,e=e||Math.PI/2,y=y||-Math.PI/2,c.VQ(a,b,m,n,k,u,e,y),A.D(a),x.H(a)):q.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.SQ=function(a,b){var m,n=[0,0,0];if(l.xc(a)){if(!m||0>m)m=.25;c.TQ(a,b,n,m);A.D(a);x.H(a)}else q.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.rz=function(a,b,l){c.$Q(a,b,l);A.D(a);x.H(a)};a.QF=function(a,b,l){c.MQ(a,b,l);A.D(a);x.H(a)};a.r2=function(a,b,l,m){c.aR(a,b,l,m);A.D(a);x.H(a)};a.s2=function(a,b){3==b.length?c.dR(a,b):c.cR(a,b);A.D(a);x.H(a)};a.o2=function(a,b,l,m){3==b.length?c.PQ(a,b,l,m):c.OQ(a,b,l,m);A.D(a);x.H(a)};a.sz=function(a,
b,l){c.sz(a,b,l);A.D(a);x.H(a)};a.remove=function(a){a.oc&&c.remove(a)};a.dJ=function(a){q.Rb("constraints.get_parent","objects.get_parent");return b.dJ(a)}};b4w.module.mouse=function(a,m){function l(){1==d&&(d=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);k.Fm(y.Oi(),"SMOOTH_PL")}function c(a){2==d&&(d=0);a.removeEventListener("mousedown",x,!1);a.removeEventListener("mouseup",q,!1);a.removeEventListener("mousemove",b,!1);k.Fm(y.Oi(),"SMOOTH_DRAG")}function b(a){B()&&(E[0]+=2*(a.clientX-D),E[1]+=2*(a.clientY-R),D=a.clientX,R=a.clientY);a.preventDefault()}function x(a){D=
a.clientX;R=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function q(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function A(a,b,d,c){if(.01<Math.abs(E[0])||.01<Math.abs(E[1]))b=k.Ff(a,b,0),a=K.mc(E[0],0,b,.1*J),b=K.mc(E[1],0,b,.1*J),E[0]-=a,E[1]-=b,c(4E-4*-a,4E-4*-b)}function h(a,b){var d=y.jr(),c=y.Oi();p.Jn(c,a,b);d&&(c=p.hr(c,I),u.us(d,c[0],c[1]))}function z(a){a=n.oq(a.clientX,a.clientY,I);(a=y.uo(a[0],a[1]))?(y.tC(a)&&y.Go(a,1),
y.tC(P)&&a!=P&&y.Go(P,0)):y.tC(P)&&y.Go(P,0);P=a}var p=m("camera"),n=m("container"),k=m("controls"),u=m("physics"),e=m("print"),y=m("scenes"),K=m("util"),F=m("main"),J=1,D=0,R=0,E=new Float32Array(2),I=new Float32Array(2),B=null,P=null,d=0;a.qY=function(a){var b,g,l,m,n;function p(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",l,!1);var e=y.Oi();if(!k.Al(e,"SMOOTH_PL")){var h=k.Gl();k.T(e,"SMOOTH_PL",
k.kb,[h],null,A,n)}b()}else a.removeEventListener("mousemove",l,!1),d=0,document.removeEventListener("pointerlockchange",p,!1),document.removeEventListener("webkitpointerlockchange",p,!1),document.removeEventListener("mozpointerlockchange",p,!1),g()}if(1!=d){d=1;b=b||function(){};g=g||function(){};n=n||h;m=m||function(){return!0};l=l||function(a){if(m()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):
"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;E[0]+=b;E[1]+=a}};document.addEventListener("pointerlockchange",p,!1);document.addEventListener("webkitpointerlockchange",p,!1);document.addEventListener("mozpointerlockchange",p,!1);var q=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof q?q.apply(a):e.error("Pointer lock is not available")}};a.d4=l;a.e3=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||
a.mozRequestPointerLock)?!0:!1};a.S7=function(a,b,c){2!=d&&(d=2,l(),B=b||function(){return!0},c=c||h,a.addEventListener("mousedown",x,!1),a.addEventListener("mouseup",q,!1),a=y.Oi(),k.Al(a,"SMOOTH_DRAG")||(b=k.Gl(),k.T(a,"SMOOTH_DRAG",k.kb,[b],null,A,c)))};a.c4=c;a.U3=function(){F.Cn()||n.Qi().addEventListener("mousemove",z)};a.K3=function(){F.Cn()||(n.Qi().removeEventListener("mousemove",z),P&&y.Go(P,0))};a.J4=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in
c[0]?c[0].clientX:-1};a.K4=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.lD=function(a){J=a};a.E5=function(){return J}};b4w.module.camera=function(a,m){function l(a,b){p.Rb("camera.set_pivot","camera.target_set_trans_pivot");c.Ea(a)?(y.copy(b,a.k.pivot),k.D(a),z.H(a)):p.error("set_pivot(): Wrong object or camera move style")}var c=m("__camera");m("__config");var b=m("__constraints"),x=m("__container"),q=m("__mat4"),A=m("__math"),h=m("__obj_util"),z=m("__physics"),p=m("__print"),n=m("__scenes"),k=m("__transform"),u=m("__tsr"),e=m("__util"),y=m("__vec3"),K=m("__vec4"),F=m("__quat"),J=new Float32Array(2),D=new Float32Array(3),
R=new Float32Array(3),E=new Float32Array(4),I=F.create();new Float32Array(9);var B={},P={};a.zg=c.zg;a.Kb=c.Kb;a.od=c.od;a.cd=c.cd;a.n9=function(a,b){if(h.xa(a)){c.$s(a);a.k.vb=c.zg;if(b){var e=b.pos||u.F(a.k.n);b.look_at?c.Pw(a,e,b.look_at):k.Gc(a,e)}k.D(a);z.H(a);c.Wn(a)}else p.error("static_setup(): Wrong camera object")};a.l9=function(a,b,e){c.ao(a)?(b=b||u.F(a.k.n),e?c.Pw(a,b,e):k.Gc(a,b),k.D(a),z.H(a)):p.error("static_set_look_at(): Wrong camera object or camera move style")};a.m9=function(a,
b){c.ao(a)?(k.ei(a,b),k.D(a),z.H(a)):p.error("static_set_rotation(): Wrong camera object or camera move style")};a.k9=function(a,b){if(!c.ao(a))return p.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return k.bm(a,b)};a.j4=function(a,b){if(h.xa(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right))p.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=
typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))p.error("eye_setup(): Wrong vertical limits object.");else{c.$s(a);a.k.vb=c.od;if(b){var e=b.pos||u.F(a.k.n);c.vM(a,e,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}k.D(a);z.H(a);c.Wn(a)}else p.error("eye_setup(): Wrong camera object")};a.i4=function(a,e,h){c.xc(a)?(e=e||u.F(a.k.n),h?c.WY(a,e,h):k.Gc(a,e),b.Rj(a,a.k.of,!0),k.D(a),z.H(a)):p.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Jn=function(a,b,e){var g,h;c.xc(a)?
(c.ms(a,b,e,g||!1,h||!1),k.D(a),z.H(a)):p.error("eye_rotate(): Wrong camera object or camera move style")};a.CU=function(a,b){c.xc(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.rM(a,b),k.D(a),z.H(a)):p.error("eye_set_vertical_limits(): Incorrect limits object."):p.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.h4=function(a,b,e){if(!c.xc(a))return p.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.la?(b=b||
{},e?(b.down=a.la.Fn,b.up=a.la.fp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=e||!1,b):null};a.BU=function(a,b){c.xc(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.gM(a,b),k.D(a),z.H(a)):p.error("eye_set_horizontal_limits(): Incorrect limits object."):p.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.g4=function(a,b,e){if(!c.xc(a))return p.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.mb?(b=b||
{},e?(b.left=a.mb.fo,b.right=a.mb.Co):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=e||!1,b):null};a.x9=function(a,b){if(h.xa(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){p.error("target_setup(): Wrong distance limits object");return}b.dist_lim.min=
Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Zr&&("number"!=typeof b.Zr.min_y||"number"!=typeof b.Zr.max_y||b.Zr.min_y>b.Zr.max_y))p.error("target_setup(): Wrong pivot limits object");else{c.$s(a);a.k.vb=c.Kb;var e=b.pos||u.F(a.k.n);c.xM(a,e,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Zr,b.use_panning||!1);k.D(a);z.H(a);c.Wn(a)}}else p.error("target_setup(): Wrong vertical limits object");else p.error("target_setup(): Wrong horizontal limits object");else p.error("target_setup(): Wrong camera object")};
a.Is=function(a,b,e){var g,h;c.Ea(a)?(c.Cw(a,b,e,g||!1,h||!1),k.D(a),z.H(a)):p.error("target_rotate(): Wrong camera object or camera move style")};a.w9=function(a,b,e){c.Ea(a)?(b=b||u.F(a.k.n),e=e||a.k.pivot,c.ws(a,b,e),k.D(a),z.H(a)):p.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.v9=function(a,b){c.Ea(a)?(c.eZ(a,b),k.D(a),z.H(a)):p.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.$Z=function(a,b){if(c.Ea(a)){var e=k.po(a,a.k.pivot),
g=Math.max(0,b);k.dh(a,0,0,g-e);k.D(a);z.H(a)}else p.error("target_set_distance(): Wrong camera object or camera move style")};a.ND=function(a){return c.Ea(a)?k.po(a,a.k.pivot):(p.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.z9=function(a,b){if(c.Ea(a)){var e=k.Uu(b,!1,D),g=k.Vu(b),l=n.A(),l=h.ka(a,l).da[0],l=c.wI(l)/2,g=g/Math.sin(l),l=k.po(a,e);c.ws(a,u.F(a.k.n),e);k.D(a);k.dh(a,0,0,g-l);k.D(a);z.H(a)}else p.error("target_zoom_object(): Wrong camera object or camera move style")};
a.YZ=function(a,b){if(!c.Ea(a))return p.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);y.copy(a.k.pivot,b);return b};a.iN=function(a,b){if(c.Ea(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){p.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}c.KY(a,b);k.D(a);z.H(a)}else p.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.q9=
function(a,b){if(!c.Ea(a))return p.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.tb?(b=b||{},b.min=e.tb.min,b.max=e.tb.max,b):null};a.b_=function(a,b){c.Ea(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.rM(a,b),k.D(a),z.H(a)):p.error("target_set_vertical_limits(): Wrong limits object"):p.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.t9=function(a,b,e){if(!c.Ea(a))return p.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.la?(b=b||{},e?(b.down=a.la.Fn,b.up=a.la.fp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=e||!1,b):null};a.a_=function(a,b){c.Ea(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.gM(a,b),k.D(a),z.H(a)):p.error("target_set_horizontal_limits(): Wrong limits object"):p.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.r9=function(a,b,e){if(!c.Ea(a))return p.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.mb?(b=b||{},e?(b.left=a.mb.fo,b.right=a.mb.Co):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=e||!1,b):null};a.u9=function(a,b){c.Ea(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?p.error("target_set_pivot_limits(): Wrong limits object"):(c.aZ(a,b),k.D(a),z.H(a)):p.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.s9=function(a,b){if(!c.Ea(a))return p.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var e=a.k;return e.ce?(b=b||{},b.min_z=e.ce.min_z,b.max_z=e.ce.max_z,b):null};a.ZZ=function(a,b,e){if(c.Ea(a)){var g=a.k;g.use_panning&&(D[0]=b,D[1]=-e,D[2]=0,u.Xc(D,g.n,D),y.add(g.pivot,D,g.pivot),b=u.F(g.n),y.add(b,D,b),k.D(a),z.H(a))}else p.error("target_pan_pivot(): wrong object")};a.y9=function(a,b){if(!c.Ea(a))return p.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.C6=function(b,f){a.dW(b,{pos:f.pos,pivot:f.pivot});var h="undefined"==
typeof f.dist_interval?0:Math.max(f.dist_interval,0),g="undefined"==typeof f.angle_interval?0:Math.max(f.angle_interval,0),l="undefined"==typeof f.t?.5:e.W(f.t,0,1),m=a.QJ(b,B);m.min=Math.max(m.min-l*h,0);m.max+=(1-l)*h;h=a.RJ(b,P);h.down=e.W(h.down+l*g,-Math.PI/2,0);h.up=e.W(h.up-(1-l)*g,-Math.PI/2,0);c.qv(b,m);c.rv(b,h);k.D(b);z.H(b);c.Wn(b)};a.dW=function(a,b){if(h.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){p.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up))p.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))p.error("hover_setup(): Wrong horizontal translation limits object");
else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))p.error("hover_setup(): Wrong vertical translation limits object");else{c.$s(a);a.k.vb=c.cd;var e=b.pos||u.F(a.k.n);c.wM(a,e,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);k.D(a);z.H(a);c.Wn(a)}}else p.error("hover_setup(): Wrong camera object")};a.SJ=function(a,b,e){var g,h;c.$a(a)?(c.ns(a,b,e,g||!1,h||
!1),k.D(a),z.H(a)):p.error("hover_rotate(): Wrong camera object or camera move style")};a.B6=function(a,b){c.$a(a)?(c.Nw(a,b),k.D(a),z.H(a)):p.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.z6=function(a,b){if(!c.$a(a))return p.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);y.copy(a.k.Wb,b);return b};a.aW=function(a){return c.$a(a)?k.po(a,a.k.Wb):(p.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.rv=function(a,b){c.$a(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?p.error("hover_set_vertical_limits(): Wrong limits object"):(c.rv(a,b),k.D(a),z.H(a)):p.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.RJ=function(a,b){if(!c.$a(a))return p.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var e=a.k;b=b||{};b.down=e.la.down;b.up=e.la.up;return b};a.qv=function(a,b){c.$a(a)?"number"!=typeof b.min||"number"!=
typeof b.max||b.min>b.max?p.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),c.qv(a,b),k.D(a),z.H(a)):p.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.QJ=function(a,b){if(!c.$a(a))return p.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var e=a.k;b=b||{};b.min=e.tb.min;b.max=e.tb.max;return b};a.cW=function(a,b){c.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max)?p.error("hover_set_vert_trans_limits(): Wrong limits object"):(c.jZ(a,b),k.D(a),z.H(a)):p.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.A6=function(a,b){if(!c.$a(a))return p.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.Cc?(b=b||{},b.min=e.Cc.min,b.max=e.Cc.max,b):null};a.bW=function(a,b){c.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?p.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(c.QY(a,b),k.D(a),z.H(a)):p.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.y6=function(a,b){if(!c.$a(a))return p.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.Bc?(b=b||{},b.min=e.Bc.min,b.max=e.Bc.max,b):null};a.D6=function(a,b){if(!c.$a(a))return p.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Jh=b};a.ao=c.ao;a.Ea=c.Ea;a.xc=c.xc;a.$a=c.$a;a.jD=function(a,b){if(!h.xa(a))return p.error("set_move_style(): Wrong camera object"),
!1;if(b!=c.zg&&b!=c.od&&b!=c.Kb&&b!=c.cd)return p.error("set_move_style(): Wrong move style"),!1;c.jD(a,b);k.D(a);z.H(a);return!0};a.am=function(a){return h.xa(a)?c.am(a):(p.error("get_move_style(): Wrong camera object"),null)};a.Gc=function(a,b){if(h.xa(a)){var e=a.k;if(c.Ea(a)){var g=u.F(e.n),g=y.subtract(b,g,D);y.add(g,e.pivot,e.pivot)}else c.$a(a)&&(g=u.F(e.n),g=y.subtract(b,g,D),y.add(g,e.Wb,e.Wb));k.Gc(a,b);k.D(a);z.H(a)}else p.error("set_translation(): Wrong camera object")};a.Zd=function(a,
b){if(!h.xa(a))return p.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return k.Zd(a,b)};a.U7=function(a,b,e,g,l){h.xa(a)?(g=g||!1,l=l||!1,c.Ea(a)?c.Cw(a,b,e,g,l):c.xc(a)?c.ms(a,b,e,g,l):c.$a(a)?c.ns(a,b,e,g,l):c.ao(a)?p.warn("rotate_camera(): not supported for STATIC cameras"):p.error("rotate_camera(): Wrong camera move style"),k.D(a),z.H(a)):p.error("rotate_camera(): Wrong camera object")};a.hZ=function(a,b){if(h.xa(a)){var c=a.k;"number"==typeof b.trans&&(c.Yk=e.W(b.trans,
0,Infinity));"number"==typeof b.rot&&(c.Xk=e.W(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Zk=e.W(b.zoom,0,.99))}else p.error("set_velocities(): Wrong camera object")};a.Ph=function(a,b){if(!h.xa(a))return p.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.Yk;b.rot=c.Xk;b.zoom=c.Zk;return b};a.S6=function(a){if(!h.xa(a))return p.error("is_look_up(): Wrong camera object"),!1;a=u.N(a.k.n);return 0<=e.pc(a,e.ad,D)[1]};a.Qn=function(a,b){if(!h.xa(a))return p.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);c.Qn(a,b);return b};a.hr=function(a,b){if(!h.xa(a))return p.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);c.hr(a,b);return b};a.C4=function(a,b){b=b||new Float32Array(2);var h=y.normalize(a,D),h=e.aD(e.ad,h,I);e.dA(h,!0);c.$A(h,b);return b};a.pM=function(a,b){if(h.xa(a))for(var e=n.A(),e=h.ka(a,e).da,g=0;g<e.length;g++){var k=e[g];k.type!=c.Rc&&k.type!=c.ed&&k.type!=c.Qe&&k.type!=c.Re||c.dZ(k,b,k.lf)}else p.error("set_stereo_distance(): Wrong camera object")};
a.tJ=function(a){if(!h.xa(a))return p.error("get_stereo_distance(): Wrong camera object"),0;var b=n.A();a=h.ka(a,b).da;for(b=0;b<a.length;b++){var e=a[b];if(e.type==c.Rc||e.type==c.ed)return e.Lk}return 0};a.eD=function(a,b){if(h.xa(a)){var e=n.A(),e=h.ka(a,e).da;c.eD(e,b)}else p.error("set_eye_distance(): Wrong camera object")};a.S4=function(a){if(!h.xa(a))return p.error("get_eye_distance(): Wrong camera object"),0;var b=n.A();a=h.ka(a,b).da;for(b=0;b<a.length;b++){var e=a[b];if(e.type==c.Rc||e.type==
c.ed||e.type==c.Qe||e.type==c.Re)return e.lf}return 0};a.P8=function(a,b){h.xa(a)?(y.copy(b,a.k.of),k.D(a),z.H(a)):p.error("set_vertical_axis(): Wrong camera object")};a.Z5=function(a,b){if(h.xa(a))return b||(b=y.create()),y.copy(a.k.of,b),b;p.error("get_vertical_axis(): Wrong camera object")};a.E9=function(a,b,e,g){if(h.xa(a)){var k=n.A();a=h.ka(a,k).da;for(k=0;k<a.length;k++){var l=a[k];l.qc||c.Gk(l,l.Ab);var m=D;m[0]=-b;m[1]=-e;m[2]=0;q.translate(l.xb,m,l.xb);q.rotateZ(l.xb,g,l.xb);c.BG(l);c.Jz(l)}}else p.error("translate_view(): Wrong camera object")};
a.c6=function(a,b){if(!h.xa(a))return p.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=u.N(a.k.n);e.pc(c,e.ad,b);return b};a.zV=function(a){if(!h.xa(a))return p.error("get_fov(): Wrong camera object"),0;var b=n.A();a=h.ka(a,b).da;return e.Cb(a[0].Wd)};a.n8=function(a,b){if(h.xa(a))for(var k=n.A(),k=h.ka(a,k).da,g=0;g<k.length;g++){var l=k[g];l.Wd=e.ne(b);l.qc||c.Gk(l,l.Ab);c.BG(l);c.Jz(l)}else p.error("set_fov(): Wrong camera object")};a.iD=function(a,b,e){var g;
if(!(g=h.xa(a)))a:{if(h.xa(a)){g=n.A();g=h.ka(a,g).da;for(var k=0;k<g.length;k++){var l=g[k];if(l.type==c.Qe||l.type==c.Re){g=!0;break a}}}else p.error("is_hmd_camera(): Wrong camera object");g=!1}g?b&&e&&c.iD(a,b,e):p.error("set_hmd_fov(): Wrong camera object")};a.Rj=function(a,c,e){h.xa(a)?(c=c||a.k.of,b.Rj(a,c,e||!1),k.D(a),z.H(a)):p.error("correct_up(): Wrong camera object")};a.B8=function(a,b){if(h.xa(a)&&c.Dv(a)){var e=a.k;if(c.Ea(a)){var g=u.F(e.n),g=y.dist(g,e.pivot);e.dk=b/2*e.ck/g}else c.$a(a)?
(g=u.F(e.n),g=y.distance(g,e.Wb),e.dk=b/2*e.ck/g):(e=n.A(),h.ka(a,e).da[0].top=b/2);c.N_(a)}else p.error("set_ortho_scale(): Wrong camera object")};a.x5=function(a){if(!h.xa(a)||!c.Dv(a))return p.error("get_ortho_scale(): Wrong camera object"),0;var b=n.A();return 2*h.ka(a,b).da[0].top};a.Dv=function(a){return h.xa(a)?c.Dv(a):(p.error("is_ortho_camera(): Wrong camera object"),!1)};a.L2=function(a,b,l,g){if(!h.xa(a))return p.error("calc_ray(): Wrong camera object"),null;var m=n.A(),q=h.ka(a,m).da[0];
g&&3==g.length?p.O('dest parameter in the function "calc_ray" should be type of parametric line.'):g=g||new Float32Array(6);switch(q.type){case c.Od:case c.yh:case c.Rc:case c.ed:var z=Math.tan(q.Wd*Math.PI/360),B=z*q.Ab,m=D;b=x.cu(b,l,J,q);m[0]=(2*b[0]/q.width-1)*B;m[1]=(1-2*b[1]/q.height)*z;m[2]=-1;u.Xc(m,a.k.n,m);y.normalize(m,m);3==g.length?y.copy(m,g):(a=k.Zd(a,R),A.jM(g,a),A.kD(g,m));return g;case c.we:return m=D,b=x.cu(b,l,J,q),m[0]=(2*b[0]/q.width-1)*q.top*q.Ab,m[1]=(1-2*b[1]/q.height)*q.top,
m[2]=0,u.Hc(m,a.k.n,m),y.copy(m,g),a=u.N(a.k.n,E),y.transformQuat(e.ad,a,m),A.kD(g,m),g;default:return p.error("calc_ray(): Non-compatible camera"),g}};a.GC=function(a,b,e){if(!h.xa(a))return p.error("project_point(): Wrong camera object"),null;e=e||new Float32Array(2);return c.GC(a,b,e)};a.i6=function(a){return(c.Ea(a)||c.$a(a))&&null!==a.k.tb};a.s6=function(a){return(c.xc(a)||c.Ea(a)||c.$a(a))&&null!==a.k.la};a.r6=function(a){p.Rb("has_vertical_limits","has_vertical_rot_limits");return c.Ea(a)||
c.xc(a)?null!==a.k.la:(p.error("has_vertical_limits(): Wrong camera object"),!1)};a.l6=function(a){return(c.Ea(a)||c.xc(a))&&null!==a.k.mb};a.k6=function(a){p.Rb("has_horizontal_limits","has_horizontal_rot_limits");return c.Ea(a)||c.xc(a)?null!==a.k.mb:(p.error("has_horizontal_limits(): Wrong camera object"),!1)};a.t6=function(a){return c.$a(a)&&null!==a.k.Cc};a.m6=function(a){return c.$a(a)&&null!==a.k.Bc};a.j7=function(a,b,e){p.Rb("move_pivot","target_pan_pivot");if(c.Ea(a)){var g=a.k;if(g.use_panning){var h=
u.F(g.n),l=y.subtract(h,g.pivot,R);D[0]=b;D[1]=0;D[2]=e;y.scale(D,y.len(l),D);u.Xc(D,g.n,D);y.add(g.pivot,D,g.pivot);y.add(h,D,h);k.D(a);z.H(a)}}else p.error("move_pivot(): wrong object")};a.O8=function(a,b){p.Rb("set_velocity_params","set_velocities");if(h.xa(a)){var c=a.k;c.Yk=e.W(b[0],0,Infinity);c.Xk=e.W(b[1],0,Infinity);c.Zk=e.W(b[2],0,.99)}else p.error("set_velocity_params(): Wrong camera object")};a.Y5=function(a,b){p.Rb("get_velocity_params","get_velocities");if(!h.xa(a))return p.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.Yk;b[1]=c.Xk;b[2]=c.Zk;return b};a.k3=function(a){p.O('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');h.xa(a)?c.Ea(a)||c.xc(a)?a.k.mb=null:c.$a(a)&&(a.k.Bc=null):p.error("clear_horizontal_limits(): Wrong camera object")};a.n3=function(a){p.O('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
h.xa(a)?c.Ea(a)||c.xc(a)?a.k.la=null:c.$a(a)&&(a.k.Cc=null):p.error("clear_vertical_limits(): Wrong camera object")};a.l3=function(){p.O("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.Pw=function(a,e,h,g){p.Kh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);g=g||a.k.of;c.Pw(a,e,h);b.Rj(a,g,!0);k.D(a);z.H(a)};a.ms=function(a,b,e,g,h){p.Kh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);c.xc(a)?(c.ms(a,
b,e,g,h),k.D(a),z.H(a)):p.error("rotate_eye_camera(): wrong object")};a.Cw=function(a,b,e,g,h){p.Kh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);c.Ea(a)?(c.Cw(a,b,e,g,h),k.D(a),z.H(a)):p.error("rotate_target_camera(): wrong object")};a.ws=function(a,b,e){p.Rb("camera.set_trans_pivot","camera.target_set_trans_pivot");c.Ea(a)?(c.ws(a,b,e),k.D(a),z.H(a)):p.error("set_trans_pivot(): Wrong object or camera move style")};a.X9=function(a,b){p.Rb("camera.zoom_object","camera.target_zoom_object");
if(c.Ea(a)){k.Uu(b,!1,D);l(a,D);k.D(a);var e=k.Vu(b),g=n.A(),g=h.ka(a,g).da[0],g=c.wI(g)/2,e=e/Math.sin(g),g=k.po(a,D);k.dh(a,0,0,e-g);k.D(a);z.H(a)}else p.error("zoom_object(): wrong object")};a.C8=l;a.ns=function(a,b,e,g,h){p.Rb("camera.rotate_hover_camera","camera.hover_rotate");c.$a(a)?(c.ns(a,b,e,g,h),k.D(a),z.H(a)):p.error("rotate_hover_camera(): wrong object")};a.d5=function(a,b){p.Rb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!c.$a(a))return p.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));y.copy(a.k.Wb,b);return b};a.OI=function(a,b){p.Rb("camera.get_eye","camera.get_translation");return h.xa(a)?c.OI(a,b):(p.error("get_eye(): Wrong object"),null)};a.B5=function(a,b){p.Rb("camera.get_pivot","camera.target_get_pivot");if(!c.Ea(a))return p.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));y.copy(a.k.pivot,b);return b};a.x6=function(a,b){p.Rb("camera.hover_cam_set_translation","camera.set_translation");if(c.$a(a)){var e=
a.k,g=u.F(e.n),g=y.subtract(b,g,D);y.add(g,e.Wb,e.Wb);k.Gc(a,b);k.D(a);z.H(a)}else p.error("hover_cam_set_translation(): wrong object")};a.Nw=function(a,b){p.Rb("camera.set_hover_pivot","camera.hover_set_pivot_translation");c.$a(a)?(c.Nw(a,b),k.D(a),z.H(a)):p.error("set_hover_pivot(): Wrong object or camera move style")};a.c5=function(a,b){p.Rb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!c.$a(a))return p.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.la.down;b[1]=a.k.la.up;return b};a.B4=function(a,b){p.Kh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!c.$a(a)&&!c.Ea(a))return p.error("get_cam_dist_limits(): wrong object"),null;if(a.k.tb)b=b||new Float32Array(2),b[0]=a.k.tb.max,b[1]=a.k.tb.min;else return null;return b};a.z2=function(b,e,h,g){p.Kh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(c.Ea(b)){var l=B;l.down=e;l.up=h;l.camera_space=g==k.mn;a.b_(b,l)}else c.xc(b)?(l=B,l.down=e,l.up=h,l.camera_space=g==k.mn,a.CU(b,l)):c.$a(b)?(l=B,l.min=e,l.max=h,a.cW(b,l)):p.error("apply_vertical_limits(): wrong object")};a.y2=function(b,c,e){p.Rb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");B.down=c;B.up=e;a.rv(b,B)};a.t2=function(b,e,h){p.Kh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(c.Ea(b)){var g=B;
g.min=e;g.max=h;a.iN(b,g)}else c.$a(b)?(g=B,g.min=e,g.max=h,a.qv(b,g)):p.error("apply_distance_limits(): wrong object")};a.i3=function(b){p.Rb("camera.clear_distance_limits","camera.target_set_distance_limits");a.iN(b,null)};a.a6=function(a,b){p.Kh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!c.Ea(a)&&!c.xc(a)&&!c.$a(a))return p.error("get_vertical_limits(): wrong object"),null;var e=a.k;b=b||new Float32Array(2);
if(c.xc(a)||c.Ea(a)){if(e.la)return b[0]=e.la.down,b[1]=e.la.up,b}else if(c.$a(a)&&e.Cc)return b[0]=e.Cc.min,b[1]=e.Cc.max,b;return null};a.x2=function(b,e,h,g){p.Kh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(c.Ea(b)){var l=B;l.left=e;l.right=h;l.camera_space=g==k.mn;a.a_(b,l)}else c.xc(b)?(l=B,l.left=e,l.right=h,l.camera_space=g==k.mn,a.BU(b,l)):c.$a(b)?(l=B,l.min=e,l.max=h,a.bW(b,l)):p.error("apply_horizontal_limits(): wrong object")};
a.b5=function(a,b){p.Kh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!c.Ea(a)&&!c.xc(a)&&!c.$a(a))return p.error("get_horizontal_limits(): wrong object"),null;var e=a.k;b=b||new Float32Array(2);if(c.xc(a)||c.Ea(a)){if(e.mb)return b[0]=e.mb.left,b[1]=e.mb.right,b}else if(c.$a(a)&&e.Bc)return b[0]=e.Bc.min,b[1]=e.Bc.max,b;return null};a.a5=function(a,b){if(!h.xa(a))return p.error("get_frustum_planes(): Wrong camera object"),
null;var c=n.A(),c=h.ka(a,c).da[0].Lh;K.copy(c.left,b.left);K.copy(c.right,b.right);K.copy(c.top,b.top);K.copy(c.bottom,b.bottom);K.copy(c.near,b.near);K.copy(c.far,b.far);return b}};b4w.module.tsr=function(a,m){function l(a,b,c,m){m||(m=x.create());l(a,b,c,m);return m}var c=m("__mat4"),b=m("__print"),x=m("__tsr");a.create=x.create;a.kI=x.kI;a.copy=x.copy;a.identity=x.identity;a.z3=function(a,c,h,m){b.Rb("create_sep","set_sep");return l(a,c,h,m)};a.sg=x.sg;a.pe=x.pe;a.Fe=x.Fe;a.pD=x.pD;a.di=x.di;a.F=x.F;a.td=x.td;a.N=x.N;a.invert=x.invert;a.nx=function(a,b){b||(b=c.create());x.nx(a,b);return b};a.Tg=x.Tg;a.multiply=x.multiply;a.Hc=x.Hc;a.wN=x.wN;a.Pk=x.Pk;a.cE=x.cE;a.Xc=x.Xc;
a.dE=x.dE;a.translate=x.translate;a.xr=function(a,b,c,l){l||(l=x.create());x.xr(a,b,c,l);return l}};b4w.module.app=function(a,m){function l(){var a=r.Cr();document.addEventListener("visibilitychange",function(){document.hidden?(a=r.Cr(),r.pause()):a||r.ci()},!1)}function c(){var a=0,b=I.af(),c=r.Cr(),d=!0;r.Rp(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=r.Cr()),r.pause(),d=!1):c||d||(r.ci(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);f||(Q.error('Warning: canvas container "'+a+'" not found, appending to body'),
f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!r.Vg(e,a))return c&&F("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
d),!1;a&&I.xv(a,"LAST");return!0}function x(a,b){a?(b&&(document.getElementById(b).style.display="block"),S=document.getElementById(a)):(S=document.createElement("div"),S.innerHTML=0,S.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",I.xv(S,"JUST_AFTER_CANVAS"))}function q(a,b){var c=String(a);b&&(c+="/"+String(b));S.innerHTML=c}function A(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function h(a,b,c){var d=Math.max(D.aW(a),1),e=aa.bm(a,v);b=M.pc(e,b,V);b[2]=0;G.normalize(b,b);G.scale(b,d*c,b);c=aa.Zd(a,ga);G.add(c,b,c);D.Gc(a,c)}function z(a,b){var c=D.RJ(a,ea);if(c.up!=c.down){var d=D.Qn(a,O)[1],c=(c.down-d)/(c.down-c.up),d=D.QJ(a,ea),c=Math.max(c,2/d.max);D.SJ(a,0,c*b)}}function p(a,b,c,d){aa.dh(a,5*b,5*c,5*d)}function n(a,b,c){var d=D.ND(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));aa.dh(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function k(a,b,c,d){for(var e=
c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function u(a,b,c,d,e){e?(e=D.YZ(a,V),a=D.Zd(a),a=G.dist(e,a)+d,d=0<b?k(b,-c,a,d):k(-b,c/(1-c),a,d)):d-=2*b*c;return d}function e(a,b,c,d,e){function k(a,b,c,d){if(1==c){D.Ph(a,P);var e=Q?.003*P.trans:.003*P.rot;c=B.Ff(a,b,0);B.Oh(a,b,0).gesture===B.At?(Ja+="X"==d?-c*e:0,eb+="Y"==d?-c*e:0):B.Oh(a,b,0).gesture===B.yt&&(a=Q?.003*P.rot:7.5E-4*P.trans,ob+="X"==d?-c*a:0,$a+="Y"==d?-c*a:0)}}function l(a){D.Ph(a,P);hb-=.05*P.zoom}function m(a){D.Ph(a,P);za-=.002*P.trans}
function q(a){D.Ph(a,P);hb+=.05*P.zoom}function r(a){D.Ph(a,P);za+=.002*P.trans}function v(a,b,c,d){if(1==c){c=B.Ff(a,b,1);D.Ph(a,P);if(Q)e=.003*P.trans,f=7.5E-4*P.rot;else var e=.003*P.rot,f=7.5E-4*P.trans;if(1===B.Oh(a,b,0).which)Ia+="X"==d?-c*e:0,Ra+="Y"==d?-c*e:0;else if(2===B.Oh(a,b,0).which||3===B.Oh(a,b,0).which)vb+="X"==d?-c*f:0,Ta+="Y"==d?-c*f:0}}function x(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function A(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function C(a){return a[0]&&(a[1]||-.1>a[2])}
function F(a){return a[0]&&(a[1]||.1<a[2])}function K(a){return a[0]&&(a[1]||a[2]||a[3])}function I(a,b,c){if(1==c)switch(c=B.Ff(a,b,0),D.Ph(a,P),b){case "FORWARD":S?wa[0]=1:Q?(b=D.Qn(a,O)[1],b=Math.abs(b)>=Math.PI/4?M.zj:M.ad,h(a,b,.5*P.trans*c)):R?n(a,-P.zoom,c):p(a,0,0,-P.trans*c);break;case "BACKWARD":S?wa[0]=-1:Q?(b=D.Qn(a,O)[1],b=Math.abs(b)>=Math.PI/4?M.el:M.Oc,h(a,b,.5*P.trans*c)):R?n(a,P.zoom,c):p(a,0,0,P.trans*c);break;case "UP":Q?z(a,30*-P.zoom*c):S||p(a,0,P.trans*c,0);break;case "DOWN":Q?
z(a,30*P.zoom*c):S||p(a,0,-P.trans*c,0);break;case "LEFT":S?wa[1]=1:Q?h(a,M.Sx,.5*P.trans*c):p(a,-P.trans*c,0,0);break;case "RIGHT":S?wa[1]=-1:Q?h(a,M.ri,.5*P.trans*c):p(a,P.trans*c,0,0);break;case "ROT_LEFT":R?D.Is(a,.75*-P.rot*c,0):D.Jn(a,.75*P.rot*c,0);break;case "ROT_RIGHT":R?D.Is(a,.75*P.rot*c,0):D.Jn(a,.75*-P.rot*c,0);break;case "ROT_UP":R?D.Is(a,0,.75*-P.rot*c):D.Jn(a,0,.75*P.rot*c);break;case "ROT_DOWN":R?D.Is(a,0,.75*P.rot*c):D.Jn(a,0,.75*-P.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":S&&
(wa[0]=0);break;case "LEFT":case "RIGHT":S&&(wa[1]=0)}S&&(g.Jw(S,wa[0],wa[1]),a=D.hr(a,W),g.us(S,a[0],a[1]))}X=a;H=b;ma=c;var J=t.Oi();y(J);var R=!1,S=null,Q=!1;switch(D.am(J)){case D.Kb:R=!a;break;case D.od:S=t.jr();break;case D.zg:return;case D.cd:Q=!0}var P=D.Ph(J,ba);a=B.Gl();if(g.rB(J)){var ea=B.gA(J,null,!0);B.T(J,"CAMERA_COLLISION",B.tf,[ea],null,function(a,b){var c=B.Oh(a,b,0).coll_dist;if(0>c){var d=B.Oh(a,b,0).coll_norm,e=V;G.scale(d,-.25*c,e);c=aa.Zd(a,ga);G.add(c,e,c);aa.gZ(a,c)}})}if(S){var ea=
aa.Zd(J),ua=aa.bm(J),ua=M.Lz(ua);ea[2]-=.5;g.xs(S,ea,ua);E.rz(J,S,[0,0,.5]);var wa=new Float32Array(2),Pa=!0;g.Eo(S,g.DE);B.xn(J,"TOGGLE_CHAR_MOVE_TYPE",B.Ne,B.NE,function(){Pa=!Pa;g.Eo(S,Pa?g.DE:g.EE)})}var Ga=f.mS(),ea=Ga.length?Ga[Ga.length-1]:0,Qa,Aa,w,Za,ub,Fa,Ec,Na,da,Da;b?Qa=Aa=w=Za=ub=Fa=b=ea=Ec=Na=da=Da=B.hA(0):(Qa=B.Qb(B.Zy),Aa=B.Qb(B.Yy),w=B.Qb(B.Wy),Za=B.Qb(B.Xy),ub=B.Qb(B.VO),Fa=B.Qb(B.PE),b=B.ku(f.pt,ea),ea=B.ku(f.qt,ea),Ec=B.Qb(B.SE),Na=B.Qb(B.OE),da=B.Qb(B.QE),Da=B.Qb(B.RE));var ua=
B.wn(f.lt,Ga),ra=B.wn(f.mt,Ga),U=B.wn(f.nt,Ga),Ga=B.wn(f.ot,Ga);Q||(B.T(J,"FORWARD",B.kb,[a,Qa,ra],C,I),B.T(J,"BACKWARD",B.kb,[a,Aa,ra],F,I));R?(B.T(J,"ROT_UP",B.kb,[a,Ec,ub,Ga],x,I),B.T(J,"ROT_DOWN",B.kb,[a,Na,Fa,Ga],A,I),B.T(J,"ROT_LEFT",B.kb,[a,da,w,U],x,I),B.T(J,"ROT_RIGHT",B.kb,[a,Da,Za,U],A,I)):Q?(B.T(J,"LEFT",B.kb,[a,da,w,ua],x,I),B.T(J,"RIGHT",B.kb,[a,Da,Za,ua],A,I),B.T(J,"FORWARD",B.kb,[a,Ec,Qa,ra],x,I),B.T(J,"BACKWARD",B.kb,[a,Na,Aa,ra],A,I),B.T(J,"UP",B.kb,[a,Fa,Ga],F,I),B.T(J,"DOWN",B.kb,
[a,ub,Ga],C,I)):(B.T(J,"UP",B.kb,[a,ub,b],K,I),B.T(J,"DOWN",B.kb,[a,Fa,ea],K,I),B.T(J,"LEFT",B.kb,[a,w,ua],C,I),B.T(J,"RIGHT",B.kb,[a,Za,ua],F,I),B.T(J,"ROT_UP",B.kb,[a,Ec,Ga],C,I),B.T(J,"ROT_DOWN",B.kb,[a,Na,Ga],F,I),B.T(J,"ROT_LEFT",B.kb,[a,da,U],C,I),B.T(J,"ROT_RIGHT",B.kb,[a,Da,U],F,I));if(!c){var La=0;c=B.kA(d);var sa=0,Ga=B.rA(d);B.T(J,"MOUSE_WHEEL",B.sp,[c],null,function(a,b,c){1==c&&(b=B.Ff(a,b,0),D.Ph(a,P),R||Q?La=u(a,b,P.zoom,La,R):(P.trans*=1+b*P.zoom,D.hZ(a,P)))});B.T(J,"TOUCH_ZOOM",B.sp,
[Ga],null,function(a,b,c){1==c&&(c=B.Ff(a,b,0),D.Ph(a,P),B.Oh(a,b,0)===B.zt&&(sa=u(a,c,.03*P.zoom,sa,R)))});B.T(J,"ZOOM_INTERPOL",B.tf,[a],null,function(a,b){if(R||Q)if(1E-5<Math.abs(La)||1E-5<Math.abs(sa)){var c=B.Ff(a,b,0),d=M.mc(La,0,c,.1*T);La-=d;c=M.mc(sa,0,c,.15*T);sa-=c;Q?z(a,-(d+c)):(d=D.ND(a)+d+c,d=Math.max(d,.001),D.$Z(a,d))}else sa=La=0})}var Ia=0,Ra=0,vb=0,Ta=0,za=0,hb=0;R?(B.T(J,"GMPD_PAN_Y_POS",B.kb,[b],null,q),B.T(J,"GMPD_PAN_Y_NEG",B.kb,[ea],null,l),B.T(J,"GMPD_PAN_X_POS",B.kb,[ua],
function(a){return-.1>a[0]},m),B.T(J,"GMPD_PAN_X_NEG",B.kb,[ua],function(a){return.1<a[0]},r)):Q&&(B.T(J,"GMPD_PAN_X_POS",B.kb,[U],function(a){return-.1>a[0]},m),B.T(J,"GMPD_PAN_X_NEG",B.kb,[U],function(a){return.1<a[0]},r));if(e){e=B.yn("X",window);c=B.yn("Y",window);b=B.Eq(d);var ea=B.Eq(window),Va=!1,ua=function(a){a[2]?Va=!0:a[0]||(Va=!1);return Va&&a[0]};B.T(J,"MOUSE_X",B.tf,[ea,e,b],ua,v,"X");B.T(J,"MOUSE_Y",B.tf,[ea,c,b],ua,v,"Y");e=f.ja(f.bd,window);f.LD(e,!1)}else e=B.yn("X",d),c=B.yn("Y",
d),b=B.Eq(d),B.T(J,"MOUSE_X",B.tf,[b,e],null,v,"X"),B.T(J,"MOUSE_Y",B.tf,[b,c],null,v,"Y");var Ja=0,eb=0,ob=0,$a=0;e=B.ou("X",d);d=B.ou("Y",d);B.T(J,"TOUCH_X",B.tf,[e],null,k,"X");B.T(J,"TOUCH_Y",B.tf,[d],null,k,"Y");B.T(J,"ROT_TRANS_INTERPOL",B.tf,[a],null,function(a,b){if(1E-5<Math.abs(Ia)||1E-5<Math.abs(Ra)||1E-5<Math.abs(Ja)||1E-5<Math.abs(eb)||1E-5<Math.abs(vb)||1E-5<Math.abs(Ta)||1E-5<Math.abs(ob)||1E-5<Math.abs($a)||1E-5<Math.abs(za)||1E-5<Math.abs(hb)){var c=B.Ff(a,b,0),d=M.mc(Ia,0,c,.08*
T),e=M.mc(Ra,0,c,.08*T);Ia-=d;Ra-=e;var f=M.mc(Ja,0,c,.12*T),k=M.mc(eb,0,c,.12*T);Ja-=f;eb-=k;var l=M.mc(vb,0,c,.08*T),m=M.mc(Ta,0,c,.08*T);vb-=l;Ta-=m;var n=M.mc(ob,0,c,.12*T),p=M.mc($a,0,c,.12*T);ob-=n;$a-=p;var q=M.mc(za,0,c,.08*T),c=M.mc(hb,0,c,.08*T);za-=q;hb-=c;R?(D.Is(a,d+f,e+k),e=D.ND(a),D.ZZ(a,e*(l+n+q),e*(m+p+c))):Q?(d+f&&h(a,M.ri,.2*(d+f)),e+k&&(m=D.Qn(a,O)[1],h(a,Math.abs(m)>Math.PI/4?M.el:M.Oc,.2*(e+k))),D.SJ(a,l+n+q,0)):(D.Jn(a,.5*(d+f),.5*(e+k)),S&&(l=D.hr(a,W),g.us(S,l[0],l[1])))}});
B.xn(J,"DEC_STEREO_DIST",B.Ne,B.TO,function(a){var b=D.tJ(a);D.pM(a,.9*b)});B.xn(J,"INC_STEREO_DIST",B.Ne,B.WO,function(a){var b=D.tJ(a);D.pM(a,1.1*b)})}function y(a){var b=D.am(a),c=B.fA(function(){var c=D.am(a),d=c!=b;b=c;return d});B.T(a,"CHANGE_MOVE_STYLE",B.tf,[c],null,function(){K();e(X,H,ma)})}function K(){var a=t.Oi();B.Al(a,"TOGGLE_CHAR_MOVE_TYPE")&&t.jr()&&E.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)B.Fm(a,b[c])}function F(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function J(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&r.eY(f)}var g=performance.now();r.Rp(f)}m("animation");var D=m("camera"),R=m("config"),E=m("constraints"),I=m("container"),B=m("controls"),P=m("data"),d=m("debug"),f=m("input"),r=m("main"),g=m("physics"),Q=m("print"),t=m("scenes"),aa=m("transform"),M=m("util"),G=m("vec3"),T=1,S=null,X=!1,H=!1,ma=
!1,W=new Float32Array(2),O=new Float32Array(2),V=new Float32Array(3),ga=new Float32Array(3);new Float32Array(3);var v=new Float32Array(4),ba={},ea={};a.Vg=function(a){function e(){var a=b(k,E,z,m),f=I.Qi();if(a){var u=I.af();I.Bk();D&&(x(n,t),r.MY(q));y&&(l(),c());p&&r.Rp(function(){u.style.height=u.clientWidth/p+"px"});h&&r.Rp(function(){I.Bk()});F&&r.Rp(function(){I.SA()});v&&R.VC();K==R.Fp?d.kN(function(a,b){0==a?(Q.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),R.qn(R.hl)):1.5>b?(Q.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),R.qn(R.Gp)):(Q.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),R.qn(R.hl));g(f,!0)}):g(f,!0)}else g(f,!1)}function f(a){a.keyCode==B.UO&&(r.Cr()?r.ci():r.pause())}function g(){}a=a||{};var h=!1,k=null,m=null,n=null,p=0,t=null,u=!0,v=!1,y=!0,z=!0,A=!1,D=!1,G=!1,F=!1,K=R.get("quality"),H;for(H in a)switch(H){case "canvas_container_id":k=a.canvas_container_id;break;case "callback":g=a.callback;break;case "autoresize":h=a.autoresize;break;case "show_hud_debug_info":G=a.show_hud_debug_info;
break;case "sfx_mix_mode":A=a.sfx_mix_mode;break;case "show_fps":D=a.show_fps;break;case "track_container_position":F=a.track_container_position;break;case "fps_wrapper_id":t=a.fps_wrapper_id;break;case "fps_elem_id":n=a.fps_elem_id;break;case "error_purge_elements":m=a.error_purge_elements;break;case "report_init_failure":z=a.report_init_failure;break;case "pause_invisible":y=a.pause_invisible;break;case "key_pause_enabled":u=a.key_pause_enabled;break;case "force_container_ratio":p=a.force_container_ratio;
break;case "min_capabilities":v=a.min_capabilities;break;case "quality":K=a.quality;break;default:R.set(H,a[H])}K!=R.Fp&&R.set("quality",K);u&&document.addEventListener("keydown",f,!1);R.set("show_hud_debug_info",G);R.set("sfx_mix_mode",A);var E=G||A||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){P.ua()},!1)};a.Bk=function(){Q.Rb("app.resize_to_container","container.resize_to_container");I.Bk()};a.z8=function(a,
b){var c=A(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.y8=function(a,b){var c=A(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.A8=function(a,b){var c=A(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.Q3=e;a.I3=K;a.d8=function(a){Q.Kh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=t.Oi();D.jD(b,a)};a.nU=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=B.Ff(a,b,0),b){case "FORWARD":d?g.kp(a,1):aa.dh(a,0,-1*e,0);break;case "BACKWARD":d?g.kp(a,-1):aa.dh(a,0,1*e,0);break;case "LEFT":d?g.jp(a,-1):aa.dh(a,1*e,0,0);break;case "RIGHT":d?g.jp(a,1):aa.dh(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&g.kp(a,0);break;case "LEFT":case "RIGHT":d&&g.jp(a,0)}}var d=g.cf(a)||g.df(a),e=B.Gl(),f=B.Qb(B.Zy),h=B.Qb(B.Yy),k=B.Qb(B.Wy),l=B.Qb(B.Xy),m=B.Qb(B.SE),n=B.Qb(B.OE),p=B.Qb(B.QE),q=B.Qb(B.RE);B.T(a,
"FORWARD",B.kb,[e,f,m],b,c);B.T(a,"BACKWARD",B.kb,[e,h,n],b,c);B.T(a,"LEFT",B.kb,[e,k,p],b,c);B.T(a,"RIGHT",B.kb,[e,l,q],b,c)};a.cU=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)B.Fm(a,b[c])};a.S3=function(){Q.O("app.enable_controls() deprecated")};a.J3=function(){Q.O("app.disable_controls() deprecated")};a.T3=function(){B.xn(null,"CAMERA_SHOT",B.Ne,B.RO,function(){d.fX()});B.xn(null,"LIGHT_SHOT",B.Ne,B.SO,function(){d.iX()});B.xn(null,"TELEMETRY",B.Ne,B.ZO,function(){d.CC()})};
a.P7=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",
d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():Q.error("B4W App: request fullscreen method is not supported")};a.b4=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&Q.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.X2=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.O7=F;a.S5=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=
e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.RT=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;J(a,c,d,e,k)}};a.vR=function(a,b,c,d,e,f){function g(e){a&&
(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},J(a,c,d,e,g))};a.$X=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.$X(b)};"css"==c.type?a.RT(d,e,f,g,h,k,l,m):"attr"==c.type&&a.vR(d,e,f,g,h,m)}};a.e8=function(a){T=a};a.D4=function(){return T}};b4w.module.config=function(a,m){var l=m("__config"),c=m("__compat"),b=m("__debug"),x=m("__data"),q=m("__print");a.Gp=l.Gp;a.hl=l.hl;a.hn=l.hn;a.jF=l.jF;a.Fp=l.Fp;a.set=l.set;a.get=l.get;a.reset=l.reset;a.VC=l.VC;a.L5=l.Pu;a.Pu=l.Pu;a.qn=function(a){x.Yg()?q.error("Cannot change quality profile after a scene is loaded."):(l.set("quality",a),b.Su()&&(l.qn(),c.fM(b.Su(),!1)))}};b4w.module.data=function(a,m){var l=m("__data"),c=m("__loader");m("__print");a.load=l.load;a.ux=function(a){l.ux(a|0)};a.WL=l.WL;a.Yg=l.Yg;a.P6=c.jm;a.b7=l.load;a.ua=a.ux;a.KF=l.KF;a.gL=l.gL;a.BN=l.BN};b4w.module.debug=function(a,m){function l(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;J.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.TA.ALL_OPS-a.TA.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.TA,e=c.s0,f=x(c.PT),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";J.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);J.groupCollapsed("directives");for(var g=c.hb.Ki.slice().sort(),f=0;f<g.length;f++){var h=g[f];J.ae(h[0],h[1])}J.groupEnd();J.groupCollapsed("node elements");g=c.hb.lg;for(f=0;f<g.length;f++)J.ae(g[f]);J.groupEnd();J.groupCollapsed("vert source");J.ae(c.q0);J.groupEnd();J.groupCollapsed("vert translated source");J.ae(c.r0);J.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];J.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&J.ae(k,e[k]);
J.groupEnd();J.groupCollapsed("vert assembly");J.ae(c.p0);J.groupEnd();J.groupCollapsed("frag source");J.ae(c.VU);J.groupEnd();J.groupCollapsed("frag translated source");J.ae(c.WU);J.groupEnd();J.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&J.ae(k,d[k]);J.groupEnd();J.groupCollapsed("frag assembly");J.ae(c.MU);J.groupEnd();J.groupEnd()}}function x(a){for(var b=[],c=R.gr(),d=0;d<c.length;d++)for(var e=c[d],f=y.Vb(e,"MESH",y.nc),g=0;g<f.length;g++){var h=K.ka(f[g],e);if(h&&h.V.length)for(var h=
h.V,k=0;k<h.length;k++){var l=h[k];if(l.zb==a)for(var m=0;m<l.ud.length;m++){var n=l.ud[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function q(a,b){function c(){Q.push(c);t=b;return a.apply(a,arguments)}return c}function A(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var h=m("__config"),z=m("__compat"),p=m("__controls"),n=m("__container"),
k=m("__debug"),u=m("__extensions"),e=m("__loader"),y=m("__objects"),K=m("__obj_util"),F=m("__physics"),J=m("__print"),D=m("__renderer"),R=m("__scenes"),E=m("__scenegraph"),I=m("__sfx"),B=m("__shaders"),P=m("__subscene"),d=m("__textures"),f=m("__util"),r=m("__vec3"),g=h.B,Q=[],t="",aa=!0,M=new Float32Array(2);a.jt=k.jt;a.fy=k.fy;a.kt=k.kt;a.ey=k.ey;a.it=k.it;a.dy=k.dy;a.cy=k.cy;a.xp=k.xp;a.A7=function(){F.YT()};a.z7=function(a){J.log("O",F.IU(a));for(var b=F.hV().zc.sa,c=0;c<b.length;c++){var d=b[c];
d.C.fa==a&&J.log("B",d)}};a.V9=function(){for(var a=R.A(),b=y.Vb(a,"MESH",y.nc),a=[R.La(a,P.Pb),R.La(a,P.Qc),R.La(a,P.ge)],c=0;c<a.length;c++){var d=a[c],e=subs.Qa;if(e.length){J.group(d.type,"DYNAMIC");for(var f=0;f<b.length;f++){var g=b[f],h=g.k;if("DYNAMIC"==h.type)for(var k=!1,l=0;l<e.length;l++){for(var m=e[l].sa,n=0;n<m.length;n++){var p=m[n];if(p.dc&&p.gf==h){J.ae(g.name,g);k=!0;break}}if(k)break}}J.groupEnd();J.groupCollapsed(d.type,"STATIC");for(f=0;f<b.length;f++)if(g=b[f],h=g.k,"DYNAMIC"!=
h.type)for(k=!1,l=0;l<e.length;l++){m=e[l].sa;for(n=0;n<m.length;n++)if(p=m[n],p.dc&&p.gf==h){J.ae(g.name,g);k=!0;break}if(k)break}J.groupEnd()}}};a.t7=function(a){for(var b=R.A(),c=y.Vb(b,"MESH",y.nc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){J.log("Object",e);for(var f=R.WA(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Qa,m=0;m<l.length;m++)for(var n=l[m].sa,p=0;p<n.length;p++)n[p].gf==e.k&&k.push(n[p]);J.log("Subscene "+h.type,k)}}}};a.u7=function(){var a=R.A();console.log("Armatures: "+y.Vb(a,
"ARMATURE",y.nc).length);console.log("Cameras: "+y.Vb(a,"CAMERA",y.nc).length);console.log("Curves: "+y.Vb(a,"CURVE",y.nc).length);console.log("Empties: "+y.Vb(a,"EMPTY",y.nc).length);console.log("Lamps: "+y.Vb(a,"LAMP",y.nc).length);console.log("Meshes: "+y.Vb(a,"MESH",y.nc).length);console.log("Speakers: "+y.Vb(a,"SPEAKER",y.nc).length)};a.Rr=function(){for(var a=0,b=R.A(),b=[R.La(b,P.Pb),R.La(b,P.Qc),R.La(b,P.ge)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=
d[e].sa,g=0;g<f.length;g++){var h=f[g].za;h&&(a+=h.Rr)}}return a};a.vm=function(){for(var a=0,b=R.A(),b=[R.La(b,P.Pb),R.La(b,P.Qc),R.La(b,P.ge)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].sa,g=0;g<f.length;g++){var h=f[g].za;h&&(a+=h.vm)}}return a};a.n7=function(){for(var a=R.A(),b=R.FD(a,[P.Pb,P.Qc,P.ge,P.Nd,P.vf]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Qa,f=0;f<e.length;f++)c+=e[f].sa.length;a=R.FD(a,[P.nd,P.Pe]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Qa,
f=0;f<e.length;f++)c+=6*e[f].sa.length;return c};a.q7=function(){return f.ir(B.HI())};a.y4=function(){for(var a=R.A(),b=R.WA(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=P.ln&&d.type!=P.uf)for(var e=d.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,h=0;h<g.length;h++){var k=g[h].za,l=g[h].gf;k&&(d.type!=P.sf&&d.type!=P.Ag||l.iw||l.hw)&&(a[k.id]=k)}}var c=b=0,m;for(m in a)d=a[m].Ba,d.zn&&(c+=d.zn/1048576),b+=d.Bn/1048576;return{vbo_memory:b,ibo_memory:c}};a.r7=function(){for(var a=[],b=0,c=R.A(),c=[R.La(c,
P.Pb),R.La(c,P.Qc),R.La(c,P.ge)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,h=0;h<g.length;h++){var k=g[h].za;if(k)for(var k=k.ya,l=0;l<k.length;l++){var m=k[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var n=m.sb;-1===a.indexOf(n)&&(a.push(n),m=m.width*m.height*4/1048576/m.Bq,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.p7=function(){for(var a=[],b=0,c=R.A(),c=R.WA(c),e=0;e<c.length;e++){var f=c[e];if(f.type!=P.ln){var g=f.p,h=[g.vc,
g.We];h.push.apply(h,f.ki);for(f=0;f<h.length;f++){var k=h[f];d.bo(k)&&-1==a.indexOf(k)&&(a.push(k),b+=g.width*g.height*d.PV(k))}}}return{number:a.length,memory:b/1024/1024}};a.fX=function(){var a=R.A();(a=R.La(a,P.Pb))&&R.yK(a.p,a,[1,1,0])};a.iX=function(){var a=R.A(),b=R.La(a,P.Pb),a=R.FD(a,[P.dd]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}R.yK(d.p,b,e)}};a.a8=function(){for(var a=R.gr(),b=0;b<a.length;b++)J.log("\n"+
E.VT(R.dB(a[b])))};a.b8=function(){};a.d7=function(){J.log("\n"+e.TV())};a.r3=p.debug;a.s7=function(a,b){var c=m_tsr.F(a.k.n),d=m_tsr.F(b.k.n);return r.dist(c,d)};a.GK=k.GK;a.Hu=k.Hu;a.kL=k.kL;a.CC=k.CC;a.l4=function(a,b){function c(){k.Hu("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.C2=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),g=new Float32Array([-1,0,0]),h=new Float32Array([0,-1,0]),k=new Float32Array([0,
0,-1]);if(!f.Nj(a,f.rF))throw"Wrong VEC3_IDENT";if(!f.Nj(b,f.jn))throw"Wrong QUAT4_IDENT";if(!f.Nj(c,f.ri))throw"Wrong AXIS_X";if(!f.Nj(d,f.zj))throw"Wrong AXIS_Y";if(!f.Nj(e,f.Oc))throw"Wrong AXIS_Z";if(!f.Nj(g,f.Sx))throw"Wrong AXIS_MX";if(!f.Nj(h,f.el))throw"Wrong AXIS_MY";if(!f.Nj(k,f.ad))throw"Wrong AXIS_MZ";};a.l7=function(){for(var a=I.jB(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==I.kB(c)&&I.ec(c,!0)}};a.MG=function(a){k.MG(a)};a.k8=function(a){var b=R.A();if(b=R.La(b,P.uf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case k.jt:case k.fy:case k.kt:case k.ey:case k.it:case k.dy:case k.cy:case k.xp:R.HY(b,a.debug_view_mode);break;default:J.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&R.GY(b,a.debug_colors_seed);"number"==typeof a.lY&&R.cZ(b,a.lY);"object"==typeof a.wireframe_edge_color&&R.lZ(b,f.Cf(a.wireframe_edge_color))}else J.error("Debugging is not available on the scene.")};a.Q4=function(){return J.tV()};a.e6=function(){return J.RV()};
a.YG=function(){return J.YG()};a.k2=function(a){var d=B.HI(),e=0,f;for(f in d)a&&-1===f.indexOf(a)||e++;var e="of "+e+" analyzing...",g={};for(f in d)if(!a||-1!==f.indexOf(a)){var h=d[f],m;var n=h.Gx;m=h.Mu;var p=u.pV();if(p){var q=p.getTranslatedShaderSource(n),p=p.getTranslatedShaderSource(m);if(z.Cn())var q=q.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),r=c("/analyze_shader/vert_gles",q),t=c("/analyze_shader/frag_gles",p);else q=q.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),r=c("/analyze_shader/vert",q),t=c("/analyze_shader/frag",p);var x=l(r),y=l(t);m={q0:k.Su().getShaderSource(n),r0:q,p0:r,s0:x,VU:k.Su().getShaderSource(m),WU:p,MU:t,TA:y}}else J.error("WEBGL_debug_shaders extension not found"),m=void 0;q=h.hb;n=q.wg+" + "+q.Ye;m.PT=h;m.hb=q;h=g[n]=g[n]||[];h.push(m);J.ae(e)}for(n in g)J.group("%c"+n,"color: #800"),h=g[n],b(h),J.groupEnd()};a.cI=k.cI;a.kN=function(b){if(B.RG())if(u.bB()){var c=g.gl_debug;g.gl_debug=!0;var d=
E.fT();R.qI(null,d);for(var e=E.ic(d,P.Ep),f=e.p,d=0;5>d;d++)D.Gn(e);g.gl_debug=c;window.setTimeout(function(){k.YX(e);var a=e.Af;b(a,f.width*f.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.kN(b)},100)};a.AG=k.AG;a.DM=k.DM;a.jL=k.jL;a.j9=function(a){Q=[];aa=!0;a=m(a);for(var b in a)"function"===typeof a[b]&&(a[b]=q(a[b],b))};a.W2=function(){return aa};a.test=function(a,b){try{return b(),!0}catch(c){return aa=!1,console.error(a+" test was failed. ",c),!1}};
a.C7=function(a){var b=n.zJ(),c=n.yJ(),d=b/2,e=c/2;n.resize(b,c,!1);b=R.A().s.Wa;(c=E.JU(b))||f.q("Couldn't find onscreen subscene");b=c.p;d=n.cu(d,e,M,c.p);d[1]=b.height-d[1];d=D.NC(b.$e,d[0],d[1]);A(a,d,1)};a.Y3=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+t;};a.Z3=A;a.X3=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.W3=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
m(a);for(var b in a)-1==Q.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.v7=function(a){if(!Boolean(a))throw"Wrong result. Function: "+t;}};b4w.module.input=function(a,m){function l(a){var c=b.ja(b.Oe);if(!c||!c.kh)return!1;if(e)return!0;var l=b.Ti(c,b.tO,k),d=b.Ti(c,b.uO,u);x.iD(a,l,d);if(l=b.Zu(c,F))d=p.A(),a=h.ka(a,d).da,x.eD(a,l);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.Zu(b.vt)!==b.Vy&&(a.distortion_coefs=[c.distortion_coefs[0],c.distortion_coefs[1]],a.chromatic_aberration_coefs=[c.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]],
c.op||(c.Ij&&c.bk&&c.Jj?a.base_line_factor=(c.Ij-c.Jj)/c.bk:c.Jj||(a.base_line_factor=c.Ij/c.bk)),c.Vi&&c.an&&!c.op&&(a.inter_lens_factor=c.Vi/c.an),y.enabled||(l=1+c.distortion_coefs[0]+c.distortion_coefs[1],p.HK(l,l)));p.Mw(a);A.Bk(!0);b.UC(c);return e=!0}function c(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=m("__input"),x=m("__camera"),q=m("__config"),A=m("__container"),
h=m("__obj_util"),z=m("__print"),p=m("__scenes"),n=m("__vec4"),k=n.create(),u=n.create(),e=!1,y=q.Lq,K=q.B;a.uy=b.uy;a.vy=b.vy;a.xy=b.xy;a.wy=b.wy;a.Jy=b.Jy;a.qy=b.qy;a.ry=b.ry;a.Cy=b.Cy;a.Ly=b.Ly;a.qt=b.qt;a.Ky=b.Ky;a.pt=b.pt;a.My=b.My;a.Ny=b.Ny;a.sy=b.sy;a.ty=b.ty;a.yy=b.yy;a.zy=b.zy;a.Ay=b.Ay;a.By=b.By;a.Dy=b.Dy;a.Ey=b.Ey;a.Fy=b.Fy;a.Gy=b.Gy;a.Hy=b.Hy;a.Iy=b.Iy;a.lt=b.lt;a.mt=b.mt;a.nt=b.nt;a.ot=b.ot;a.ky=b.ky;a.ly=b.ly;a.my=b.my;a.ny=b.ny;a.oy=b.oy;a.py=b.py;a.iy=b.iy;a.jy=b.jy;a.tt=b.tt;a.ut=
b.ut;a.vt=b.vt;a.IE=b.IE;a.JE=b.JE;a.HE=b.HE;a.Vy=b.Vy;var F=b.Ry;a.Ry=F;a.Qy=b.Qy;a.Oy=b.Oy;a.Ty=b.Ty;a.Uy=b.Uy;a.Sy=b.Sy;a.Py=b.Py;a.vi=b.vi;a.fl=b.fl;a.Cp=b.Cp;a.Dp=b.Dp;a.Ap=b.Ap;a.zp=b.zp;a.kl=b.kl;a.Jp=b.Jp;a.jl=b.jl;a.st=b.st;a.fn=b.fn;var J={};J[b.Oe]=[b.tt,b.ut];J[b.bd]=[b.vi];var D={};D[b.Oe]=[b.vt];var R={};R[b.bd]=[b.vi,b.fl,b.Cp,b.Dp];R[b.tp]=[b.Ap,b.zp];R[b.yg]=[b.kl,b.Jp,b.jl];R[b.uh]=[b.st,b.fn];var E={};E[b.Oe]=[b.Qy,b.Ry,b.Oy,b.Ty,b.Uy,b.Sy,b.Py];a.uh=b.uh;a.Oe=b.Oe;a.bd=b.bd;a.tp=
b.tp;a.yg=b.yg;a.Nz=b.Nz;a.ja=b.ja;a.LD=function(a,c){a&&b.LD(a,c)};a.F7=function(){z.O("input.register_device() deprecated")};a.UC=function(a){a&&a.type==b.Oe?b.UC(a):z.error("reset_device is undefined for device.")};a.Ti=function(a,c,e){if(a&&a.type in J&&0<=J[a.type].indexOf(c))return b.Ti(a,c,e);z.error("device hasn't param: ",c)};a.Zu=function(a,c){if(a&&a.type in D&&0<=D[a.type].indexOf(c))return b.Zu(a,c);z.error("device hasn't param: ",c)};a.yd=function(a,c,e){e=e||null;if(a&&a.type in R&&
0<=R[a.type].indexOf(c))return b.yd(a,c,e);z.error("device hasn't param: ",c)};a.Bd=function(a,c,e){e=e||null;if(a&&a.type in R&&0<=R[a.type].indexOf(c))return b.Bd(a,c,e);z.error("device hasn't param: ",c)};a.dD=function(a,c,e){if(a&&a.type in E&&0<=E[a.type].indexOf(c))return b.dD(a,c,e);z.error("device hasn't config: ",c)};a.Q7=function(){if(p.Ca()){var a=p.Mh(p.A());if(a&&(l(a),a=b.ja(b.Oe))){var c=a.Rf;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=A.Qi(),c.requestPresent([{source:a}]).then(function(){if(!K.is_mobile_device){var a=
c.getEyeParameters("left"),b=c.getEyeParameters("right");A.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){z.error("HMD fullscreen request failed.")})):z.error("HMD fullscreen request failed."))}}};a.V3=l;a.L3=function(){var a=b.ja(b.Oe);if(!(e||a&&a.kh))return!1;p.Mw({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);p.HK(a,a);A.Bk(!0);return!0};a.p8=function(a,e,h){c();switch(a){case 0:a=b.gt;break;case 1:a=b.$x;break;
case 2:a=b.ay;break;case 3:a=b.by;break;default:a=b.gt}a=b.ja(a);b.dD(a,e,h)};a.gJ=b.gJ;a.ZI=b.ZI;a.mS=c};b4w.module.preloader=function(a,m){var l=m("container"),c,b,x,q,A,h,z,p,n=null;a.gT=function(){var a="#000",h="#5276cf",e="#fff",m="#fff",n;for(n in void 0)switch(n){case "container_color":a=(void 0).container_color;break;case "bar_color":h=(void 0).bar_color;break;case "frame_color":e=(void 0).frame_color;break;case "font_color":m=(void 0).font_color}n=document.createElement("div");var p=n.cloneNode(),z=n.cloneNode(),A=n.cloneNode(),R=l.af();z.appendChild(p);z.appendChild(A);n.appendChild(z);R.appendChild(n);
n.style.cssText="background-color: "+a+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";z.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+e+";";p.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";A.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
m+";";c=p;b=A;x=n;q="DEFAULT"};a.A3=function(a){var h=null,e=null,l="#bf9221",m="#000",p;for(p in a)switch(p){case "canvas_container_id":h=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":m=a.bg_color;break;case "bar_color":l=a.bar_color}a=document.createElement("div");p=document.createElement("div");a.id="simple_preloader_container";var z=document.createElement("div"),D=document.createElement("div"),e=document.getElementById(e);n=document.getElementById(h);
a.style.cssText="z-index: 4;background-color: "+m+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";p.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";z.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+l+";border-radius: 0px;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
p.appendChild(z);p.appendChild(D);a.appendChild(p);document.body.appendChild(a);q="SIMPLE";x=a;c=z;b=D;A=e};a.x3=function(a){var c=null,e=null,l="rgba(0,0,0,0)",m="",p="",z="rgba(0,0,0,0)",D;for(D in a)switch(D){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "frame_bg_color":l=a.frame_bg_color;break;case "bg_color":z=a.bg_color;break;case "frame_class":m=a.frame_class;break;case "anim_elem_class":p=a.anim_elem_class}a=
document.createElement("div");D=document.createElement("div");var R=document.createElement("div"),E=document.createElement("div"),e=document.getElementById(e);n=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+z+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+l+";";R.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
E.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";R.className=p;D.appendChild(R);D.className=m;D.appendChild(E);a.appendChild(D);n.appendChild(a);q="ROTATION";x=a;h=R;b=E;A=e};a.v3=function(a){var h=a.preloader_width,h=h/(h-a.img_width),e=document.getElementById(a.preloader_bar_id),l=document.getElementById(a.fill_band_id),m=document.getElementById(a.preloader_caption_id),F=document.getElementById(a.preloader_container_id),
J=document.getElementById(a.background_container_id);n=document.getElementById(a.canvas_container_id);q="ADVANCED";c=e;z=l;p=h;b=m;x=F;A=J};a.Q_=function(a){b.innerHTML=a+"%";"SIMPLE"==q?c.style.width=a+"%":"ADVANCED"==q?(c.style.width=a/p+"%",z.style.width=100-a+"%"):"ROTATION"==q?h.style.transform="rotate("+a+"deg)":"DEFAULT"==q&&(c.style.width=a+"%");100==a&&(x.parentNode.removeChild(x),A&&A.parentNode.removeChild(A))}};"object"==typeof module&&module.MA&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,m){m("__print");var l=m("__version");a.version=l.version;a.oE=l.oE;a.type=l.type;a.JH=l.JH;a.xA=l.xA};"object"==typeof module&&module.MA&&b4w.module.version(exports);b4w.module.lights=function(a,m){function l(a){for(var c=h.A(),e=x.Vb(c,"LAMP",x.nc),l=0;l<e.length;l++){var m=e[l];if("SUN"==m.ub.type){var q=m;break}}if(!q)A.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=n.Cb(180-a.hor_position);a=n.Cb(90-a.vert_position);l=q.k;z.Qw(q,[a,0,e]);e=new Float32Array(3);m=p.N(l.n);n.pc(m,n.Oc,e);l=p.F(l.n);l=k.length(l);k.copy(e,u);k.scale(u,l,u);z.Gc(q,u);z.D(q);e=q.ub;if(e.WH){var y=c.world.light_settings.environment_energy,
l=c.world.horizon_color,m=c.world.zenith_color,B=Math.cos(Math.abs(a));a=Math.max(Math.min(3*B,1),0)*e.MH;y*=Math.max(B,.1);b.vs(e,a);h.Kw(c,y,l,m)}h.gp(q,c)}}function c(a){if(q.Xg(a))return a.ub.type;A.error("get_light_type(): Wrong object");return!1}var b=m("__lights"),x=m("__objects"),q=m("__obj_util"),A=m("__print"),h=m("__scenes"),z=m("__transform"),p=m("__tsr"),n=m("__util"),k=m("__vec3"),u=new Float32Array(3),e,y=60;a.e5=function(a){var b=h.A(),b=x.Vb(b,"LAMP",x.nc);if(!a)return b;for(var c=
[],e=0;e<b.length;e++){var k=b[e];k.ub.type===a&&c.push(k)}return c};a.OV=function(){for(var a=h.A(),a=x.Vb(a,"LAMP",x.nc),b=null,c=0;c<a.length;c++){var e=a[c];if("SUN"==e.ub.type){b=e;break}}return b?(b=b.ub.direction,a=n.ne(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=n.ne(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.L8=l;a.j8=function(a){for(var b=h.A(),b=x.Vb(b,"LAMP",x.nc),c=0;c<b.length;c++){var e=b[c];if("SUN"==e.ub.type){var k=e;break}}k?
(k=-Math.cos(a/12*Math.PI)*y,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=k,l(b)):A.error("There is no sun on the scene")};a.i8=function(a){(e=a.getDate())?1582==e&&10==a.g7&&4<a.UT&&15>a.UT&&A.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):A.error("There is no year 0 in the Julian system!")};a.v8=function(a){y=Math.min(Math.max(a,0),90)};a.h5=function(a){if(q.Xg(a))var b=a.ub;else return A.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var e=
{light_type:a,light_color:new Float32Array(3),light_energy:b.Bf,light_spot_blend:b.Fs,light_spot_size:b.Om,light_distance:b.distance};e.light_color.set(b.color);break;case "POINT":e={light_type:a,light_color:new Float32Array(3),light_energy:b.Bf,light_distance:b.distance};e.light_color.set(b.color);break;default:e={light_type:a,light_color:new Float32Array(3),light_energy:b.Bf},e.light_color.set(b.color)}return e?e:null};a.i5=c;a.r8=function(a,c){if(q.Xg(a)){var e=a.ub,k=h.A(),l=!1;"number"==typeof c.light_energy&&
b.vs(e,c.light_energy);"object"==typeof c.light_color&&b.Ow(e,c.light_color);"number"==typeof c.light_spot_blend&&(b.TY(e,c.light_spot_blend),l=!0);"number"==typeof c.light_spot_size&&(b.UY(e,c.light_spot_size),l=!0);"number"==typeof c.light_distance&&(b.SY(e,c.light_distance),l=!0);h.gp(a,k);l&&h.q_(k)}else A.error("set_light_params(): Wrong object")};a.g5=function(a){return q.Xg(a)?a.ub.Bf:(A.error("get_light_energy(): Wrong object"),0)};a.vs=function(a,c){if(q.Xg(a)){var e=h.A();b.vs(a.ub,c);h.gp(a,
e)}else A.error("set_light_energy(): Wrong object")};a.f5=function(a,b){if(!q.Xg(a))return A.error("get_light_color(): Wrong object"),null;b=b||new Float32Array(3);b.set(a.ub.color);return b};a.Ow=function(a,c){if(q.Xg(a)){var e=h.A();b.Ow(a.ub,c);h.gp(a,e)}else A.error("set_light_color(): Wrong object")}};if(b4w.module_check("logic"))throw"Failed to register module: logic";
b4w.register("logic",function(a,m){function l(a){var e=x.Qb(x.NE);x.T(a,"CHANGE_CAMERA",x.Ne,[e],null,function(a,e,h){1==h&&"CHANGE_CAMERA"==e&&0==k.state&&(a=b(k.CG,c(k.CG,k.LF)),p.OL(a.name),k.LF=a.name,console.log("First person view > CHANGE_CAMERA"))})}function c(a,b){for(var c=0,e=a.length;c<e;c++)if(a[c].name===b)return c;return-1}function b(a,b){var c=b+1;c==a.length&&(c=0);return a[c]}m("main");var x=m("controls"),q=m("scenes"),A=m("physics");m("animation");m("sfx");m("time");var h=m("transform");
m("util");m("vec3");m("constraints");m("mouse");m("camera");m("container");var z=m("character"),p=m("cam_util"),n=null,k=null,u=null,e=new Float32Array(4);a.vB=function(){n=q.lr("LogicEmpty");k=z.GJ();l(n)};a.q5=function(a,b){for(var c=0,e=a.length;c<e;c++)if(a[c].name===b)return a[c];return-1};a.t5=c;a.D3=b;a.lW=function(){u={};for(var a=/^Spawner/,b=q.Pi("EMPTY"),c=0;c<b.length;c++)a.test(b[c].name)&&(u[b[c].name]=b[c],console.log("Empty found: "+b[c].name));console.log(c+" Spawners loaded")};a.DZ=
function(a,b){var c=h.Zd(a);h.bm(a,e);A.xs(b,[c[0],c[1],c[2]],e);console.log("Spawner position: "+h.Zd(a));console.log("Object position: "+h.Zd(b))};a.iB=function(){return u.SpawnerOutRover};a.e7=function(){};a.c8=function(){}});if(b4w.module_check("cam_util"))throw"Failed to register module: cam_util";
b4w.register("cam_util",function(a,m){m("main");m("controls");var l=m("scenes");m("physics");m("animation");m("sfx");m("time");m("transform");m("util");m("vec3");var c=m("constraints");m("mouse");m("camera");m("container");var b=null,x=null;a.fW=function(){b=l.Oi();console.log("cam_util config started")};a.gW=function(){x={};for(var a=/^Camera/,b=l.Pi("EMPTY"),c=0;c<b.length;c++)a.test(b[c].name)&&(x[b[c].name]=b[c],console.log("Camera empty found: "+b[c].name));console.log(c+" Camnera empties loaded")};
a.sV=function(){return x};a.Mh=function(){if(null!=b)return b};a.OL=function(a){"CameraFirstPersonEmpty"==a?(c.remove(b),c.rz(b,x[a],[0,0,0])):"CameraThirdPersonEmpty"==a&&(c.remove(b),c.SQ(b,x[a]))}});if(b4w.module_check("environment"))throw"Failed to register module: environment";
b4w.register("environment",function(a,m){m("main");var l=m("controls"),c=m("scenes");m("physics");m("animation");m("sfx");m("time");var b=m("transform");m("util");m("vec3");var x=m("constraints");m("mouse");m("camera");m("container");var q=m("tsr"),A=m("character"),h=null,z=null,p=new Float32Array(3);a.iW=function(){h=c.lr("Sun");z=c.lr("SunHolder");var a=A.GI();x.QF(h,z,[0,0,0]);x.QF(z,a,[6.5,0,6]);console.log("Environment started")};a.oZ=function(){var a=l.Gl();l.T(z,"UPDATE",l.kb,[a],null,function(a){var c=
q.create();q.identity(c);b.fi(a,c);b.Zd(z,p);b.Gc(h,p)})}});if(b4w.module_check("character"))throw"Failed to register module: character";
b4w.register("character",function(a,m){m("main");var l=m("controls"),c=m("scenes"),b=m("physics");m("animation");m("sfx");m("time");m("transform");m("util");m("vec3");m("constraints");m("mouse");m("camera");m("container");var x=m("cam_util"),q=null;a.hW=function(){var a=c.lr("Character"),b=x.Mh(),l=x.sV(),m=[],n;for(n in l)"Character"==l[n].parent.name&&m.push(l[n]);q={Cm:a,M2:b,state:0,CG:m,LF:"CameraFirstPersonEmpty"};x.OL("CameraFirstPersonEmpty");console.log("Character controlled")};a.GJ=function(){return q};
a.GI=function(){return q.Cm};a.nZ=function(){function a(c,h,k){if(1==k)switch(h){case "FORWARD":x=1;break;case "BACKWARD":x=-1;break;case "LEFT":e=1;break;case "RIGHT":e=-1;break;case "RUNNING":b.Eo(c,b.pO)}else switch(h){case "FORWARD":case "BACKWARD":x=0;break;case "LEFT":case "RIGHT":e=0;break;case "RUNNING":b.Eo(c,b.EE)}b.Jw(c,x,e)}var c=l.Qb(l.Wy),m=l.Qb(l.Yy),p=l.Qb(l.Xy),n=l.Qb(l.Zy),k=l.Qb(l.YO),u=l.Qb(l.XO),e=0,x=0,c=[n,m,c,p,u];l.T(q.Cm,"FORWARD",l.ti,c,function(a){return a[0]},a);l.T(q.Cm,
"BACKWARD",l.ti,c,function(a){return a[1]},a);l.T(q.Cm,"LEFT",l.ti,c,function(a){return a[2]},a);l.T(q.Cm,"RIGHT",l.ti,c,function(a){return a[3]},a);l.T(q.Cm,"RUNNING",l.ti,c,function(a){return(a[0]||a[1]||a[2]||a[3])&&a[4]},a);l.T(q.Cm,"JUMP",l.Ne,[k],null,function(a){b.Oz(a)})}});if(b4w.module_check("vehicles"))throw"Failed to register module: vehicles";
b4w.register("vehicles",function(a,m){function l(a){var k=!1,l=[b.qA(2,!0)],m=[b.Qb(b.PE)],n=a.v.xk;A.SF(z.iB(),a,[0,0,0]);var D=p.GI();b.T(a,"GET_DISTANCE",b.ti,l,function(a){return a[0]},function(a,b,c){1==c&&(5>q.distance(a,D)?0==k&&(k=!0,x.iR(a)):1==k&&(k=!1,x.nq(a)))},[n]);b.T(a,"ENTER_VEHICLE",b.Ne,m,function(a){return a[0]},function(a,b,e){1==e&&(b=h.Mh(),0==u.state&&1==k?(console.log("Entering vehicle"),A.remove(b),A.UQ(b,a),c.nU(a),console.log("vehicle entered."),u.state=1):1==u.state&&(console.log("Leaving vehicle"),
z.DZ(z.iB(),D),A.rz(b,D,[0,.7,0]),c.cU(a),u.state=0))},[n])}var c=m("app");m("main");var b=m("controls"),x=m("scenes");m("physics");m("animation");m("sfx");m("time");var q=m("transform");m("util");m("vec3");var A=m("constraints");m("mouse");m("camera");m("container");var h=m("cam_util"),z=m("logic"),p=m("character"),n=[],k=null,u=null;a.mW=function(){k=x.lr("Chassis");u=p.GJ();A.SF(z.iB(),k,[0,5,0]);n[0]=k;l(n[0]);console.log("Vehicles set up")};a.W8=function(){}});if(b4w.module_check("robots"))throw"Failed to register module: robots";b4w.register("robots",function(a,m){m("main");m("controls");m("scenes");m("physics");m("animation");m("sfx");m("time");m("transform");m("util");m("vec3");m("constraints");m("mouse");m("camera");m("container");a.H6=function(){console.log("Vehicles set up")};a.U8=function(){}});if(b4w.module_check("machines"))throw"Failed to register module: machines";b4w.register("machines",function(a,m){m("main");m("controls");m("scenes");m("physics");m("animation");m("sfx");m("time");m("transform");m("util");m("vec3");m("constraints");m("mouse");m("camera");m("container");a.G6=function(){console.log("Machines set up")};a.T8=function(){}});if(b4w.module_check("build"))throw"Failed to register module: build";b4w.register("build",function(a,m){m("main");m("controls");m("scenes");m("physics");m("animation");m("sfx");m("time");m("transform");m("util");m("vec3");m("constraints");m("mouse");m("camera");m("container");a.F6=function(){console.log("Build config started")};a.S8=function(){}});b4w.register("terraform_app",function(a,m){function l(a,e){e?(h.gT(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},A.load(D+"terraform.json",b,c)):console.log("b4w init failure")}function c(a){h.Q_(a)}function b(a,b){if(b){var c=k.OV();console.log(c);u.lW();e.gW();e.fW();K.hW();u.vB();y.iW();var h=p.Qi();h.addEventListener("mouseup",function(){n.qY(h)},!1);K.nZ();y.oZ();F.mW()}else console.log("b4w load failure")}var x=m("app"),q=m("config"),A=m("data"),h=m("preloader"),
z=m("version");m("scenes");m("constraints");m("main");m("controls");var p=m("container"),n=m("mouse");m("physics");var k=m("lights");m("tsr");m("transform");m("mat4");var u=m("logic"),e=m("cam_util"),y=m("environment"),K=m("character"),F=m("vehicles");m("robots");m("machines");m("build");var J="DEBUG"==z.type(),D=q.Pu("terraform");a.Vg=function(){x.Vg({canvas_container_id:"main_canvas_container",callback:l,show_fps:J,console_verbose:J,autoresize:!0,ssao:!1})}});b4w.require("terraform_app").Vg();
